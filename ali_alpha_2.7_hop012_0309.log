Namespace(K=1, Ks='[20, 40, 60]', alpha=2.7, batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ali', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, gnn='lightgcn', gpu_id=4, l2=0.001, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=32, neg_mix_num=2, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上进行softmax自适应权重,引入alpha超参数来控制模型倾向......
start training ...
epoch: 0 s: 0 batch_loss 0.6931478381156921 BPR_loss 0.6931475400924683 reg_loss 3.145268294701964e-07
epoch: 0 s: 256000 batch_loss 0.692864179611206 BPR_loss 0.6928322911262512 reg_loss 3.19108075927943e-05
epoch: 0 s: 512000 batch_loss 0.6890271306037903 BPR_loss 0.6884703636169434 reg_loss 0.0005567730986513197
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 44.762831926345825 | 197.05343389511108 | 247.3199005126953 | [0.02808298 0.04660228 0.06038958] | [0.01217235 0.01617552 0.0187889 ] | [0.0018518  0.00153949 0.00133726] | [0.03538139 0.05781534 0.07440296] |
|   0   | 44.762831926345825 |  617.628912448883  | 247.3199005126953 | [0.00323738 0.0067043  0.00940578] | [0.00129499 0.00202303 0.00252265] | [0.00017658 0.00018951 0.0001825 ] | [0.00347258 0.00741802 0.01069851] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6850211024284363 BPR_loss 0.6836850047111511 reg_loss 0.001336114015430212
epoch: 1 s: 256000 batch_loss 0.6830302476882935 BPR_loss 0.6812604069709778 reg_loss 0.0017698551528155804
epoch: 1 s: 512000 batch_loss 0.6796409487724304 BPR_loss 0.6770117878913879 reg_loss 0.00262918951921165
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 68.86535239219666 | 708.0164086818695 | 244.4827423095703 | [0.03669736 0.05933543 0.07741674] | [0.01600114 0.02090768 0.02430515] | [0.00235646 0.00191764 0.00167186] | [0.04512989 0.07241741 0.0935966 ] |
|   1   | 68.86535239219666 | 631.4920513629913 | 244.4827423095703 | [0.0050765  0.0096715  0.01410889] | [0.0020763  0.00303446 0.00384815] | [0.00027263 0.00026931 0.00026672] | [0.00536403 0.01058029 0.01566356] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6816322207450867 BPR_loss 0.67917799949646 reg_loss 0.0024542445316910744
epoch: 2 s: 256000 batch_loss 0.6812507510185242 BPR_loss 0.6784404516220093 reg_loss 0.0028102791402488947
epoch: 2 s: 512000 batch_loss 0.6790923476219177 BPR_loss 0.6757135987281799 reg_loss 0.0033787533175200224
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 74.82356357574463 |  678.615231513977 | 243.15219116210938 | [0.04519135 0.07024424 0.08929605] | [0.01972558 0.02515321 0.02873395] | [0.00281148 0.00221168 0.0018911 ] | [0.05421654 0.08387568 0.10654404] |
|   2   | 74.82356357574463 | 471.5552339553833 | 243.15219116210938 | [0.00656158 0.0123609  0.01785903] | [0.00267573 0.00388295 0.00488581] | [0.00035243 0.00034061 0.00033396] | [0.00695994 0.01343224 0.01969766] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6782466769218445 BPR_loss 0.6744881868362427 reg_loss 0.0037584754172712564
epoch: 3 s: 256000 batch_loss 0.6764988899230957 BPR_loss 0.6726661324501038 reg_loss 0.003832748392596841
epoch: 3 s: 512000 batch_loss 0.6777064800262451 BPR_loss 0.6739509701728821 reg_loss 0.0037555291783064604
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 68.82676076889038 | 721.3654453754425 | 242.10069274902344 | [0.05182925 0.07871612 0.0998173 ] | [0.02298855 0.02879503 0.03275102] | [0.00318033 0.0024454  0.00208781] | [0.06162098 0.09325189 0.11801611] |
|   3   | 68.82676076889038 | 617.1178572177887 | 242.10069274902344 | [0.0075701  0.01416295 0.02005772] | [0.00311953 0.00449064 0.00556255] | [0.00040489 0.00038789 0.00037139] | [0.0080091  0.01532369 0.02192898] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.6760115623474121 BPR_loss 0.6713533401489258 reg_loss 0.004658238496631384
epoch: 4 s: 256000 batch_loss 0.6695778369903564 BPR_loss 0.6649748682975769 reg_loss 0.004602959379553795
epoch: 4 s: 512000 batch_loss 0.6749827861785889 BPR_loss 0.6703850030899048 reg_loss 0.00459777656942606
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 70.27256727218628 | 678.5359973907471 | 240.74349975585938 | [0.05671773 0.08481047 0.10639622] | [0.02523779 0.03129176 0.03534053] | [0.00344231 0.00260983 0.002208  ] | [0.06672274 0.09987039 0.12519993] |
|   4   | 70.27256727218628 | 536.4614150524139 | 240.74349975585938 | [0.00829171 0.01529338 0.0220297 ] | [0.00339866 0.00485766 0.00608119] | [0.00044479 0.00042003 0.0004076 ] | [0.00880706 0.01659451 0.02405686] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.675784170627594 BPR_loss 0.6705429553985596 reg_loss 0.005241238046437502
epoch: 5 s: 256000 batch_loss 0.6724518537521362 BPR_loss 0.667269229888916 reg_loss 0.0051826429553329945
epoch: 5 s: 512000 batch_loss 0.6663575172424316 BPR_loss 0.6604466438293457 reg_loss 0.00591089203953743
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 69.92748785018921 | 568.3599500656128 | 239.15635681152344 | [0.0600173  0.08953718 0.11164778] | [0.0269935  0.033357   0.03749051] | [0.00362156 0.0027453  0.00230292] | [0.07040428 0.1051514  0.13063262] |
|   5   | 69.92748785018921 | 658.0851700305939 | 239.15635681152344 | [0.0091106  0.01657282 0.02356712] | [0.0036731  0.00522547 0.00649584] | [0.00048912 0.00045587 0.00043592] | [0.00970845 0.01802787 0.02572666] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.6643680334091187 BPR_loss 0.6581050157546997 reg_loss 0.006263017188757658
epoch: 6 s: 256000 batch_loss 0.6668738126754761 BPR_loss 0.6605174541473389 reg_loss 0.006356344558298588
epoch: 6 s: 512000 batch_loss 0.6641830205917358 BPR_loss 0.6569681763648987 reg_loss 0.007214847020804882
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 71.88540959358215 | 697.3981440067291 | 237.19773864746094 | [0.06252191 0.0926858  0.11503501] | [0.02830555 0.03480031 0.03898313] | [0.00375669 0.002827   0.00236313] | [0.07312062 0.10847444 0.13421764] |
|   6   | 71.88540959358215 | 579.7735178470612 | 237.19773864746094 | [0.00981497 0.01743481 0.0251778 ] | [0.00392524 0.00551325 0.00691347] | [0.0005268  0.00047951 0.000464  ] | [0.0104473  0.01895882 0.02741123] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.6543642282485962 BPR_loss 0.6461134552955627 reg_loss 0.008250763639807701
epoch: 7 s: 256000 batch_loss 0.6580427289009094 BPR_loss 0.6497445106506348 reg_loss 0.00829822476953268
epoch: 7 s: 512000 batch_loss 0.6527249217033386 BPR_loss 0.6437605619430542 reg_loss 0.008964339271187782
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 66.08058500289917 | 574.9837498664856 | 235.16018676757812 | [0.06492112 0.09570423 0.11801086] | [0.02937804 0.03600782 0.04017627] | [0.00388561 0.00291111 0.00241897] | [0.07556119 0.11181126 0.1375131 ] |
|   7   | 66.08058500289917 | 641.7114517688751 | 235.16018676757812 | [0.01035925 0.01863297 0.02640725] | [0.0041296  0.00584524 0.00725337] | [0.00055783 0.00051054 0.00048567] | [0.01103838 0.02021486 0.02872638] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.6535428762435913 BPR_loss 0.6445906162261963 reg_loss 0.008952251635491848
epoch: 8 s: 256000 batch_loss 0.6464751958847046 BPR_loss 0.636791467666626 reg_loss 0.009683710522949696
epoch: 8 s: 512000 batch_loss 0.6474617123603821 BPR_loss 0.637008547782898 reg_loss 0.010453193448483944
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 72.74260330200195 | 698.7135646343231 | 233.0867462158203 | [0.06674733 0.09760595 0.11968212] | [0.03021144 0.03686428 0.04098102] | [0.00398075 0.00296523 0.00244655] | [0.0774778  0.11396227 0.13925046] |
|   8   | 72.74260330200195 | 595.5435333251953 | 233.0867462158203 | [0.01091831 0.01950481 0.02752967] | [0.00436205 0.00614048 0.00759376] | [0.00058738 0.00053271 0.00050562] | [0.01164423 0.02110147 0.02992331] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.6467794179916382 BPR_loss 0.636795699596405 reg_loss 0.009983728639781475
epoch: 9 s: 256000 batch_loss 0.6495578289031982 BPR_loss 0.6382768750190735 reg_loss 0.011280925013124943
epoch: 9 s: 512000 batch_loss 0.6461087465286255 BPR_loss 0.6346303820610046 reg_loss 0.01147838681936264
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 72.77031302452087 | 598.0668160915375 | 231.05831909179688 | [0.0681409  0.09932163 0.12189368] | [0.03092665 0.03764579 0.04186106] | [0.00405797 0.00301383 0.00248952] | [0.07898075 0.11582373 0.14163587] |
|   9   | 72.77031302452087 | 529.3754153251648 | 231.05831909179688 | [0.01135177 0.0202609  0.02858376] | [0.00451721 0.00636249 0.0078759 ] | [0.00060955 0.00055081 0.00052434] | [0.01208754 0.02184032 0.03106113] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.6407958269119263 BPR_loss 0.628791868686676 reg_loss 0.012003937736153603
epoch: 10 s: 256000 batch_loss 0.6399754285812378 BPR_loss 0.6275763511657715 reg_loss 0.01239908579736948
epoch: 10 s: 512000 batch_loss 0.6382190585136414 BPR_loss 0.6251165866851807 reg_loss 0.013102454133331776
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 70.27975344657898 | 674.2534096240997 | 229.06114196777344 | [0.06962472 0.10067322 0.12343431] | [0.03149759 0.03818796 0.04243465] | [0.00414208 0.00305209 0.00251641] | [0.08070432 0.11736804 0.14318019] |
|   10  | 70.27975344657898 | 633.4338459968567 | 229.06114196777344 | [0.01177291 0.02119185 0.02957874] | [0.00463834 0.00658955 0.00811511] | [0.0006295  0.00057519 0.00054256] | [0.01248652 0.02283038 0.03213985] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.6393757462501526 BPR_loss 0.6267030239105225 reg_loss 0.01267271488904953
epoch: 11 s: 256000 batch_loss 0.6341159343719482 BPR_loss 0.6203608512878418 reg_loss 0.013755093328654766
epoch: 11 s: 512000 batch_loss 0.6327760219573975 BPR_loss 0.6190149188041687 reg_loss 0.013761130161583424
+-------+-------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 76.03007006645203 | 644.8446505069733 | 227.27978515625 | [0.07073445 0.10216485 0.1242415 ] | [0.0319579  0.0387232  0.04284109] | [0.00420344 0.00309484 0.00253066] | [0.08194529 0.11887099 0.14417296] |
|   11  | 76.03007006645203 | 577.9612617492676 | 227.27978515625 | [0.01243788 0.02210112 0.03028434] | [0.00487882 0.00688216 0.0083693 ] | [0.00066348 0.00059957 0.00055487] | [0.01318103 0.0237761  0.0328787 ] |
+-------+-------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.6333412528038025 BPR_loss 0.618126630783081 reg_loss 0.015214602462947369
epoch: 12 s: 256000 batch_loss 0.6311939358711243 BPR_loss 0.6161242723464966 reg_loss 0.015069685876369476
epoch: 12 s: 512000 batch_loss 0.6320418119430542 BPR_loss 0.617216944694519 reg_loss 0.014824848622083664
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 69.85636615753174 |  638.879246711731 | 225.4618682861328 | [0.07142261 0.10283752 0.12545341] | [0.03227897 0.03905536 0.04327159] | [0.00423653 0.00311276 0.00255341] | [0.08256577 0.11961558 0.14551045] |
|   12  | 69.85636615753174 | 657.4535348415375 | 225.4618682861328 | [0.0127014  0.02288184 0.03105766] | [0.00502496 0.00714477 0.00862755] | [0.00067826 0.00062174 0.00056817] | [0.01347657 0.02467749 0.03366187] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.6256411075592041 BPR_loss 0.609529972076416 reg_loss 0.016111155971884727
epoch: 13 s: 256000 batch_loss 0.6267719268798828 BPR_loss 0.6103848814964294 reg_loss 0.01638701558113098
epoch: 13 s: 512000 batch_loss 0.6227841377258301 BPR_loss 0.6059471368789673 reg_loss 0.0168369859457016
