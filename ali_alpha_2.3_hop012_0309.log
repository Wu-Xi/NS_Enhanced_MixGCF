Namespace(K=1, Ks='[20, 40, 60]', alpha=2.3, batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ali', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, gnn='lightgcn', gpu_id=4, l2=0.001, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=32, neg_mix_num=2, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上进行softmax自适应权重,引入alpha超参数来控制模型倾向......
start training ...
epoch: 0 s: 0 batch_loss 0.6931478381156921 BPR_loss 0.6931475400924683 reg_loss 3.1217558671414736e-07
epoch: 0 s: 256000 batch_loss 0.6927434206008911 BPR_loss 0.6927022337913513 reg_loss 4.11796681873966e-05
epoch: 0 s: 512000 batch_loss 0.6882139444351196 BPR_loss 0.687605619430542 reg_loss 0.0006083419430069625
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 44.7533757686615 | 199.14406180381775 | 247.16241455078125 | [0.02918109 0.04819391 0.06277083] | [0.01252962 0.0166562  0.01941532] | [0.00191247 0.00158327 0.00138345] | [0.03660857 0.05962164 0.07713309] |
|   0   | 44.7533757686615 | 615.0805952548981  | 247.16241455078125 | [0.00347381 0.00694073 0.00995657] | [0.00137303 0.00209932 0.00265321] | [0.00018767 0.00019506 0.00019112] | [0.00369424 0.00763968 0.01120092] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6838884949684143 BPR_loss 0.682512104511261 reg_loss 0.0013763788156211376
epoch: 1 s: 256000 batch_loss 0.6819746494293213 BPR_loss 0.6801919341087341 reg_loss 0.001782724866643548
epoch: 1 s: 512000 batch_loss 0.6783560514450073 BPR_loss 0.6757593750953674 reg_loss 0.0025966758839786053
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 67.68786287307739 | 712.0473189353943 | 244.10975646972656 | [0.03883498 0.06199075 0.08041236] | [0.01691379 0.02193734 0.02540934] | [0.00247435 0.00199038 0.00173184] | [0.04748773 0.07538194 0.09714026] |
|   1   | 67.68786287307739 | 587.6394417285919 | 244.10975646972656 | [0.00520949 0.01025519 0.0146975 ] | [0.0021471  0.00320332 0.00401442] | [0.00028002 0.00028519 0.00027658] | [0.00549702 0.0112157  0.01623986] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6805302500724792 BPR_loss 0.6781013011932373 reg_loss 0.0024289682041853666
epoch: 2 s: 256000 batch_loss 0.6800402998924255 BPR_loss 0.6772513389587402 reg_loss 0.002788952784612775
epoch: 2 s: 512000 batch_loss 0.6775512099266052 BPR_loss 0.6741964817047119 reg_loss 0.0033547270577400923
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 76.2639832496643 | 673.3425762653351  | 242.65419006347656 | [0.04788033 0.07319731 0.09350541] | [0.02100094 0.02649325 0.03029827] | [0.00296591 0.00230062 0.00197337] | [0.0572638  0.08741934 0.11121836] |
|   2   | 76.2639832496643 | 417.93896555900574 | 242.65419006347656 | [0.00684727 0.01261014 0.01831034] | [0.00278446 0.00398248 0.00501987] | [0.00036647 0.00034615 0.00034012] | [0.0072407  0.01366867 0.02006709] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6766659617424011 BPR_loss 0.6729509234428406 reg_loss 0.0037150122225284576
epoch: 3 s: 256000 batch_loss 0.6744771599769592 BPR_loss 0.6706215739250183 reg_loss 0.0038556016515940428
epoch: 3 s: 512000 batch_loss 0.6754761934280396 BPR_loss 0.6716644763946533 reg_loss 0.003811714006587863
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 73.7084128856659 | 682.4490082263947 | 241.35240173339844 | [0.05434353 0.08211318 0.10356653] | [0.02418144 0.03016257 0.03418507] | [0.00332304 0.00254019 0.00215906] | [0.06437869 0.09702995 0.12220782] |
|   3   | 73.7084128856659 | 688.9527246952057 | 241.35240173339844 | [0.00782008 0.01439692 0.02057614] | [0.00321069 0.00458004 0.00570401] | [0.00041745 0.00039417 0.00038051] | [0.00826031 0.01558967 0.02247573] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.673486053943634 BPR_loss 0.6687790751457214 reg_loss 0.00470700254663825
epoch: 4 s: 256000 batch_loss 0.6662119030952454 BPR_loss 0.6614890098571777 reg_loss 0.004722885321825743
epoch: 4 s: 512000 batch_loss 0.671708881855011 BPR_loss 0.6668950319290161 reg_loss 0.0048138778656721115
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 68.70576786994934 | 608.8802218437195 | 239.63113403320312 | [0.05874571 0.08808294 0.10995671] | [0.02625226 0.03255737 0.03665947] | [0.00355606 0.00269945 0.00227304] | [0.06894269 0.10342783 0.12892284] |
|   4   | 68.70576786994934 |  631.20245885849  | 239.63113403320312 | [0.00839146 0.01573669 0.02240651] | [0.00343263 0.00496463 0.0061779 ] | [0.00044848 0.00043149 0.00041375] | [0.00886617 0.01705259 0.02441151] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.6719847917556763 BPR_loss 0.6664941310882568 reg_loss 0.00549068721011281
epoch: 5 s: 256000 batch_loss 0.6685959696769714 BPR_loss 0.6631563305854797 reg_loss 0.00543965445831418
epoch: 5 s: 512000 batch_loss 0.6619263291358948 BPR_loss 0.6556875705718994 reg_loss 0.006238744594156742
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 68.7668845653534 | 582.1066172122955 | 237.61782836914062 | [0.06238668 0.092353   0.11492918] | [0.02806115 0.03452106 0.03873867] | [0.00374979 0.00282562 0.00236382] | [0.07288622 0.10825382 0.13421764] |
|   5   | 68.7668845653534 | 601.0504474639893 | 237.61782836914062 | [0.0092596  0.01706785 0.02384246] | [0.00369411 0.00531603 0.00654508] | [0.00049577 0.00046806 0.00044011] | [0.00982667 0.01850073 0.02599264] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.6593282222747803 BPR_loss 0.6527136564254761 reg_loss 0.006614560727030039
epoch: 6 s: 256000 batch_loss 0.6615318059921265 BPR_loss 0.6548025012016296 reg_loss 0.006729280110448599
epoch: 6 s: 512000 batch_loss 0.6584517955780029 BPR_loss 0.650822639465332 reg_loss 0.007629152853041887
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 66.96220707893372 | 662.9837548732758 | 235.20425415039062 | [0.06444761 0.09541218 0.1174958 ] | [0.02922722 0.03589635 0.04002314] | [0.00385872 0.00290593 0.00240863] | [0.07517511 0.11159065 0.13697535] |
|   6   | 66.96220707893372 | 615.4513175487518 | 235.20425415039062 | [0.00985807 0.01788674 0.02510195] | [0.00390735 0.00557382 0.00688351] | [0.00053123 0.00048838 0.00046203] | [0.01052118 0.01934302 0.02732257] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.6477336287498474 BPR_loss 0.639042317867279 reg_loss 0.008691332302987576
epoch: 7 s: 256000 batch_loss 0.6517027616500854 BPR_loss 0.6429840326309204 reg_loss 0.008718702010810375
epoch: 7 s: 512000 batch_loss 0.645576536655426 BPR_loss 0.6360907554626465 reg_loss 0.009485777467489243
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 73.8068277835846 | 568.1162533760071 | 232.74241638183594 | [0.06685078 0.0980365  0.1202456 ] | [0.03017428 0.03687945 0.04103473] | [0.00398902 0.00297626 0.00246056] | [0.07771221 0.11430699 0.13992609] |
|   7   | 73.8068277835846 | 613.1326193809509 | 232.74241638183594 | [0.0105181  0.01881522 0.02653334] | [0.00412953 0.00585528 0.00725028] | [0.00056596 0.00051461 0.00048715] | [0.01123048 0.0203774  0.02882981] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.6463269591331482 BPR_loss 0.6368579864501953 reg_loss 0.00946898479014635
epoch: 8 s: 256000 batch_loss 0.638258159160614 BPR_loss 0.627950131893158 reg_loss 0.010308017022907734
epoch: 8 s: 512000 batch_loss 0.6392541527748108 BPR_loss 0.6281765699386597 reg_loss 0.011077595874667168
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 78.36379361152649 | 714.5966846942902 | 230.26939392089844 | [0.06858262 0.09945582 0.12214664] | [0.03103679 0.03767501 0.04191062] | [0.00408692 0.00301417 0.00249136] | [0.07957366 0.11592025 0.14192543] |
|   8   | 78.36379361152649 | 637.5725755691528 | 230.26939392089844 | [0.01093678 0.0196846  0.02764173] | [0.00432238 0.0061428  0.0075814 ] | [0.00058443 0.00053677 0.00050636] | [0.0115999  0.02129357 0.02996764] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.638434112071991 BPR_loss 0.6277714967727661 reg_loss 0.010662637650966644
epoch: 9 s: 256000 batch_loss 0.6415337324142456 BPR_loss 0.6295323967933655 reg_loss 0.012001353316009045
epoch: 9 s: 512000 batch_loss 0.6375201940536499 BPR_loss 0.6253818273544312 reg_loss 0.01213835645467043
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 71.59402108192444 |  622.089742898941 | 227.8986358642578 | [0.06968726 0.10172277 0.12386491] | [0.03170614 0.03859172 0.04272297] | [0.00414346 0.00307933 0.00252445] | [0.08080084 0.11842976 0.14382825] |
|   9   | 71.59402108192444 | 530.9555487632751 | 227.8986358642578 | [0.01151308 0.02052565 0.02863547] | [0.0045157  0.00638655 0.00785611] | [0.00061324 0.00055746 0.00052384] | [0.0121762  0.02212108 0.03106113] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.631037175655365 BPR_loss 0.6183310747146606 reg_loss 0.0127060916274786
epoch: 10 s: 256000 batch_loss 0.6301775574684143 BPR_loss 0.6170196533203125 reg_loss 0.013157899491488934
epoch: 10 s: 512000 batch_loss 0.6276732683181763 BPR_loss 0.6138269901275635 reg_loss 0.013846266083419323
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 75.58618497848511 | 638.3659582138062 | 225.5845184326172 | [0.0711153  0.10315073 0.12507222] | [0.03225686 0.03915081 0.04323591] | [0.00422274 0.00312207 0.00254467] | [0.08229    0.12001544 0.1449727 ] |
|   10  | 75.58618497848511 | 635.3801612854004 | 225.5845184326172 | [0.011949   0.02141769 0.02943712] | [0.00470604 0.00667193 0.00812313] | [0.00063689 0.0005811  0.00053763] | [0.01264906 0.02306681 0.03187386] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.629806399345398 BPR_loss 0.6163850426673889 reg_loss 0.013421346433460712
epoch: 11 s: 256000 batch_loss 0.6237528324127197 BPR_loss 0.6092442870140076 reg_loss 0.014508536085486412
epoch: 11 s: 512000 batch_loss 0.6222545504570007 BPR_loss 0.607719898223877 reg_loss 0.01453467644751072
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 72.12486147880554 | 657.3491668701172 | 223.51353454589844 | [0.07189134 0.10407622 0.12594883] | [0.03262382 0.03955974 0.04363775] | [0.00425928 0.00314723 0.00256122] | [0.08308974 0.12099443 0.14613094] |
|   11  | 72.12486147880554 | 576.5697093009949 | 223.51353454589844 | [0.01248959 0.0220808  0.03043875] | [0.0049113  0.00690538 0.00841716] | [0.00066644 0.00059921 0.00055586] | [0.01324014 0.0237761  0.0329378 ] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.6224658489227295 BPR_loss 0.6064321398735046 reg_loss 0.01603369042277336
epoch: 12 s: 256000 batch_loss 0.6197961568832397 BPR_loss 0.6039326190948486 reg_loss 0.015863558277487755
epoch: 12 s: 512000 batch_loss 0.6204030513763428 BPR_loss 0.604756236076355 reg_loss 0.015646830201148987
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 74.39378046989441 | 634.3730146884918 | 221.4261474609375 | [0.07297765 0.10484488 0.12690818] | [0.03297253 0.0398438  0.04395944] | [0.00432064 0.00316757 0.00257938] | [0.08427555 0.12178038 0.14717886] |
|   12  | 74.39378046989441 | 667.8746280670166 | 221.4261474609375 | [0.01290581 0.02278394 0.03114755] | [0.00506133 0.00711473 0.0086306 ] | [0.00069008 0.00061694 0.00056817] | [0.01368345 0.02450017 0.03367665] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.6140329837799072 BPR_loss 0.5971170663833618 reg_loss 0.016915930435061455
epoch: 13 s: 256000 batch_loss 0.615479052066803 BPR_loss 0.5982913374900818 reg_loss 0.017187712714076042
epoch: 13 s: 512000 batch_loss 0.610457718372345 BPR_loss 0.5928053855895996 reg_loss 0.017652345821261406
