Namespace(K=1, Ks='[20, 40, 60]', alpha=2.5, batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ali', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, gnn='lightgcn', gpu_id=4, l2=0.001, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=32, neg_mix_num=2, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上进行softmax自适应权重,引入alpha超参数来控制模型倾向......
start training ...
epoch: 0 s: 0 batch_loss 0.6931478381156921 BPR_loss 0.6931475400924683 reg_loss 3.133390578113904e-07
epoch: 0 s: 256000 batch_loss 0.6928101181983948 BPR_loss 0.6927738189697266 reg_loss 3.6315908801043406e-05
epoch: 0 s: 512000 batch_loss 0.6886420249938965 BPR_loss 0.6880584955215454 reg_loss 0.0005835302290506661
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 44.8700487613678 | 195.16865730285645 | 247.24496459960938 | [0.02831264 0.04692778 0.06152552] | [0.01206338 0.0161017  0.01886383] | [0.00186835 0.00154983 0.00135932] | [0.03568474 0.05831173 0.07565771] |
|   0   | 44.8700487613678 | 633.5309660434723  | 247.24496459960938 | [0.00332974 0.00674124 0.00955205] | [0.00132829 0.00204878 0.00256652] | [0.00018028 0.00019099 0.00018447] | [0.00354647 0.00747713 0.01078717] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6844762563705444 BPR_loss 0.6831170320510864 reg_loss 0.0013592320028692484
epoch: 1 s: 256000 batch_loss 0.6825408935546875 BPR_loss 0.680763304233551 reg_loss 0.0017775717424228787
epoch: 1 s: 512000 batch_loss 0.679053544998169 BPR_loss 0.6764386892318726 reg_loss 0.002614853670820594
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 68.36539387702942 | 729.5912160873413 | 244.305908203125 | [0.03784725 0.06072742 0.07887626] | [0.01656035 0.0215144  0.02493268] | [0.00241644 0.00195315 0.00170013] | [0.0464398  0.07393415 0.0952788 ] |
|   1   | 68.36539387702942 | 618.5495867729187 | 244.305908203125 | [0.00509127 0.00983528 0.01422711] | [0.00208743 0.00308278 0.00388605] | [0.00027337 0.00027448 0.0002682 ] | [0.00537881 0.01078717 0.01573744] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6811153888702393 BPR_loss 0.6786699295043945 reg_loss 0.0024454807862639427
epoch: 2 s: 256000 batch_loss 0.6807366013526917 BPR_loss 0.677939772605896 reg_loss 0.002796841086819768
epoch: 2 s: 512000 batch_loss 0.6783586144447327 BPR_loss 0.6749886274337769 reg_loss 0.003370009595528245
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 79.97065234184265 | 664.3258216381073  | 242.92031860351562 | [0.04633468 0.0716136  0.09092174] | [0.02037161 0.02584455 0.02947848] | [0.00287629 0.00224994 0.00192442] | [0.05554023 0.08550273 0.10850201] |
|   2   | 79.97065234184265 | 450.38312816619873 | 242.92031860351562 | [0.00652464 0.01240523 0.01809608] | [0.00269003 0.00391431 0.00495368] | [0.00035021 0.00034098 0.00033741] | [0.00691561 0.01343224 0.01990454] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6775393486022949 BPR_loss 0.6738063097000122 reg_loss 0.003733030054718256
epoch: 3 s: 256000 batch_loss 0.6756211519241333 BPR_loss 0.6717817783355713 reg_loss 0.0038393628783524036
epoch: 3 s: 512000 batch_loss 0.6766844987869263 BPR_loss 0.6729083061218262 reg_loss 0.00377616542391479
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 73.84177041053772 | 712.7912721633911 | 241.75648498535156 | [0.05299532 0.08033174 0.10139463] | [0.02363121 0.02952639 0.03347819] | [0.00324789 0.00248883 0.00211746] | [0.06290331 0.09505819 0.11973967] |
|   3   | 73.84177041053772 | 614.7822341918945 | 241.75648498535156 | [0.00758611 0.0143415  0.02046531] | [0.00312161 0.00452944 0.00564056] | [0.00040637 0.00039307 0.00037854] | [0.00803866 0.01551579 0.02235751] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.6747676730155945 BPR_loss 0.6700894832611084 reg_loss 0.004678207915276289
epoch: 4 s: 256000 batch_loss 0.6680461168289185 BPR_loss 0.6633904576301575 reg_loss 0.004655654542148113
epoch: 4 s: 512000 batch_loss 0.6734352111816406 BPR_loss 0.6687416434288025 reg_loss 0.004693554248660803
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 75.1994309425354 | 665.9669232368469 | 240.23220825195312 | [0.05732593 0.08634439 0.10815587] | [0.025683   0.03192278 0.03601485] | [0.0034754  0.0026474  0.00224041] | [0.06741217 0.1014147  0.12714412] |
|   4   | 75.1994309425354 | 527.2746622562408 | 240.23220825195312 | [0.0083422  0.01554952 0.02232967] | [0.00343942 0.00494304 0.00617301] | [0.00044626 0.00042668 0.00041277] | [0.00883661 0.01686049 0.0243524 ] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.6740866899490356 BPR_loss 0.6687330007553101 reg_loss 0.0053536659106612206
epoch: 5 s: 256000 batch_loss 0.6706788539886475 BPR_loss 0.6653734445571899 reg_loss 0.005305437836796045
epoch: 5 s: 512000 batch_loss 0.6643458008766174 BPR_loss 0.6582800149917603 reg_loss 0.006065789144486189
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 64.98181319236755 | 562.7689263820648 | 238.44895935058594 | [0.06123404 0.09049459 0.1129255 ] | [0.02752815 0.03384684 0.0380404 ] | [0.00368292 0.00277288 0.00232682] | [0.07159009 0.10615796 0.13203905] |
|   5   | 64.98181319236755 | 653.9054968357086 | 238.44895935058594 | [0.00915247 0.01672182 0.02363805] | [0.00367286 0.00524976 0.00650437] | [0.00048986 0.00045919 0.00043617] | [0.00972323 0.01814608 0.02575621] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.6619833707809448 BPR_loss 0.6555578708648682 reg_loss 0.0064254822209477425
epoch: 6 s: 256000 batch_loss 0.6644877791404724 BPR_loss 0.6579625010490417 reg_loss 0.006525266915559769
epoch: 6 s: 512000 batch_loss 0.6614347696304321 BPR_loss 0.6540199518203735 reg_loss 0.0074148233979940414
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 67.54087090492249 | 643.7911334037781 | 236.27828979492188 | [0.06364558 0.09392231 0.11617194] | [0.02882657 0.03534424 0.0395111 ] | [0.00381253 0.00286147 0.00238473] | [0.07416855 0.10986708 0.13563786] |
|   6   | 67.54087090492249 |  640.444009065628 | 236.27828979492188 | [0.00982236 0.01770203 0.02519135] | [0.00393865 0.0055778  0.00693203] | [0.00052754 0.00048505 0.00046252] | [0.01046207 0.01918047 0.02733734] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.6512167453765869 BPR_loss 0.6427518129348755 reg_loss 0.008464918471872807
epoch: 7 s: 256000 batch_loss 0.6551798582077026 BPR_loss 0.6466915011405945 reg_loss 0.008488343097269535
epoch: 7 s: 512000 batch_loss 0.6493406891822815 BPR_loss 0.6401320695877075 reg_loss 0.009208627976477146
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 70.2699978351593 | 560.7582960128784 | 234.03887939453125 | [0.06563069 0.09678826 0.11913043] | [0.02977597 0.03647725 0.04065348] | [0.00392422 0.00294385 0.00244103] | [0.07634714 0.11305223 0.13869891] |
|   7   | 70.2699978351593 | 639.9683859348297 | 234.03887939453125 | [0.01046392 0.01880537 0.02655748] | [0.00413358 0.00586267 0.00726542] | [0.000563   0.00051387 0.00048789] | [0.01115659 0.02034785 0.02887414] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.6502067446708679 BPR_loss 0.6410077810287476 reg_loss 0.009198940359055996
epoch: 8 s: 256000 batch_loss 0.6427125930786133 BPR_loss 0.6327202320098877 reg_loss 0.009992357343435287
epoch: 8 s: 512000 batch_loss 0.6436846852302551 BPR_loss 0.6329233646392822 reg_loss 0.01076130848377943
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 78.6548523902893 | 658.6016283035278 | 231.7738037109375 | [0.06723499 0.09838761 0.12104651] | [0.03057257 0.03727795 0.04150657] | [0.00401384 0.00298625 0.00247183] | [0.0780845  0.11485853 0.14086371] |
|   8   | 78.6548523902893 |  602.593729019165 | 231.7738037109375 | [0.01096141 0.01956392 0.02764665] | [0.00435701 0.00614252 0.00760645] | [0.00058664 0.00053345 0.00050759] | [0.01164423 0.0211458  0.03004152] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.6431027054786682 BPR_loss 0.6327885389328003 reg_loss 0.01031414046883583
epoch: 9 s: 256000 batch_loss 0.645764946937561 BPR_loss 0.634150505065918 reg_loss 0.011614430695772171
epoch: 9 s: 512000 batch_loss 0.6421785354614258 BPR_loss 0.6303716897964478 reg_loss 0.01180686242878437
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 68.2967324256897 | 606.4236822128296 | 229.58615112304688 | [0.06900416 0.10041275 0.1229911 ] | [0.03137798 0.03813229 0.04234985] | [0.00410967 0.0030452  0.00251089] | [0.08008383 0.11718879 0.14297336] |
|   9   | 68.2967324256897 |  571.082065820694 | 229.58615112304688 | [0.01146875 0.0204099  0.02853327] | [0.00454286 0.00639746 0.00787248] | [0.00061177 0.0005545  0.00052335] | [0.01214665 0.02200287 0.0310168 ] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.6361891627311707 BPR_loss 0.6238510608673096 reg_loss 0.012338096275925636
epoch: 10 s: 256000 batch_loss 0.6354226469993591 BPR_loss 0.6226634383201599 reg_loss 0.012759201228618622
epoch: 10 s: 512000 batch_loss 0.6333240270614624 BPR_loss 0.6198577880859375 reg_loss 0.013466253876686096
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 76.46228456497192 | 685.1045770645142 | 227.43472290039062 | [0.07031599 0.10182607 0.12481276] | [0.03185307 0.03863844 0.042928  ] | [0.00417517 0.0030845  0.00254399] | [0.08139375 0.11865038 0.14498649] |
|   10  | 76.46228456497192 | 629.4085433483124 | 227.43472290039062 | [0.01192684 0.02128174 0.02929674] | [0.00470486 0.00664823 0.00810144] | [0.00063541 0.00057778 0.00053591] | [0.01261951 0.02293381 0.03177043] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.6349738836288452 BPR_loss 0.6219377517700195 reg_loss 0.013036152347922325
epoch: 11 s: 256000 batch_loss 0.6292206048965454 BPR_loss 0.6151071786880493 reg_loss 0.014113429933786392
epoch: 11 s: 512000 batch_loss 0.6278280019760132 BPR_loss 0.6136883497238159 reg_loss 0.01413965318351984
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 74.48137760162354 | 703.9055230617523 | 225.51644897460938 | [0.07136746 0.10303653 0.12561966] | [0.03223833 0.03906176 0.04326975] | [0.00422894 0.00312    0.00255594] | [0.08251062 0.1199465  0.14573107] |
|   11  | 74.48137760162354 | 548.6693024635315 | 225.51644897460938 | [0.01255979 0.02206295 0.03016489] | [0.00495736 0.00692841 0.00839993] | [0.0006694  0.0005981  0.00055167] | [0.01329925 0.02373177 0.0326866 ] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.6280326843261719 BPR_loss 0.6124109029769897 reg_loss 0.015621784143149853
epoch: 12 s: 256000 batch_loss 0.625866174697876 BPR_loss 0.6104081273078918 reg_loss 0.015458020381629467
epoch: 12 s: 512000 batch_loss 0.6266443133354187 BPR_loss 0.6114156246185303 reg_loss 0.01522868499159813
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 69.35367012023926 | 553.4976222515106 | 223.57432556152344 | [0.07234047 0.10383895 0.12621212] | [0.03264072 0.03942614 0.0436014 ] | [0.00428686 0.00313965 0.00256559] | [0.08357233 0.12069108 0.14633776] |
|   12  | 69.35367012023926 | 629.5125167369843 | 223.57432556152344 | [0.01291197 0.02279441 0.03087172] | [0.00505751 0.00711312 0.0085805 ] | [0.00068713 0.00061842 0.00056448] | [0.01365389 0.02455928 0.03344022] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.6204603314399719 BPR_loss 0.6039601564407349 reg_loss 0.016500167548656464
epoch: 13 s: 256000 batch_loss 0.6216167211532593 BPR_loss 0.6048370599746704 reg_loss 0.016779635101556778
epoch: 13 s: 512000 batch_loss 0.6171036958694458 BPR_loss 0.599865734577179 reg_loss 0.017237938940525055
