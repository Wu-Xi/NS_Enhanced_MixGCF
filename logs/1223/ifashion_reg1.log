Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ifashion', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=2, l2=1e-06, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.693148136138916 BPR_loss 0.693148136138916 reg_loss 1.4235583545296748e-10
epoch: 0 s: 256000 batch_loss 0.6931405663490295 BPR_loss 0.6931405663490295 reg_loss 1.3980400170865437e-09
epoch: 0 s: 512000 batch_loss 0.6930538415908813 BPR_loss 0.6930538415908813 reg_loss 1.4843227091887456e-08
epoch: 0 s: 768000 batch_loss 0.6926567554473877 BPR_loss 0.6926566958427429 reg_loss 7.902440302132163e-08
epoch: 0 s: 1024000 batch_loss 0.6912431716918945 BPR_loss 0.6912428736686707 reg_loss 2.714467086661898e-07
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 71.56311082839966 | 1059.6929514408112 | 424.404541015625 | [0.07676509 0.11495626 0.14344529] | [0.03511299 0.04331642 0.04863571] | [0.00478562 0.00361507 0.00302278] | [0.09313848 0.13849885 0.171778  ] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6884087920188904 BPR_loss 0.6884081959724426 reg_loss 6.071214784242329e-07
epoch: 1 s: 256000 batch_loss 0.6846163868904114 BPR_loss 0.6846153140068054 reg_loss 1.0788969575514784e-06
epoch: 1 s: 512000 batch_loss 0.6787378191947937 BPR_loss 0.6787359714508057 reg_loss 1.8576062075226218e-06
epoch: 1 s: 768000 batch_loss 0.6728499531745911 BPR_loss 0.6728472709655762 reg_loss 2.6840052669285797e-06
epoch: 1 s: 1024000 batch_loss 0.6658368110656738 BPR_loss 0.6658331155776978 reg_loss 3.6711337543238187e-06
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 77.8033242225647 | 1206.1329092979431 | 413.7611083984375 | [0.08250207 0.12274644 0.15294145] | [0.03766391 0.04631243 0.05194562] | [0.00513749 0.00385665 0.00321974] | [0.09985233 0.14746306 0.18256852] |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6584616899490356 BPR_loss 0.6584571599960327 reg_loss 4.539964720606804e-06
epoch: 2 s: 256000 batch_loss 0.648871660232544 BPR_loss 0.6488661766052246 reg_loss 5.494442120834719e-06
epoch: 2 s: 512000 batch_loss 0.6375417113304138 BPR_loss 0.6375342607498169 reg_loss 7.4434174166526645e-06
epoch: 2 s: 768000 batch_loss 0.6287589073181152 BPR_loss 0.6287508010864258 reg_loss 8.114008778647985e-06
epoch: 2 s: 1024000 batch_loss 0.6170082092285156 BPR_loss 0.616998553276062 reg_loss 9.636926733946893e-06
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 84.47101259231567 | 1161.647078037262 | 388.3582763671875 | [0.08623825 0.12751054 0.15816445] | [0.03948659 0.04834847 0.0540758 ] | [0.00537164 0.00400637 0.00333263] | [0.10424517 0.15300524 0.18857938] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.610256552696228 BPR_loss 0.6102460026741028 reg_loss 1.0547202691668645e-05
epoch: 3 s: 256000 batch_loss 0.6043319702148438 BPR_loss 0.60431969165802 reg_loss 1.2293819963815622e-05
epoch: 3 s: 512000 batch_loss 0.591343104839325 BPR_loss 0.5913296937942505 reg_loss 1.3404562196228653e-05
epoch: 3 s: 768000 batch_loss 0.5832879543304443 BPR_loss 0.5832735300064087 reg_loss 1.4428312169911806e-05
epoch: 3 s: 1024000 batch_loss 0.5716389417648315 BPR_loss 0.5716230273246765 reg_loss 1.593412525835447e-05
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 87.49357295036316 | 1181.8225836753845 | 359.56982421875 | [0.08875162 0.13059651 0.16169549] | [0.04086566 0.04985293 0.05566281] | [0.00553642 0.00410568 0.00340894] | [0.1073287  0.15663928 0.19264117] |
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.5629869103431702 BPR_loss 0.5629703998565674 reg_loss 1.6490244888700545e-05
epoch: 4 s: 256000 batch_loss 0.5540903806686401 BPR_loss 0.5540723204612732 reg_loss 1.8064143660012633e-05
epoch: 4 s: 512000 batch_loss 0.5425360798835754 BPR_loss 0.5425160527229309 reg_loss 2.0033920009154826e-05
epoch: 4 s: 768000 batch_loss 0.5348106622695923 BPR_loss 0.5347902774810791 reg_loss 2.0383602532092482e-05
epoch: 4 s: 1024000 batch_loss 0.5244260430335999 BPR_loss 0.5244044661521912 reg_loss 2.1586894945357926e-05
+-------+------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 73.696115732193  | 1231.7186043262482 | 331.915283203125 | [0.0905756  0.13336214 0.16451602] | [0.0417856  0.05097986 0.0568028 ] | [0.00565322 0.00419662 0.00347298] | [0.10952698 0.15994599 0.19611898] |
+-------+------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.5177233219146729 BPR_loss 0.5177010297775269 reg_loss 2.228129596915096e-05
epoch: 5 s: 256000 batch_loss 0.5157250165939331 BPR_loss 0.5157010555267334 reg_loss 2.3965476430021226e-05
epoch: 5 s: 512000 batch_loss 0.5096147060394287 BPR_loss 0.5095897912979126 reg_loss 2.491883424227126e-05
epoch: 5 s: 768000 batch_loss 0.4998495280742645 BPR_loss 0.49982285499572754 reg_loss 2.667135777301155e-05
epoch: 5 s: 1024000 batch_loss 0.48087161779403687 BPR_loss 0.480843722820282 reg_loss 2.789829704852309e-05
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 78.8528642654419 | 1202.9656558036804 | 307.41717529296875 | [0.09224736 0.13538362 0.16685469] | [0.04261005 0.05188977 0.05776658] | [0.00576071 0.00426702 0.00352487] | [0.1114872  0.16245299 0.19884544] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.48324617743492126 BPR_loss 0.48321694135665894 reg_loss 2.9225773687358014e-05
epoch: 6 s: 256000 batch_loss 0.47421419620513916 BPR_loss 0.47418445348739624 reg_loss 2.9755457944702357e-05
epoch: 6 s: 512000 batch_loss 0.4678186774253845 BPR_loss 0.46778807044029236 reg_loss 3.0620107281720266e-05
epoch: 6 s: 768000 batch_loss 0.4632159471511841 BPR_loss 0.463183730840683 reg_loss 3.220370126655325e-05
epoch: 6 s: 1024000 batch_loss 0.4567689895629883 BPR_loss 0.4567365348339081 reg_loss 3.2463460229337215e-05
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 79.12054252624512 | 1241.543273448944 | 285.69342041015625 | [0.09377729 0.1372172  0.16857542] | [0.04328975 0.05263181 0.05848978] | [0.00585686 0.00432765 0.00356287] | [0.11329864 0.16461407 0.20081682] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.4523012638092041 BPR_loss 0.452267587184906 reg_loss 3.368829857208766e-05
epoch: 7 s: 256000 batch_loss 0.4443885385990143 BPR_loss 0.4443538784980774 reg_loss 3.46646411344409e-05
epoch: 7 s: 512000 batch_loss 0.42572951316833496 BPR_loss 0.42569318413734436 reg_loss 3.634122549556196e-05
epoch: 7 s: 768000 batch_loss 0.4214736223220825 BPR_loss 0.42143476009368896 reg_loss 3.887629645760171e-05
epoch: 7 s: 1024000 batch_loss 0.42544105648994446 BPR_loss 0.4254041314125061 reg_loss 3.69143599527888e-05
+-------+------------------+-----------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |  tesing time(s) |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-----------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 78.7970802783966 | 1206.6141705513 | 265.6517333984375 | [0.09475702 0.13832138 0.16984514] | [0.04379397 0.05317481 0.05906797] | [0.00591656 0.00436233 0.00359182] | [0.11444056 0.16586014 0.20230838] |
+-------+------------------+-----------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.415196031332016 BPR_loss 0.41515618562698364 reg_loss 3.9833241316955537e-05
epoch: 8 s: 256000 batch_loss 0.40044617652893066 BPR_loss 0.40040647983551025 reg_loss 3.968484452343546e-05
epoch: 8 s: 512000 batch_loss 0.394837349653244 BPR_loss 0.3947950601577759 reg_loss 4.230371996527538e-05
epoch: 8 s: 768000 batch_loss 0.4082925021648407 BPR_loss 0.40825116634368896 reg_loss 4.132096728426404e-05
epoch: 8 s: 1024000 batch_loss 0.3862386643886566 BPR_loss 0.38619565963745117 reg_loss 4.29927276854869e-05
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 84.09038591384888 | 1196.8394193649292 | 247.55650329589844 | [0.09535219 0.1391398  0.17090715] | [0.04413341 0.05357384 0.05950884] | [0.00595636 0.00439265 0.00361463] | [0.11524027 0.16688674 0.20347633] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.3884814381599426 BPR_loss 0.3884361684322357 reg_loss 4.5269956899574026e-05
epoch: 9 s: 256000 batch_loss 0.37778621912002563 BPR_loss 0.3777412176132202 reg_loss 4.500283466768451e-05
epoch: 9 s: 512000 batch_loss 0.37040773034095764 BPR_loss 0.37036383152008057 reg_loss 4.389864989207126e-05
epoch: 9 s: 768000 batch_loss 0.37694817781448364 BPR_loss 0.3769030272960663 reg_loss 4.515679756877944e-05
epoch: 9 s: 1024000 batch_loss 0.36294686794281006 BPR_loss 0.36289843916893005 reg_loss 4.844133582082577e-05
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 148.16863203048706 | 1156.3080728054047 | 231.96607971191406 | [0.09638279 0.14022986 0.17210516] | [0.04454754 0.05399159 0.05994698] | [0.00602517 0.0044291  0.00364377] | [0.11649377 0.16814768 0.20490465] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.3806220591068268 BPR_loss 0.3805760145187378 reg_loss 4.60390692751389e-05
epoch: 10 s: 256000 batch_loss 0.37518301606178284 BPR_loss 0.37513500452041626 reg_loss 4.8007015720941126e-05
epoch: 10 s: 512000 batch_loss 0.34884369373321533 BPR_loss 0.348793089389801 reg_loss 5.0611855840543285e-05
epoch: 10 s: 768000 batch_loss 0.3560737669467926 BPR_loss 0.3560235798358917 reg_loss 5.0178870878880844e-05
epoch: 10 s: 1024000 batch_loss 0.34932389855384827 BPR_loss 0.349270761013031 reg_loss 5.315228190738708e-05
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 143.50541591644287 | 1304.218322277069 | 217.49826049804688 | [0.09726104 0.14072486 0.17259926] | [0.04488937 0.05424746 0.06020989] | [0.00608357 0.00444593 0.00365573] | [0.11753525 0.16872794 0.20547375] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.36002492904663086 BPR_loss 0.35997188091278076 reg_loss 5.3037252655485645e-05
epoch: 11 s: 256000 batch_loss 0.3435603380203247 BPR_loss 0.3435089588165283 reg_loss 5.139070708537474e-05
epoch: 11 s: 512000 batch_loss 0.3244425654411316 BPR_loss 0.32438623905181885 reg_loss 5.63238027098123e-05
epoch: 11 s: 768000 batch_loss 0.33708706498146057 BPR_loss 0.3370334804058075 reg_loss 5.358962152968161e-05
epoch: 11 s: 1024000 batch_loss 0.32977545261383057 BPR_loss 0.32972079515457153 reg_loss 5.464347850647755e-05
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 148.6588590145111 | 1187.2251739501953 | 204.817626953125 | [0.09782135 0.14116358 0.17299903] | [0.04527239 0.05461339 0.06056586] | [0.00612672 0.00446629 0.00366609] | [0.11829405 0.16936027 0.20602052] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.32874709367752075 BPR_loss 0.3286890387535095 reg_loss 5.805126784252934e-05
epoch: 12 s: 256000 batch_loss 0.3289155066013336 BPR_loss 0.32885852456092834 reg_loss 5.696970401913859e-05
epoch: 12 s: 512000 batch_loss 0.3166483938694 BPR_loss 0.3165917992591858 reg_loss 5.6579978263471276e-05
epoch: 12 s: 768000 batch_loss 0.3123999834060669 BPR_loss 0.31234002113342285 reg_loss 5.995493120281026e-05
epoch: 12 s: 1024000 batch_loss 0.3074665367603302 BPR_loss 0.3074086010456085 reg_loss 5.792620140709914e-05
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 138.14237070083618 | 1104.9761910438538 | 192.71104431152344 | [0.09835474 0.14158351 0.17339757] | [0.04555438 0.0548706  0.06082377] | [0.00615945 0.00447987 0.00367663] | [0.11890778 0.16984009 0.20638876] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.2983432412147522 BPR_loss 0.29828256368637085 reg_loss 6.067999129300006e-05
epoch: 13 s: 256000 batch_loss 0.2983635365962982 BPR_loss 0.2983004152774811 reg_loss 6.312652112683281e-05
epoch: 13 s: 512000 batch_loss 0.3093896508216858 BPR_loss 0.3093288540840149 reg_loss 6.0797265177825466e-05
epoch: 13 s: 768000 batch_loss 0.28034088015556335 BPR_loss 0.2802770733833313 reg_loss 6.380307604558766e-05
epoch: 13 s: 1024000 batch_loss 0.2895275056362152 BPR_loss 0.289463609457016 reg_loss 6.388923793565482e-05
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 148.68090081214905 | 1211.2741932868958 | 182.37698364257812 | [0.09887052 0.14196104 0.17358291] | [0.04582624 0.05511329 0.06103662] | [0.00619404 0.0044927  0.00368425] | [0.11948804 0.17026785 0.20669377] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.28000977635383606 BPR_loss 0.2799472510814667 reg_loss 6.253840547287837e-05
epoch: 14 s: 256000 batch_loss 0.28885340690612793 BPR_loss 0.2887886166572571 reg_loss 6.478802242781967e-05
epoch: 14 s: 512000 batch_loss 0.28701502084732056 BPR_loss 0.2869516909122467 reg_loss 6.331817712634802e-05
epoch: 14 s: 768000 batch_loss 0.2770087718963623 BPR_loss 0.27694255113601685 reg_loss 6.621747888857499e-05
epoch: 14 s: 1024000 batch_loss 0.2701372802257538 BPR_loss 0.2700708210468292 reg_loss 6.645037501584738e-05
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 150.84564018249512 | 1205.4161307811737 | 171.94007873535156 | [0.09901466 0.14227555 0.17362034] | [0.04601923 0.05534909 0.06121604] | [0.00620669 0.00450721 0.00368524] | [0.11967773 0.17066956 0.20674956] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.2771110236644745 BPR_loss 0.2770446240901947 reg_loss 6.640776700805873e-05
epoch: 15 s: 256000 batch_loss 0.2620949447154999 BPR_loss 0.26202625036239624 reg_loss 6.869790377095342e-05
epoch: 15 s: 512000 batch_loss 0.2700246572494507 BPR_loss 0.2699565887451172 reg_loss 6.807254976592958e-05
epoch: 15 s: 768000 batch_loss 0.2680022418498993 BPR_loss 0.2679325044155121 reg_loss 6.974724237807095e-05
epoch: 15 s: 1024000 batch_loss 0.26993313431739807 BPR_loss 0.26986265182495117 reg_loss 7.046839164104313e-05
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 152.34108114242554 | 1169.315747976303 | 163.07521057128906 | [0.09927153 0.14253892 0.17374561] | [0.04618308 0.0555176  0.06135148] | [0.00622473 0.00451818 0.00368772] | [0.12003482 0.17097457 0.20688347] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.2509225308895111 BPR_loss 0.25085192918777466 reg_loss 7.059094059513882e-05
epoch: 16 s: 256000 batch_loss 0.27327248454093933 BPR_loss 0.2732047438621521 reg_loss 6.775166548322886e-05
epoch: 16 s: 512000 batch_loss 0.26680073142051697 BPR_loss 0.26673102378845215 reg_loss 6.971912807784975e-05
epoch: 16 s: 768000 batch_loss 0.24644368886947632 BPR_loss 0.24637164175510406 reg_loss 7.205017755040899e-05
epoch: 16 s: 1024000 batch_loss 0.24951916933059692 BPR_loss 0.24944351613521576 reg_loss 7.565873238490894e-05
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 144.78741693496704 | 1173.605471611023 | 154.90066528320312 | [0.09946367 0.14261677 0.17366248] | [0.04630148 0.05561297 0.06142247] | [0.00623533 0.00452134 0.00368878] | [0.12017988 0.17106012 0.20689091] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.24268940091133118 BPR_loss 0.24261504411697388 reg_loss 7.43539712857455e-05
epoch: 17 s: 256000 batch_loss 0.2427188903093338 BPR_loss 0.24264517426490784 reg_loss 7.372206164291129e-05
epoch: 17 s: 512000 batch_loss 0.24689827859401703 BPR_loss 0.24682262539863586 reg_loss 7.565801934106275e-05
epoch: 17 s: 768000 batch_loss 0.22517268359661102 BPR_loss 0.2250976264476776 reg_loss 7.505672692786902e-05
epoch: 17 s: 1024000 batch_loss 0.24304081499576569 BPR_loss 0.24296370148658752 reg_loss 7.710917998338118e-05
+-------+--------------------+--------------------+--------------------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |              recall             |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 142.42985486984253 | 1217.4936861991882 | 146.34625244140625 | [0.099385  0.1425845 0.1735139] | [0.04635798 0.05567434 0.06146087] | [0.00624128 0.00452153 0.00368617] | [0.12022079 0.17105268 0.20671981] |
+-------+--------------------+--------------------+--------------------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.22781780362129211 BPR_loss 0.22773891687393188 reg_loss 7.888310210546479e-05
epoch: 18 s: 256000 batch_loss 0.23386512696743011 BPR_loss 0.23378986120224 reg_loss 7.526630361098796e-05
epoch: 18 s: 512000 batch_loss 0.23415067791938782 BPR_loss 0.234071746468544 reg_loss 7.892532448749989e-05
epoch: 18 s: 768000 batch_loss 0.2172783464193344 BPR_loss 0.21719908714294434 reg_loss 7.92644641478546e-05
epoch: 18 s: 1024000 batch_loss 0.21838507056236267 BPR_loss 0.21830688416957855 reg_loss 7.819133315933868e-05
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 141.1350314617157 | 1222.261646747589 | 139.21449279785156 | [0.09936351 0.1424727  0.17333976] | [0.0463794  0.05567631 0.06145473] | [0.00624147 0.00451679 0.00368382] | [0.12023939 0.17084066 0.20644084] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.234248086810112 BPR_loss 0.23416846990585327 reg_loss 7.961942174006253e-05
epoch: 19 s: 256000 batch_loss 0.2241351157426834 BPR_loss 0.22405461966991425 reg_loss 8.050071483012289e-05
epoch: 19 s: 512000 batch_loss 0.24129122495651245 BPR_loss 0.2412106841802597 reg_loss 8.05422751000151e-05
epoch: 19 s: 768000 batch_loss 0.21410688757896423 BPR_loss 0.21402442455291748 reg_loss 8.246803190559149e-05
epoch: 19 s: 1024000 batch_loss 0.21041174232959747 BPR_loss 0.21033328771591187 reg_loss 7.844830543035641e-05
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 141.99080204963684 | 1183.5177311897278 | 132.7550811767578 | [0.09960198 0.14220803 0.17319949] | [0.04649489 0.05568636 0.06148661] | [0.00625635 0.00451102 0.00368115] | [0.12049604 0.17062121 0.20627718] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.2109151929616928 BPR_loss 0.21083031594753265 reg_loss 8.487094601150602e-05
epoch: 20 s: 256000 batch_loss 0.21105176210403442 BPR_loss 0.21096539497375488 reg_loss 8.637237624498084e-05
epoch: 20 s: 512000 batch_loss 0.22544695436954498 BPR_loss 0.2253625988960266 reg_loss 8.435393101535738e-05
epoch: 20 s: 768000 batch_loss 0.20966936647891998 BPR_loss 0.20958560705184937 reg_loss 8.375804463867098e-05
epoch: 20 s: 1024000 batch_loss 0.208126038312912 BPR_loss 0.2080398052930832 reg_loss 8.62301021697931e-05
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 163.48515462875366 | 12641.69494843483 | 126.89812469482422 | [0.09950452 0.14200538 0.1729479 ] | [0.04649788 0.05567172 0.06146536] | [0.00625133 0.00450693 0.00367824] | [0.12035842 0.17035712 0.2060726 ] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.20272734761238098 BPR_loss 0.20264120399951935 reg_loss 8.614245598437265e-05
epoch: 21 s: 256000 batch_loss 0.1992858648300171 BPR_loss 0.1991978883743286 reg_loss 8.79737053764984e-05
epoch: 21 s: 512000 batch_loss 0.19500693678855896 BPR_loss 0.194920152425766 reg_loss 8.678497397340834e-05
epoch: 21 s: 768000 batch_loss 0.1873883754014969 BPR_loss 0.18729877471923828 reg_loss 8.959940896602347e-05
epoch: 21 s: 1024000 batch_loss 0.1790166050195694 BPR_loss 0.17892645299434662 reg_loss 9.014789975481108e-05
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 80.72519445419312 | 1251.233410835266 | 121.15162658691406 | [0.09951167 0.1418052  0.17267271] | [0.04653604 0.05566436 0.06144106] | [0.00625226 0.004502   0.00367235] | [0.1203547  0.17010419 0.20566344] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.2057141363620758 BPR_loss 0.2056240439414978 reg_loss 9.009191853692755e-05
epoch: 22 s: 256000 batch_loss 0.19338640570640564 BPR_loss 0.19329960644245148 reg_loss 8.67984927026555e-05
epoch: 22 s: 512000 batch_loss 0.1825016289949417 BPR_loss 0.18240833282470703 reg_loss 9.330210741609335e-05
epoch: 22 s: 768000 batch_loss 0.17619773745536804 BPR_loss 0.17610636353492737 reg_loss 9.137635061051697e-05
epoch: 22 s: 1024000 batch_loss 0.187566876411438 BPR_loss 0.18747064471244812 reg_loss 9.623714868212119e-05
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 90.23993182182312 | 1126.167643070221 | 115.7228775024414 | [0.09915085 0.14144787 0.17236159] | [0.04648929 0.05561744 0.06140217] | [0.00623793 0.00449047 0.00366578] | [0.1200311  0.16971363 0.20528033] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.19319698214530945 BPR_loss 0.1931077390909195 reg_loss 8.923968562157825e-05
epoch: 23 s: 256000 batch_loss 0.17521914839744568 BPR_loss 0.17512169480323792 reg_loss 9.745353600010276e-05
epoch: 23 s: 512000 batch_loss 0.1927790641784668 BPR_loss 0.19268596172332764 reg_loss 9.309968299930915e-05
epoch: 23 s: 768000 batch_loss 0.16651031374931335 BPR_loss 0.16641676425933838 reg_loss 9.354475332656875e-05
epoch: 23 s: 1024000 batch_loss 0.16128842532634735 BPR_loss 0.16119635105133057 reg_loss 9.20688034966588e-05
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 85.8301739692688 | 1249.0326511859894 | 110.94955444335938 | [0.0990096  0.14122172 0.17196413] | [0.04645895 0.05557473 0.06132598] | [0.0062251  0.00448573 0.00365747] | [0.11981164 0.16942722 0.20488605] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.18250834941864014 BPR_loss 0.18241220712661743 reg_loss 9.614593727746978e-05
epoch: 24 s: 256000 batch_loss 0.17446087300777435 BPR_loss 0.17436574399471283 reg_loss 9.512600809102878e-05
epoch: 24 s: 512000 batch_loss 0.1848335862159729 BPR_loss 0.18473398685455322 reg_loss 9.959458839148283e-05
epoch: 24 s: 768000 batch_loss 0.17253650724887848 BPR_loss 0.17243653535842896 reg_loss 9.99759795377031e-05
epoch: 24 s: 1024000 batch_loss 0.16330590844154358 BPR_loss 0.16320815682411194 reg_loss 9.774815407581627e-05
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 80.47301959991455 | 1257.514095544815 | 106.41386413574219 | [0.09885878 0.14100047 0.17154362] | [0.04645262 0.0555503  0.06126541] | [0.00621692 0.00447941 0.00365053] | [0.1196703  0.16922636 0.20439878] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.17715483903884888 BPR_loss 0.17706060409545898 reg_loss 9.424204472452402e-05
epoch: 25 s: 256000 batch_loss 0.15963366627693176 BPR_loss 0.15953513979911804 reg_loss 9.851954382611439e-05
epoch: 25 s: 512000 batch_loss 0.16092051565647125 BPR_loss 0.1608215570449829 reg_loss 9.8961747426074e-05
epoch: 25 s: 768000 batch_loss 0.16188520193099976 BPR_loss 0.16178646683692932 reg_loss 9.874041279545054e-05
epoch: 25 s: 1024000 batch_loss 0.16303202509880066 BPR_loss 0.16293123364448547 reg_loss 0.00010079234198201448
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 90.04155349731445 | 1138.2595098018646 | 102.38312530517578 | [0.09865306 0.14071818 0.17107016] | [0.04639108 0.05547842 0.06115739] | [0.00620632 0.00447271 0.00364141] | [0.11938389 0.16895483 0.20387804] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.16988812386989594 BPR_loss 0.16978798806667328 reg_loss 0.00010013420251198113
epoch: 26 s: 256000 batch_loss 0.15286785364151 BPR_loss 0.15276503562927246 reg_loss 0.00010282199218636379
epoch: 26 s: 512000 batch_loss 0.15830545127391815 BPR_loss 0.15820729732513428 reg_loss 9.81531702564098e-05
epoch: 26 s: 768000 batch_loss 0.17860625684261322 BPR_loss 0.17850062251091003 reg_loss 0.0001056399560184218
epoch: 26 s: 1024000 batch_loss 0.15897521376609802 BPR_loss 0.1588754653930664 reg_loss 9.974685963243246e-05
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 90.66950964927673 | 1257.0646708011627 | 98.50675964355469 | [0.09846536 0.14047966 0.17049668] | [0.04635358 0.05542659 0.06104368] | [0.00619479 0.00446388 0.00362945] | [0.11916443 0.16867958 0.20321224] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.16037139296531677 BPR_loss 0.1602695882320404 reg_loss 0.00010181215475313365
epoch: 27 s: 256000 batch_loss 0.18231847882270813 BPR_loss 0.18221619725227356 reg_loss 0.00010228341852780432
epoch: 27 s: 512000 batch_loss 0.15803533792495728 BPR_loss 0.15793028473854065 reg_loss 0.00010505691170692444
epoch: 27 s: 768000 batch_loss 0.1484062671661377 BPR_loss 0.14830134809017181 reg_loss 0.00010491391003597528
epoch: 27 s: 1024000 batch_loss 0.15207862854003906 BPR_loss 0.15197792649269104 reg_loss 0.00010069808922708035
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 97.42242980003357 | 1335.3203918933868 | 94.65811157226562 | [0.09824579 0.14009809 0.16985562] | [0.04622605 0.05526328 0.06083684] | [0.00618344 0.004453   0.00361823] | [0.11895613 0.16823695 0.20248692] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 28 s: 0 batch_loss 0.147180438041687 BPR_loss 0.14707434177398682 reg_loss 0.00010609213495627046
epoch: 28 s: 256000 batch_loss 0.1672188639640808 BPR_loss 0.16711822152137756 reg_loss 0.00010064410889754072
epoch: 28 s: 512000 batch_loss 0.13658031821250916 BPR_loss 0.13647887110710144 reg_loss 0.00010143978579435498
epoch: 28 s: 768000 batch_loss 0.14524996280670166 BPR_loss 0.14514830708503723 reg_loss 0.00010165882849832997
epoch: 28 s: 1024000 batch_loss 0.16081926226615906 BPR_loss 0.16071467101573944 reg_loss 0.0001045964818331413
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   28  | 109.03286027908325 | 1212.9128992557526 | 90.91812896728516 | [0.09809625 0.1397613  0.1694191 ] | [0.04616876 0.05517085 0.06072133] | [0.00617414 0.00444565 0.003608  ] | [0.11872924 0.16791335 0.20201825] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 29 s: 0 batch_loss 0.1452019065618515 BPR_loss 0.14509403705596924 reg_loss 0.00010787619248731062
epoch: 29 s: 256000 batch_loss 0.14597909152507782 BPR_loss 0.1458713412284851 reg_loss 0.00010775123519124463
epoch: 29 s: 512000 batch_loss 0.15022079646587372 BPR_loss 0.15010975301265717 reg_loss 0.00011104172153864056
epoch: 29 s: 768000 batch_loss 0.14393079280853271 BPR_loss 0.14382191002368927 reg_loss 0.00010888208635151386
epoch: 29 s: 1024000 batch_loss 0.14657853543758392 BPR_loss 0.1464689075946808 reg_loss 0.00010963527165586129
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   29  | 73.0546007156372 | 777.7449369430542 | 87.71363830566406 | [0.09796957 0.13933331 0.16924994] | [0.0461587  0.05509198 0.06069141] | [0.00616336 0.00443031 0.00360434] | [0.11862881 0.16733681 0.20181739] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.09796956678538067
early stopping at 29, recall@20:0.0996
