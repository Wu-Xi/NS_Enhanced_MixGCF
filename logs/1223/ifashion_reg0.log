Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ifashion', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=2, l2=1e-06, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.693148136138916 BPR_loss 0.693148136138916 reg_loss 1.5493888116946408e-10
epoch: 0 s: 256000 batch_loss 0.6931405067443848 BPR_loss 0.6931405067443848 reg_loss 3.5566634082329074e-09
epoch: 0 s: 512000 batch_loss 0.6930543184280396 BPR_loss 0.6930542588233948 reg_loss 3.5554602817455816e-08
epoch: 0 s: 768000 batch_loss 0.6926556825637817 BPR_loss 0.6926554441452026 reg_loss 2.1143331707662583e-07
epoch: 0 s: 1024000 batch_loss 0.6912962794303894 BPR_loss 0.6912954449653625 reg_loss 8.157200568348344e-07
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 65.67572450637817 | 1022.891880273819 | 424.4120178222656 | [0.07667822 0.11502659 0.14373017] | [0.03521378 0.04345486 0.04881138] | [0.00478023 0.00361637 0.00302756] | [0.09290786 0.13853604 0.17195282] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6885769367218018 BPR_loss 0.6885749101638794 reg_loss 2.0374195628392044e-06
epoch: 1 s: 256000 batch_loss 0.6848013997077942 BPR_loss 0.6847975254058838 reg_loss 3.897209808201296e-06
epoch: 1 s: 512000 batch_loss 0.6786847114562988 BPR_loss 0.6786776185035706 reg_loss 7.08187008058303e-06
epoch: 1 s: 768000 batch_loss 0.672956645488739 BPR_loss 0.672946035861969 reg_loss 1.0621162800816819e-05
epoch: 1 s: 1024000 batch_loss 0.6662831902503967 BPR_loss 0.6662681698799133 reg_loss 1.5007133697508834e-05
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 79.31213474273682 | 1151.245802640915 | 413.88519287109375 | [0.08304519 0.12286735 0.15316067] | [0.03783293 0.04638046 0.05202992] | [0.00517302 0.00385842 0.00322166] | [0.10049582 0.14758208 0.18266895] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6583713293075562 BPR_loss 0.6583524346351624 reg_loss 1.8885048120864667e-05
epoch: 2 s: 256000 batch_loss 0.6494414210319519 BPR_loss 0.6494181752204895 reg_loss 2.3217229681904428e-05
epoch: 2 s: 512000 batch_loss 0.637978732585907 BPR_loss 0.6379465460777283 reg_loss 3.2164469303097576e-05
epoch: 2 s: 768000 batch_loss 0.6303375363349915 BPR_loss 0.6303021907806396 reg_loss 3.5369765100767836e-05
epoch: 2 s: 1024000 batch_loss 0.6173771619796753 BPR_loss 0.6173349618911743 reg_loss 4.220750633976422e-05
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 97.41421627998352 | 1173.558830022812 | 388.61920166015625 | [0.08645884 0.12798385 0.15847238] | [0.03963558 0.04854262 0.05423789] | [0.00539154 0.00402162 0.00333901] | [0.10462084 0.15353342 0.18886579] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6096883416175842 BPR_loss 0.609641432762146 reg_loss 4.6933808334870264e-05
epoch: 3 s: 256000 batch_loss 0.6039053201675415 BPR_loss 0.6038507223129272 reg_loss 5.457408042275347e-05
epoch: 3 s: 512000 batch_loss 0.5922052264213562 BPR_loss 0.5921463966369629 reg_loss 5.882546247448772e-05
epoch: 3 s: 768000 batch_loss 0.5840066075325012 BPR_loss 0.5839414000511169 reg_loss 6.522385228890926e-05
epoch: 3 s: 1024000 batch_loss 0.573108434677124 BPR_loss 0.5730373859405518 reg_loss 7.104522956069559e-05
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 76.48458361625671 | 1249.8293545246124 | 359.839599609375 | [0.08910544 0.13093699 0.16186218] | [0.04098999 0.04997147 0.05575076] | [0.00555837 0.00411628 0.00341328] | [0.10775274 0.15698148 0.19278251] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.5633196234703064 BPR_loss 0.5632458329200745 reg_loss 7.376768189715222e-05
epoch: 4 s: 256000 batch_loss 0.5541027188301086 BPR_loss 0.5540210604667664 reg_loss 8.167196938302368e-05
epoch: 4 s: 512000 batch_loss 0.5434530973434448 BPR_loss 0.5433614253997803 reg_loss 9.168146789306775e-05
epoch: 4 s: 768000 batch_loss 0.5330244302749634 BPR_loss 0.5329320430755615 reg_loss 9.238810889655724e-05
epoch: 4 s: 1024000 batch_loss 0.526384174823761 BPR_loss 0.5262869596481323 reg_loss 9.723361290525645e-05
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 75.84759020805359 | 1237.2348794937134 | 332.27886962890625 | [0.09110157 0.13352267 0.16456629] | [0.04190876 0.05102594 0.0568271 ] | [0.00568186 0.00420211 0.00347162] | [0.11011096 0.1600427  0.19595904] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.5153926014900208 BPR_loss 0.5152924656867981 reg_loss 0.0001001395721687004
epoch: 5 s: 256000 batch_loss 0.5152097940444946 BPR_loss 0.515100359916687 reg_loss 0.00010945928806904703
epoch: 5 s: 512000 batch_loss 0.5083062052726746 BPR_loss 0.5081937909126282 reg_loss 0.00011242926120758057
epoch: 5 s: 768000 batch_loss 0.499197393655777 BPR_loss 0.49907612800598145 reg_loss 0.0001212710194522515
epoch: 5 s: 1024000 batch_loss 0.47998666763305664 BPR_loss 0.4798610806465149 reg_loss 0.00012559520837385207
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 78.8171067237854 | 1223.0161821842194 | 307.6378479003906 | [0.09274888 0.13559514 0.16692576] | [0.04279419 0.05200929 0.05786641] | [0.00578935 0.00426953 0.00352357] | [0.11203026 0.16246787 0.19880824] |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.48441973328590393 BPR_loss 0.4842885136604309 reg_loss 0.00013122943346388638
epoch: 6 s: 256000 batch_loss 0.4716856777667999 BPR_loss 0.47155243158340454 reg_loss 0.00013323576422408223
epoch: 6 s: 512000 batch_loss 0.4676129221916199 BPR_loss 0.46747487783432007 reg_loss 0.00013803807087242603
epoch: 6 s: 768000 batch_loss 0.46518316864967346 BPR_loss 0.46503737568855286 reg_loss 0.00014580404968000948
epoch: 6 s: 1024000 batch_loss 0.45389336347579956 BPR_loss 0.4537445902824402 reg_loss 0.00014876849309075624
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 80.1040632724762 | 1220.7066671848297 | 285.8150634765625 | [0.09394225 0.13737029 0.16854257] | [0.04336989 0.05271368 0.05854313] | [0.00586374 0.00432755 0.00356045] | [0.11351438 0.16455828 0.20070895] |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.45304590463638306 BPR_loss 0.4528917968273163 reg_loss 0.00015410066407639533
epoch: 7 s: 256000 batch_loss 0.44432881474494934 BPR_loss 0.4441690146923065 reg_loss 0.00015980938042048365
epoch: 7 s: 512000 batch_loss 0.4277927279472351 BPR_loss 0.42762520909309387 reg_loss 0.00016750942450016737
epoch: 7 s: 768000 batch_loss 0.4207112491130829 BPR_loss 0.42053425312042236 reg_loss 0.00017698232841212302
epoch: 7 s: 1024000 batch_loss 0.4294339120388031 BPR_loss 0.4292665123939514 reg_loss 0.00016740075079724193
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 79.8003568649292 | 1191.0519630908966 | 265.7052917480469 | [0.09508468 0.13878655 0.16988605] | [0.04394974 0.05334605 0.0591593 ] | [0.0059413  0.00437489 0.00359015] | [0.11489063 0.16636972 0.2022935 ] |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.41424453258514404 BPR_loss 0.41405850648880005 reg_loss 0.00018603458011057228
epoch: 8 s: 256000 batch_loss 0.40074536204338074 BPR_loss 0.4005644917488098 reg_loss 0.00018087707576341927
epoch: 8 s: 512000 batch_loss 0.39446818828582764 BPR_loss 0.39427533745765686 reg_loss 0.000192844177945517
epoch: 8 s: 768000 batch_loss 0.4119454622268677 BPR_loss 0.4117576777935028 reg_loss 0.0001877820905065164
epoch: 8 s: 1024000 batch_loss 0.3827928602695465 BPR_loss 0.38259434700012207 reg_loss 0.00019851818797178566
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 85.74249291419983 | 1170.2326045036316 | 247.62493896484375 | [0.09587848 0.13980048 0.17079264] | [0.044299   0.05374422 0.0595439 ] | [0.00598909 0.00440594 0.00361079] | [0.11576473 0.16740376 0.20333126] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.38761410117149353 BPR_loss 0.38740572333335876 reg_loss 0.00020837994816247374
epoch: 9 s: 256000 batch_loss 0.37460535764694214 BPR_loss 0.3743976354598999 reg_loss 0.00020770812989212573
epoch: 9 s: 512000 batch_loss 0.37250494956970215 BPR_loss 0.3723052740097046 reg_loss 0.0001996629434870556
epoch: 9 s: 768000 batch_loss 0.3782868981361389 BPR_loss 0.3780800700187683 reg_loss 0.00020683066395577043
epoch: 9 s: 1024000 batch_loss 0.36354514956474304 BPR_loss 0.36332759261131287 reg_loss 0.00021755047782789916
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 89.47585368156433 | 1202.946521282196 | 231.93487548828125 | [0.09641344 0.14059294 0.17173897] | [0.04458242 0.05409313 0.0599164 ] | [0.00602741 0.00443421 0.00363174] | [0.11643053 0.16834854 0.20438019] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.377230167388916 BPR_loss 0.37702155113220215 reg_loss 0.00020862264500465244
epoch: 10 s: 256000 batch_loss 0.3755008280277252 BPR_loss 0.3752838373184204 reg_loss 0.00021699341596104205
epoch: 10 s: 512000 batch_loss 0.35569828748703003 BPR_loss 0.35547053813934326 reg_loss 0.00022776391415391117
epoch: 10 s: 768000 batch_loss 0.35318320989608765 BPR_loss 0.35295525193214417 reg_loss 0.00022797200654167682
epoch: 10 s: 1024000 batch_loss 0.3488242030143738 BPR_loss 0.34858429431915283 reg_loss 0.00023991854686755687
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 127.5937397480011 | 1256.0367937088013 | 217.35202026367188 | [0.09713643 0.14125264 0.17219467] | [0.0449514  0.05444656 0.06023993] | [0.00607483 0.00445653 0.00364458] | [0.11737531 0.16918173 0.20498648] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.36031869053840637 BPR_loss 0.3600769340991974 reg_loss 0.00024175176804419607
epoch: 11 s: 256000 batch_loss 0.34628042578697205 BPR_loss 0.3460492491722107 reg_loss 0.00023117211821954697
epoch: 11 s: 512000 batch_loss 0.3214203119277954 BPR_loss 0.32116299867630005 reg_loss 0.0002573098463471979
epoch: 11 s: 768000 batch_loss 0.3371790051460266 BPR_loss 0.3369362950325012 reg_loss 0.00024272034352179617
epoch: 11 s: 1024000 batch_loss 0.3269522786140442 BPR_loss 0.32670632004737854 reg_loss 0.0002459609240759164
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 129.59741401672363 | 1098.316618680954 | 204.7316131591797 | [0.09774791 0.14148539 0.17291089] | [0.04529726 0.0547173  0.06060227] | [0.00611686 0.00446555 0.00366224] | [0.11807459 0.16949045 0.20584942] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.33144333958625793 BPR_loss 0.33118224143981934 reg_loss 0.0002611052477732301
epoch: 12 s: 256000 batch_loss 0.3271785080432892 BPR_loss 0.3269199728965759 reg_loss 0.00025852659018710256
epoch: 12 s: 512000 batch_loss 0.31416085362434387 BPR_loss 0.3139069378376007 reg_loss 0.00025391270173713565
epoch: 12 s: 768000 batch_loss 0.31182554364204407 BPR_loss 0.31155604124069214 reg_loss 0.00026949893799610436
epoch: 12 s: 1024000 batch_loss 0.31006065011024475 BPR_loss 0.3097936511039734 reg_loss 0.00026698614237830043
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 136.44768595695496 | 1198.1527698040009 | 192.65394592285156 | [0.09830074 0.14215876 0.17321855] | [0.04558637 0.0550284  0.06083955] | [0.0061561  0.00449168 0.00367105] | [0.11873296 0.17039059 0.20621394] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.3005973696708679 BPR_loss 0.3003242611885071 reg_loss 0.0002731103450059891
epoch: 13 s: 256000 batch_loss 0.2962806224822998 BPR_loss 0.29598671197891235 reg_loss 0.0002939181576948613
epoch: 13 s: 512000 batch_loss 0.31343263387680054 BPR_loss 0.3131572902202606 reg_loss 0.00027535605477169156
epoch: 13 s: 768000 batch_loss 0.2828312814235687 BPR_loss 0.2825354337692261 reg_loss 0.00029583985451608896
epoch: 13 s: 1024000 batch_loss 0.2929794490337372 BPR_loss 0.2926883101463318 reg_loss 0.00029113757773302495
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 136.581449508667 | 1313.7421236038208 | 182.0846405029297 | [0.0987483  0.1422786  0.17351293] | [0.04587617 0.05525057 0.06109752] | [0.00618716 0.00449614 0.00367873] | [0.1192723  0.17043151 0.20661938] |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.28132346272468567 BPR_loss 0.2810353636741638 reg_loss 0.00028808953356929123
epoch: 14 s: 256000 batch_loss 0.28698304295539856 BPR_loss 0.2866918444633484 reg_loss 0.00029119287501089275
epoch: 14 s: 512000 batch_loss 0.2922295928001404 BPR_loss 0.29193997383117676 reg_loss 0.000289628078462556
epoch: 14 s: 768000 batch_loss 0.2762109339237213 BPR_loss 0.2759106755256653 reg_loss 0.0003002638404723257
epoch: 14 s: 1024000 batch_loss 0.27240779995918274 BPR_loss 0.27210819721221924 reg_loss 0.00029960385290905833
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 133.337140083313 | 1185.141431093216 | 171.8665771484375 | [0.09920187 0.14238544 0.1734256 ] | [0.04609835 0.05539296 0.06121015] | [0.00621878 0.00450042 0.00367954] | [0.11983768 0.17061005 0.20651895] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.27619287371635437 BPR_loss 0.27588653564453125 reg_loss 0.00030633778078481555
epoch: 15 s: 256000 batch_loss 0.26544129848480225 BPR_loss 0.2651251554489136 reg_loss 0.0003161428321618587
epoch: 15 s: 512000 batch_loss 0.26964065432548523 BPR_loss 0.2693270444869995 reg_loss 0.0003135957522317767
epoch: 15 s: 768000 batch_loss 0.26986628770828247 BPR_loss 0.26955240964889526 reg_loss 0.000313882454065606
epoch: 15 s: 1024000 batch_loss 0.26421546936035156 BPR_loss 0.2638959288597107 reg_loss 0.00031954506994225085
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 142.95411825180054 | 1080.739874124527 | 162.97422790527344 | [0.09938552 0.14249451 0.17364487] | [0.04624973 0.05553908 0.06136831] | [0.00622808 0.00450693 0.00368338] | [0.12007201 0.17074024 0.20666029] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.2568286061286926 BPR_loss 0.2565101981163025 reg_loss 0.0003183965163771063
epoch: 16 s: 256000 batch_loss 0.2729259729385376 BPR_loss 0.2726198434829712 reg_loss 0.00030613227863796055
epoch: 16 s: 512000 batch_loss 0.262102872133255 BPR_loss 0.2617880403995514 reg_loss 0.0003148338000755757
epoch: 16 s: 768000 batch_loss 0.25593918561935425 BPR_loss 0.25561490654945374 reg_loss 0.00032427386031486094
epoch: 16 s: 1024000 batch_loss 0.24736660718917847 BPR_loss 0.2470196634531021 reg_loss 0.00034693945781327784
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 128.11230087280273 | 1210.935787677765 | 154.53750610351562 | [0.09932509 0.14253198 0.17337499] | [0.04625884 0.05557287 0.06134769] | [0.00622826 0.00450907 0.00368047] | [0.1200311  0.1708667  0.20638504] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.24576130509376526 BPR_loss 0.24542509019374847 reg_loss 0.00033621868351474404
epoch: 17 s: 256000 batch_loss 0.24074135720729828 BPR_loss 0.24040880799293518 reg_loss 0.0003325536963529885
epoch: 17 s: 512000 batch_loss 0.25002050399780273 BPR_loss 0.24966970086097717 reg_loss 0.0003507938818074763
epoch: 17 s: 768000 batch_loss 0.22736914455890656 BPR_loss 0.22702670097351074 reg_loss 0.0003424387250561267
epoch: 17 s: 1024000 batch_loss 0.2431565523147583 BPR_loss 0.24280810356140137 reg_loss 0.00034845282789319754
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 128.06139063835144 | 1224.9686114788055 | 146.2720947265625 | [0.09943861 0.14263573 0.17312472] | [0.04634205 0.055646   0.06135704] | [0.00624072 0.00451353 0.00367632] | [0.12022079 0.17094481 0.20613955] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.22424881160259247 BPR_loss 0.22389331459999084 reg_loss 0.0003554975555744022
epoch: 18 s: 256000 batch_loss 0.22869010269641876 BPR_loss 0.22834792733192444 reg_loss 0.0003421757137402892
epoch: 18 s: 512000 batch_loss 0.23388166725635529 BPR_loss 0.2335270196199417 reg_loss 0.0003546506923157722
epoch: 18 s: 768000 batch_loss 0.21832838654518127 BPR_loss 0.21796470880508423 reg_loss 0.0003636842593550682
epoch: 18 s: 1024000 batch_loss 0.22185920178890228 BPR_loss 0.22150304913520813 reg_loss 0.00035614537773653865
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 121.62391328811646 | 1165.5794558525085 | 139.1094970703125 | [0.09941063 0.1424077  0.17276537] | [0.04640812 0.05567801 0.06136503] | [0.00624054 0.00450879 0.00367092] | [0.12018732 0.17068072 0.20573412] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.23683522641658783 BPR_loss 0.23648110032081604 reg_loss 0.0003541272890288383
epoch: 19 s: 256000 batch_loss 0.2232716679573059 BPR_loss 0.22291019558906555 reg_loss 0.0003614707093220204
epoch: 19 s: 512000 batch_loss 0.23893055319786072 BPR_loss 0.23856541514396667 reg_loss 0.00036514532985165715
epoch: 19 s: 768000 batch_loss 0.21648666262626648 BPR_loss 0.21611136198043823 reg_loss 0.0003753009077627212
epoch: 19 s: 1024000 batch_loss 0.20648989081382751 BPR_loss 0.20613634586334229 reg_loss 0.00035353974089957774
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 123.52051305770874 | 1158.0289721488953 | 132.7589874267578 | [0.09960629 0.14209624 0.17257977] | [0.04650121 0.05566445 0.06137713] | [0.00625411 0.00450089 0.00366838] | [0.12041421 0.17039803 0.20551094] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.2088647484779358 BPR_loss 0.20848076045513153 reg_loss 0.0003839912242256105
epoch: 20 s: 256000 batch_loss 0.20900052785873413 BPR_loss 0.20861561596393585 reg_loss 0.0003849056374747306
epoch: 20 s: 512000 batch_loss 0.22087201476097107 BPR_loss 0.22049707174301147 reg_loss 0.00037493614945560694
epoch: 20 s: 768000 batch_loss 0.21137644350528717 BPR_loss 0.2109978199005127 reg_loss 0.0003786267770919949
epoch: 20 s: 1024000 batch_loss 0.2073868215084076 BPR_loss 0.2070060670375824 reg_loss 0.0003807570901699364
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 123.10762405395508 | 12538.325394392014 | 126.52706146240234 | [0.09936914 0.14210099 0.17198332] | [0.04647187 0.05568538 0.0612923 ] | [0.0062437  0.0045021  0.00365809] | [0.12017244 0.17040547 0.20494928] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.19909067451953888 BPR_loss 0.19870597124099731 reg_loss 0.0003847065381705761
epoch: 21 s: 256000 batch_loss 0.1939568817615509 BPR_loss 0.19355657696723938 reg_loss 0.00040031151729635894
epoch: 21 s: 512000 batch_loss 0.1942114681005478 BPR_loss 0.19382107257843018 reg_loss 0.0003904002078343183
epoch: 21 s: 768000 batch_loss 0.1936679631471634 BPR_loss 0.19326496124267578 reg_loss 0.0004029994015581906
epoch: 21 s: 1024000 batch_loss 0.17724353075027466 BPR_loss 0.176841601729393 reg_loss 0.0004019266343675554
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 82.88064503669739 | 1210.305784702301 | 121.09440612792969 | [0.09926581 0.14168697 0.17171139] | [0.04647024 0.05562376 0.06125578] | [0.00623589 0.0044914  0.0036535 ] | [0.12004597 0.16992937 0.2046294 ] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.20568017661571503 BPR_loss 0.20527803897857666 reg_loss 0.0004021373752038926
epoch: 22 s: 256000 batch_loss 0.18453527987003326 BPR_loss 0.1841481328010559 reg_loss 0.000387142994441092
epoch: 22 s: 512000 batch_loss 0.18421049416065216 BPR_loss 0.18379954993724823 reg_loss 0.0004109382280148566
epoch: 22 s: 768000 batch_loss 0.18188031017780304 BPR_loss 0.18147405982017517 reg_loss 0.0004062549560330808
epoch: 22 s: 1024000 batch_loss 0.18757429718971252 BPR_loss 0.18713818490505219 reg_loss 0.0004361179890111089
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 81.36209201812744 | 1209.0932128429413 | 115.60212707519531 | [0.09911459 0.1415003  0.17147817] | [0.04645827 0.05560117 0.06122274] | [0.00622659 0.00448536 0.00364854] | [0.11989719 0.16965784 0.20438019] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.18486082553863525 BPR_loss 0.1844571828842163 reg_loss 0.0004036481259390712
epoch: 23 s: 256000 batch_loss 0.17772774398326874 BPR_loss 0.17729708552360535 reg_loss 0.0004306635237298906
epoch: 23 s: 512000 batch_loss 0.18893715739250183 BPR_loss 0.18853121995925903 reg_loss 0.00040593132143840194
epoch: 23 s: 768000 batch_loss 0.17193712294101715 BPR_loss 0.17151618003845215 reg_loss 0.0004209491889923811
epoch: 23 s: 1024000 batch_loss 0.15887579321861267 BPR_loss 0.15846794843673706 reg_loss 0.0004078436177223921
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 80.93318581581116 | 1223.098684310913 | 111.01026153564453 | [0.09907312 0.14137222 0.17100116] | [0.04646544 0.05558478 0.06114315] | [0.00622826 0.00448396 0.00364079] | [0.11985628 0.16949789 0.20381481] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.1833413988351822 BPR_loss 0.18291066586971283 reg_loss 0.0004307390481699258
epoch: 24 s: 256000 batch_loss 0.17888741195201874 BPR_loss 0.17846721410751343 reg_loss 0.00042020203545689583
epoch: 24 s: 512000 batch_loss 0.17990413308143616 BPR_loss 0.1794578731060028 reg_loss 0.0004462563374545425
epoch: 24 s: 768000 batch_loss 0.1719828099012375 BPR_loss 0.17154128849506378 reg_loss 0.00044151442125439644
epoch: 24 s: 1024000 batch_loss 0.1705576479434967 BPR_loss 0.1701349914073944 reg_loss 0.00042265121010132134
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 83.34453225135803 | 1157.6521759033203 | 106.45652770996094 | [0.09888132 0.1410271  0.17054126] | [0.04641102 0.05549882 0.06103849] | [0.00621748 0.00447178 0.00363162] | [0.11968517 0.16916313 0.20328291] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.17556047439575195 BPR_loss 0.17513880133628845 reg_loss 0.000421670702053234
epoch: 25 s: 256000 batch_loss 0.15568096935749054 BPR_loss 0.15524715185165405 reg_loss 0.0004338207363616675
epoch: 25 s: 512000 batch_loss 0.16158390045166016 BPR_loss 0.16114959120750427 reg_loss 0.00043430543155409396
epoch: 25 s: 768000 batch_loss 0.15418902039527893 BPR_loss 0.1537478268146515 reg_loss 0.0004411896225064993
epoch: 25 s: 1024000 batch_loss 0.16036906838417053 BPR_loss 0.1599297672510147 reg_loss 0.00043929845560342073
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 84.64369773864746 | 1199.9892745018005 | 102.23348236083984 | [0.098687   0.1406546  0.17038393] | [0.04633588 0.05538441 0.06096036] | [0.00621022 0.00446155 0.0036279 ] | [0.11948804 0.16879489 0.20311553] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.1668453812599182 BPR_loss 0.16640664637088776 reg_loss 0.0004387371882330626
epoch: 26 s: 256000 batch_loss 0.15138231217861176 BPR_loss 0.1509314924478531 reg_loss 0.0004508215351961553
epoch: 26 s: 512000 batch_loss 0.15635818243026733 BPR_loss 0.15592001378536224 reg_loss 0.0004381636972539127
epoch: 26 s: 768000 batch_loss 0.17526718974113464 BPR_loss 0.17480403184890747 reg_loss 0.00046316106454469264
epoch: 26 s: 1024000 batch_loss 0.158997043967247 BPR_loss 0.15856236219406128 reg_loss 0.0004346846544649452
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 82.1248242855072 | 1226.1163539886475 | 98.34239959716797 | [0.09875568 0.14019311 0.16995731] | [0.04636673 0.05530253 0.06088896] | [0.00620836 0.00444714 0.00362077] | [0.11951035 0.16817    0.2026543 ] |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.15849854052066803 BPR_loss 0.15805786848068237 reg_loss 0.00044067882117815316
epoch: 27 s: 256000 batch_loss 0.17618092894554138 BPR_loss 0.17573437094688416 reg_loss 0.00044655418605543673
epoch: 27 s: 512000 batch_loss 0.15631236135959625 BPR_loss 0.1558435559272766 reg_loss 0.0004688121844083071
epoch: 27 s: 768000 batch_loss 0.15068863332271576 BPR_loss 0.1502310037612915 reg_loss 0.00045762621448375285
epoch: 27 s: 1024000 batch_loss 0.1547325849533081 BPR_loss 0.154291033744812 reg_loss 0.0004415475996211171
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 81.60892534255981 | 1162.4634239673615 | 94.75099182128906 | [0.09853456 0.1398346  0.1693493 ] | [0.04628912 0.05518968 0.06073031] | [0.00620037 0.00443589 0.00360806] | [0.11936157 0.16774597 0.20194386] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 28 s: 0 batch_loss 0.1461685448884964 BPR_loss 0.14570847153663635 reg_loss 0.00046007498167455196
epoch: 28 s: 256000 batch_loss 0.1702200323343277 BPR_loss 0.1697806417942047 reg_loss 0.00043939557508565485
epoch: 28 s: 512000 batch_loss 0.13876782357692719 BPR_loss 0.13831749558448792 reg_loss 0.00045032158959656954
epoch: 28 s: 768000 batch_loss 0.14609017968177795 BPR_loss 0.1456497758626938 reg_loss 0.0004404023347888142
epoch: 28 s: 1024000 batch_loss 0.1635672003030777 BPR_loss 0.1631176620721817 reg_loss 0.00044954149052500725
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   28  | 83.37350726127625 | 1200.6386318206787 | 90.951904296875 | [0.09812999 0.13958012 0.16899595] | [0.04616327 0.05509541 0.0606157 ] | [0.0061814  0.0044291  0.00360019] | [0.11897101 0.16745212 0.20150495] |
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 29 s: 0 batch_loss 0.14450079202651978 BPR_loss 0.14402873814105988 reg_loss 0.0004720491706393659
epoch: 29 s: 256000 batch_loss 0.15052415430545807 BPR_loss 0.15005627274513245 reg_loss 0.0004678875848185271
epoch: 29 s: 512000 batch_loss 0.14860932528972626 BPR_loss 0.148126021027565 reg_loss 0.00048330839490517974
epoch: 29 s: 768000 batch_loss 0.14360523223876953 BPR_loss 0.14312416315078735 reg_loss 0.0004810677492059767
epoch: 29 s: 1024000 batch_loss 0.14711818099021912 BPR_loss 0.14664378762245178 reg_loss 0.00047438929323107004
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   29  | 80.67222571372986 | 1116.686934709549 | 87.6289291381836 | [0.09799005 0.13915221 0.16859206] | [0.04614787 0.0550268  0.06054797] | [0.00616838 0.00441989 0.00359201] | [0.11877759 0.16704296 0.20105488] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.09799005152701658
early stopping at 29, recall@20:0.0996
