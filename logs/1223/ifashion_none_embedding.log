Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ifashion', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=2, l2=1e-06, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.693148136138916 BPR_loss 0.693148136138916 reg_loss 3.2142094541498523e-10
epoch: 0 s: 256000 batch_loss 0.6931406855583191 BPR_loss 0.6931406855583191 reg_loss 5.635189204156177e-09
epoch: 0 s: 512000 batch_loss 0.6930525898933411 BPR_loss 0.6930525898933411 reg_loss 6.034476740524042e-08
epoch: 0 s: 768000 batch_loss 0.6926590204238892 BPR_loss 0.6926590204238892 reg_loss 3.643361594640737e-07
epoch: 0 s: 1024000 batch_loss 0.6912626028060913 BPR_loss 0.6912626028060913 reg_loss 1.410425625181233e-06
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 74.27279305458069 | 1180.7596807479858 | 424.4069519042969 | [0.07659819 0.11481436 0.14304451] | [0.03500742 0.04321634 0.04848662] | [0.00477353 0.00361088 0.00301485] | [0.09287067 0.13827195 0.17120146] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6885391473770142 BPR_loss 0.6885391473770142 reg_loss 3.475346602499485e-06
epoch: 1 s: 256000 batch_loss 0.6846407055854797 BPR_loss 0.6846407055854797 reg_loss 6.537959961860906e-06
epoch: 1 s: 512000 batch_loss 0.6786254644393921 BPR_loss 0.6786254644393921 reg_loss 1.1842354069813155e-05
epoch: 1 s: 768000 batch_loss 0.6726198196411133 BPR_loss 0.6726198196411133 reg_loss 1.7704784113448113e-05
epoch: 1 s: 1024000 batch_loss 0.6661710739135742 BPR_loss 0.6661710739135742 reg_loss 2.4872031644918025e-05
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 79.48818707466125 | 1203.5544738769531 | 413.8067321777344 | [0.08275141 0.12325242 0.1525559 ] | [0.03783736 0.04653636 0.05200757] | [0.00515089 0.00387014 0.00321236] | [0.10008295 0.14799496 0.18204406] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6576270461082458 BPR_loss 0.6576270461082458 reg_loss 3.125734656350687e-05
epoch: 2 s: 256000 batch_loss 0.648510217666626 BPR_loss 0.648510217666626 reg_loss 3.834523158730008e-05
epoch: 2 s: 512000 batch_loss 0.6374580264091492 BPR_loss 0.6374580264091492 reg_loss 5.286970190354623e-05
epoch: 2 s: 768000 batch_loss 0.6287834048271179 BPR_loss 0.6287834048271179 reg_loss 5.773302473244257e-05
epoch: 2 s: 1024000 batch_loss 0.6167806386947632 BPR_loss 0.6167806386947632 reg_loss 6.906680937390774e-05
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 86.61792087554932 | 1191.6799335479736 | 388.4567565917969 | [0.08641736 0.12749172 0.15826604] | [0.0396144  0.04844763 0.0541956 ] | [0.00538317 0.00400795 0.00333585] | [0.10441627 0.15310567 0.18869097] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6094387769699097 BPR_loss 0.6094387769699097 reg_loss 7.676753011764959e-05
epoch: 3 s: 256000 batch_loss 0.6035365462303162 BPR_loss 0.6035365462303162 reg_loss 8.92382740858011e-05
epoch: 3 s: 512000 batch_loss 0.5921640396118164 BPR_loss 0.5921640396118164 reg_loss 9.640093048801646e-05
epoch: 3 s: 768000 batch_loss 0.5820117592811584 BPR_loss 0.5820117592811584 reg_loss 0.00010632863995851949
epoch: 3 s: 1024000 batch_loss 0.5716283321380615 BPR_loss 0.5716283321380615 reg_loss 0.00011612185335252434
+-------+-------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |      Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 78.87094211578369 | 1192.1084899902344 | 359.6826171875 | [0.08878414 0.13073345 0.16154607] | [0.04086873 0.0498957  0.05565661] | [0.00552954 0.00411173 0.00340925] | [0.10721712 0.15682898 0.19258909] |
+-------+-------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.5625579357147217 BPR_loss 0.5625579357147217 reg_loss 0.00012018461711704731
epoch: 4 s: 256000 batch_loss 0.5540964603424072 BPR_loss 0.5540964603424072 reg_loss 0.00013285149179864675
epoch: 4 s: 512000 batch_loss 0.5421038866043091 BPR_loss 0.5421038866043091 reg_loss 0.00014905413263477385
epoch: 4 s: 768000 batch_loss 0.5344637632369995 BPR_loss 0.5344637632369995 reg_loss 0.00015022243314888328
epoch: 4 s: 1024000 batch_loss 0.5241419672966003 BPR_loss 0.5241419672966003 reg_loss 0.00015896980767138302
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 84.95322847366333 | 1147.2744739055634 | 332.10589599609375 | [0.09085336 0.13339512 0.16429812] | [0.04177431 0.05092685 0.05670117] | [0.00566661 0.00419811 0.00346672] | [0.10976131 0.16002038 0.19568379] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.5178942680358887 BPR_loss 0.5178942680358887 reg_loss 0.00016369154036510736
epoch: 5 s: 256000 batch_loss 0.5157094597816467 BPR_loss 0.5157094597816467 reg_loss 0.00017831135482992977
epoch: 5 s: 512000 batch_loss 0.5108379125595093 BPR_loss 0.5108379125595093 reg_loss 0.000183799333171919
epoch: 5 s: 768000 batch_loss 0.5021216869354248 BPR_loss 0.5021216869354248 reg_loss 0.00019804727344308048
epoch: 5 s: 1024000 batch_loss 0.4803890585899353 BPR_loss 0.4803890585899353 reg_loss 0.00020403902453836054
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 84.66466975212097 | 1203.2257359027863 | 307.61065673828125 | [0.0926226  0.13556876 0.16619554] | [0.0426693  0.05190875 0.0576392 ] | [0.00578061 0.00427018 0.00351117] | [0.11183312 0.16255714 0.19793042] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.48433852195739746 BPR_loss 0.48433852195739746 reg_loss 0.0002142136509064585
epoch: 6 s: 256000 batch_loss 0.47240573167800903 BPR_loss 0.47240573167800903 reg_loss 0.00021747213031630963
epoch: 6 s: 512000 batch_loss 0.46840760111808777 BPR_loss 0.46840760111808777 reg_loss 0.0002255991566926241
epoch: 6 s: 768000 batch_loss 0.46586915850639343 BPR_loss 0.46586915850639343 reg_loss 0.00023859970679040998
epoch: 6 s: 1024000 batch_loss 0.4539312720298767 BPR_loss 0.4539312720298767 reg_loss 0.00024208641843870282
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 75.09282422065735 | 1232.3024652004242 | 285.8456115722656 | [0.09378345 0.13721056 0.16815482] | [0.04329406 0.05264376 0.05843197] | [0.00585612 0.0043243  0.00355444] | [0.11323169 0.16445041 0.20032212] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.4519394636154175 BPR_loss 0.4519394636154175 reg_loss 0.00024927250342443585
epoch: 7 s: 256000 batch_loss 0.4442523419857025 BPR_loss 0.4442523419857025 reg_loss 0.00025780947180464864
epoch: 7 s: 512000 batch_loss 0.42888879776000977 BPR_loss 0.42888879776000977 reg_loss 0.0002722898789215833
epoch: 7 s: 768000 batch_loss 0.4203341603279114 BPR_loss 0.4203341603279114 reg_loss 0.00028845391352660954
epoch: 7 s: 1024000 batch_loss 0.4261760711669922 BPR_loss 0.4261760711669922 reg_loss 0.00027183181373402476
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 79.36576199531555 | 1231.3372235298157 | 265.865966796875 | [0.09479176 0.13872629 0.16955564] | [0.04375397 0.05321195 0.05897761] | [0.00592084 0.0043747  0.00358388] | [0.11447403 0.16628045 0.20181739] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.4162485897541046 BPR_loss 0.4162485897541046 reg_loss 0.00029969849856570363
epoch: 8 s: 256000 batch_loss 0.4005945920944214 BPR_loss 0.4005945920944214 reg_loss 0.0002945809974335134
epoch: 8 s: 512000 batch_loss 0.3954598605632782 BPR_loss 0.3954598605632782 reg_loss 0.0003146547242067754
epoch: 8 s: 768000 batch_loss 0.4104939103126526 BPR_loss 0.4104939103126526 reg_loss 0.00030517487903125584
epoch: 8 s: 1024000 batch_loss 0.3824707269668579 BPR_loss 0.3824707269668579 reg_loss 0.0003226105764042586
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 79.22532081604004 | 1227.9959263801575 | 247.75843811035156 | [0.09579915 0.13984826 0.17042798] | [0.04414064 0.05361479 0.05933928] | [0.00598519 0.0044092  0.00360502] | [0.11569034 0.16750791 0.20286631] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.38777807354927063 BPR_loss 0.38777807354927063 reg_loss 0.0003404348681215197
epoch: 9 s: 256000 batch_loss 0.374940425157547 BPR_loss 0.374940425157547 reg_loss 0.00033677101600915194
epoch: 9 s: 512000 batch_loss 0.3692781329154968 BPR_loss 0.3692781329154968 reg_loss 0.0003244766849093139
epoch: 9 s: 768000 batch_loss 0.3782184422016144 BPR_loss 0.3782184422016144 reg_loss 0.0003357150126248598
epoch: 9 s: 1024000 batch_loss 0.36282557249069214 BPR_loss 0.36282557249069214 reg_loss 0.00035768214729614556
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 133.32469272613525 | 1172.0815410614014 | 232.17958068847656 | [0.09676303 0.14073546 0.17157799] | [0.04457529 0.05404379 0.05981473] | [0.00604247 0.00444193 0.00363156] | [0.11671322 0.16857544 0.20420537] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.37836503982543945 BPR_loss 0.37836503982543945 reg_loss 0.0003398984845262021
epoch: 10 s: 256000 batch_loss 0.3793985843658447 BPR_loss 0.3793985843658447 reg_loss 0.0003552365815266967
epoch: 10 s: 512000 batch_loss 0.3490092158317566 BPR_loss 0.3490092158317566 reg_loss 0.00037298546521924436
epoch: 10 s: 768000 batch_loss 0.35563474893569946 BPR_loss 0.35563474893569946 reg_loss 0.0003717551880981773
epoch: 10 s: 1024000 batch_loss 0.34956806898117065 BPR_loss 0.34956806898117065 reg_loss 0.0003922546748071909
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 138.1753225326538 | 1188.177127122879 | 217.5967254638672 | [0.09726292 0.14123142 0.172376  ] | [0.04486938 0.05434436 0.06017409] | [0.00607576 0.00445913 0.00365065] | [0.11740135 0.16923008 0.2051427 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.35697221755981445 BPR_loss 0.35697221755981445 reg_loss 0.00039544745231978595
epoch: 11 s: 256000 batch_loss 0.3439306616783142 BPR_loss 0.3439306616783142 reg_loss 0.00037689111195504665
epoch: 11 s: 512000 batch_loss 0.3300296366214752 BPR_loss 0.3300296366214752 reg_loss 0.0004218218964524567
epoch: 11 s: 768000 batch_loss 0.33848217129707336 BPR_loss 0.33848217129707336 reg_loss 0.00039573656977154315
epoch: 11 s: 1024000 batch_loss 0.3254737854003906 BPR_loss 0.3254737854003906 reg_loss 0.0004029124102089554
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 141.23937916755676 | 1219.3594388961792 | 204.92886352539062 | [0.09796394 0.14157142 0.17270483] | [0.04525497 0.05465194 0.06047751] | [0.00612728 0.00447215 0.00365697] | [0.11823082 0.16963552 0.20545515] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.3258277475833893 BPR_loss 0.3258277475833893 reg_loss 0.00042519651469774544
epoch: 12 s: 256000 batch_loss 0.3253771662712097 BPR_loss 0.3253771662712097 reg_loss 0.0004220482660457492
epoch: 12 s: 512000 batch_loss 0.31349390745162964 BPR_loss 0.31349390745162964 reg_loss 0.00041466488619334996
epoch: 12 s: 768000 batch_loss 0.3128179609775543 BPR_loss 0.3128179609775543 reg_loss 0.0004418753378558904
epoch: 12 s: 1024000 batch_loss 0.3126722276210785 BPR_loss 0.3126722276210785 reg_loss 0.0004364335909485817
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 121.24336886405945 | 1130.2839398384094 | 192.86447143554688 | [0.09836538 0.14199225 0.17304597] | [0.04547561 0.05487861 0.06068942] | [0.00615871 0.00448833 0.00366621] | [0.11880363 0.17020089 0.20586058] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.30469271540641785 BPR_loss 0.30469271540641785 reg_loss 0.00045021873665973544
epoch: 13 s: 256000 batch_loss 0.29856622219085693 BPR_loss 0.29856622219085693 reg_loss 0.0004805016505997628
epoch: 13 s: 512000 batch_loss 0.312588632106781 BPR_loss 0.312588632106781 reg_loss 0.00045176385901868343
epoch: 13 s: 768000 batch_loss 0.284577876329422 BPR_loss 0.284577876329422 reg_loss 0.00048133806558325887
epoch: 13 s: 1024000 batch_loss 0.291300505399704 BPR_loss 0.291300505399704 reg_loss 0.0004762483877129853
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 141.42105722427368 | 1135.5221843719482 | 182.3645782470703 | [0.09893061 0.14243859 0.17339962] | [0.04577981 0.05515579 0.0609519 ] | [0.00619442 0.00450182 0.00367557] | [0.11945084 0.17064353 0.20630321] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.27659302949905396 BPR_loss 0.27659302949905396 reg_loss 0.00046982246567495167
epoch: 14 s: 256000 batch_loss 0.2840609550476074 BPR_loss 0.2840609550476074 reg_loss 0.00047965857083909214
epoch: 14 s: 512000 batch_loss 0.2925959825515747 BPR_loss 0.2925959825515747 reg_loss 0.0004765712365042418
epoch: 14 s: 768000 batch_loss 0.2767276167869568 BPR_loss 0.2767276167869568 reg_loss 0.0004935433389618993
epoch: 14 s: 1024000 batch_loss 0.2719291150569916 BPR_loss 0.2719291150569916 reg_loss 0.0004941365914419293
+-------+--------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 131.88837003707886 | 1240.0302112102509 | 172.01123046875 | [0.09928733 0.14255391 0.17343889] | [0.04601603 0.05533946 0.06112329] | [0.00622306 0.00450898 0.00367954] | [0.11992695 0.17076255 0.20647803] |
+-------+--------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.2748871445655823 BPR_loss 0.2748871445655823 reg_loss 0.0004994972259737551
epoch: 15 s: 256000 batch_loss 0.2599426507949829 BPR_loss 0.2599426507949829 reg_loss 0.0005177912535145879
epoch: 15 s: 512000 batch_loss 0.27149683237075806 BPR_loss 0.27149683237075806 reg_loss 0.0005134850507602096
epoch: 15 s: 768000 batch_loss 0.2677057087421417 BPR_loss 0.2677057087421417 reg_loss 0.0005150389624759555
epoch: 15 s: 1024000 batch_loss 0.2701238989830017 BPR_loss 0.2701238989830017 reg_loss 0.0005252939299680293
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 135.973290681839 | 1149.1277995109558 | 163.16233825683594 | [0.09963495 0.14285613 0.1736012 ] | [0.04621386 0.05552364 0.0612787 ] | [0.00624909 0.00451958 0.00368295] | [0.1203919  0.17112707 0.20656358] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.2563626766204834 BPR_loss 0.2563626766204834 reg_loss 0.0005253086565062404
epoch: 16 s: 256000 batch_loss 0.27139711380004883 BPR_loss 0.27139711380004883 reg_loss 0.000503738468978554
epoch: 16 s: 512000 batch_loss 0.26441842317581177 BPR_loss 0.26441842317581177 reg_loss 0.0005159437423571944
epoch: 16 s: 768000 batch_loss 0.2496696412563324 BPR_loss 0.2496696412563324 reg_loss 0.0005375636392273009
epoch: 16 s: 1024000 batch_loss 0.2395290732383728 BPR_loss 0.2395290732383728 reg_loss 0.0005722708883695304
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 129.537015914917 | 1138.070012331009 | 154.9135284423828 | [0.09975739 0.14285622 0.173764  ] | [0.04635071 0.05564304 0.06142198] | [0.00625114 0.00452265 0.0036871 ] | [0.12042537 0.17115311 0.20670493] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.2445732057094574 BPR_loss 0.2445732057094574 reg_loss 0.0005533044459298253
epoch: 17 s: 256000 batch_loss 0.24205657839775085 BPR_loss 0.24205657839775085 reg_loss 0.0005442918627522886
epoch: 17 s: 512000 batch_loss 0.2530466318130493 BPR_loss 0.2530466318130493 reg_loss 0.0005784425302408636
epoch: 17 s: 768000 batch_loss 0.2220100313425064 BPR_loss 0.2220100313425064 reg_loss 0.0005631963140331209
epoch: 17 s: 1024000 batch_loss 0.24393953382968903 BPR_loss 0.24393953382968903 reg_loss 0.000575271958950907
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 141.0648934841156 | 1248.5763311386108 | 146.55245971679688 | [0.0997812  0.14262083 0.17353741] | [0.04642041 0.05566087 0.0614479 ] | [0.00625895 0.00451707 0.0036845 ] | [0.12053696 0.17085182 0.206452  ] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.22762957215309143 BPR_loss 0.22762957215309143 reg_loss 0.0005882635596208274
epoch: 18 s: 256000 batch_loss 0.2286081314086914 BPR_loss 0.2286081314086914 reg_loss 0.0005627151113003492
epoch: 18 s: 512000 batch_loss 0.2332148402929306 BPR_loss 0.2332148402929306 reg_loss 0.0005865334533154964
epoch: 18 s: 768000 batch_loss 0.21369051933288574 BPR_loss 0.21369051933288574 reg_loss 0.0006021751323714852
epoch: 18 s: 1024000 batch_loss 0.22029241919517517 BPR_loss 0.22029241919517517 reg_loss 0.0005894663045182824
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 137.0238049030304 | 1175.7983734607697 | 139.23643493652344 | [0.09995406 0.14256021 0.1734829 ] | [0.04646081 0.05564665 0.06143031] | [0.00627011 0.00451604 0.00368264] | [0.12070062 0.17080347 0.20636273] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.23346981406211853 BPR_loss 0.23346981406211853 reg_loss 0.0005842503742314875
epoch: 19 s: 256000 batch_loss 0.22099491953849792 BPR_loss 0.22099491953849792 reg_loss 0.0005970631027594209
epoch: 19 s: 512000 batch_loss 0.23694269359111786 BPR_loss 0.23694269359111786 reg_loss 0.0006027112249284983
epoch: 19 s: 768000 batch_loss 0.2156018614768982 BPR_loss 0.2156018614768982 reg_loss 0.0006219201604835689
epoch: 19 s: 1024000 batch_loss 0.20879651606082916 BPR_loss 0.20879651606082916 reg_loss 0.0005835523479618132
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 151.95403790473938 | 1120.7079961299896 | 132.97042846679688 | [0.09981    0.14244627 0.17346106] | [0.04642083 0.05561638 0.0614163 ] | [0.00626397 0.00451288 0.00368171] | [0.12061879 0.17064725 0.20627346] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.21134109795093536 BPR_loss 0.21134109795093536 reg_loss 0.0006394109223037958
epoch: 20 s: 256000 batch_loss 0.20829634368419647 BPR_loss 0.20829634368419647 reg_loss 0.0006406150059774518
epoch: 20 s: 512000 batch_loss 0.22407133877277374 BPR_loss 0.22407133877277374 reg_loss 0.0006251175655052066
epoch: 20 s: 768000 batch_loss 0.21004030108451843 BPR_loss 0.21004030108451843 reg_loss 0.0006278014625422657
epoch: 20 s: 1024000 batch_loss 0.20380476117134094 BPR_loss 0.20380476117134094 reg_loss 0.0006352733471430838
+-------+--------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 160.72288489341736 | 12622.419195652008 | 126.79052734375 | [0.0995952  0.14232994 0.17315185] | [0.04646651 0.05568158 0.06144756] | [0.00625579 0.00451186 0.00367842] | [0.12041793 0.17058773 0.20595357] |
+-------+--------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.20462732017040253 BPR_loss 0.20462732017040253 reg_loss 0.0006434666574932635
epoch: 21 s: 256000 batch_loss 0.193645179271698 BPR_loss 0.193645179271698 reg_loss 0.0006624629022553563
epoch: 21 s: 512000 batch_loss 0.19257262349128723 BPR_loss 0.19257262349128723 reg_loss 0.0006491757812909782
epoch: 21 s: 768000 batch_loss 0.19118276238441467 BPR_loss 0.19118276238441467 reg_loss 0.0006704006809741259
epoch: 21 s: 1024000 batch_loss 0.17635022103786469 BPR_loss 0.17635022103786469 reg_loss 0.0006715180934406817
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 77.44252038002014 | 1270.8489544391632 | 121.15393829345703 | [0.09966492 0.1421165  0.17288094] | [0.04652916 0.05568285 0.06143629] | [0.00625932 0.00450591 0.00367291] | [0.12045885 0.17030504 0.20563741] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.20647123456001282 BPR_loss 0.20647123456001282 reg_loss 0.0006682858220301569
epoch: 22 s: 256000 batch_loss 0.18647581338882446 BPR_loss 0.18647581338882446 reg_loss 0.0006456441478803754
epoch: 22 s: 512000 batch_loss 0.17801505327224731 BPR_loss 0.17801505327224731 reg_loss 0.0006879197899252176
epoch: 22 s: 768000 batch_loss 0.1789940893650055 BPR_loss 0.1789940893650055 reg_loss 0.0006782548734918237
epoch: 22 s: 1024000 batch_loss 0.18973395228385925 BPR_loss 0.18973395228385925 reg_loss 0.0007290104986168444
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 90.41688823699951 | 1143.2462940216064 | 115.6340103149414 | [0.09936469 0.14183552 0.17233135] | [0.04641935 0.0555795  0.06128526] | [0.00624296 0.00449642 0.00366094] | [0.12016128 0.17000376 0.20496044] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.18532706797122955 BPR_loss 0.18532706797122955 reg_loss 0.0006683837855234742
epoch: 23 s: 256000 batch_loss 0.1788446605205536 BPR_loss 0.1788446605205536 reg_loss 0.0007222452550195158
epoch: 23 s: 512000 batch_loss 0.18907450139522552 BPR_loss 0.18907450139522552 reg_loss 0.0006837215041741729
epoch: 23 s: 768000 batch_loss 0.17241959273815155 BPR_loss 0.17241959273815155 reg_loss 0.0006995043950155377
epoch: 23 s: 1024000 batch_loss 0.16483710706233978 BPR_loss 0.16483710706233978 reg_loss 0.0006810129270888865
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 89.33220982551575 | 1228.2128744125366 | 110.98869323730469 | [0.09926516 0.14184285 0.17207804] | [0.04637872 0.05555365 0.06121011] | [0.00623756 0.0044981  0.00365697] | [0.12009805 0.16998516 0.20474099] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.18853884935379028 BPR_loss 0.18853884935379028 reg_loss 0.0007185089052654803
epoch: 24 s: 256000 batch_loss 0.17790785431861877 BPR_loss 0.17790785431861877 reg_loss 0.0007043994264677167
epoch: 24 s: 512000 batch_loss 0.18834081292152405 BPR_loss 0.18834081292152405 reg_loss 0.0007477527833543718
epoch: 24 s: 768000 batch_loss 0.1691969931125641 BPR_loss 0.1691969931125641 reg_loss 0.0007461749482899904
epoch: 24 s: 1024000 batch_loss 0.16882655024528503 BPR_loss 0.16882655024528503 reg_loss 0.00071301544085145
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 77.46350288391113 | 1255.0572638511658 | 106.39849090576172 | [0.09898809 0.14139818 0.17155878] | [0.04627493 0.05541402 0.06106837] | [0.00622194 0.00448136 0.00364848] | [0.11977444 0.16944954 0.20419793] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.1813362091779709 BPR_loss 0.1813362091779709 reg_loss 0.0007047827239148319
epoch: 25 s: 256000 batch_loss 0.16364970803260803 BPR_loss 0.16364970803260803 reg_loss 0.0007301694131456316
epoch: 25 s: 512000 batch_loss 0.15662643313407898 BPR_loss 0.15662643313407898 reg_loss 0.0007332746754400432
epoch: 25 s: 768000 batch_loss 0.15824320912361145 BPR_loss 0.15824320912361145 reg_loss 0.0007392806583084166
epoch: 25 s: 1024000 batch_loss 0.1671450287103653 BPR_loss 0.1671450287103653 reg_loss 0.0007428987300954759
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 86.26946306228638 | 1133.5828726291656 | 102.35563659667969 | [0.09887633 0.14132251 0.17098399] | [0.04626664 0.05541382 0.06097646] | [0.00621227 0.00448052 0.00363751] | [0.11957731 0.16938259 0.20356932] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.15967915952205658 BPR_loss 0.15967915952205658 reg_loss 0.0007390070823021233
epoch: 26 s: 256000 batch_loss 0.1479259729385376 BPR_loss 0.1479259729385376 reg_loss 0.0007628690800629556
epoch: 26 s: 512000 batch_loss 0.1528598964214325 BPR_loss 0.1528598964214325 reg_loss 0.0007329910295084119
epoch: 26 s: 768000 batch_loss 0.1712217926979065 BPR_loss 0.1712217926979065 reg_loss 0.0007825970533303916
epoch: 26 s: 1024000 batch_loss 0.1613231897354126 BPR_loss 0.1613231897354126 reg_loss 0.0007364943157881498
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 91.04005599021912 | 1220.9609506130219 | 98.25419616699219 | [0.09870847 0.14087502 0.17068983] | [0.04622818 0.0553179  0.06090157] | [0.00620409 0.00446853 0.00363007] | [0.11940992 0.16893624 0.20324199] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.159544438123703 BPR_loss 0.159544438123703 reg_loss 0.0007445995579473674
epoch: 27 s: 256000 batch_loss 0.17240360379219055 BPR_loss 0.17240360379219055 reg_loss 0.0007532371091656387
epoch: 27 s: 512000 batch_loss 0.15216416120529175 BPR_loss 0.15216416120529175 reg_loss 0.0007897770847193897
epoch: 27 s: 768000 batch_loss 0.1482427418231964 BPR_loss 0.1482427418231964 reg_loss 0.000774393614847213
epoch: 27 s: 1024000 batch_loss 0.15054811537265778 BPR_loss 0.15054811537265778 reg_loss 0.0007448843098245561
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 93.61438393592834 | 1290.446573972702 | 94.56051635742188 | [0.09836933 0.14034955 0.17022726] | [0.0460964  0.05515484 0.06074796] | [0.00618363 0.00445532 0.00362102] | [0.11901193 0.16831134 0.20271753] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 28 s: 0 batch_loss 0.14174844324588776 BPR_loss 0.14174844324588776 reg_loss 0.0007818920421414077
epoch: 28 s: 256000 batch_loss 0.16798430681228638 BPR_loss 0.16798430681228638 reg_loss 0.0007450523553416133
epoch: 28 s: 512000 batch_loss 0.13843195140361786 BPR_loss 0.13843195140361786 reg_loss 0.0007567740394733846
epoch: 28 s: 768000 batch_loss 0.14840245246887207 BPR_loss 0.14840245246887207 reg_loss 0.0007439898909069598
epoch: 28 s: 1024000 batch_loss 0.16141203045845032 BPR_loss 0.16141203045845032 reg_loss 0.0007620175601914525
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   28  | 108.53320264816284 | 1195.4188199043274 | 90.73335266113281 | [0.09806052 0.14010232 0.1698811 ] | [0.04608718 0.0551582  0.06073172] | [0.00616615 0.00444733 0.00361352] | [0.11866229 0.1680175  0.20227118] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.0980605172303113
early stopping at 28, recall@20:0.1000
