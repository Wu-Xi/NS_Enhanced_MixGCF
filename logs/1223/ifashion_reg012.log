Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ifashion', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=2, l2=1e-06, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.693148136138916 BPR_loss 0.693148136138916 reg_loss 2.412621664948933e-11
epoch: 0 s: 256000 batch_loss 0.6931405663490295 BPR_loss 0.6931405663490295 reg_loss 6.846357925027746e-10
epoch: 0 s: 512000 batch_loss 0.6930526494979858 BPR_loss 0.6930526494979858 reg_loss 9.580412907439495e-09
epoch: 0 s: 768000 batch_loss 0.6926645636558533 BPR_loss 0.6926645040512085 reg_loss 7.105986554734045e-08
epoch: 0 s: 1024000 batch_loss 0.6913028359413147 BPR_loss 0.6913025379180908 reg_loss 3.0573085041396553e-07
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 73.90842771530151 | 1098.4409987926483 | 424.40716552734375 | [0.07669702 0.11408858 0.1428658 ] | [0.03505878 0.04309116 0.04846924] | [0.00478004 0.00358884 0.00301299] | [0.09294134 0.13745364 0.17114567] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6885555982589722 BPR_loss 0.6885548233985901 reg_loss 7.880741463850427e-07
epoch: 1 s: 256000 batch_loss 0.6846140623092651 BPR_loss 0.684612512588501 reg_loss 1.538502260700625e-06
epoch: 1 s: 512000 batch_loss 0.6786280870437622 BPR_loss 0.6786252856254578 reg_loss 2.814675781337428e-06
epoch: 1 s: 768000 batch_loss 0.6727360486984253 BPR_loss 0.6727318167686462 reg_loss 4.2434844544914085e-06
epoch: 1 s: 1024000 batch_loss 0.6662327647209167 BPR_loss 0.6662267446517944 reg_loss 6.015133749315282e-06
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 83.29766583442688 | 1200.934180021286 | 413.8079528808594 | [0.08257122 0.12288974 0.1527811 ] | [0.03769884 0.04635419 0.05192918] | [0.00513824 0.00385833 0.00321453] | [0.09989325 0.14762672 0.18242718] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6575157046318054 BPR_loss 0.657508134841919 reg_loss 7.598514457640704e-06
epoch: 2 s: 256000 batch_loss 0.6485288143157959 BPR_loss 0.6485195159912109 reg_loss 9.308116204920225e-06
epoch: 2 s: 512000 batch_loss 0.6378697156906128 BPR_loss 0.6378568410873413 reg_loss 1.2864531527156942e-05
epoch: 2 s: 768000 batch_loss 0.6290794610977173 BPR_loss 0.6290653944015503 reg_loss 1.4078599633648992e-05
epoch: 2 s: 1024000 batch_loss 0.6160147190093994 BPR_loss 0.6159977912902832 reg_loss 1.6907901226659305e-05
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 79.54441356658936 | 1186.044486284256 | 388.4787292480469 | [0.08631782 0.12734452 0.15822802] | [0.03948033 0.04830115 0.05406595] | [0.00537294 0.00400525 0.00333368] | [0.1043084  0.15292713 0.18867237] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6097336411476135 BPR_loss 0.6097149848937988 reg_loss 1.8678923879633658e-05
epoch: 3 s: 256000 batch_loss 0.6036719679832458 BPR_loss 0.6036500930786133 reg_loss 2.1846584786544554e-05
epoch: 3 s: 512000 batch_loss 0.5920830368995667 BPR_loss 0.5920594930648804 reg_loss 2.3536724256700836e-05
epoch: 3 s: 768000 batch_loss 0.5848233699798584 BPR_loss 0.5847972631454468 reg_loss 2.6088649974553846e-05
epoch: 3 s: 1024000 batch_loss 0.5722892880439758 BPR_loss 0.5722607970237732 reg_loss 2.8513444704003632e-05
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 88.36963057518005 | 1161.0077085494995 | 359.7506103515625 | [0.08862491 0.13042434 0.16181194] | [0.04071886 0.04971023 0.05557143] | [0.00552117 0.00410261 0.00341086] | [0.10704602 0.15654257 0.19297965] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.562275767326355 BPR_loss 0.5622463226318359 reg_loss 2.944248990388587e-05
epoch: 4 s: 256000 batch_loss 0.5542423725128174 BPR_loss 0.5542098879814148 reg_loss 3.246801134082489e-05
epoch: 4 s: 512000 batch_loss 0.5416906476020813 BPR_loss 0.5416542291641235 reg_loss 3.642499359557405e-05
epoch: 4 s: 768000 batch_loss 0.5337440967559814 BPR_loss 0.5337069630622864 reg_loss 3.711471435963176e-05
epoch: 4 s: 1024000 batch_loss 0.5265358686447144 BPR_loss 0.5264966487884521 reg_loss 3.9207930967677385e-05
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 82.0576479434967 | 1226.7331671714783 | 332.1251525878906 | [0.09061912 0.13340279 0.1646948 ] | [0.04171951 0.05092013 0.05676335] | [0.00564968 0.00419783 0.00347397] | [0.10938564 0.16013569 0.1962938 ] |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.5177617073059082 BPR_loss 0.5177215337753296 reg_loss 4.018276740680449e-05
epoch: 5 s: 256000 batch_loss 0.5139206051826477 BPR_loss 0.5138769149780273 reg_loss 4.368165537016466e-05
epoch: 5 s: 512000 batch_loss 0.5086349248886108 BPR_loss 0.5085898637771606 reg_loss 4.506420009420253e-05
epoch: 5 s: 768000 batch_loss 0.4985281229019165 BPR_loss 0.498479425907135 reg_loss 4.8699654144002125e-05
epoch: 5 s: 1024000 batch_loss 0.484164834022522 BPR_loss 0.4841144382953644 reg_loss 5.0397437007632107e-05
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 74.80024266242981 | 1221.4667508602142 | 307.60614013671875 | [0.09227837 0.13553965 0.16676774] | [0.04248596 0.05178353 0.05762566] | [0.00576387 0.0042672  0.00352257] | [0.11147604 0.1625869  0.19882312] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.4844593405723572 BPR_loss 0.4844065010547638 reg_loss 5.2834657253697515e-05
epoch: 6 s: 256000 batch_loss 0.47176408767700195 BPR_loss 0.47171056270599365 reg_loss 5.353619053494185e-05
epoch: 6 s: 512000 batch_loss 0.46733933687210083 BPR_loss 0.46728354692459106 reg_loss 5.5776625231374055e-05
epoch: 6 s: 768000 batch_loss 0.4634971022605896 BPR_loss 0.4634380340576172 reg_loss 5.9081492508994415e-05
epoch: 6 s: 1024000 batch_loss 0.45547017455101013 BPR_loss 0.45541054010391235 reg_loss 5.963527655694634e-05
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 79.11374378204346 | 1218.9441814422607 | 285.83538818359375 | [0.0937477  0.13731306 0.16867103] | [0.04322026 0.05258164 0.05844472] | [0.00585519 0.00432467 0.00356157] | [0.11314614 0.16463639 0.20089865] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.4532416760921478 BPR_loss 0.4531805217266083 reg_loss 6.11504219705239e-05
epoch: 7 s: 256000 batch_loss 0.44663792848587036 BPR_loss 0.44657403230667114 reg_loss 6.391074566636235e-05
epoch: 7 s: 512000 batch_loss 0.4276072084903717 BPR_loss 0.42754021286964417 reg_loss 6.700253288727254e-05
epoch: 7 s: 768000 batch_loss 0.4207186996936798 BPR_loss 0.420647531747818 reg_loss 7.117018685676157e-05
epoch: 7 s: 1024000 batch_loss 0.42686206102371216 BPR_loss 0.4267944097518921 reg_loss 6.764972204109654e-05
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 79.31716179847717 | 1249.654011964798 | 265.73748779296875 | [0.09484615 0.13849928 0.1700811 ] | [0.04377821 0.05316654 0.05906763] | [0.00592753 0.00436624 0.00359337] | [0.11452239 0.16607587 0.20254643] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.42067116498947144 BPR_loss 0.420597106218338 reg_loss 7.406214717775583e-05
epoch: 8 s: 256000 batch_loss 0.40288376808166504 BPR_loss 0.40281081199645996 reg_loss 7.295663090189919e-05
epoch: 8 s: 512000 batch_loss 0.3915843367576599 BPR_loss 0.3915061354637146 reg_loss 7.819871098035946e-05
epoch: 8 s: 768000 batch_loss 0.4069913625717163 BPR_loss 0.4069156348705292 reg_loss 7.572156027890742e-05
epoch: 8 s: 1024000 batch_loss 0.38474392890930176 BPR_loss 0.3846633732318878 reg_loss 8.056492515606806e-05
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 78.87493515014648 | 1201.7866551876068 | 247.61355590820312 | [0.09567116 0.13956368 0.17119398] | [0.04413915 0.05358317 0.05949631] | [0.00597589 0.00440018 0.00361736] | [0.11547832 0.16722894 0.20382969] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.38853317499160767 BPR_loss 0.38844814896583557 reg_loss 8.501973934471607e-05
epoch: 9 s: 256000 batch_loss 0.37543854117393494 BPR_loss 0.3753545880317688 reg_loss 8.395065378863364e-05
epoch: 9 s: 512000 batch_loss 0.3744155466556549 BPR_loss 0.37433457374572754 reg_loss 8.097860700218007e-05
epoch: 9 s: 768000 batch_loss 0.3753417432308197 BPR_loss 0.37525826692581177 reg_loss 8.347851689904928e-05
epoch: 9 s: 1024000 batch_loss 0.36085453629493713 BPR_loss 0.36076492071151733 reg_loss 8.962092397268862e-05
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 132.75508284568787 | 1131.8622043132782 | 231.99818420410156 | [0.09652286 0.14049187 0.17202629] | [0.04453266 0.05400295 0.05989611] | [0.00602889 0.00443486 0.00363738] | [0.11646401 0.16841549 0.20477446] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.3766573369503021 BPR_loss 0.3765731155872345 reg_loss 8.422224345849827e-05
epoch: 10 s: 256000 batch_loss 0.3708711266517639 BPR_loss 0.37078285217285156 reg_loss 8.828172576613724e-05
epoch: 10 s: 512000 batch_loss 0.3476616144180298 BPR_loss 0.34756848216056824 reg_loss 9.31180693442002e-05
epoch: 10 s: 768000 batch_loss 0.35599198937416077 BPR_loss 0.3558994233608246 reg_loss 9.256914927391335e-05
epoch: 10 s: 1024000 batch_loss 0.34916749596595764 BPR_loss 0.34906893968582153 reg_loss 9.856246470008045e-05
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 146.93068623542786 | 1256.1011378765106 | 217.4961395263672 | [0.09720518 0.14112038 0.17292274] | [0.04489795 0.0543485  0.06029508] | [0.00607948 0.00445439 0.00365877] | [0.11738647 0.16911478 0.20573784] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.3594760596752167 BPR_loss 0.3593767285346985 reg_loss 9.93168432614766e-05
epoch: 11 s: 256000 batch_loss 0.34682807326316833 BPR_loss 0.3467334508895874 reg_loss 9.462468005949631e-05
epoch: 11 s: 512000 batch_loss 0.32357364892959595 BPR_loss 0.3234676122665405 reg_loss 0.0001060456270352006
epoch: 11 s: 768000 batch_loss 0.3387030065059662 BPR_loss 0.3386041820049286 reg_loss 9.882249287329614e-05
epoch: 11 s: 1024000 batch_loss 0.33219826221466064 BPR_loss 0.33209726214408875 reg_loss 0.00010098710481543094
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 148.7520031929016 | 1267.4414250850677 | 204.6997528076172 | [0.09786197 0.14167595 0.17341998] | [0.0453022  0.05473067 0.06066443] | [0.00612356 0.00447485 0.00367086] | [0.1181713  0.16983638 0.20639992] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.32747912406921387 BPR_loss 0.3273719847202301 reg_loss 0.00010714153904700652
epoch: 12 s: 256000 batch_loss 0.32392996549606323 BPR_loss 0.32382380962371826 reg_loss 0.0001061443763319403
epoch: 12 s: 512000 batch_loss 0.31160059571266174 BPR_loss 0.31149619817733765 reg_loss 0.00010438446042826399
epoch: 12 s: 768000 batch_loss 0.3114965558052063 BPR_loss 0.3113841414451599 reg_loss 0.00011241268657613546
epoch: 12 s: 1024000 batch_loss 0.30680733919143677 BPR_loss 0.3066973090171814 reg_loss 0.00011002465180354193
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 122.45315432548523 | 1093.0767035484314 | 192.7156524658203 | [0.09830812 0.14208167 0.17359656] | [0.04555422 0.05498216 0.06087365] | [0.00615369 0.0044928  0.00367787] | [0.1187404  0.17038687 0.20664914] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.30113187432289124 BPR_loss 0.30101799964904785 reg_loss 0.00011387066479073837
epoch: 13 s: 256000 batch_loss 0.30163145065307617 BPR_loss 0.301510214805603 reg_loss 0.00012123351916670799
epoch: 13 s: 512000 batch_loss 0.30848556756973267 BPR_loss 0.308371901512146 reg_loss 0.00011367677507223561
epoch: 13 s: 768000 batch_loss 0.280783087015152 BPR_loss 0.2806611657142639 reg_loss 0.00012191736459499225
epoch: 13 s: 1024000 batch_loss 0.2894824743270874 BPR_loss 0.289361834526062 reg_loss 0.00012064547627232969
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 162.77215552330017 | 1160.3507390022278 | 182.13870239257812 | [0.09878428 0.14235624 0.17379777] | [0.0458501  0.05523757 0.06111494] | [0.00618698 0.00450275 0.00368276] | [0.11929462 0.17072164 0.20678304] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.2825973927974701 BPR_loss 0.2824779748916626 reg_loss 0.0001194100477732718
epoch: 14 s: 256000 batch_loss 0.2860300838947296 BPR_loss 0.2859090268611908 reg_loss 0.0001210550544783473
epoch: 14 s: 512000 batch_loss 0.29033029079437256 BPR_loss 0.2902095317840576 reg_loss 0.00012074925325578079
epoch: 14 s: 768000 batch_loss 0.2762986123561859 BPR_loss 0.27617335319519043 reg_loss 0.00012527000217232853
epoch: 14 s: 1024000 batch_loss 0.2696855664253235 BPR_loss 0.2695600092411041 reg_loss 0.00012556588626466691
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 142.34337973594666 | 1206.2949175834656 | 171.91033935546875 | [0.0991051  0.14266594 0.17393634] | [0.04605006 0.05543006 0.06127764] | [0.00621097 0.00451502 0.00368989] | [0.11969261 0.17106012 0.20701737] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.2748015820980072 BPR_loss 0.2746749818325043 reg_loss 0.00012660988431889564
epoch: 15 s: 256000 batch_loss 0.2612583637237549 BPR_loss 0.26112693548202515 reg_loss 0.00013143035175744444
epoch: 15 s: 512000 batch_loss 0.269623339176178 BPR_loss 0.26949262619018555 reg_loss 0.00013072103320155293
epoch: 15 s: 768000 batch_loss 0.26994791626930237 BPR_loss 0.2698156237602234 reg_loss 0.00013230608601588756
epoch: 15 s: 1024000 batch_loss 0.26711776852607727 BPR_loss 0.2669830322265625 reg_loss 0.00013473816215991974
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 149.9124779701233 | 1167.4636421203613 | 162.8887176513672 | [0.09946607 0.14248841 0.17412138] | [0.04624405 0.05551077 0.0614283 ] | [0.00623533 0.00451065 0.00369417] | [0.12015012 0.17082207 0.20725915] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.2507365643978119 BPR_loss 0.2506026327610016 reg_loss 0.000133944398839958
epoch: 16 s: 256000 batch_loss 0.2674707770347595 BPR_loss 0.26734256744384766 reg_loss 0.00012821631389670074
epoch: 16 s: 512000 batch_loss 0.26534250378608704 BPR_loss 0.26520979404449463 reg_loss 0.00013270742783788592
epoch: 16 s: 768000 batch_loss 0.2510196268558502 BPR_loss 0.2508823275566101 reg_loss 0.00013729145575780421
epoch: 16 s: 1024000 batch_loss 0.24904748797416687 BPR_loss 0.24890071153640747 reg_loss 0.0001467789406888187
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 149.28219032287598 | 1169.2298135757446 | 154.6626434326172 | [0.09934644 0.14237331 0.17370537] | [0.04624746 0.0555264  0.06139864] | [0.00622715 0.00450768 0.00369014] | [0.1199939  0.1707142  0.20679048] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.2427198737859726 BPR_loss 0.24257755279541016 reg_loss 0.00014232481771614403
epoch: 17 s: 256000 batch_loss 0.23808908462524414 BPR_loss 0.23794996738433838 reg_loss 0.0001391184632666409
epoch: 17 s: 512000 batch_loss 0.2496328204870224 BPR_loss 0.2494834065437317 reg_loss 0.00014941244444344193
epoch: 17 s: 768000 batch_loss 0.22484086453914642 BPR_loss 0.22469517588615417 reg_loss 0.0001456838654121384
epoch: 17 s: 1024000 batch_loss 0.24354864656925201 BPR_loss 0.24340052902698517 reg_loss 0.00014812206791248173
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 154.2695436477661 | 1252.6727316379547 | 146.0768280029297 | [0.09952987 0.1423317  0.17371404] | [0.04642441 0.05565185 0.06152817] | [0.00624091 0.00450795 0.00368921] | [0.12024311 0.17064725 0.20674212] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.22410045564174652 BPR_loss 0.22394847869873047 reg_loss 0.0001519714860478416
epoch: 18 s: 256000 batch_loss 0.23070107400417328 BPR_loss 0.23055541515350342 reg_loss 0.00014566161553375423
epoch: 18 s: 512000 batch_loss 0.23080921173095703 BPR_loss 0.23065772652626038 reg_loss 0.00015148271631915122
epoch: 18 s: 768000 batch_loss 0.21643340587615967 BPR_loss 0.2162785828113556 reg_loss 0.00015482852177228779
epoch: 18 s: 1024000 batch_loss 0.215979665517807 BPR_loss 0.21582689881324768 reg_loss 0.00015276821795850992
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 151.9702866077423 | 1127.7524316310883 | 138.98825073242188 | [0.09962914 0.1422184  0.17340981] | [0.04650784 0.05569399 0.06153165] | [0.00624928 0.00450758 0.0036832 ] | [0.12038818 0.17058401 0.20637761] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.23489989340305328 BPR_loss 0.23474764823913574 reg_loss 0.00015224696835502982
epoch: 19 s: 256000 batch_loss 0.22174730896949768 BPR_loss 0.221591517329216 reg_loss 0.00015579447790514678
epoch: 19 s: 512000 batch_loss 0.2371544986963272 BPR_loss 0.23699821531772614 reg_loss 0.0001562858815304935
epoch: 19 s: 768000 batch_loss 0.21387624740600586 BPR_loss 0.21371491253376007 reg_loss 0.00016133571625687182
epoch: 19 s: 1024000 batch_loss 0.2056448757648468 BPR_loss 0.20549330115318298 reg_loss 0.00015156985318753868
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 161.4283788204193 | 1150.664179801941 | 132.43077087402344 | [0.09948311 0.14199254 0.17315909] | [0.0465054  0.05567693 0.06151509] | [0.00624556 0.00450089 0.00368053] | [0.12028031 0.17026785 0.2062065 ] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.21108780801296234 BPR_loss 0.2109208106994629 reg_loss 0.00016700023843441159
epoch: 20 s: 256000 batch_loss 0.21074436604976654 BPR_loss 0.21057721972465515 reg_loss 0.00016714351659175009
epoch: 20 s: 512000 batch_loss 0.21904684603214264 BPR_loss 0.21888437867164612 reg_loss 0.00016246263112407178
epoch: 20 s: 768000 batch_loss 0.21112383902072906 BPR_loss 0.21096035838127136 reg_loss 0.00016348245844710618
epoch: 20 s: 1024000 batch_loss 0.2008424997329712 BPR_loss 0.20067624747753143 reg_loss 0.00016625647549517453
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 165.4524896144867 | 12649.123442173004 | 126.55831146240234 | [0.09957357 0.14201136 0.17300586] | [0.04652331 0.05567152 0.06147295] | [0.00625226 0.00450145 0.00367613] | [0.12042165 0.17040175 0.20601681] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.19834576547145844 BPR_loss 0.19817817211151123 reg_loss 0.0001675899839028716
epoch: 21 s: 256000 batch_loss 0.1968950778245926 BPR_loss 0.19672057032585144 reg_loss 0.0001745039626257494
epoch: 21 s: 512000 batch_loss 0.19660121202468872 BPR_loss 0.19643154740333557 reg_loss 0.00016966997645795345
epoch: 21 s: 768000 batch_loss 0.19297975301742554 BPR_loss 0.19280225038528442 reg_loss 0.000177509878994897
epoch: 21 s: 1024000 batch_loss 0.17785538733005524 BPR_loss 0.17767801880836487 reg_loss 0.00017736770678311586
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 82.60351824760437 | 1276.7348580360413 | 121.03124237060547 | [0.09943524 0.14197037 0.17278314] | [0.04649046 0.0556571  0.06142378] | [0.00624203 0.00449986 0.00367117] | [0.12016128 0.17026413 0.20571552] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.2128560096025467 BPR_loss 0.21267926692962646 reg_loss 0.00017674216360319406
epoch: 22 s: 256000 batch_loss 0.1877661496400833 BPR_loss 0.1875973343849182 reg_loss 0.00016881994088180363
epoch: 22 s: 512000 batch_loss 0.17931748926639557 BPR_loss 0.1791347861289978 reg_loss 0.0001827025116654113
epoch: 22 s: 768000 batch_loss 0.18770678341388702 BPR_loss 0.18752846121788025 reg_loss 0.0001783157786121592
epoch: 22 s: 1024000 batch_loss 0.18080967664718628 BPR_loss 0.18061715364456177 reg_loss 0.00019253016216680408
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 93.61169600486755 | 1123.3374907970428 | 115.33232116699219 | [0.09920534 0.14159191 0.17240448] | [0.04652878 0.05566376 0.06143293] | [0.0062305  0.00448796 0.00366454] | [0.11997902 0.16977686 0.20523569] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.190837100148201 BPR_loss 0.19066093862056732 reg_loss 0.00017616628610994667
epoch: 23 s: 256000 batch_loss 0.17964543402194977 BPR_loss 0.1794535219669342 reg_loss 0.00019190850434824824
epoch: 23 s: 512000 batch_loss 0.18757300078868866 BPR_loss 0.1873921900987625 reg_loss 0.00018081747111864388
epoch: 23 s: 768000 batch_loss 0.1736423373222351 BPR_loss 0.17345649003982544 reg_loss 0.00018584859208203852
epoch: 23 s: 1024000 batch_loss 0.15601679682731628 BPR_loss 0.15583641827106476 reg_loss 0.0001803841587388888
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 90.3682029247284 | 1230.3260910511017 | 110.80213165283203 | [0.09891261 0.1413563  0.17219685] | [0.0465029  0.05565577 0.06142558] | [0.00621617 0.00448378 0.00366038] | [0.11961078 0.16957972 0.2049902 ] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.18223626911640167 BPR_loss 0.18204501271247864 reg_loss 0.00019124946265947074
epoch: 24 s: 256000 batch_loss 0.16990266740322113 BPR_loss 0.16971582174301147 reg_loss 0.00018684423412196338
epoch: 24 s: 512000 batch_loss 0.1898614466190338 BPR_loss 0.18966025114059448 reg_loss 0.000201192160602659
epoch: 24 s: 768000 batch_loss 0.17054656147956848 BPR_loss 0.17034822702407837 reg_loss 0.00019834160048048943
epoch: 24 s: 1024000 batch_loss 0.16630618274211884 BPR_loss 0.16611583530902863 reg_loss 0.00019035251170862466
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 81.56902980804443 | 1249.9700436592102 | 106.32811737060547 | [0.09881292 0.14106538 0.17166232] | [0.0464676  0.05558009 0.06130174] | [0.00621301 0.00447671 0.00364904] | [0.1196145  0.16936771 0.20433927] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.1707816869020462 BPR_loss 0.1705949902534485 reg_loss 0.00018670203280635178
epoch: 25 s: 256000 batch_loss 0.15669675171375275 BPR_loss 0.1565023809671402 reg_loss 0.0001943716051755473
epoch: 25 s: 512000 batch_loss 0.15709976851940155 BPR_loss 0.15690484642982483 reg_loss 0.0001949193683685735
epoch: 25 s: 768000 batch_loss 0.16497908532619476 BPR_loss 0.16478204727172852 reg_loss 0.00019704119767993689
epoch: 25 s: 1024000 batch_loss 0.15429608523845673 BPR_loss 0.15409813821315765 reg_loss 0.0001979420194402337
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 91.68793392181396 | 1119.8450469970703 | 102.10285186767578 | [0.09866265 0.14092802 0.17120811] | [0.04641987 0.05553131 0.06119453] | [0.0062039  0.00447262 0.00364036] | [0.11943596 0.16914825 0.20379993] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.1660872995853424 BPR_loss 0.16588979959487915 reg_loss 0.00019749428611248732
epoch: 26 s: 256000 batch_loss 0.15184366703033447 BPR_loss 0.15163826942443848 reg_loss 0.00020540352852549404
epoch: 26 s: 512000 batch_loss 0.15501727163791656 BPR_loss 0.15482188761234283 reg_loss 0.00019537679327186197
epoch: 26 s: 768000 batch_loss 0.17893044650554657 BPR_loss 0.17871949076652527 reg_loss 0.00021095862030051649
epoch: 26 s: 1024000 batch_loss 0.15843696892261505 BPR_loss 0.15824034810066223 reg_loss 0.00019661667465697974
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 93.41393852233887 | 1243.5044071674347 | 98.17442321777344 | [0.09844933 0.14037125 0.17064458] | [0.04637012 0.05541829 0.06107466] | [0.00619256 0.00445988 0.00362858] | [0.11919419 0.1685494  0.2032048 ] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.15847937762737274 BPR_loss 0.1582786589860916 reg_loss 0.00020071302424184978
epoch: 27 s: 256000 batch_loss 0.17922748625278473 BPR_loss 0.17902693152427673 reg_loss 0.0002005515416385606
epoch: 27 s: 512000 batch_loss 0.1594083309173584 BPR_loss 0.15919902920722961 reg_loss 0.00020930873870383948
epoch: 27 s: 768000 batch_loss 0.1546030342578888 BPR_loss 0.15439336001873016 reg_loss 0.0002096753887599334
epoch: 27 s: 1024000 batch_loss 0.15482328832149506 BPR_loss 0.15462368726730347 reg_loss 0.00019960664212703705
+-------+-------------------+--------------------+-------------------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |              recall             |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 98.20201516151428 | 1312.2052850723267 | 94.55146026611328 | [0.0983078 0.1396358 0.1700122] | [0.04627376 0.05520046 0.06088035] | [0.00618288 0.00443793 0.00361705] | [0.11900077 0.16769017 0.20254271] |
+-------+-------------------+--------------------+-------------------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 28 s: 0 batch_loss 0.14219851791858673 BPR_loss 0.14198625087738037 reg_loss 0.00021226058015599847
epoch: 28 s: 256000 batch_loss 0.1679530292749405 BPR_loss 0.16775327920913696 reg_loss 0.0001997534418478608
epoch: 28 s: 512000 batch_loss 0.1377355456352234 BPR_loss 0.1375332474708557 reg_loss 0.0002023007837124169
epoch: 28 s: 768000 batch_loss 0.14703872799873352 BPR_loss 0.1468404084444046 reg_loss 0.00019831594545394182
epoch: 28 s: 1024000 batch_loss 0.16433845460414886 BPR_loss 0.16413378715515137 reg_loss 0.00020466030400712043
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   28  | 110.23170232772827 | 1197.7712805271149 | 90.97359466552734 | [0.09798896 0.13945622 0.16967248] | [0.04619788 0.05515372 0.06080731] | [0.00616131 0.00443207 0.00361203] | [0.11861393 0.16754883 0.20218191] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.09798895666824095
early stopping at 28, recall@20:0.0996
