Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ali', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.001, lr=0.005, mess_dropout=False, mess_dropout_rate=0.1, n_negs=32, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上进行softmax自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931480169296265 BPR_loss 0.6931477785110474 reg_loss 2.222623010084135e-07
epoch: 0 s: 256000 batch_loss 0.6779631972312927 BPR_loss 0.6765815615653992 reg_loss 0.0013816109858453274
epoch: 0 s: 512000 batch_loss 0.6617502570152283 BPR_loss 0.658610463142395 reg_loss 0.003139814594760537
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 43.262587785720825 | 159.1842212677002  | 240.00575256347656 | [0.06100081 0.09165198 0.11280954] | [0.02769524 0.03428633 0.03825825] | [0.00366499 0.00280218 0.00232659] | [0.07145221 0.10730241 0.13191495] |
|   0   | 43.262587785720825 | 209.05474376678467 | 240.00575256347656 | [0.00804346 0.01442439 0.02104617] | [0.00323556 0.0045577  0.00576324] | [0.00043001 0.0003927  0.00038863] | [0.0085263  0.01550101 0.02293381] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6327324509620667 BPR_loss 0.6278039216995239 reg_loss 0.004928520880639553
epoch: 1 s: 256000 batch_loss 0.611621081829071 BPR_loss 0.6042569875717163 reg_loss 0.0073640779592096806
epoch: 1 s: 512000 batch_loss 0.5924882888793945 BPR_loss 0.5826137065887451 reg_loss 0.009874598123133183
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 65.53359937667847 | 365.7113997936249 | 217.02064514160156 | [0.07226246 0.10395093 0.12508379] | [0.03336344 0.04016655 0.04411488] | [0.0042772  0.00312586 0.00253295] | [0.08339308 0.1200706  0.14462799] |
|   1   | 65.53359937667847 | 324.2679443359375 | 217.02064514160156 | [0.01162428 0.02031337 0.02803761] | [0.00466601 0.00646524 0.00787236] | [0.00061915 0.00054896 0.00051276] | [0.01229442 0.0217221  0.03035184] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.5599745512008667 BPR_loss 0.5484644174575806 reg_loss 0.011510125361382961
epoch: 2 s: 256000 batch_loss 0.5450417995452881 BPR_loss 0.5316675901412964 reg_loss 0.0133742094039917
epoch: 2 s: 512000 batch_loss 0.5330337285995483 BPR_loss 0.5176020860671997 reg_loss 0.015431631356477737
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 69.20322442054749 | 380.1335439682007 | 193.26109313964844 | [0.07556298 0.10606658 0.12674215] | [0.0350942  0.04166447 0.04553936] | [0.00444542 0.00318825 0.0025672 ] | [0.08672991 0.12260769 0.14644807] |
|   2   | 69.20322442054749 | 328.3808784484863 | 193.26109313964844 | [0.01404401 0.02355333 0.03191596] | [0.00576441 0.00773073 0.00925202] | [0.00075067 0.00063652 0.0005832 ] | [0.01489516 0.02523902 0.03454849] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.510645866394043 BPR_loss 0.4939834773540497 reg_loss 0.016662394627928734
epoch: 3 s: 256000 batch_loss 0.4979226589202881 BPR_loss 0.4796276390552521 reg_loss 0.018295029178261757
epoch: 3 s: 512000 batch_loss 0.4911944568157196 BPR_loss 0.47190505266189575 reg_loss 0.0192894134670496
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 69.56884551048279 | 387.4622790813446  | 177.66175842285156 | [0.07538003 0.10472001 0.12516603] | [0.03554819 0.041857   0.0456782 ] | [0.00442957 0.00313758 0.00252813] | [0.08631625 0.12087033 0.14457283] |
|   3   | 69.56884551048279 | 331.87705636024475 | 177.66175842285156 | [0.01572784 0.02589892 0.03374524] | [0.0064263  0.00853503 0.00996498] | [0.00084081 0.00070043 0.00061718] | [0.01669794 0.02776587 0.03657293] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.4768340289592743 BPR_loss 0.4566720724105835 reg_loss 0.020161962136626244
epoch: 4 s: 256000 batch_loss 0.46323642134666443 BPR_loss 0.4421837329864502 reg_loss 0.021052690222859383
epoch: 4 s: 512000 batch_loss 0.47120237350463867 BPR_loss 0.4492368698120117 reg_loss 0.021965518593788147
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 71.03599309921265 | 384.92297172546387 | 168.01651000976562 | [0.07491182 0.10361305 0.12329504] | [0.03553419 0.04169465 0.04537081] | [0.00441302 0.00310483 0.00249136] | [0.08594396 0.11951906 0.14242182] |
|   4   | 71.03599309921265 |  328.280864238739  | 168.01651000976562 | [0.0166381  0.02631418 0.03456363] | [0.00684755 0.00886519 0.01037136] | [0.00088588 0.00071151 0.00063467] | [0.01759934 0.02819441 0.03753343] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.45080506801605225 BPR_loss 0.4280831217765808 reg_loss 0.02272193878889084
epoch: 5 s: 256000 batch_loss 0.4489496946334839 BPR_loss 0.42615294456481934 reg_loss 0.02279675006866455
epoch: 5 s: 512000 batch_loss 0.449157178401947 BPR_loss 0.4257007837295532 reg_loss 0.023456400260329247
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 66.74406671524048 | 387.12124943733215 | 161.78546142578125 | [0.07379291 0.10172854 0.12115651] | [0.03540248 0.04141081 0.04504983] | [0.00434684 0.00304727 0.0024493 ] | [0.08464784 0.11727152 0.13982957] |
|   5   | 66.74406671524048 | 319.76741123199463 | 161.78546142578125 | [0.01678105 0.02702224 0.0348907 ] | [0.00696027 0.00910098 0.01053902] | [0.000894   0.00073294 0.0006423 ] | [0.01777666 0.02908102 0.03797674] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.43815529346466064 BPR_loss 0.41425538063049316 reg_loss 0.02389991469681263
epoch: 6 s: 256000 batch_loss 0.43793243169784546 BPR_loss 0.41397225856781006 reg_loss 0.023960163816809654
epoch: 6 s: 512000 batch_loss 0.4468807280063629 BPR_loss 0.4222564101219177 reg_loss 0.02462431788444519
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 66.03562593460083 |  388.827073097229 | 157.4252166748047 | [0.07337621 0.1012174  0.12061218] | [0.0353101  0.04130399 0.04492966] | [0.0043165  0.00303348 0.00243575] | [0.08413766 0.11684408 0.13901605] |
|   6   | 66.03562593460083 | 333.6046714782715 | 157.4252166748047 | [0.01685704 0.02695218 0.03544596] | [0.00700701 0.00911475 0.01066549] | [0.00089548 0.00073072 0.0006524 ] | [0.01780622 0.02894803 0.03856782] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.4184194803237915 BPR_loss 0.39323726296424866 reg_loss 0.025182226672768593
epoch: 7 s: 256000 batch_loss 0.4340912103652954 BPR_loss 0.4090842306613922 reg_loss 0.025006989017128944
epoch: 7 s: 512000 batch_loss 0.4363051950931549 BPR_loss 0.4108181595802307 reg_loss 0.02548702247440815
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 67.70838284492493 | 381.1463348865509 | 154.45066833496094 | [0.07236397 0.10014164 0.11932875] | [0.034716   0.04067271 0.0442697 ] | [0.00428065 0.00300556 0.00241782] | [0.08336551 0.11538249 0.13759583] |
|   7   | 67.70838284492493 | 328.3231465816498 | 154.45066833496094 | [0.01691837 0.02711781 0.03583854] | [0.00709133 0.0092234  0.01081696] | [0.0008977  0.00073552 0.00066102] | [0.01786532 0.02916968 0.03901113] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.4286218583583832 BPR_loss 0.40307170152664185 reg_loss 0.025550158694386482
epoch: 8 s: 256000 batch_loss 0.4182462692260742 BPR_loss 0.39221662282943726 reg_loss 0.026029644533991814
epoch: 8 s: 512000 batch_loss 0.4182823598384857 BPR_loss 0.3920842409133911 reg_loss 0.026198111474514008
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 67.15750670433044 | 381.61408019065857 | 152.2818145751953 | [0.07221366 0.09900055 0.11792358] | [0.0346023  0.04035637 0.04390403] | [0.00426066 0.00297143 0.00238817] | [0.08303458 0.11415531 0.13627213] |
|   8   | 67.15750670433044 | 336.3807830810547  | 152.2818145751953 | [0.01683659 0.02729894 0.03556813] | [0.00700397 0.0091795  0.01069155] | [0.00089622 0.00074032 0.00065486] | [0.01782099 0.02937656 0.03868603] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.4193814992904663 BPR_loss 0.39322951436042786 reg_loss 0.026151997968554497
epoch: 9 s: 256000 batch_loss 0.42512473464012146 BPR_loss 0.39876919984817505 reg_loss 0.026355544105172157
epoch: 9 s: 512000 batch_loss 0.42632657289505005 BPR_loss 0.3999740481376648 reg_loss 0.026352534070611
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 65.76007723808289 | 389.3302013874054 | 150.48780822753906 | [0.07137769 0.09847342 0.11689869] | [0.03445801 0.04028695 0.04374277] | [0.00421378 0.00296178 0.00237255] | [0.08202802 0.11372787 0.13508632] |
|   9   | 65.76007723808289 | 351.5939383506775 | 150.48780822753906 | [0.01695494 0.02706018 0.03576784] | [0.00696711 0.0090686  0.0106628 ] | [0.00090213 0.00073404 0.00065979] | [0.01792443 0.02911058 0.03890769] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.40991881489753723 BPR_loss 0.383289098739624 reg_loss 0.026629727333784103
epoch: 10 s: 256000 batch_loss 0.406656950712204 BPR_loss 0.3799518346786499 reg_loss 0.02670511230826378
epoch: 10 s: 512000 batch_loss 0.41986149549484253 BPR_loss 0.39305317401885986 reg_loss 0.02680831588804722
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 64.32521319389343 | 383.3091127872467 | 149.04286193847656 | [0.07130017 0.09730134 0.1158155 ] | [0.03402343 0.03963039 0.04309296] | [0.00419723 0.00292214 0.00234474] | [0.08184877 0.11230765 0.13372125] |
|   10  | 64.32521319389343 | 349.5035676956177 | 149.04286193847656 | [0.01686492 0.02707003 0.03568364] | [0.00695308 0.00907944 0.01065745] | [0.00089548 0.00073515 0.0006593 ] | [0.01782099 0.02915491 0.03890769] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.40888094902038574 BPR_loss 0.38220858573913574 reg_loss 0.026672376319766045
epoch: 11 s: 256000 batch_loss 0.40155693888664246 BPR_loss 0.3745799958705902 reg_loss 0.02697695605456829
epoch: 11 s: 512000 batch_loss 0.4063461422920227 BPR_loss 0.3792797327041626 reg_loss 0.02706640399992466
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 62.94273018836975 | 390.39210867881775 | 147.88534545898438 | [0.07069044 0.09675924 0.11504956] | [0.03386433 0.03948185 0.0429145 ] | [0.00417172 0.00291145 0.00233463] | [0.0813248  0.1117699  0.13294909] |
|   11  | 62.94273018836975 | 352.7675015926361  | 147.88534545898438 | [0.01620198 0.0269236  0.03522729] | [0.00679088 0.00902769 0.01054896] | [0.00086223 0.00072961 0.00064994] | [0.01714125 0.02891848 0.03833139] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.40519171953201294 BPR_loss 0.3778354823589325 reg_loss 0.02735624648630619
epoch: 12 s: 256000 batch_loss 0.4093468487262726 BPR_loss 0.38219791650772095 reg_loss 0.027148935943841934
epoch: 12 s: 512000 batch_loss 0.4084821343421936 BPR_loss 0.38144826889038086 reg_loss 0.02703387662768364
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 66.4222891330719 | 385.7616596221924 | 146.9967041015625 | [0.07048748 0.09619819 0.11429556] | [0.03377409 0.03930698 0.04269466] | [0.00416414 0.00289559 0.00231716] | [0.08100767 0.11135624 0.13208041] |
|   12  | 66.4222891330719 | 348.8556010723114 | 146.9967041015625 | [0.01665608 0.02661416 0.0352529 ] | [0.00686914 0.00894146 0.01052181] | [0.00088366 0.00072038 0.00064994] | [0.01755501 0.02856383 0.03837572] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.4031887948513031 BPR_loss 0.37587040662765503 reg_loss 0.027318377047777176
epoch: 13 s: 256000 batch_loss 0.40990394353866577 BPR_loss 0.38261932134628296 reg_loss 0.027284609153866768
epoch: 13 s: 512000 batch_loss 0.4120427966117859 BPR_loss 0.3847818970680237 reg_loss 0.02726089581847191
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 60.77866816520691 | 383.15333676338196 | 146.1063690185547 | [0.06971591 0.09636614 0.11392335] | [0.03366694 0.03939894 0.04268984] | [0.00412415 0.00290283 0.00231464] | [0.08030445 0.11132866 0.13197011] |
|   13  | 60.77866816520691 | 354.4840896129608  | 146.1063690185547 | [0.0165359  0.02617552 0.0347917 ] | [0.00685782 0.0088746  0.01045023] | [0.00087553 0.00071262 0.00064206] | [0.01740724 0.02820918 0.0378733 ] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.39240723848342896 BPR_loss 0.3648730516433716 reg_loss 0.027534175664186478
epoch: 14 s: 256000 batch_loss 0.40347322821617126 BPR_loss 0.3758794069290161 reg_loss 0.0275938268750906
epoch: 14 s: 512000 batch_loss 0.4153139889240265 BPR_loss 0.38786646723747253 reg_loss 0.027447521686553955
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 62.19788074493408 | 391.00708293914795 | 145.44476318359375 | [0.06925187 0.09543616 0.11301547] | [0.03343698 0.03907794 0.0423807 ] | [0.00409313 0.00287284 0.00229556] | [0.07969776 0.11029452 0.13094975] |
|   14  | 62.19788074493408 | 357.8669743537903  | 145.44476318359375 | [0.01629885 0.02610718 0.03456661] | [0.00672044 0.00876641 0.01031913] | [0.00086593 0.00071003 0.0006391 ] | [0.01720036 0.0281353  0.03771076] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.4005414545536041 BPR_loss 0.3729380667209625 reg_loss 0.0276033915579319
epoch: 15 s: 256000 batch_loss 0.3970348834991455 BPR_loss 0.36973243951797485 reg_loss 0.027302447706460953
epoch: 15 s: 512000 batch_loss 0.4030548632144928 BPR_loss 0.37533965706825256 reg_loss 0.027715204283595085
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 61.98612952232361 | 373.2669861316681  | 144.72366333007812 | [0.06891118 0.09516833 0.11236419] | [0.03307731 0.03872369 0.04195551] | [0.00407658 0.0028625  0.00228269] | [0.0794082  0.10990844 0.13012244] |
|   15  | 61.98612952232361 | 283.91189908981323 | 144.72366333007812 | [0.01634627 0.02598885 0.03423461] | [0.00676646 0.00877986 0.01029195] | [0.00086815 0.00070597 0.00063245] | [0.01725947 0.02797275 0.03731178] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.39484524726867676 BPR_loss 0.3670664429664612 reg_loss 0.027778811752796173
epoch: 16 s: 256000 batch_loss 0.40673503279685974 BPR_loss 0.3788372278213501 reg_loss 0.02789781428873539
epoch: 16 s: 512000 batch_loss 0.4026423394680023 BPR_loss 0.37501412630081177 reg_loss 0.02762821689248085
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 54.11177587509155 | 260.6559660434723  | 144.10882568359375 | [0.06931284 0.09493306 0.11196858] | [0.03315988 0.03866606 0.04187035] | [0.00410485 0.00286112 0.00227948] | [0.07987701 0.10986708 0.12984667] |
|   16  | 54.11177587509155 | 193.34562945365906 | 144.10882568359375 | [0.01621524 0.02578221 0.03378887] | [0.00668061 0.00866987 0.01013528] | [0.00085928 0.0006971  0.00062186] | [0.01709692 0.02760333 0.03669115] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.39273184537887573 BPR_loss 0.3649445176124573 reg_loss 0.02778732404112816
epoch: 17 s: 256000 batch_loss 0.39669331908226013 BPR_loss 0.36893805861473083 reg_loss 0.027755260467529297
epoch: 17 s: 512000 batch_loss 0.39977920055389404 BPR_loss 0.37198805809020996 reg_loss 0.027791157364845276
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 49.39216923713684 | 235.11023831367493 | 143.75082397460938 | [0.06810884 0.09419001 0.11167132] | [0.0327964  0.03843338 0.04170244] | [0.00402143 0.00284182 0.00226776] | [0.07840163 0.10913629 0.12936407] |
|   17  | 49.39216923713684 | 196.2357370853424  | 143.75082397460938 | [0.01608242 0.02558926 0.0341882 ] | [0.0066217  0.00860404 0.01017859] | [0.00085189 0.00069341 0.00063122] | [0.01694915 0.02748511 0.03725267] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.3888569176197052 BPR_loss 0.36100876331329346 reg_loss 0.02784816361963749
epoch: 18 s: 256000 batch_loss 0.3991648256778717 BPR_loss 0.3712536096572876 reg_loss 0.02791120670735836
epoch: 18 s: 512000 batch_loss 0.4105638265609741 BPR_loss 0.3827899396419525 reg_loss 0.027773883193731308
+-------+-------------------+--------------------+--------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |     Loss     |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 49.50791668891907 | 224.65033602714539 | 143.26171875 | [0.06849423 0.09428085 0.11126737] | [0.03291766 0.03848203 0.04166622] | [0.00405659 0.00284664 0.00226408] | [0.07900833 0.10932933 0.12901936] |
|   18  | 49.50791668891907 | 185.00110864639282 | 143.26171875 | [0.01592821 0.02573136 0.03399918] | [0.00655381 0.00860365 0.01011415] | [0.00084524 0.00069932 0.00062654] | [0.01680138 0.02770677 0.03700146] |
+-------+-------------------+--------------------+--------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.39188629388809204 BPR_loss 0.3639717102050781 reg_loss 0.027914585545659065
epoch: 19 s: 256000 batch_loss 0.3984512984752655 BPR_loss 0.3705335259437561 reg_loss 0.027917765080928802
epoch: 19 s: 512000 batch_loss 0.39914578199386597 BPR_loss 0.3713272511959076 reg_loss 0.02781853638589382
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 51.19496393203735 | 228.33636927604675 | 142.77659606933594 | [0.06856874 0.09401607 0.11172931] | [0.03281568 0.03829302 0.0416227 ] | [0.0040621  0.00283527 0.00227465] | [0.07911864 0.1089984  0.12962605] |
|   19  | 51.19496393203735 | 187.47867345809937 | 142.77659606933594 | [0.01576934 0.02563591 0.03359316] | [0.00645745 0.00851531 0.00997264] | [0.00083933 0.00069562 0.0006194 ] | [0.01668317 0.027559   0.03651382] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.015769343257041445
early stopping at 19, recall@20:0.0170
