Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='amazon', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=3, l2=0.001, lr=0.005, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上进行softmax自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931475400924683 BPR_loss 0.6931474208831787 reg_loss 1.1949748568440555e-07
epoch: 0 s: 256000 batch_loss 0.6701217889785767 BPR_loss 0.6621030569076538 reg_loss 0.008018703199923038
epoch: 0 s: 512000 batch_loss 0.6609935164451599 BPR_loss 0.6507906317710876 reg_loss 0.010202880948781967
epoch: 0 s: 768000 batch_loss 0.648781418800354 BPR_loss 0.6371345520019531 reg_loss 0.011646894738078117
epoch: 0 s: 1024000 batch_loss 0.6459456086158752 BPR_loss 0.6342398524284363 reg_loss 0.011705738492310047
epoch: 0 s: 1280000 batch_loss 0.6346820592880249 BPR_loss 0.6217091679573059 reg_loss 0.012972917407751083
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 152.6127781867981 | 1350.8635783195496 | 438.4411926269531 | [0.03916051 0.06062881 0.07587193] | [0.0181842  0.02271216 0.02549445] | [0.00223155 0.00174468 0.00145886] | [0.04403958 0.0683413  0.08547957] |
|   0   | 152.6127781867981 | 1173.3205716609955 | 438.4411926269531 | [0.05083743 0.07441056 0.09133053] | [0.02207017 0.02704106 0.03013418] | [0.00292331 0.00215122 0.00176649] | [0.05759958 0.08426037 0.10333417] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6145666837692261 BPR_loss 0.6009232401847839 reg_loss 0.01364345196634531
epoch: 1 s: 256000 batch_loss 0.6197164058685303 BPR_loss 0.605799674987793 reg_loss 0.013916757889091969
epoch: 1 s: 512000 batch_loss 0.6158838272094727 BPR_loss 0.6008967161178589 reg_loss 0.014987103641033173
epoch: 1 s: 768000 batch_loss 0.607403039932251 BPR_loss 0.5918451547622681 reg_loss 0.01555788516998291
epoch: 1 s: 1024000 batch_loss 0.5980211496353149 BPR_loss 0.5817434787750244 reg_loss 0.016277646645903587
epoch: 1 s: 1280000 batch_loss 0.5922657251358032 BPR_loss 0.5754703283309937 reg_loss 0.01679539866745472
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 125.03658413887024 | 1365.8135030269623 | 405.5311584472656 | [0.044838   0.06622961 0.08268367] | [0.0206702  0.02517532 0.02817339] | [0.00254044 0.00189456 0.00158056] | [0.05012231 0.07431451 0.09256271] |
|   1   | 125.03658413887024 | 1151.078224182129  | 405.5311584472656 | [0.05669935 0.08288892 0.10162612] | [0.02526185 0.03076342 0.034198  ] | [0.00325421 0.00238679 0.00196082] | [0.06393388 0.0932182  0.1144192 ] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.5797561407089233 BPR_loss 0.5626366138458252 reg_loss 0.0171195175498724
epoch: 2 s: 256000 batch_loss 0.5804072618484497 BPR_loss 0.5625367760658264 reg_loss 0.01787051185965538
epoch: 2 s: 512000 batch_loss 0.5753682851791382 BPR_loss 0.556702733039856 reg_loss 0.018665581941604614
epoch: 2 s: 768000 batch_loss 0.5660666823387146 BPR_loss 0.5471518039703369 reg_loss 0.018914904445409775
epoch: 2 s: 1024000 batch_loss 0.5604103803634644 BPR_loss 0.5413013696670532 reg_loss 0.01910904049873352
epoch: 2 s: 1280000 batch_loss 0.552484929561615 BPR_loss 0.5322433710098267 reg_loss 0.02024153247475624
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 115.16319108009338 | 1336.4327938556671 | 378.8252258300781 | [0.04707461 0.06882844 0.0852571 ] | [0.02182499 0.02640195 0.02939346] | [0.00266019 0.0019621  0.00162425] | [0.05246632 0.07691409 0.09522801] |
|   2   | 115.16319108009338 | 1133.2196836471558 | 378.8252258300781 | [0.06080712 0.08823496 0.10843607] | [0.02700281 0.03278334 0.03648097] | [0.00348268 0.00253569 0.00208754] | [0.0684325  0.09917434 0.12191951] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.5418320298194885 BPR_loss 0.5214473605155945 reg_loss 0.020384684205055237
epoch: 3 s: 256000 batch_loss 0.525284469127655 BPR_loss 0.5038142204284668 reg_loss 0.02147025056183338
epoch: 3 s: 512000 batch_loss 0.5264461040496826 BPR_loss 0.5043851733207703 reg_loss 0.022060927003622055
epoch: 3 s: 768000 batch_loss 0.5290816426277161 BPR_loss 0.506781816482544 reg_loss 0.02229980193078518
epoch: 3 s: 1024000 batch_loss 0.5246118903160095 BPR_loss 0.5019017457962036 reg_loss 0.022710151970386505
epoch: 3 s: 1280000 batch_loss 0.5254515409469604 BPR_loss 0.5026822090148926 reg_loss 0.022769324481487274
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 113.63453698158264 | 1370.0002133846283 | 354.7193908691406 | [0.04793671 0.06980436 0.08612692] | [0.02250156 0.02710123 0.03007461] | [0.0027062  0.00198656 0.00163874] | [0.05337909 0.07789989 0.09606046] |
|   3   | 113.63453698158264 | 1117.5105016231537 | 354.7193908691406 | [0.06256513 0.09067655 0.11099017] | [0.02783494 0.03375031 0.03746869] | [0.00356816 0.00260364 0.00213691] | [0.07011849 0.10171121 0.12472425] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.5125820636749268 BPR_loss 0.4889293313026428 reg_loss 0.02365274354815483
epoch: 4 s: 256000 batch_loss 0.4951959550380707 BPR_loss 0.4707646369934082 reg_loss 0.024431318044662476
epoch: 4 s: 512000 batch_loss 0.4996611773967743 BPR_loss 0.4748976230621338 reg_loss 0.024763550609350204
epoch: 4 s: 768000 batch_loss 0.5048684477806091 BPR_loss 0.47972777485847473 reg_loss 0.02514069527387619
epoch: 4 s: 1024000 batch_loss 0.49445778131484985 BPR_loss 0.46906527876853943 reg_loss 0.02539251744747162
epoch: 4 s: 1280000 batch_loss 0.5020641684532166 BPR_loss 0.47638535499572754 reg_loss 0.025678787380456924
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 156.20327377319336 | 1352.6370239257812 | 335.75299072265625 | [0.04737282 0.06915499 0.08577041] | [0.02221565 0.02679609 0.02983028] | [0.00266092 0.00196082 0.00162876] | [0.05259046 0.07696521 0.09563693] |
|   4   | 156.20327377319336 | 966.9968497753143  | 335.75299072265625 | [0.06344021 0.09171015 0.11237728] | [0.02806007 0.03402431 0.03780879] | [0.00360638 0.00263082 0.00216067] | [0.07093785 0.10289298 0.12617389] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.4830968379974365 BPR_loss 0.45732399821281433 reg_loss 0.02577284909784794
epoch: 5 s: 256000 batch_loss 0.47925129532814026 BPR_loss 0.45233094692230225 reg_loss 0.02692035399377346
epoch: 5 s: 512000 batch_loss 0.4800100326538086 BPR_loss 0.4529055953025818 reg_loss 0.027104452252388
epoch: 5 s: 768000 batch_loss 0.4823356568813324 BPR_loss 0.4549674391746521 reg_loss 0.027368217706680298
epoch: 5 s: 1024000 batch_loss 0.46869006752967834 BPR_loss 0.44173720479011536 reg_loss 0.026952851563692093
epoch: 5 s: 1280000 batch_loss 0.4706991910934448 BPR_loss 0.4429423213005066 reg_loss 0.027756884694099426
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 100.64331102371216 | 980.6643602848053 | 321.91571044921875 | [0.04773136 0.0697618  0.08595554] | [0.02207409 0.02669971 0.0296579 ] | [0.0026737  0.00197251 0.0016307 ] | [0.05284603 0.07746906 0.09576107] |
|   5   | 100.64331102371216 | 810.2255415916443 | 321.91571044921875 | [0.06381117 0.09172356 0.11258898] | [0.02872411 0.03461788 0.03843566] | [0.00362489 0.00263397 0.00216527] | [0.07126087 0.10306631 0.12651267] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.4598501920700073 BPR_loss 0.43179547786712646 reg_loss 0.02805471420288086
epoch: 6 s: 256000 batch_loss 0.4671933054924011 BPR_loss 0.43906712532043457 reg_loss 0.028126182034611702
epoch: 6 s: 512000 batch_loss 0.46455514430999756 BPR_loss 0.43622496724128723 reg_loss 0.02833019196987152
epoch: 6 s: 768000 batch_loss 0.4745035469532013 BPR_loss 0.4466899335384369 reg_loss 0.027813620865345
epoch: 6 s: 1024000 batch_loss 0.4657670855522156 BPR_loss 0.4374873638153076 reg_loss 0.028279706835746765
epoch: 6 s: 1280000 batch_loss 0.4661947786808014 BPR_loss 0.4377326965332031 reg_loss 0.02846209518611431
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 97.95498991012573 | 973.9806749820709 | 312.5990295410156 | [0.0472565  0.06918682 0.08493004] | [0.021887   0.02649485 0.02937228] | [0.0026496  0.00195662 0.00161087] | [0.05234948 0.07682646 0.09450509] |
|   6   | 97.95498991012573 | 718.1060004234314 | 312.5990295410156 | [0.06366102 0.09162014 0.11225481] | [0.02857746 0.03446959 0.03825221] | [0.00361898 0.00262472 0.00215989] | [0.07111906 0.1027039  0.12615814] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.4502873122692108 BPR_loss 0.4217548072338104 reg_loss 0.02853250503540039
epoch: 7 s: 256000 batch_loss 0.45386290550231934 BPR_loss 0.4247947335243225 reg_loss 0.02906818501651287
epoch: 7 s: 512000 batch_loss 0.46370789408683777 BPR_loss 0.4348544776439667 reg_loss 0.028853416442871094
epoch: 7 s: 768000 batch_loss 0.4527277946472168 BPR_loss 0.42357832193374634 reg_loss 0.029149478301405907
epoch: 7 s: 1024000 batch_loss 0.4602018892765045 BPR_loss 0.43116676807403564 reg_loss 0.02903512679040432
epoch: 7 s: 1280000 batch_loss 0.47010794281959534 BPR_loss 0.44127529859542847 reg_loss 0.028832636773586273
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 103.73184990882874 | 942.4232075214386 | 305.8860168457031 | [0.04695599 0.06850707 0.08465305] | [0.02191704 0.02644288 0.02939397] | [0.00263354 0.00193727 0.00160539] | [0.0520793  0.07614736 0.09424952] |
|   7   | 103.73184990882874 |  725.189582824707 | 305.8860168457031 | [0.06381331 0.09177167 0.11174436] | [0.02871176 0.03460082 0.03826033] | [0.00362922 0.0026324  0.00215056] | [0.07137905 0.10292449 0.12553574] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.4533556401729584 BPR_loss 0.42410212755203247 reg_loss 0.029253508895635605
epoch: 8 s: 256000 batch_loss 0.45256170630455017 BPR_loss 0.42302244901657104 reg_loss 0.029539266601204872
epoch: 8 s: 512000 batch_loss 0.45896780490875244 BPR_loss 0.42972618341445923 reg_loss 0.029241612181067467
epoch: 8 s: 768000 batch_loss 0.45225656032562256 BPR_loss 0.42272090911865234 reg_loss 0.02953564189374447
epoch: 8 s: 1024000 batch_loss 0.47212618589401245 BPR_loss 0.4428144097328186 reg_loss 0.029311776161193848
epoch: 8 s: 1280000 batch_loss 0.45225390791893005 BPR_loss 0.42266201972961426 reg_loss 0.029591895639896393
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 106.50636529922485 |  923.670435667038 | 300.88189697265625 | [0.04625293 0.0682799  0.08407432] | [0.02149219 0.02611565 0.02899965] | [0.00259958 0.00193198 0.00159431] | [0.05138559 0.0759648  0.09367264] |
|   8   | 106.50636529922485 | 679.0126802921295 | 300.88189697265625 | [0.06345931 0.09060286 0.11075684] | [0.02827664 0.03400465 0.03769511] | [0.0036048  0.0026001  0.00213126] | [0.07089846 0.10162454 0.12447214] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.44721150398254395 BPR_loss 0.4176037311553955 reg_loss 0.029607759788632393
epoch: 9 s: 256000 batch_loss 0.44100648164749146 BPR_loss 0.4109364151954651 reg_loss 0.030070079490542412
epoch: 9 s: 512000 batch_loss 0.4453139305114746 BPR_loss 0.41556984186172485 reg_loss 0.029744088649749756
epoch: 9 s: 768000 batch_loss 0.4417584538459778 BPR_loss 0.4119449257850647 reg_loss 0.02981354296207428
epoch: 9 s: 1024000 batch_loss 0.44196614623069763 BPR_loss 0.4120953381061554 reg_loss 0.02987079694867134
epoch: 9 s: 1280000 batch_loss 0.44778501987457275 BPR_loss 0.41797971725463867 reg_loss 0.029805291444063187
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 113.51726031303406 | 903.8187727928162 | 297.24664306640625 | [0.0466642  0.06836204 0.0841102 ] | [0.02176396 0.02632699 0.02919588] | [0.00262003 0.00193727 0.00159444] | [0.05179452 0.07618387 0.09368725] |
|   9   | 113.51726031303406 | 675.3890109062195 | 297.24664306640625 | [0.06298314 0.09034416 0.11066647] | [0.0281582  0.03393312 0.0376505 ] | [0.00357683 0.00259458 0.00212877] | [0.07038636 0.10145909 0.12431457] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.44120022654533386 BPR_loss 0.41155293583869934 reg_loss 0.02964729070663452
epoch: 10 s: 256000 batch_loss 0.42853108048439026 BPR_loss 0.3984566926956177 reg_loss 0.030074400827288628
epoch: 10 s: 512000 batch_loss 0.43915289640426636 BPR_loss 0.4088920056819916 reg_loss 0.030260881409049034
epoch: 10 s: 768000 batch_loss 0.4387485384941101 BPR_loss 0.40855005383491516 reg_loss 0.03019847720861435
epoch: 10 s: 1024000 batch_loss 0.4482388496398926 BPR_loss 0.41839808225631714 reg_loss 0.029840754345059395
epoch: 10 s: 1280000 batch_loss 0.44250956177711487 BPR_loss 0.4124603271484375 reg_loss 0.03004923276603222
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 105.69532990455627 | 875.9119365215302 | 294.2908630371094 | [0.0464613  0.0677047  0.08367478] | [0.02159846 0.02606244 0.02897362] | [0.00260871 0.00191683 0.00158555] | [0.05158275 0.07539523 0.09321991] |
|   10  | 105.69532990455627 | 651.0988872051239 | 294.2908630371094 | [0.0631168  0.09032224 0.1101991 ] | [0.02827972 0.03401767 0.03765865] | [0.00358471 0.00259104 0.00212194] | [0.0705912  0.10137243 0.12394428] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.4277889132499695 BPR_loss 0.39755791425704956 reg_loss 0.030230997130274773
epoch: 11 s: 256000 batch_loss 0.43378153443336487 BPR_loss 0.4037625193595886 reg_loss 0.030019013211131096
epoch: 11 s: 512000 batch_loss 0.4235900044441223 BPR_loss 0.3932104706764221 reg_loss 0.030379530042409897
epoch: 11 s: 768000 batch_loss 0.4430176019668579 BPR_loss 0.41277211904525757 reg_loss 0.030245471745729446
epoch: 11 s: 1024000 batch_loss 0.4395725131034851 BPR_loss 0.40919923782348633 reg_loss 0.030373282730579376
epoch: 11 s: 1280000 batch_loss 0.43208956718444824 BPR_loss 0.40167367458343506 reg_loss 0.030415894463658333
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 102.07429718971252 |  871.846551656723 | 292.21966552734375 | [0.04611074 0.0678111  0.0836099 ] | [0.02144864 0.02600768 0.02888543] | [0.00259119 0.00192285 0.00158531] | [0.05122494 0.075607   0.09316149] |
|   11  | 102.07429718971252 | 662.6011562347412 | 292.21966552734375 | [0.06242889 0.08997387 0.1090143 ] | [0.02796347 0.03375821 0.03725067] | [0.00355398 0.00257823 0.0020987 ] | [0.06992941 0.10093912 0.12260494] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.43256834149360657 BPR_loss 0.40215548872947693 reg_loss 0.03041284717619419
epoch: 12 s: 256000 batch_loss 0.4306502938270569 BPR_loss 0.40009504556655884 reg_loss 0.030555250123143196
epoch: 12 s: 512000 batch_loss 0.43635648488998413 BPR_loss 0.4055449962615967 reg_loss 0.0308114904910326
epoch: 12 s: 768000 batch_loss 0.4359097480773926 BPR_loss 0.4056636095046997 reg_loss 0.03024614416062832
epoch: 12 s: 1024000 batch_loss 0.4416976869106293 BPR_loss 0.4113062024116516 reg_loss 0.03039148822426796
epoch: 12 s: 1280000 batch_loss 0.4327520728111267 BPR_loss 0.4022900462150574 reg_loss 0.03046201542019844
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 122.00262236595154 | 896.7442362308502 | 290.4504699707031 | [0.04569298 0.06729277 0.08324485] | [0.02118655 0.02572845 0.02863805] | [0.00256198 0.00190624 0.00157934] | [0.05069919 0.07491329 0.09274526] |
|   12  | 122.00262236595154 | 685.2063868045807 | 290.4504699707031 | [0.06219513 0.08958758 0.10910513] | [0.02793299 0.03370735 0.0372813 ] | [0.0035398  0.00257213 0.00210067] | [0.06969305 0.10063185 0.12277827] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.42687562108039856 BPR_loss 0.39628714323043823 reg_loss 0.030588475987315178
epoch: 13 s: 256000 batch_loss 0.4355238974094391 BPR_loss 0.40497490763664246 reg_loss 0.030548986047506332
epoch: 13 s: 512000 batch_loss 0.4280797839164734 BPR_loss 0.39766353368759155 reg_loss 0.030416259542107582
epoch: 13 s: 768000 batch_loss 0.4315033555030823 BPR_loss 0.4007381200790405 reg_loss 0.030765222385525703
epoch: 13 s: 1024000 batch_loss 0.4399827718734741 BPR_loss 0.40925031900405884 reg_loss 0.030732441693544388
epoch: 13 s: 1280000 batch_loss 0.43939271569252014 BPR_loss 0.40859654545783997 reg_loss 0.03079616278409958
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 87.17121624946594 | 522.4358112812042  | 288.8016357421875 | [0.04547195 0.06697413 0.08258185] | [0.02110141 0.02561409 0.02846186] | [0.00255358 0.00189711 0.00156669] | [0.05050933 0.07458469 0.09209537] |
|   13  | 87.17121624946594 | 426.11924481391907 | 288.8016357421875 | [0.06206661 0.08895771 0.10900966] | [0.02785736 0.03353809 0.03721452] | [0.00352877 0.00255598 0.00210093] | [0.0694567  0.09993067 0.12277039] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.41869407892227173 BPR_loss 0.38776683807373047 reg_loss 0.030927235260605812
epoch: 14 s: 256000 batch_loss 0.43124136328697205 BPR_loss 0.4004838466644287 reg_loss 0.030757516622543335
epoch: 14 s: 512000 batch_loss 0.44224900007247925 BPR_loss 0.41143906116485596 reg_loss 0.030809935182332993
epoch: 14 s: 768000 batch_loss 0.4264306426048279 BPR_loss 0.39551183581352234 reg_loss 0.030918817967176437
epoch: 14 s: 1024000 batch_loss 0.4300157129764557 BPR_loss 0.39920827746391296 reg_loss 0.030807439237833023
epoch: 14 s: 1280000 batch_loss 0.42945775389671326 BPR_loss 0.3989149034023285 reg_loss 0.030542844906449318
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 86.25249671936035 | 485.8901779651642  | 287.3749694824219 | [0.04519805 0.06683612 0.08250191] | [0.0210902  0.02563679 0.0285011 ] | [0.00253423 0.00189237 0.0015673 ] | [0.05015152 0.07443864 0.09210997] |
|   14  | 86.25249671936035 | 431.69262623786926 | 287.3749694824219 | [0.06145105 0.08888424 0.10826202] | [0.02762945 0.03340801 0.0369602 ] | [0.00349805 0.00254869 0.00208465] | [0.06877127 0.09971795 0.12182497] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.4156849682331085 BPR_loss 0.38506853580474854 reg_loss 0.030616432428359985
epoch: 15 s: 256000 batch_loss 0.4077404737472534 BPR_loss 0.37698936462402344 reg_loss 0.030751114711165428
epoch: 15 s: 512000 batch_loss 0.43045440316200256 BPR_loss 0.39987996220588684 reg_loss 0.030574429780244827
epoch: 15 s: 768000 batch_loss 0.43685823678970337 BPR_loss 0.40577906370162964 reg_loss 0.031079167500138283
epoch: 15 s: 1024000 batch_loss 0.4238247871398926 BPR_loss 0.39290839433670044 reg_loss 0.030916398391127586
epoch: 15 s: 1280000 batch_loss 0.4275147616863251 BPR_loss 0.3967994451522827 reg_loss 0.030715327709913254
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 81.51576924324036 | 490.3723261356354  | 286.15478515625 | [0.04538224 0.06710412 0.08244514] | [0.02112142 0.02568285 0.02848337] | [0.00254956 0.00190204 0.00156608] | [0.05043631 0.07479645 0.09206616] |
|   15  | 81.51576924324036 | 403.54615092277527 | 286.15478515625 | [0.06172402 0.08880454 0.1079187 ] | [0.02779905 0.03350582 0.03701173] | [0.00351144 0.00254889 0.00207913] | [0.06911793 0.09975734 0.12154922] |
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.4167022109031677 BPR_loss 0.3859742283821106 reg_loss 0.03072797879576683
epoch: 16 s: 256000 batch_loss 0.4219280183315277 BPR_loss 0.3911476135253906 reg_loss 0.030780401080846786
epoch: 16 s: 512000 batch_loss 0.4265284836292267 BPR_loss 0.3954859972000122 reg_loss 0.031042493879795074
epoch: 16 s: 768000 batch_loss 0.42772820591926575 BPR_loss 0.3965971767902374 reg_loss 0.031131040304899216
epoch: 16 s: 1024000 batch_loss 0.438015341758728 BPR_loss 0.4072130024433136 reg_loss 0.03080233372747898
epoch: 16 s: 1280000 batch_loss 0.4333001971244812 BPR_loss 0.4026508927345276 reg_loss 0.03064931184053421
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 77.72036910057068 | 368.73043394088745 | 285.4345397949219 | [0.04510941 0.06645482 0.0820608 ] | [0.02074033 0.02522564 0.0280744 ] | [0.00253094 0.00188123 0.00155817] | [0.05005659 0.0739786  0.09158421] |
|   16  | 77.72036910057068 | 366.8355219364166  | 285.4345397949219 | [0.06177829 0.0888489  0.10815082] | [0.02791383 0.03361445 0.03714872] | [0.00351971 0.00255184 0.00208189] | [0.06925186 0.09985188 0.12173043] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.417443186044693 BPR_loss 0.3862416446208954 reg_loss 0.031201539561152458
epoch: 17 s: 256000 batch_loss 0.4168568551540375 BPR_loss 0.38559389114379883 reg_loss 0.03126297518610954
epoch: 17 s: 512000 batch_loss 0.4249776303768158 BPR_loss 0.39398905634880066 reg_loss 0.030988575890660286
epoch: 17 s: 768000 batch_loss 0.42010459303855896 BPR_loss 0.38895630836486816 reg_loss 0.031148290261626244
epoch: 17 s: 1024000 batch_loss 0.4349467158317566 BPR_loss 0.404249906539917 reg_loss 0.030696803703904152
epoch: 17 s: 1280000 batch_loss 0.42524683475494385 BPR_loss 0.39460432529449463 reg_loss 0.03064250387251377
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 76.95681977272034 | 375.14192175865173 | 284.31805419921875 | [0.04553983 0.0668397  0.08251209] | [0.02124447 0.02573078 0.02859121] | [0.00256344 0.00189839 0.00156912] | [0.05069188 0.07467231 0.09213188] |
|   17  | 76.95681977272034 | 361.07671761512756 | 284.31805419921875 | [0.06139001 0.08836207 0.10751082] | [0.02763071 0.03331975 0.03682589] | [0.00349647 0.00254002 0.00207099] | [0.06881854 0.0993713  0.1209741 ] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.06139000569517013
early stopping at 17, recall@20:0.0638
