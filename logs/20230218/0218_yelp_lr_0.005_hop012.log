Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='yelp2018', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=2, l2=0.001, lr=0.005, mess_dropout=False, mess_dropout_rate=0.1, n_negs=64, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上进行softmax自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.693148136138916 BPR_loss 0.6931480169296265 reg_loss 1.4682098026241874e-07
epoch: 0 s: 256000 batch_loss 0.6881484389305115 BPR_loss 0.6871875524520874 reg_loss 0.0009608936379663646
epoch: 0 s: 512000 batch_loss 0.6873502135276794 BPR_loss 0.6852759122848511 reg_loss 0.0020742786582559347
epoch: 0 s: 768000 batch_loss 0.6865671873092651 BPR_loss 0.6839468479156494 reg_loss 0.0026203168090432882
epoch: 0 s: 1024000 batch_loss 0.6815758943557739 BPR_loss 0.6780434846878052 reg_loss 0.0035323980264365673
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 211.43723559379578 | 62.824217081069946 | 413.405517578125 | [0.05837469 0.09715404 0.12916809] | [0.04777236 0.06237519 0.07358974] | [0.0269436  0.02256063 0.02011126] | [0.36491095 0.51051535 0.60057471] |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6792680621147156 BPR_loss 0.6755027770996094 reg_loss 0.0037652887403964996
epoch: 1 s: 256000 batch_loss 0.6723350286483765 BPR_loss 0.6676714420318604 reg_loss 0.004663611296564341
epoch: 1 s: 512000 batch_loss 0.6723553538322449 BPR_loss 0.6673516035079956 reg_loss 0.005003744270652533
epoch: 1 s: 768000 batch_loss 0.6692760586738586 BPR_loss 0.6638844013214111 reg_loss 0.005391635000705719
epoch: 1 s: 1024000 batch_loss 0.6701031923294067 BPR_loss 0.6642369627952576 reg_loss 0.005866257473826408
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 215.2938060760498 | 58.41868805885315 | 407.55145263671875 | [0.06292497 0.10384642 0.13784474] | [0.05155411 0.06696539 0.0788869 ] | [0.02886826 0.02406057 0.02143752] | [0.38622584 0.5347038  0.62432108] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6683286428451538 BPR_loss 0.6621078848838806 reg_loss 0.0062207370065152645
epoch: 2 s: 256000 batch_loss 0.669339656829834 BPR_loss 0.6630271673202515 reg_loss 0.0063124727457761765
epoch: 2 s: 512000 batch_loss 0.6742457747459412 BPR_loss 0.6677029728889465 reg_loss 0.006542783230543137
epoch: 2 s: 768000 batch_loss 0.6703129410743713 BPR_loss 0.6631903648376465 reg_loss 0.007122590206563473
epoch: 2 s: 1024000 batch_loss 0.6597296595573425 BPR_loss 0.6523236036300659 reg_loss 0.007406036835163832
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 210.46740770339966 | 54.826958656311035 | 404.2499084472656 | [0.0654736  0.10784134 0.14280267] | [0.05356594 0.0695407  0.08177473] | [0.02984085 0.02491711 0.02213117] | [0.39699381 0.54708223 0.63524694] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6615486741065979 BPR_loss 0.6539212465286255 reg_loss 0.007627455051988363
epoch: 3 s: 256000 batch_loss 0.6687019467353821 BPR_loss 0.6610754132270813 reg_loss 0.0076265521347522736
epoch: 3 s: 512000 batch_loss 0.6596441268920898 BPR_loss 0.6516416072845459 reg_loss 0.008002519607543945
epoch: 3 s: 768000 batch_loss 0.6649520993232727 BPR_loss 0.6567884087562561 reg_loss 0.00816371850669384
epoch: 3 s: 1024000 batch_loss 0.6675510406494141 BPR_loss 0.6592408418655396 reg_loss 0.008310206234455109
+-------+--------------------+-----------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |  tesing time(s) |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-----------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 216.44094920158386 | 47.161297082901 | 401.91973876953125 | [0.06694409 0.11030816 0.14550151] | [0.05492216 0.0713259  0.08361857] | [0.0305245  0.02551156 0.02253379] | [0.40283567 0.55453455 0.64137299] |
+-------+--------------------+-----------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.6650601029396057 BPR_loss 0.6564367413520813 reg_loss 0.008623389527201653
epoch: 4 s: 256000 batch_loss 0.6564428210258484 BPR_loss 0.6473599672317505 reg_loss 0.00908284354954958
epoch: 4 s: 512000 batch_loss 0.6632871627807617 BPR_loss 0.6545013785362244 reg_loss 0.008785771206021309
epoch: 4 s: 768000 batch_loss 0.6620982885360718 BPR_loss 0.6529086232185364 reg_loss 0.009189660660922527
epoch: 4 s: 1024000 batch_loss 0.6659135818481445 BPR_loss 0.6567232608795166 reg_loss 0.009190349839627743
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 254.3374240398407 | 185.511216878891 | 400.1168518066406 | [0.06796911 0.11181934 0.14731956] | [0.05582863 0.07234108 0.08476293] | [0.0309508  0.02577602 0.02277641] | [0.40760389 0.55857648 0.64623595] |
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.660262942314148 BPR_loss 0.6506713032722473 reg_loss 0.00959161575883627
epoch: 5 s: 256000 batch_loss 0.6569162011146545 BPR_loss 0.6469562649726868 reg_loss 0.009959928691387177
epoch: 5 s: 512000 batch_loss 0.6625117063522339 BPR_loss 0.652976393699646 reg_loss 0.009535311721265316
epoch: 5 s: 768000 batch_loss 0.6603524684906006 BPR_loss 0.6506786346435547 reg_loss 0.009673848748207092
epoch: 5 s: 1024000 batch_loss 0.6592214703559875 BPR_loss 0.6493411064147949 reg_loss 0.009880353696644306
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 373.9731979370117 | 257.0340986251831 | 398.5773620605469 | [0.06887362 0.11290384 0.14848441] | [0.05659742 0.07316296 0.08561921] | [0.03138499 0.02601759 0.02296324] | [0.41230896 0.56113427 0.64794114] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.656855583190918 BPR_loss 0.6464393138885498 reg_loss 0.010416262783110142
epoch: 6 s: 256000 batch_loss 0.6593666076660156 BPR_loss 0.6491755247116089 reg_loss 0.010191056877374649
epoch: 6 s: 512000 batch_loss 0.649189829826355 BPR_loss 0.6385330557823181 reg_loss 0.010656782425940037
epoch: 6 s: 768000 batch_loss 0.6573655605316162 BPR_loss 0.6470116376876831 reg_loss 0.010353943333029747
epoch: 6 s: 1024000 batch_loss 0.6622824668884277 BPR_loss 0.6519666910171509 reg_loss 0.010315760038793087
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 358.0907521247864 | 269.1157314777374 | 397.4235534667969 | [0.06949638 0.11383243 0.14976249] | [0.05712391 0.0738165  0.08639816] | [0.03160604 0.02623232 0.02316376] | [0.41483516 0.56353417 0.65097259] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.6553868055343628 BPR_loss 0.6445271968841553 reg_loss 0.010859624482691288
epoch: 7 s: 256000 batch_loss 0.6549760103225708 BPR_loss 0.6437839865684509 reg_loss 0.011192047037184238
epoch: 7 s: 512000 batch_loss 0.6519356369972229 BPR_loss 0.6407134532928467 reg_loss 0.011222208850085735
epoch: 7 s: 768000 batch_loss 0.6570031642913818 BPR_loss 0.6459043622016907 reg_loss 0.011098798364400864
epoch: 7 s: 1024000 batch_loss 0.6643727421760559 BPR_loss 0.6533998250961304 reg_loss 0.010972931049764156
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 360.7287039756775 | 246.7962875366211 | 396.4551696777344 | [0.07002176 0.11425456 0.15050107] | [0.05760002 0.07427209 0.08694631] | [0.03181919 0.02636415 0.02326586] | [0.41679298 0.56520778 0.6522357 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.6541539430618286 BPR_loss 0.6429237723350525 reg_loss 0.011230189353227615
epoch: 8 s: 256000 batch_loss 0.6531659364700317 BPR_loss 0.6415895223617554 reg_loss 0.011576412245631218
epoch: 8 s: 512000 batch_loss 0.6485819220542908 BPR_loss 0.6364316344261169 reg_loss 0.012150278314948082
epoch: 8 s: 768000 batch_loss 0.6468690037727356 BPR_loss 0.6351289749145508 reg_loss 0.011740051209926605
epoch: 8 s: 1024000 batch_loss 0.6577639579772949 BPR_loss 0.6460167169570923 reg_loss 0.011747247539460659
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 324.3291583061218 | 247.15983533859253 | 395.6139831542969 | [0.07037666 0.115224   0.15142238] | [0.05779419 0.07469395 0.0873423 ] | [0.03195497 0.02652678 0.02335375] | [0.41796135 0.56804977 0.65390931] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.6462733745574951 BPR_loss 0.6339303851127625 reg_loss 0.012342977337539196
epoch: 9 s: 256000 batch_loss 0.6555052995681763 BPR_loss 0.6436501145362854 reg_loss 0.011855212040245533
epoch: 9 s: 512000 batch_loss 0.6518079042434692 BPR_loss 0.6397615671157837 reg_loss 0.012046324089169502
epoch: 9 s: 768000 batch_loss 0.6504629850387573 BPR_loss 0.6382545828819275 reg_loss 0.012208391912281513
epoch: 9 s: 1024000 batch_loss 0.6471878886222839 BPR_loss 0.6345656514167786 reg_loss 0.012622212991118431
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 340.2546365261078 | 273.03807520866394 | 394.6395568847656 | [0.0708063  0.11593582 0.1525166 ] | [0.05825846 0.07526285 0.08803773] | [0.03217601 0.02670361 0.02353585] | [0.41998232 0.56947076 0.65630921] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.6561701893806458 BPR_loss 0.6437586545944214 reg_loss 0.01241155806928873
epoch: 10 s: 256000 batch_loss 0.6526060104370117 BPR_loss 0.6401456594467163 reg_loss 0.012460371479392052
epoch: 10 s: 512000 batch_loss 0.6527237296104431 BPR_loss 0.6403322219848633 reg_loss 0.01239151693880558
epoch: 10 s: 768000 batch_loss 0.6489936113357544 BPR_loss 0.6365324258804321 reg_loss 0.012461187317967415
epoch: 10 s: 1024000 batch_loss 0.6550692319869995 BPR_loss 0.6423564553260803 reg_loss 0.012712760828435421
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 373.19935297966003 | 262.47125029563904 | 393.97686767578125 | [0.0709668  0.11620236 0.1526764 ] | [0.05839601 0.07543927 0.08818925] | [0.03224548 0.02672335 0.02353848] | [0.4207086  0.57079702 0.6571618 ] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.651930570602417 BPR_loss 0.6391991972923279 reg_loss 0.012731366790831089
epoch: 11 s: 256000 batch_loss 0.6489143967628479 BPR_loss 0.63599693775177 reg_loss 0.012917463667690754
epoch: 11 s: 512000 batch_loss 0.6519335508346558 BPR_loss 0.639168918132782 reg_loss 0.01276461873203516
epoch: 11 s: 768000 batch_loss 0.6499277949333191 BPR_loss 0.6371372938156128 reg_loss 0.012790495529770851
epoch: 11 s: 1024000 batch_loss 0.6560013294219971 BPR_loss 0.6429091691970825 reg_loss 0.01309214811772108
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 365.3372735977173 | 246.30104088783264 | 393.3193054199219 | [0.07119522 0.11597116 0.15281605] | [0.05841919 0.07533558 0.08822117] | [0.03223285 0.02667282 0.0235448 ] | [0.42260326 0.56978654 0.65700392] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.6499595046043396 BPR_loss 0.6369593739509583 reg_loss 0.013000132516026497
epoch: 12 s: 256000 batch_loss 0.6424697637557983 BPR_loss 0.6294905543327332 reg_loss 0.01297922246158123
epoch: 12 s: 512000 batch_loss 0.6463682651519775 BPR_loss 0.6331883668899536 reg_loss 0.013179907575249672
epoch: 12 s: 768000 batch_loss 0.6524063944816589 BPR_loss 0.6395974159240723 reg_loss 0.01280896831303835
epoch: 12 s: 1024000 batch_loss 0.6397819519042969 BPR_loss 0.6259809732437134 reg_loss 0.013800982385873795
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 365.59458661079407 | 196.91422629356384 | 392.7677001953125 | [0.07141329 0.11701495 0.1535243 ] | [0.05874763 0.07592685 0.08870172] | [0.03241916 0.02689624 0.02368006] | [0.42348743 0.57360743 0.65785651] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.6451197266578674 BPR_loss 0.6313376426696777 reg_loss 0.013782085850834846
epoch: 13 s: 256000 batch_loss 0.6491311192512512 BPR_loss 0.636020302772522 reg_loss 0.01311078853905201
epoch: 13 s: 512000 batch_loss 0.6519384384155273 BPR_loss 0.6384525895118713 reg_loss 0.013485852628946304
epoch: 13 s: 768000 batch_loss 0.6445384621620178 BPR_loss 0.6306751370429993 reg_loss 0.013863321393728256
epoch: 13 s: 1024000 batch_loss 0.6591855883598328 BPR_loss 0.6456364989280701 reg_loss 0.013549095019698143
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 361.6322705745697 | 213.81016778945923 | 392.1923522949219 | [0.07120004 0.11675433 0.15352385] | [0.05858607 0.0757911  0.08863495] | [0.03227075 0.02681729 0.02362953] | [0.42206644 0.57212328 0.65795124] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.646312952041626 BPR_loss 0.6325557231903076 reg_loss 0.013757232576608658
epoch: 14 s: 256000 batch_loss 0.643614649772644 BPR_loss 0.629646897315979 reg_loss 0.013967768289148808
epoch: 14 s: 512000 batch_loss 0.6459313035011292 BPR_loss 0.6318935751914978 reg_loss 0.014037742279469967
epoch: 14 s: 768000 batch_loss 0.6490122079849243 BPR_loss 0.6349584460258484 reg_loss 0.014053760096430779
epoch: 14 s: 1024000 batch_loss 0.6479709148406982 BPR_loss 0.6338678598403931 reg_loss 0.014103082939982414
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 414.56589460372925 | 205.1037518978119 | 391.5920104980469 | [0.07175421 0.11706541 0.15371958] | [0.0589073  0.07601007 0.08879674] | [0.03253916 0.02691518 0.02365532] | [0.42509789 0.57316534 0.65807755] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.6479552388191223 BPR_loss 0.633880078792572 reg_loss 0.014075136743485928
epoch: 15 s: 256000 batch_loss 0.6524802446365356 BPR_loss 0.6382566690444946 reg_loss 0.014223597943782806
epoch: 15 s: 512000 batch_loss 0.6515083909034729 BPR_loss 0.6372869610786438 reg_loss 0.014221401885151863
epoch: 15 s: 768000 batch_loss 0.6449880599975586 BPR_loss 0.6310672760009766 reg_loss 0.013920784927904606
epoch: 15 s: 1024000 batch_loss 0.6512866020202637 BPR_loss 0.6372915506362915 reg_loss 0.013995067216455936
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 408.93500447273254 | 183.0309579372406 | 391.2855224609375 | [0.07188586 0.11743074 0.15408756] | [0.05913689 0.07628319 0.08912325] | [0.03258652 0.02694597 0.02373163] | [0.42516105 0.57417582 0.65880384] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.6462116241455078 BPR_loss 0.6318641901016235 reg_loss 0.014347461983561516
epoch: 16 s: 256000 batch_loss 0.6397400498390198 BPR_loss 0.6251445412635803 reg_loss 0.01459552999585867
epoch: 16 s: 512000 batch_loss 0.6483311653137207 BPR_loss 0.6336402893066406 reg_loss 0.01469087228178978
epoch: 16 s: 768000 batch_loss 0.6430166959762573 BPR_loss 0.6283615231513977 reg_loss 0.014655162580311298
epoch: 16 s: 1024000 batch_loss 0.6492767930030823 BPR_loss 0.6344850659370422 reg_loss 0.0147916991263628
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 416.6716182231903 | 121.73003125190735 | 390.8627014160156 | [0.07186159 0.11727971 0.15434177] | [0.05920835 0.07629006 0.08927061] | [0.03261968 0.02691518 0.02377742] | [0.42452949 0.57319692 0.65889857] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.6428324580192566 BPR_loss 0.6282012462615967 reg_loss 0.01463122945278883
epoch: 17 s: 256000 batch_loss 0.6479818224906921 BPR_loss 0.6331543922424316 reg_loss 0.014827419072389603
epoch: 17 s: 512000 batch_loss 0.6458131074905396 BPR_loss 0.6311856508255005 reg_loss 0.014627449214458466
epoch: 17 s: 768000 batch_loss 0.6521071791648865 BPR_loss 0.6370716094970703 reg_loss 0.015035557560622692
epoch: 17 s: 1024000 batch_loss 0.6461231708526611 BPR_loss 0.6311109662055969 reg_loss 0.015012183226644993
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 415.4341745376587 | 126.05588102340698 | 390.56805419921875 | [0.07182068 0.11720944 0.15449734] | [0.05925005 0.07635651 0.0893949 ] | [0.03252968 0.02688597 0.02375637] | [0.42351901 0.57401794 0.65911962] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.6439502239227295 BPR_loss 0.6288802027702332 reg_loss 0.015070028603076935
epoch: 18 s: 256000 batch_loss 0.6482592225074768 BPR_loss 0.6330787539482117 reg_loss 0.015180491842329502
epoch: 18 s: 512000 batch_loss 0.6412593722343445 BPR_loss 0.6264374852180481 reg_loss 0.014821900986135006
epoch: 18 s: 768000 batch_loss 0.6539016962051392 BPR_loss 0.639160692691803 reg_loss 0.014740978367626667
epoch: 18 s: 1024000 batch_loss 0.6499506235122681 BPR_loss 0.6350990533828735 reg_loss 0.014851554296910763
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 442.63380908966064 | 170.15097403526306 | 390.2372131347656 | [0.07165553 0.11747753 0.15440972] | [0.05920333 0.07646666 0.08941353] | [0.03246021 0.02690966 0.02376163] | [0.42364532 0.57439687 0.658867  ] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.642310380935669 BPR_loss 0.6273314952850342 reg_loss 0.014978867024183273
epoch: 19 s: 256000 batch_loss 0.6440591812133789 BPR_loss 0.6288654208183289 reg_loss 0.015193774364888668
epoch: 19 s: 512000 batch_loss 0.6479393839836121 BPR_loss 0.633017897605896 reg_loss 0.014921457506716251
epoch: 19 s: 768000 batch_loss 0.6445218324661255 BPR_loss 0.6295334696769714 reg_loss 0.014988340437412262
epoch: 19 s: 1024000 batch_loss 0.642412543296814 BPR_loss 0.6268894076347351 reg_loss 0.01552315428853035
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 431.4638555049896 | 169.7474627494812 | 389.8672790527344 | [0.07159428 0.11757545 0.15424594] | [0.05916099 0.0764711  0.08932501] | [0.0324239  0.0269286  0.02373742] | [0.42301377 0.57376532 0.65877226] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.6450313925743103 BPR_loss 0.6298940181732178 reg_loss 0.01513738464564085
epoch: 20 s: 256000 batch_loss 0.6468844413757324 BPR_loss 0.6314717531204224 reg_loss 0.01541268453001976
epoch: 20 s: 512000 batch_loss 0.6394709348678589 BPR_loss 0.6238378286361694 reg_loss 0.015633104369044304
epoch: 20 s: 768000 batch_loss 0.6444875001907349 BPR_loss 0.628750205039978 reg_loss 0.01573728583753109
epoch: 20 s: 1024000 batch_loss 0.6417367458343506 BPR_loss 0.6261313557624817 reg_loss 0.01560540497303009
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 420.86377573013306 | 173.82349348068237 | 389.5552673339844 | [0.07159672 0.1175785  0.1545917 ] | [0.05913819 0.07642233 0.08938907] | [0.0324539  0.02690808 0.02376216] | [0.42348743 0.5744916  0.65930908] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.6407485008239746 BPR_loss 0.6249313354492188 reg_loss 0.015817148610949516
epoch: 21 s: 256000 batch_loss 0.6478078365325928 BPR_loss 0.6320816278457642 reg_loss 0.015726201236248016
epoch: 21 s: 512000 batch_loss 0.6423587799072266 BPR_loss 0.6262826323509216 reg_loss 0.016076156869530678
epoch: 21 s: 768000 batch_loss 0.6375212669372559 BPR_loss 0.6215639114379883 reg_loss 0.015957340598106384
epoch: 21 s: 1024000 batch_loss 0.644100546836853 BPR_loss 0.6281728744506836 reg_loss 0.015927700325846672
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 362.9953782558441 | 190.7729787826538 | 389.216064453125 | [0.07182812 0.11744979 0.15452318] | [0.0593284  0.07647148 0.08946477] | [0.0325281  0.02687255 0.02374584] | [0.4236769  0.57370216 0.65921435] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.6442999243736267 BPR_loss 0.628620982170105 reg_loss 0.01567894034087658
epoch: 22 s: 256000 batch_loss 0.6427044868469238 BPR_loss 0.626922070980072 reg_loss 0.015782395377755165
epoch: 22 s: 512000 batch_loss 0.6460460424423218 BPR_loss 0.6303106546401978 reg_loss 0.015735359862446785
epoch: 22 s: 768000 batch_loss 0.6517446041107178 BPR_loss 0.6356182098388672 reg_loss 0.01612640544772148
epoch: 22 s: 1024000 batch_loss 0.652551531791687 BPR_loss 0.6370740532875061 reg_loss 0.01547745056450367
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 364.43792605400085 | 197.55909299850464 | 389.1019287109375 | [0.07176983 0.11749571 0.15481357] | [0.05940872 0.07661986 0.08969311] | [0.03253916 0.02692939 0.02382163] | [0.42342428 0.57404951 0.6601301 ] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.6391101479530334 BPR_loss 0.6230387687683105 reg_loss 0.01607140526175499
epoch: 23 s: 256000 batch_loss 0.6488032341003418 BPR_loss 0.6329468488693237 reg_loss 0.015856383368372917
epoch: 23 s: 512000 batch_loss 0.6435185074806213 BPR_loss 0.6274522542953491 reg_loss 0.016066240146756172
epoch: 23 s: 768000 batch_loss 0.6475727558135986 BPR_loss 0.6316945552825928 reg_loss 0.015878217294812202
epoch: 23 s: 1024000 batch_loss 0.6312394142150879 BPR_loss 0.6149954795837402 reg_loss 0.016243964433670044
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 411.24014687538147 | 210.68158173561096 | 388.7680969238281 | [0.07177972 0.11761746 0.15461572] | [0.05935118 0.07658182 0.08953062] | [0.03254863 0.02692939 0.02375163] | [0.42386636 0.57464949 0.66057219] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.6414254307746887 BPR_loss 0.6252502202987671 reg_loss 0.016175229102373123
epoch: 24 s: 256000 batch_loss 0.6473130583763123 BPR_loss 0.6312367916107178 reg_loss 0.016076287254691124
epoch: 24 s: 512000 batch_loss 0.6481894850730896 BPR_loss 0.6322164535522461 reg_loss 0.015973029658198357
epoch: 24 s: 768000 batch_loss 0.6462494134902954 BPR_loss 0.6302258372306824 reg_loss 0.016023604199290276
epoch: 24 s: 1024000 batch_loss 0.6479858160018921 BPR_loss 0.6320382356643677 reg_loss 0.015947554260492325
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 399.002090215683 | 205.3437147140503 | 388.65264892578125 | [0.07159682 0.11768718 0.15500538] | [0.05917557 0.07652349 0.08958002] | [0.03246495 0.0269586  0.02382163] | [0.42260326 0.57474422 0.66164583] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.6388689279556274 BPR_loss 0.6224147081375122 reg_loss 0.01645420491695404
epoch: 25 s: 256000 batch_loss 0.6505844593048096 BPR_loss 0.6339962482452393 reg_loss 0.016588199883699417
epoch: 25 s: 512000 batch_loss 0.6429206728935242 BPR_loss 0.6264352798461914 reg_loss 0.016485393047332764
epoch: 25 s: 768000 batch_loss 0.6443546414375305 BPR_loss 0.6279880404472351 reg_loss 0.0163666270673275
epoch: 25 s: 1024000 batch_loss 0.646302342414856 BPR_loss 0.6298183798789978 reg_loss 0.01648397371172905
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 354.4258587360382 | 135.35548663139343 | 388.312255859375 | [0.07169329 0.11769937 0.15436472] | [0.0592615  0.07656672 0.08940145] | [0.03249968 0.0269436  0.02372742] | [0.42351901 0.57521789 0.6595617 ] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.07169329461895285
early stopping at 25, recall@20:0.0719
