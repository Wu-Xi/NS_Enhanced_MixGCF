Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ali', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.001, lr=0.009, mess_dropout=False, mess_dropout_rate=0.1, n_negs=32, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上进行softmax自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931480169296265 BPR_loss 0.6931477785110474 reg_loss 2.222623010084135e-07
epoch: 0 s: 256000 batch_loss 0.6683801412582397 BPR_loss 0.6656908392906189 reg_loss 0.0026892900932580233
epoch: 0 s: 512000 batch_loss 0.6344166398048401 BPR_loss 0.6280139684677124 reg_loss 0.006402671802788973
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 54.18895435333252 | 296.8921356201172 | 233.17608642578125 | [0.06630203 0.09666289 0.11851299] | [0.03002568 0.03657295 0.04066147] | [0.00393456 0.0029311  0.00241897] | [0.07691247 0.11259721 0.13781645] |
|   0   | 54.18895435333252 | 355.2128412723541 | 233.17608642578125 | [0.01040211 0.01771768 0.02503524] | [0.00423548 0.00574995 0.00707598] | [0.00055931 0.00048173 0.00045882] | [0.01109748 0.01907703 0.02721913] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.5768377184867859 BPR_loss 0.5666611790657043 reg_loss 0.01017654500901699
epoch: 1 s: 256000 batch_loss 0.5461228489875793 BPR_loss 0.5319284796714783 reg_loss 0.014194358140230179
epoch: 1 s: 512000 batch_loss 0.5353419184684753 BPR_loss 0.5181815028190613 reg_loss 0.017160439863801003
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 62.43386745452881 | 392.67041635513306 | 195.1990203857422 | [0.07126607 0.0996721  0.12082865] | [0.03334286 0.03945922 0.04341094] | [0.00419378 0.00299625 0.00244861] | [0.08172467 0.11541007 0.13960896] |
|   1   | 62.43386745452881 | 351.9754786491394  | 195.1990203857422 | [0.01413439 0.02360959 0.03129704] | [0.00584418 0.0078086  0.00920898] |  [0.0007551 0.0006391 0.0005731]   | [0.01501337 0.02535723 0.03394264] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.4885827302932739 BPR_loss 0.46964240074157715 reg_loss 0.018940338864922523
epoch: 2 s: 256000 batch_loss 0.4859411120414734 BPR_loss 0.4651574492454529 reg_loss 0.020783662796020508
epoch: 2 s: 512000 batch_loss 0.48253872990608215 BPR_loss 0.4601033926010132 reg_loss 0.02243533544242382
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 63.17915177345276 | 374.46312642097473 | 173.0873260498047 | [0.07146144 0.09857465 0.11813492] | [0.0336805  0.03954756 0.04321165] | [0.00420688 0.00297177 0.00240127] | [0.08201423 0.11396227 0.13657548] |
|   2   | 63.17915177345276 | 359.98151087760925 | 173.0873260498047 | [0.01573892 0.02518815 0.03325645] | [0.00644452 0.00841298 0.00988476] | [0.00084007 0.00068269 0.00061152] | [0.01671272 0.02705658 0.03618873] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.4570818543434143 BPR_loss 0.4339492917060852 reg_loss 0.023132573813199997
epoch: 3 s: 256000 batch_loss 0.4526228904724121 BPR_loss 0.4280563294887543 reg_loss 0.024566570296883583
epoch: 3 s: 512000 batch_loss 0.45578232407569885 BPR_loss 0.4309632182121277 reg_loss 0.024819092825055122
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 64.5602216720581 | 386.5255711078644 | 163.21424865722656 | [0.06925701 0.09626302 0.11517773] | [0.03304128 0.03886768 0.04242084] | [0.00408485 0.00289628 0.00234244] | [0.07962881 0.11124593 0.13330759] |
|   3   | 64.5602216720581 | 358.7465057373047 | 163.21424865722656 | [0.01602683 0.02547038 0.03380005] | [0.00661666 0.00859596 0.01012361] | [0.00085337 0.00069119 0.00062506] | [0.01693438 0.02738167 0.03700146] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.43223637342453003 BPR_loss 0.4067957103252411 reg_loss 0.025440674275159836
epoch: 4 s: 256000 batch_loss 0.42963436245918274 BPR_loss 0.40366411209106445 reg_loss 0.02597023732960224
epoch: 4 s: 512000 batch_loss 0.445254921913147 BPR_loss 0.41888585686683655 reg_loss 0.02636905014514923
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 62.47728753089905 | 377.06196117401123 | 158.08168029785156 | [0.06886844 0.09428496 0.11254218] | [0.03272139 0.03821758 0.04164955] | [0.00406693 0.00284285 0.00229166] | [0.07922894 0.10905355 0.13050852] |
|   4   | 62.47728753089905 | 367.42245411872864 | 158.08168029785156 | [0.01606647 0.02562861 0.03292598] | [0.00662915 0.00863341 0.00997289] | [0.00086002 0.00069969 0.00061004] | [0.01706737 0.02766244 0.03608529] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.41653600335121155 BPR_loss 0.3899082839488983 reg_loss 0.026627710089087486
epoch: 5 s: 256000 batch_loss 0.42930054664611816 BPR_loss 0.4025622606277466 reg_loss 0.026738297194242477
epoch: 5 s: 512000 batch_loss 0.43418848514556885 BPR_loss 0.4073767066001892 reg_loss 0.026811787858605385
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 62.92723798751831 | 377.1644103527069  | 154.8452911376953 | [0.06825594 0.09385738 0.11132319] | [0.03273507 0.03825235 0.04154076] | [0.00403384 0.00282355 0.00226615] | [0.07851194 0.10836413 0.12888147] |
|   5   | 62.92723798751831 | 367.20969700813293 | 154.8452911376953 | [0.01606338 0.02535635 0.03315194] | [0.00661678 0.00856465 0.00999168] | [0.00085558 0.00069341 0.00061423] | [0.01697871 0.02745556 0.03627739] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.41586053371429443 BPR_loss 0.3889481723308563 reg_loss 0.02691236138343811
epoch: 6 s: 256000 batch_loss 0.4187983572483063 BPR_loss 0.3917960226535797 reg_loss 0.02700234204530716
epoch: 6 s: 512000 batch_loss 0.4341927468776703 BPR_loss 0.40691766142845154 reg_loss 0.027275096625089645
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 61.54229807853699 | 380.32183861732483 | 152.45681762695312 | [0.06780506 0.09320333 0.11113254] | [0.03249604 0.03797225 0.04133771] | [0.00400488 0.00281079 0.00226224] | [0.07794661 0.1077988  0.12866086] |
|   6   | 61.54229807853699 | 358.4796652793884  | 152.45681762695312 | [0.01575532 0.02528139 0.03294404] | [0.00647564 0.00846244 0.00986913] | [0.00084155 0.00068713 0.0006093 ] | [0.01671272 0.02720435 0.03599663] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.402493417263031 BPR_loss 0.3749907612800598 reg_loss 0.027502652257680893
epoch: 7 s: 256000 batch_loss 0.42231303453445435 BPR_loss 0.39487865567207336 reg_loss 0.027434376999735832
epoch: 7 s: 512000 batch_loss 0.42560189962387085 BPR_loss 0.39806824922561646 reg_loss 0.0275336392223835
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 63.15790772438049 | 376.4140214920044  | 150.81985473632812 | [0.06778085 0.09232742 0.10960749] | [0.03217858 0.03747915 0.04073441] | [0.00399592 0.00278597 0.00223512] | [0.07782251 0.10661298 0.12699244] |
|   7   | 63.15790772438049 | 365.98670077323914 | 150.81985473632812 | [0.01560471 0.02515784 0.03285772] | [0.00639098 0.00838934 0.00980147] | [0.0008312  0.00068565 0.00060832] | [0.01652062 0.0271748  0.03589319] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.4099629819393158 BPR_loss 0.38246211409568787 reg_loss 0.027500880882143974
epoch: 8 s: 256000 batch_loss 0.4106884002685547 BPR_loss 0.382828950881958 reg_loss 0.027859454974532127
epoch: 8 s: 512000 batch_loss 0.41944319009780884 BPR_loss 0.3916156589984894 reg_loss 0.027827516198158264
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 62.490915060043335 | 382.2044506072998 | 149.56016540527344 | [0.06620663 0.09127936 0.10871598] | [0.03185224 0.03727124 0.0405429 ] | [0.00391319 0.00275978 0.00221697] | [0.07618168 0.10570294 0.12616513] |
|   8   | 62.490915060043335 | 367.0488648414612 | 149.56016540527344 | [0.01523466 0.02480442 0.03204018] | [0.00623721 0.0082331  0.00955772] | [0.00081273 0.00067568 0.00059329] | [0.01610687 0.0267906  0.03500658] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.40929368138313293 BPR_loss 0.38148510456085205 reg_loss 0.02780856564640999
epoch: 9 s: 256000 batch_loss 0.41353118419647217 BPR_loss 0.38553372025489807 reg_loss 0.027997450903058052
epoch: 9 s: 512000 batch_loss 0.4177187383174896 BPR_loss 0.3900015950202942 reg_loss 0.02771713025867939
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 63.362109661102295 | 379.6146454811096  | 148.46157836914062 | [0.06647852 0.09121246 0.10850175] | [0.03204867 0.03738729 0.04063556] | [0.00394008 0.00276115 0.00221536] | [0.0766367  0.10560642 0.12577905] |
|   9   | 63.362109661102295 | 364.58507657051086 | 148.46157836914062 | [0.01528615 0.02450693 0.03208746] | [0.00630754 0.0082385  0.00962602] | [0.00081643 0.0006705  0.00059502] | [0.01622508 0.02656894 0.03509524] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.3967176079750061 BPR_loss 0.36874258518218994 reg_loss 0.027975017204880714
epoch: 10 s: 256000 batch_loss 0.40344712138175964 BPR_loss 0.3754168152809143 reg_loss 0.028030304238200188
epoch: 10 s: 512000 batch_loss 0.41491419076919556 BPR_loss 0.3868658244609833 reg_loss 0.028048375621438026
+-------+-------------------+------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 60.86496114730835 | 387.352420091629 | 147.457763671875 | [0.06634121 0.09072876 0.10776272] | [0.03175268 0.03701948 0.04022131] | [0.00393249 0.00274426 0.00220065] | [0.07659533 0.10516519 0.12502068] |
|   10  | 60.86496114730835 | 365.51997590065  | 147.457763671875 | [0.01511335 0.02427271 0.03178553] | [0.00622872 0.00814385 0.00952052] | [0.00080608 0.00066164 0.0005896 ] | [0.01600343 0.02622907 0.03478492] |
+-------+-------------------+------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.40497151017189026 BPR_loss 0.37713423371315 reg_loss 0.027837282046675682
epoch: 11 s: 256000 batch_loss 0.397091269493103 BPR_loss 0.3688402473926544 reg_loss 0.028251033276319504
epoch: 11 s: 512000 batch_loss 0.40692853927612305 BPR_loss 0.3787478506565094 reg_loss 0.028180677443742752
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 58.90352654457092 | 369.81568574905396 | 146.8529510498047 | [0.06582847 0.0904232  0.1075246 ] | [0.03130695 0.03661856 0.03984649] | [0.00389733 0.00273634 0.00220042] | [0.07597485 0.10475153 0.12482764] |
|   11  | 58.90352654457092 | 360.2497367858887  | 146.8529510498047 | [0.01500081 0.02410141 0.03148682] | [0.00616612 0.00805861 0.00941392] | [0.00079943 0.00065388 0.00058246] | [0.01587044 0.0258892  0.03438594] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.40080612897872925 BPR_loss 0.37237226963043213 reg_loss 0.028433872386813164
epoch: 12 s: 256000 batch_loss 0.40876951813697815 BPR_loss 0.3805367350578308 reg_loss 0.028232775628566742
epoch: 12 s: 512000 batch_loss 0.41411271691322327 BPR_loss 0.3859887719154358 reg_loss 0.028123952448368073
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 60.72270441055298 | 377.2444660663605 | 146.2902069091797 | [0.06588695 0.09041882 0.10667552] | [0.03134152 0.03662971 0.03969412] | [0.00390767 0.00273323 0.00217882] | [0.07607137 0.10465501 0.12372456] |
|   12  | 60.72270441055298 | 370.0431160926819 | 146.2902069091797 | [0.01481968 0.02386906 0.031382  ] | [0.00613795 0.00802612 0.00940314] | [0.00078761 0.00065019 0.00058123] | [0.015634   0.02577099 0.03429728] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.39189884066581726 BPR_loss 0.3635072708129883 reg_loss 0.028391573578119278
epoch: 13 s: 256000 batch_loss 0.4031790494918823 BPR_loss 0.37483692169189453 reg_loss 0.028342120349407196
epoch: 13 s: 512000 batch_loss 0.4115373194217682 BPR_loss 0.3832678198814392 reg_loss 0.028269503265619278
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 61.708338260650635 | 374.7483766078949  | 145.5786895751953 | [0.0653513  0.09016336 0.10728459] | [0.03104423 0.03641356 0.03964171] | [0.00387113 0.00272944 0.00219697] | [0.07536815 0.10443439 0.1246346 ] |
|   13  | 61.708338260650635 | 367.67874479293823 | 145.5786895751953 | [0.01468915 0.02399366 0.03105123] | [0.00606345 0.00800355 0.00929331] | [0.00078466 0.00065351 0.00057359] | [0.01554534 0.02585965 0.03388353] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.38735178112983704 BPR_loss 0.3588080406188965 reg_loss 0.028543731197714806
epoch: 14 s: 256000 batch_loss 0.39500918984413147 BPR_loss 0.36640942096710205 reg_loss 0.02859976701438427
epoch: 14 s: 512000 batch_loss 0.41423434019088745 BPR_loss 0.3858957886695862 reg_loss 0.028338536620140076
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 64.01428365707397 | 351.25411200523376 | 145.08963012695312 | [0.06432716 0.08948528 0.10667169] | [0.03070256 0.03614674 0.03937311] | [0.00380288 0.00271358 0.00218089] | [0.07408582 0.10367602 0.1237935 ] |
|   14  | 64.01428365707397 | 297.2142684459686  | 145.08963012695312 | [0.01457894 0.023657   0.03065744] | [0.00605901 0.00795212 0.00923472] | [0.00077874 0.00064501 0.0005667 ] | [0.01545668 0.02551978 0.033455  ] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.014578937432956032
early stopping at 14, recall@20:0.0161
