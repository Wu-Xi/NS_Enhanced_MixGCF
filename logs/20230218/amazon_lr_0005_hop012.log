Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='amazon', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=3, l2=0.001, lr=0.005, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上进行softmax自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.693147599697113 BPR_loss 0.6931474208831787 reg_loss 1.6988676065921027e-07
epoch: 0 s: 256000 batch_loss 0.6743972897529602 BPR_loss 0.6647706627845764 reg_loss 0.009626631624996662
epoch: 0 s: 512000 batch_loss 0.6651322841644287 BPR_loss 0.6505616307258606 reg_loss 0.014570661820471287
epoch: 0 s: 768000 batch_loss 0.654374361038208 BPR_loss 0.6362252235412598 reg_loss 0.01814914308488369
epoch: 0 s: 1024000 batch_loss 0.6512757539749146 BPR_loss 0.6321974992752075 reg_loss 0.019078269600868225
epoch: 0 s: 1280000 batch_loss 0.6424597501754761 BPR_loss 0.6206573247909546 reg_loss 0.02180241420865059
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 94.20554876327515 | 1086.0915117263794 | 441.657958984375 | [0.0407567  0.06156706 0.07709089] | [0.01898129 0.02336513 0.02619771] | [0.00232466 0.00177224 0.00148235] | [0.04581401 0.06937092 0.08680127] |
|   0   | 94.20554876327515 | 1222.178808927536  | 441.657958984375 | [0.05214234 0.07549881 0.09311357] | [0.02264975 0.02757818 0.0308025 ] | [0.00299382 0.00218214 0.00180036] | [0.05893893 0.08539487 0.10522501] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.622730553150177 BPR_loss 0.5998408198356628 reg_loss 0.022889718413352966
epoch: 1 s: 256000 batch_loss 0.6272154450416565 BPR_loss 0.6034159660339355 reg_loss 0.023799462243914604
epoch: 1 s: 512000 batch_loss 0.6240377426147461 BPR_loss 0.5977166891098022 reg_loss 0.026321059092879295
epoch: 1 s: 768000 batch_loss 0.6164312958717346 BPR_loss 0.5891060829162598 reg_loss 0.0273252222687006
epoch: 1 s: 1024000 batch_loss 0.6089310646057129 BPR_loss 0.5796419382095337 reg_loss 0.029289130121469498
epoch: 1 s: 1280000 batch_loss 0.603925883769989 BPR_loss 0.5733267664909363 reg_loss 0.030599091202020645
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 113.34808158874512 | 1262.8544363975525 | 411.75335693359375 | [0.04555711 0.06722677 0.08384967] | [0.02118411 0.025745   0.02877043] | [0.00257731 0.00192084 0.0016004 ] | [0.05090365 0.07530761 0.09371646] |
|   1   | 113.34808158874512 | 1216.4699492454529 | 411.75335693359375 | [0.0572178  0.08405611 0.10323031] | [0.02566457 0.0313135  0.03482458] | [0.00327627 0.00242185 0.00199207] | [0.06431205 0.09454967 0.11620761] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.5914887189865112 BPR_loss 0.5603728294372559 reg_loss 0.03111591748893261
epoch: 2 s: 256000 batch_loss 0.5893692374229431 BPR_loss 0.5571823120117188 reg_loss 0.032186947762966156
epoch: 2 s: 512000 batch_loss 0.5858900547027588 BPR_loss 0.5521864295005798 reg_loss 0.03370364010334015
epoch: 2 s: 768000 batch_loss 0.5764766931533813 BPR_loss 0.5425587296485901 reg_loss 0.03391798585653305
epoch: 2 s: 1024000 batch_loss 0.5728291273117065 BPR_loss 0.5372676253318787 reg_loss 0.03556147217750549
epoch: 2 s: 1280000 batch_loss 0.5659537315368652 BPR_loss 0.5281929969787598 reg_loss 0.03776070848107338
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 111.13471126556396 | 1248.0010361671448 | 387.103271484375 | [0.0475075  0.06912449 0.08564074] | [0.02221663 0.02676827 0.02978164] | [0.00267845 0.0019674  0.00162997] | [0.05280222 0.07709664 0.09555661] |
|   2   | 111.13471126556396 | 1209.262374162674  | 387.103271484375 | [0.06144645 0.08898928 0.10888679] | [0.02737943 0.03318298 0.03682858] | [0.00350317 0.00255755 0.00209804] | [0.0688343  0.09992279 0.12243161] |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.556817352771759 BPR_loss 0.5177597999572754 reg_loss 0.039057549089193344
epoch: 3 s: 256000 batch_loss 0.5416461825370789 BPR_loss 0.5018643140792847 reg_loss 0.03978189453482628
epoch: 3 s: 512000 batch_loss 0.5425058007240295 BPR_loss 0.5015099048614502 reg_loss 0.040995869785547256
epoch: 3 s: 768000 batch_loss 0.5462406873703003 BPR_loss 0.5052701830863953 reg_loss 0.04097051918506622
epoch: 3 s: 1024000 batch_loss 0.541947603225708 BPR_loss 0.4998674988746643 reg_loss 0.042080093175172806
epoch: 3 s: 1280000 batch_loss 0.5415652394294739 BPR_loss 0.4994426965713501 reg_loss 0.04212256893515587
+-------+-------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |      Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 119.5824875831604 | 1210.1340222358704 | 365.3193359375 | [0.04807959 0.06990503 0.08610059] | [0.02274054 0.02732803 0.03027829] | [0.00271496 0.00198656 0.00163618] | [0.05357625 0.07787068 0.09590712] |
|   3   | 119.5824875831604 | 1216.0187525749207 | 365.3193359375 | [0.06217973 0.09038594 0.11095096] | [0.02792635 0.03387239 0.03763435] | [0.00353429 0.00259537 0.00213481] | [0.06948821 0.10142758 0.12452729] |
+-------+-------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.529026985168457 BPR_loss 0.4854641258716583 reg_loss 0.04356284812092781
epoch: 4 s: 256000 batch_loss 0.5182942748069763 BPR_loss 0.4715919494628906 reg_loss 0.046702317893505096
epoch: 4 s: 512000 batch_loss 0.5190251469612122 BPR_loss 0.4736538529396057 reg_loss 0.04537130519747734
epoch: 4 s: 768000 batch_loss 0.5243978500366211 BPR_loss 0.4776056408882141 reg_loss 0.046792201697826385
epoch: 4 s: 1024000 batch_loss 0.5168907642364502 BPR_loss 0.46909838914871216 reg_loss 0.047792352735996246
epoch: 4 s: 1280000 batch_loss 0.5217726826667786 BPR_loss 0.47459661960601807 reg_loss 0.0471760518848896
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 137.88369393348694 | 1246.0753645896912 | 349.0009460449219 | [0.04709634 0.06881199 0.08547918] | [0.02229207 0.02685027 0.02988771] | [0.00264851 0.00194914 0.00162072] | [0.05227646 0.07651247 0.0951769 ] |
|   4   | 137.88369393348694 | 1132.918897151947  | 349.0009460449219 | [0.06210299 0.09090246 0.11146564] | [0.0278275  0.03389765 0.0376609 ] | [0.00353468 0.00260975 0.00214268] | [0.06946458 0.10201059 0.12511818] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.505961537361145 BPR_loss 0.45813170075416565 reg_loss 0.04782985895872116
epoch: 5 s: 256000 batch_loss 0.5031518340110779 BPR_loss 0.45230022072792053 reg_loss 0.050851594656705856
epoch: 5 s: 512000 batch_loss 0.5035060048103333 BPR_loss 0.45238518714904785 reg_loss 0.051120806485414505
epoch: 5 s: 768000 batch_loss 0.5055952668190002 BPR_loss 0.45505955815315247 reg_loss 0.05053570866584778
epoch: 5 s: 1024000 batch_loss 0.4954897165298462 BPR_loss 0.4448530077934265 reg_loss 0.05063671991229057
epoch: 5 s: 1280000 batch_loss 0.49742481112480164 BPR_loss 0.44666656851768494 reg_loss 0.050758231431245804
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 133.84910678863525 | 943.3771402835846 | 337.5191650390625 | [0.04704605 0.06889066 0.08499728] | [0.02198974 0.02657792 0.02951399] | [0.00264157 0.00194932 0.00161038] | [0.05218153 0.07649786 0.09464384] |
|   5   | 133.84910678863525 | 869.1378405094147 | 337.5191650390625 | [0.06232864 0.0905419  0.1111841 ] | [0.02832126 0.03427786 0.03805514] | [0.00354571 0.00260049 0.00214137] | [0.06968518 0.10168757 0.12503939] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.4855358600616455 BPR_loss 0.4330611228942871 reg_loss 0.0524747334420681
epoch: 6 s: 256000 batch_loss 0.4909258782863617 BPR_loss 0.43871426582336426 reg_loss 0.05221160501241684
epoch: 6 s: 512000 batch_loss 0.4925830066204071 BPR_loss 0.43867892026901245 reg_loss 0.053904078900814056
epoch: 6 s: 768000 batch_loss 0.4999961853027344 BPR_loss 0.44810396432876587 reg_loss 0.0518922284245491
epoch: 6 s: 1024000 batch_loss 0.4903337359428406 BPR_loss 0.4382374584674835 reg_loss 0.05209627375006676
epoch: 6 s: 1280000 batch_loss 0.4961787760257721 BPR_loss 0.4423489570617676 reg_loss 0.05382981896400452
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 114.88492774963379 | 926.6675291061401 | 329.95062255859375 | [0.04663865 0.06801611 0.08413549] | [0.02165637 0.02614638 0.02908784] | [0.0026182  0.00192358 0.00159444] | [0.0517434  0.07557048 0.09365804] |
|   6   | 114.88492774963379 | 861.3211858272552 | 329.95062255859375 | [0.06203822 0.08988657 0.11026896] | [0.02804558 0.03392313 0.03765792] | [0.00352444 0.00257981 0.00212417] | [0.06928337 0.10080518 0.12401519] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.477372944355011 BPR_loss 0.42324239015579224 reg_loss 0.05413055047392845
epoch: 7 s: 256000 batch_loss 0.4827355742454529 BPR_loss 0.4280276894569397 reg_loss 0.05470786988735199
epoch: 7 s: 512000 batch_loss 0.4898337721824646 BPR_loss 0.43690329790115356 reg_loss 0.052930474281311035
epoch: 7 s: 768000 batch_loss 0.48058021068573 BPR_loss 0.4267176389694214 reg_loss 0.0538625568151474
epoch: 7 s: 1024000 batch_loss 0.4880405068397522 BPR_loss 0.43332868814468384 reg_loss 0.05471181496977806
epoch: 7 s: 1280000 batch_loss 0.49825358390808105 BPR_loss 0.44450199604034424 reg_loss 0.05375158041715622
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 111.47050356864929 | 854.3519525527954 | 324.5531005859375 | [0.04600337 0.06703763 0.08352606] | [0.02155453 0.02598054 0.02898634] | [0.00258388 0.00190058 0.001583  ] | [0.05105699 0.07470882 0.09297163] |
|   7   | 111.47050356864929 | 829.3602764606476 | 324.5531005859375 | [0.06179769 0.08947887 0.10971069] | [0.02804968 0.03389196 0.03759588] | [0.00351498 0.00257292 0.00211367] | [0.06909429 0.10056095 0.12340855] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.48244142532348633 BPR_loss 0.42680373787879944 reg_loss 0.055637698620557785
epoch: 8 s: 256000 batch_loss 0.48123300075531006 BPR_loss 0.42575541138648987 reg_loss 0.055477600544691086
epoch: 8 s: 512000 batch_loss 0.4858413338661194 BPR_loss 0.4314690828323364 reg_loss 0.054372258484363556
epoch: 8 s: 768000 batch_loss 0.48300397396087646 BPR_loss 0.4272266924381256 reg_loss 0.05577727034687996
epoch: 8 s: 1024000 batch_loss 0.49896523356437683 BPR_loss 0.44356274604797363 reg_loss 0.0554024800658226
epoch: 8 s: 1280000 batch_loss 0.4846237301826477 BPR_loss 0.42770400643348694 reg_loss 0.05691970884799957
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 103.15674424171448 | 849.5636606216431 | 320.5648498535156 | [0.04534204 0.06668036 0.08273985] | [0.02112293 0.02560913 0.02853842] | [0.00254774 0.00188835 0.00156936] | [0.05030487 0.07421958 0.09222681] |
|   8   | 103.15674424171448 | 817.4773526191711 | 320.5648498535156 | [0.0611389  0.08853889 0.10819767] | [0.02747821 0.03326031 0.03686116] | [0.0034752  0.00254554 0.00208701] | [0.06833796 0.09941857 0.12169892] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.476612389087677 BPR_loss 0.4210694432258606 reg_loss 0.0555429607629776
epoch: 9 s: 256000 batch_loss 0.4720005691051483 BPR_loss 0.4147462844848633 reg_loss 0.05725427716970444
epoch: 9 s: 512000 batch_loss 0.47402870655059814 BPR_loss 0.4180449843406677 reg_loss 0.05598371848464012
epoch: 9 s: 768000 batch_loss 0.47307050228118896 BPR_loss 0.41614383459091187 reg_loss 0.056926652789115906
epoch: 9 s: 1024000 batch_loss 0.4731559753417969 BPR_loss 0.4164700508117676 reg_loss 0.0566859096288681
epoch: 9 s: 1280000 batch_loss 0.4799543023109436 BPR_loss 0.42323288321495056 reg_loss 0.05672142282128334
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 110.41419076919556 | 868.8391842842102 | 317.6440124511719 | [0.04596451 0.06733662 0.08276206] | [0.02143123 0.02592317 0.02874027] | [0.00257877 0.00190788 0.00157168] | [0.05093286 0.07505933 0.09229983] |
|   9   | 110.41419076919556 | 797.1439523696899 | 317.6440124511719 | [0.06073821 0.0877562  0.10804861] | [0.02734831 0.03305602 0.03675911] | [0.00345314 0.00252702 0.00207953] | [0.06798342 0.09870163 0.1213759 ] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.4720875024795532 BPR_loss 0.4156779646873474 reg_loss 0.05640953779220581
epoch: 10 s: 256000 batch_loss 0.46107134222984314 BPR_loss 0.40416836738586426 reg_loss 0.05690298601984978
epoch: 10 s: 512000 batch_loss 0.47068190574645996 BPR_loss 0.4125315248966217 reg_loss 0.058150388300418854
epoch: 10 s: 768000 batch_loss 0.47330594062805176 BPR_loss 0.41558241844177246 reg_loss 0.0577235072851181
epoch: 10 s: 1024000 batch_loss 0.47909823060035706 BPR_loss 0.422332763671875 reg_loss 0.05676547437906265
epoch: 10 s: 1280000 batch_loss 0.47411996126174927 BPR_loss 0.4165803790092468 reg_loss 0.05753958970308304
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 115.58722376823425 | 843.3364148139954 | 315.3128356933594 | [0.04551427 0.06651146 0.08206687] | [0.02123061 0.025646   0.02848354] | [0.00255942 0.00188543 0.00155756] | [0.05054584 0.07413195 0.091555  ] |
|   10  | 115.58722376823425 | 765.3830046653748 | 315.3128356933594 | [0.06076573 0.08790614 0.10781831] | [0.02741978 0.03314968 0.03678506] | [0.0034622  0.00253057 0.00207611] | [0.06808584 0.09889071 0.12122621] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.4585776925086975 BPR_loss 0.39994215965270996 reg_loss 0.05863552540540695
epoch: 11 s: 256000 batch_loss 0.46567800641059875 BPR_loss 0.40765899419784546 reg_loss 0.058019015938043594
epoch: 11 s: 512000 batch_loss 0.45921748876571655 BPR_loss 0.4005087614059448 reg_loss 0.05870871618390083
epoch: 11 s: 768000 batch_loss 0.47559356689453125 BPR_loss 0.4171779751777649 reg_loss 0.058415576815605164
epoch: 11 s: 1024000 batch_loss 0.4711771011352539 BPR_loss 0.41180968284606934 reg_loss 0.059367429465055466
epoch: 11 s: 1280000 batch_loss 0.46527522802352905 BPR_loss 0.4057697653770447 reg_loss 0.05950547009706497
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 117.91906881332397 | 822.4368433952332 | 313.6253356933594 | [0.04552234 0.06639053 0.08238432] | [0.02111821 0.02550364 0.02842059] | [0.00255796 0.00188433 0.00156364] | [0.05053124 0.07408084 0.09189821] |
|   11  | 117.91906881332397 | 757.0118460655212 | 313.6253356933594 | [0.05988853 0.08692633 0.10651979] | [0.02689173 0.03260497 0.03619482] | [0.00341059 0.00250063 0.00205366] | [0.06710891 0.09782711 0.11992626] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.4641440212726593 BPR_loss 0.40575334429740906 reg_loss 0.058390676975250244
epoch: 12 s: 256000 batch_loss 0.4629254937171936 BPR_loss 0.40313810110092163 reg_loss 0.05978739634156227
epoch: 12 s: 512000 batch_loss 0.4682482182979584 BPR_loss 0.40831494331359863 reg_loss 0.05993328243494034
epoch: 12 s: 768000 batch_loss 0.46879106760025024 BPR_loss 0.4097388982772827 reg_loss 0.05905216932296753
epoch: 12 s: 1024000 batch_loss 0.4767059087753296 BPR_loss 0.41699957847595215 reg_loss 0.05970633402466774
epoch: 12 s: 1280000 batch_loss 0.466166228055954 BPR_loss 0.40597623586654663 reg_loss 0.06018999218940735
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 133.73560094833374 | 824.4224553108215 | 312.24786376953125 | [0.04494328 0.0656479  0.08139528] | [0.02069128 0.02504341 0.02792003] | [0.00252291 0.0018606  0.00154697] | [0.04991785 0.07312425 0.09083209] |
|   12  | 133.73560094833374 | 719.0408055782318 | 312.24786376953125 | [0.06018764 0.08680116 0.10631986] | [0.02721239 0.03283451 0.03641072] | [0.00342832 0.00249866 0.00205077] | [0.06741617 0.09774045 0.11980808] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.45946240425109863 BPR_loss 0.399646520614624 reg_loss 0.059815868735313416
epoch: 13 s: 256000 batch_loss 0.46662816405296326 BPR_loss 0.4078032970428467 reg_loss 0.05882485583424568
epoch: 13 s: 512000 batch_loss 0.4617997705936432 BPR_loss 0.4031412601470947 reg_loss 0.05865852162241936
epoch: 13 s: 768000 batch_loss 0.46484124660491943 BPR_loss 0.40518391132354736 reg_loss 0.059657320380210876
epoch: 13 s: 1024000 batch_loss 0.4728233814239502 BPR_loss 0.4129331111907959 reg_loss 0.05989028513431549
epoch: 13 s: 1280000 batch_loss 0.47504204511642456 BPR_loss 0.41462263464927673 reg_loss 0.06041940674185753
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 90.41988015174866 |  490.360036611557  | 310.89794921875 | [0.04446531 0.06525306 0.0803979 ] | [0.02046957 0.02483909 0.02760914] | [0.00249808 0.00184947 0.00152884] | [0.04934828 0.07275183 0.08982438] |
|   13  | 90.41988015174866 | 441.91265654563904 | 310.89794921875 | [0.05995086 0.08651555 0.10631408] | [0.02705453 0.03266922 0.03629082] | [0.0034165  0.00249196 0.00205103] | [0.06725072 0.09737804 0.1196899 ] |
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.4547770321369171 BPR_loss 0.3936273157596588 reg_loss 0.0611497238278389
epoch: 14 s: 256000 batch_loss 0.4621240496635437 BPR_loss 0.4019710421562195 reg_loss 0.06015302240848541
epoch: 14 s: 512000 batch_loss 0.4738425314426422 BPR_loss 0.41348975896835327 reg_loss 0.06035276874899864
epoch: 14 s: 768000 batch_loss 0.4625393748283386 BPR_loss 0.4019363224506378 reg_loss 0.06060303747653961
epoch: 14 s: 1024000 batch_loss 0.4635211229324341 BPR_loss 0.4024243950843811 reg_loss 0.06109672784805298
epoch: 14 s: 1280000 batch_loss 0.4644843339920044 BPR_loss 0.40481463074684143 reg_loss 0.059669699519872665
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 80.50713467597961 | 460.7341139316559 | 309.7558288574219 | [0.04450552 0.0653748  0.08109244] | [0.02058188 0.02496126 0.0278383 ] | [0.00250137 0.00185056 0.00154296] | [0.0494359  0.07287597 0.09067874] |
|   14  | 80.50713467597961 | 435.8396737575531 | 309.7558288574219 | [0.0594701  0.08584006 0.10568529] | [0.02676193 0.03233434 0.03596404] | [0.00338657 0.00247306 0.00203803] | [0.06657318 0.09665322 0.1189966 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.44884011149406433 BPR_loss 0.3886573910713196 reg_loss 0.06018272042274475
epoch: 15 s: 256000 batch_loss 0.4470098316669464 BPR_loss 0.3861825466156006 reg_loss 0.06082727387547493
epoch: 15 s: 512000 batch_loss 0.4610168933868408 BPR_loss 0.40215423703193665 reg_loss 0.05886267125606537
epoch: 15 s: 768000 batch_loss 0.468963623046875 BPR_loss 0.40791502594947815 reg_loss 0.06104860454797745
epoch: 15 s: 1024000 batch_loss 0.4607611298561096 BPR_loss 0.398859441280365 reg_loss 0.06190168857574463
epoch: 15 s: 1280000 batch_loss 0.46496087312698364 BPR_loss 0.4047691822052002 reg_loss 0.06019168719649315
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 82.58746290206909 | 446.5292134284973 | 308.7932434082031 | [0.04473214 0.06538208 0.08076128] | [0.02063173 0.02498437 0.0277969 ] | [0.00251926 0.00185786 0.00153797] | [0.04979371 0.07305122 0.09041586] |
|   15  | 82.58746290206909 | 445.8774607181549 | 308.7932434082031 | [0.05922899 0.08594115 0.10560063] | [0.02674751 0.03239209 0.03599371] | [0.00337711 0.00247522 0.00203816] | [0.06638409 0.09682655 0.11903599] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.059228990734098555
early stopping at 15, recall@20:0.0623
