Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='yelp2018', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.001, lr=0.009, mess_dropout=False, mess_dropout_rate=0.1, n_negs=64, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上进行softmax自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.693148136138916 BPR_loss 0.6931480169296265 reg_loss 1.323738700875765e-07
epoch: 0 s: 256000 batch_loss 0.6838622093200684 BPR_loss 0.682750940322876 reg_loss 0.0011112443171441555
epoch: 0 s: 512000 batch_loss 0.683998167514801 BPR_loss 0.6819989681243896 reg_loss 0.001999200088903308
epoch: 0 s: 768000 batch_loss 0.6822870969772339 BPR_loss 0.6796853542327881 reg_loss 0.0026017241179943085
epoch: 0 s: 1024000 batch_loss 0.6770311594009399 BPR_loss 0.6736482381820679 reg_loss 0.003382911905646324
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 201.86575031280518 | 38.547948360443115 | 410.8918151855469 | [0.06168976 0.1024176  0.13561316] | [0.0503579  0.06569418 0.07734061] | [0.0282446  0.02364295 0.02104753] | [0.3793735  0.52930403 0.61715296] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6707238554954529 BPR_loss 0.6670677065849304 reg_loss 0.0036561735905706882
epoch: 1 s: 256000 batch_loss 0.6647666692733765 BPR_loss 0.66037517786026 reg_loss 0.0043914965353906155
epoch: 1 s: 512000 batch_loss 0.6646222472190857 BPR_loss 0.6598773002624512 reg_loss 0.004744933918118477
epoch: 1 s: 768000 batch_loss 0.6612340211868286 BPR_loss 0.6561872363090515 reg_loss 0.0050467876717448235
epoch: 1 s: 1024000 batch_loss 0.6624650359153748 BPR_loss 0.6571817398071289 reg_loss 0.0052832746878266335
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 213.465265750885 | 63.98477649688721 | 403.0716857910156 | [0.06582439 0.10826967 0.1433077 ] | [0.05406443 0.07007993 0.08234764] | [0.03004295 0.02506158 0.02224643] | [0.39790956 0.54904004 0.63625742] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6581599712371826 BPR_loss 0.6525900959968567 reg_loss 0.0055698794312775135
epoch: 2 s: 256000 batch_loss 0.6602780222892761 BPR_loss 0.6544637680053711 reg_loss 0.005814267788082361
epoch: 2 s: 512000 batch_loss 0.6654485464096069 BPR_loss 0.6594507098197937 reg_loss 0.005997839849442244
epoch: 2 s: 768000 batch_loss 0.6623932123184204 BPR_loss 0.6559691429138184 reg_loss 0.006424042861908674
epoch: 2 s: 1024000 batch_loss 0.6520529985427856 BPR_loss 0.6455477476119995 reg_loss 0.006505258847028017
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 211.04153561592102 | 60.52463698387146 | 399.0346374511719 | [0.06805314 0.11120394 0.14721775] | [0.0557605  0.07207658 0.08468994] | [0.03087344 0.02567655 0.02280325] | [0.40845649 0.55845017 0.64484653] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6505093574523926 BPR_loss 0.6438919901847839 reg_loss 0.0066173798404634
epoch: 3 s: 256000 batch_loss 0.6592358350753784 BPR_loss 0.652446985244751 reg_loss 0.006788823287934065
epoch: 3 s: 512000 batch_loss 0.6494889259338379 BPR_loss 0.6424115896224976 reg_loss 0.007077365648001432
epoch: 3 s: 768000 batch_loss 0.6560620069503784 BPR_loss 0.6489299535751343 reg_loss 0.007132065482437611
epoch: 3 s: 1024000 batch_loss 0.6582854390144348 BPR_loss 0.6510321497917175 reg_loss 0.0072532836347818375
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 209.06813979148865 | 59.669649839401245 | 396.3332214355469 | [0.06964489 0.11402392 0.14960362] | [0.05731503 0.07402375 0.0864678 ] | [0.0317134  0.02626705 0.02312903] | [0.41486674 0.56454465 0.64901478] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.6555635333061218 BPR_loss 0.6481493711471558 reg_loss 0.007414139341562986
epoch: 4 s: 256000 batch_loss 0.6449975371360779 BPR_loss 0.6372406482696533 reg_loss 0.007756894454360008
epoch: 4 s: 512000 batch_loss 0.653462827205658 BPR_loss 0.6457765698432922 reg_loss 0.007686253171414137
epoch: 4 s: 768000 batch_loss 0.6528113484382629 BPR_loss 0.6449344158172607 reg_loss 0.007876953110098839
epoch: 4 s: 1024000 batch_loss 0.6581469774246216 BPR_loss 0.6501082181930542 reg_loss 0.008038785308599472
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 213.42818069458008 | 54.17424130439758 | 394.26934814453125 | [0.07001913 0.11471377 0.15054135] | [0.05764993 0.07446939 0.08702295] | [0.03180656 0.02634442 0.02322692] | [0.41578249 0.56726033 0.65179361] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.6483871340751648 BPR_loss 0.6402294635772705 reg_loss 0.008157647214829922
epoch: 5 s: 256000 batch_loss 0.6461108922958374 BPR_loss 0.6375732421875 reg_loss 0.008537670597434044
epoch: 5 s: 512000 batch_loss 0.6529001593589783 BPR_loss 0.6446150541305542 reg_loss 0.008285099640488625
epoch: 5 s: 768000 batch_loss 0.6499743461608887 BPR_loss 0.6414944529533386 reg_loss 0.008479895070195198
epoch: 5 s: 1024000 batch_loss 0.6490126252174377 BPR_loss 0.6404513120651245 reg_loss 0.00856128428131342
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 257.28403544425964 | 195.9504954814911 | 392.5503845214844 | [0.07065378 0.11533448 0.15178106] | [0.05832496 0.07513503 0.08786983] | [0.03212707 0.02653309 0.02340112] | [0.41909814 0.56779715 0.65390931] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.6441760659217834 BPR_loss 0.6353071928024292 reg_loss 0.008868862874805927
epoch: 6 s: 256000 batch_loss 0.6469988822937012 BPR_loss 0.6381654143333435 reg_loss 0.008833460509777069
epoch: 6 s: 512000 batch_loss 0.6387091279029846 BPR_loss 0.629589319229126 reg_loss 0.009119829162955284
epoch: 6 s: 768000 batch_loss 0.6477652192115784 BPR_loss 0.6387304067611694 reg_loss 0.00903479102998972
epoch: 6 s: 1024000 batch_loss 0.6528647541999817 BPR_loss 0.6438751220703125 reg_loss 0.008989643305540085
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 357.8199441432953 | 257.2859625816345 | 391.2812805175781 | [0.07079673 0.11567323 0.15216354] | [0.05828283 0.07517708 0.08794602] | [0.03217286 0.02661598 0.0234948 ] | [0.42001389 0.5708286  0.65454086] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.6424124240875244 BPR_loss 0.633144199848175 reg_loss 0.009268248453736305
epoch: 7 s: 256000 batch_loss 0.6446335911750793 BPR_loss 0.635097324848175 reg_loss 0.009536290541291237
epoch: 7 s: 512000 batch_loss 0.6409839391708374 BPR_loss 0.6314486265182495 reg_loss 0.009535335004329681
epoch: 7 s: 768000 batch_loss 0.6476783752441406 BPR_loss 0.6381974220275879 reg_loss 0.009480957873165607
epoch: 7 s: 1024000 batch_loss 0.6559372544288635 BPR_loss 0.6465480327606201 reg_loss 0.009389249607920647
+-------+--------------------+--------------------+--------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |  Loss  |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 358.61453771591187 | 258.70914363861084 | 390.25 | [0.07085565 0.11612235 0.15214593] | [0.05848047 0.07552563 0.0881631 ] | [0.03217286 0.02669177 0.0235069 ] | [0.42092965 0.57142857 0.65529872] |
+-------+--------------------+--------------------+--------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.6423603296279907 BPR_loss 0.6327967643737793 reg_loss 0.009563561528921127
epoch: 8 s: 256000 batch_loss 0.6409379839897156 BPR_loss 0.6310952305793762 reg_loss 0.009842762723565102
epoch: 8 s: 512000 batch_loss 0.637955367565155 BPR_loss 0.627814769744873 reg_loss 0.010140626691281796
epoch: 8 s: 768000 batch_loss 0.6371349096298218 BPR_loss 0.6271721124649048 reg_loss 0.00996282696723938
epoch: 8 s: 1024000 batch_loss 0.6489614248275757 BPR_loss 0.6390035152435303 reg_loss 0.009957928210496902
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 352.90717029571533 | 242.6476411819458 | 389.4242858886719 | [0.07119237 0.11628751 0.15330434] | [0.05868796 0.07565737 0.08863281] | [0.03229127 0.02668703 0.02363374] | [0.42130858 0.57130226 0.65757231] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.6340644955635071 BPR_loss 0.6238049268722534 reg_loss 0.010259585455060005
epoch: 9 s: 256000 batch_loss 0.6444109082221985 BPR_loss 0.6342918276786804 reg_loss 0.010119053535163403
epoch: 9 s: 512000 batch_loss 0.6394858956336975 BPR_loss 0.6293236017227173 reg_loss 0.01016226690262556
epoch: 9 s: 768000 batch_loss 0.6399457454681396 BPR_loss 0.6295449733734131 reg_loss 0.010400782339274883
epoch: 9 s: 1024000 batch_loss 0.6378998756408691 BPR_loss 0.6274013519287109 reg_loss 0.010498538613319397
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 334.14362144470215 | 248.8277542591095 | 388.49603271484375 | [0.07132789 0.11622557 0.1532671 ] | [0.05892861 0.07582146 0.08879955] | [0.03237179 0.02669335 0.02362532] | [0.4218454  0.57070229 0.65659341] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.6433678269386292 BPR_loss 0.6330447196960449 reg_loss 0.010323109105229378
epoch: 10 s: 256000 batch_loss 0.642193615436554 BPR_loss 0.6316952109336853 reg_loss 0.010498409159481525
epoch: 10 s: 512000 batch_loss 0.6427100896835327 BPR_loss 0.6322075724601746 reg_loss 0.010502533987164497
epoch: 10 s: 768000 batch_loss 0.6391783356666565 BPR_loss 0.6286418437957764 reg_loss 0.010536502115428448
epoch: 10 s: 1024000 batch_loss 0.6467919945716858 BPR_loss 0.6360793709754944 reg_loss 0.010712603107094765
+-------+-------------------+------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 336.4143543243408 | 265.955397605896 | 387.898193359375 | [0.0712527  0.11643854 0.15348013] | [0.05898124 0.07602005 0.08895395] | [0.03232917 0.02675256 0.0236269 ] | [0.42212959 0.57161804 0.65747758] |
+-------+-------------------+------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.6394596099853516 BPR_loss 0.6287534236907959 reg_loss 0.010706193745136261
epoch: 11 s: 256000 batch_loss 0.6374074220657349 BPR_loss 0.6265455484390259 reg_loss 0.010861893184483051
epoch: 11 s: 512000 batch_loss 0.6431041955947876 BPR_loss 0.6323851943016052 reg_loss 0.010718978941440582
epoch: 11 s: 768000 batch_loss 0.6402690410614014 BPR_loss 0.6293880343437195 reg_loss 0.010881006717681885
epoch: 11 s: 1024000 batch_loss 0.6474484801292419 BPR_loss 0.6365662813186646 reg_loss 0.01088221836835146
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 376.6598837375641 | 250.23977184295654 | 387.3287353515625 | [0.07133055 0.11598807 0.15256216] | [0.05892203 0.07573082 0.0885494 ] | [0.03232443 0.02660967 0.02350322] | [0.42209802 0.57038651 0.65624605] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.638273298740387 BPR_loss 0.6274534463882446 reg_loss 0.010819845832884312
epoch: 12 s: 256000 batch_loss 0.6335372924804688 BPR_loss 0.6226689219474792 reg_loss 0.010868346318602562
epoch: 12 s: 512000 batch_loss 0.6361663937568665 BPR_loss 0.6250976324081421 reg_loss 0.011068756692111492
epoch: 12 s: 768000 batch_loss 0.64482182264328 BPR_loss 0.6339985132217407 reg_loss 0.010823280550539494
epoch: 12 s: 1024000 batch_loss 0.6299055218696594 BPR_loss 0.6185309886932373 reg_loss 0.011374537833034992
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 357.3410279750824 | 240.10699439048767 | 386.8717956542969 | [0.07156815 0.11670096 0.1533683 ] | [0.05905401 0.07610132 0.08893935] | [0.03238127 0.02683071 0.023669  ] | [0.42358216 0.57354427 0.65687761] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.6332786083221436 BPR_loss 0.6219812035560608 reg_loss 0.011297411285340786
epoch: 13 s: 256000 batch_loss 0.6387556791305542 BPR_loss 0.6277579665184021 reg_loss 0.010997718200087547
epoch: 13 s: 512000 batch_loss 0.6419816613197327 BPR_loss 0.630720317363739 reg_loss 0.011261317878961563
epoch: 13 s: 768000 batch_loss 0.6354508399963379 BPR_loss 0.6239267587661743 reg_loss 0.011524062603712082
epoch: 13 s: 1024000 batch_loss 0.6507982611656189 BPR_loss 0.6394748687744141 reg_loss 0.011323378421366215
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 355.08225750923157 | 158.48587203025818 | 386.3857116699219 | [0.07115919 0.11639783 0.15292985] | [0.05889326 0.07594885 0.0887608 ] | [0.03219654 0.02667046 0.02353638] | [0.42089807 0.57187066 0.65643552] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.6360903382301331 BPR_loss 0.6248053908348083 reg_loss 0.011284973472356796
epoch: 14 s: 256000 batch_loss 0.6341425776481628 BPR_loss 0.6225118637084961 reg_loss 0.01163072045892477
epoch: 14 s: 512000 batch_loss 0.6350733637809753 BPR_loss 0.6234521865844727 reg_loss 0.011621189303696156
epoch: 14 s: 768000 batch_loss 0.6397737264633179 BPR_loss 0.6281447410583496 reg_loss 0.011629002168774605
epoch: 14 s: 1024000 batch_loss 0.6388073563575745 BPR_loss 0.6272027492523193 reg_loss 0.011604616418480873
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 380.1431543827057 | 138.67594408988953 | 385.88995361328125 | [0.07142097 0.11639673 0.15308807] | [0.05904439 0.07598369 0.08882017] | [0.03232443 0.02669888 0.02355111] | [0.42266641 0.5723759  0.65700392] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.6391203999519348 BPR_loss 0.6276127696037292 reg_loss 0.011507651768624783
epoch: 15 s: 256000 batch_loss 0.6399868130683899 BPR_loss 0.6283137202262878 reg_loss 0.011673115193843842
epoch: 15 s: 512000 batch_loss 0.6435143351554871 BPR_loss 0.6318308115005493 reg_loss 0.011683538556098938
epoch: 15 s: 768000 batch_loss 0.6341376900672913 BPR_loss 0.6225709915161133 reg_loss 0.01156671904027462
epoch: 15 s: 1024000 batch_loss 0.6424384713172913 BPR_loss 0.630934476852417 reg_loss 0.011504014022648335
+-------+--------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 442.83107137680054 | 170.5184886455536 | 385.66064453125 | [0.07153362 0.11667251 0.15292241] | [0.05919027 0.07617275 0.08887541] | [0.03246495 0.02678098 0.02358322] | [0.4246558  0.57161804 0.65681445] |
+-------+--------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.6354432702064514 BPR_loss 0.6236711144447327 reg_loss 0.01177218183875084
epoch: 16 s: 256000 batch_loss 0.6291514039039612 BPR_loss 0.6172282695770264 reg_loss 0.011923139914870262
epoch: 16 s: 512000 batch_loss 0.6400367617607117 BPR_loss 0.6281503438949585 reg_loss 0.011886426247656345
epoch: 16 s: 768000 batch_loss 0.6338779926300049 BPR_loss 0.6219052076339722 reg_loss 0.011972806416451931
epoch: 16 s: 1024000 batch_loss 0.6414244771003723 BPR_loss 0.6295133829116821 reg_loss 0.011911085806787014
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 423.3501024246216 | 167.79603958129883 | 385.350341796875 | [0.07160825 0.11627957 0.15287336] | [0.05919124 0.07598501 0.08881124] | [0.03246495 0.02666019 0.02354743] | [0.42424529 0.57095491 0.65697234] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.6315762996673584 BPR_loss 0.619698166847229 reg_loss 0.011878124438226223
epoch: 17 s: 256000 batch_loss 0.6392297148704529 BPR_loss 0.6270346641540527 reg_loss 0.012195057235658169
epoch: 17 s: 512000 batch_loss 0.635641872882843 BPR_loss 0.6236294507980347 reg_loss 0.012012450024485588
epoch: 17 s: 768000 batch_loss 0.6427144408226013 BPR_loss 0.6305688619613647 reg_loss 0.012145553715527058
epoch: 17 s: 1024000 batch_loss 0.6363776326179504 BPR_loss 0.6242642402648926 reg_loss 0.012113380245864391
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 409.6203382015228 | 159.7099175453186 | 385.13641357421875 | [0.07124236 0.11618897 0.15298661] | [0.05911632 0.07604084 0.08890459] | [0.0322518  0.02660493 0.02349796] | [0.42074018 0.57000758 0.65627763] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.6324984431266785 BPR_loss 0.6203784346580505 reg_loss 0.012120031751692295
epoch: 18 s: 256000 batch_loss 0.6381009221076965 BPR_loss 0.6258676052093506 reg_loss 0.012233289889991283
epoch: 18 s: 512000 batch_loss 0.6329514980316162 BPR_loss 0.6209654211997986 reg_loss 0.011986076831817627
epoch: 18 s: 768000 batch_loss 0.6468977332115173 BPR_loss 0.6349436640739441 reg_loss 0.011954092420637608
epoch: 18 s: 1024000 batch_loss 0.6435379981994629 BPR_loss 0.6316051483154297 reg_loss 0.011932839639484882
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 368.722797870636 | 192.93265008926392 | 384.8970642089844 | [0.07148415 0.11628148 0.152859  ] | [0.05915347 0.07596476 0.0887685 ] | [0.03238127 0.02661835 0.02350006] | [0.42228748 0.57010231 0.65630921] |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.6313406229019165 BPR_loss 0.6191842555999756 reg_loss 0.012156384997069836
epoch: 19 s: 256000 batch_loss 0.6358794569969177 BPR_loss 0.623569130897522 reg_loss 0.012310340069234371
epoch: 19 s: 512000 batch_loss 0.639756977558136 BPR_loss 0.6275820136070251 reg_loss 0.012174943462014198
epoch: 19 s: 768000 batch_loss 0.636502206325531 BPR_loss 0.6244111061096191 reg_loss 0.012091116979718208
epoch: 19 s: 1024000 batch_loss 0.6332144141197205 BPR_loss 0.620847225189209 reg_loss 0.012367182411253452
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 353.8195083141327 | 243.19288539886475 | 384.6038513183594 | [0.07128382 0.11618348 0.15274245] | [0.05907954 0.07597339 0.08877646] | [0.03226127 0.0266223  0.02349112] | [0.42212959 0.56962865 0.65485664] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.6357484459877014 BPR_loss 0.6235515475273132 reg_loss 0.012196915224194527
epoch: 20 s: 256000 batch_loss 0.6377701163291931 BPR_loss 0.6254346370697021 reg_loss 0.012335493229329586
epoch: 20 s: 512000 batch_loss 0.6297383308410645 BPR_loss 0.6172401905059814 reg_loss 0.01249813660979271
epoch: 20 s: 768000 batch_loss 0.6358715891838074 BPR_loss 0.6234177947044373 reg_loss 0.012453785166144371
epoch: 20 s: 1024000 batch_loss 0.633988618850708 BPR_loss 0.6215569972991943 reg_loss 0.012431631796061993
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 380.2222502231598 | 241.1583948135376 | 384.37982177734375 | [0.07124251 0.11627014 0.15282976] | [0.05906549 0.07596834 0.08875691] | [0.03229759 0.0266373  0.02348743] | [0.42171909 0.569976   0.65706707] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.6297029852867126 BPR_loss 0.6172325015068054 reg_loss 0.012470465153455734
epoch: 21 s: 256000 batch_loss 0.6405134201049805 BPR_loss 0.6280038356781006 reg_loss 0.012509581632912159
epoch: 21 s: 512000 batch_loss 0.6330142617225647 BPR_loss 0.6202864646911621 reg_loss 0.012727798894047737
epoch: 21 s: 768000 batch_loss 0.6314435601234436 BPR_loss 0.6187095642089844 reg_loss 0.012733985669910908
epoch: 21 s: 1024000 batch_loss 0.6365514993667603 BPR_loss 0.6239610910415649 reg_loss 0.012590387836098671
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 364.25300455093384 | 234.17291688919067 | 384.0825500488281 | [0.07121582 0.1160073  0.1526183 ] | [0.05913888 0.07595173 0.08876787] | [0.0322518  0.02655125 0.02343638] | [0.42175066 0.57044967 0.65526715] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.6351720690727234 BPR_loss 0.6226009726524353 reg_loss 0.012571117840707302
epoch: 22 s: 256000 batch_loss 0.6331414580345154 BPR_loss 0.6205447316169739 reg_loss 0.012596714310348034
epoch: 22 s: 512000 batch_loss 0.6380013823509216 BPR_loss 0.6255657076835632 reg_loss 0.012435697950422764
epoch: 22 s: 768000 batch_loss 0.6442612409591675 BPR_loss 0.6315625905990601 reg_loss 0.012698637321591377
epoch: 22 s: 1024000 batch_loss 0.6443067789077759 BPR_loss 0.6318854093551636 reg_loss 0.012421393766999245
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 333.7031617164612 | 228.78951954841614 | 384.0433349609375 | [0.07132652 0.11629871 0.15271332] | [0.05912866 0.07601705 0.08876288] | [0.03233706 0.02666967 0.02350954] | [0.42212959 0.57130226 0.65611974] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.6279762983322144 BPR_loss 0.6153467893600464 reg_loss 0.012629483826458454
epoch: 23 s: 256000 batch_loss 0.6414194107055664 BPR_loss 0.6287999749183655 reg_loss 0.012619451619684696
epoch: 23 s: 512000 batch_loss 0.6348673105239868 BPR_loss 0.6222339272499084 reg_loss 0.012633400969207287
epoch: 23 s: 768000 batch_loss 0.6404188275337219 BPR_loss 0.6277666687965393 reg_loss 0.012652144767343998
epoch: 23 s: 1024000 batch_loss 0.6244917511940002 BPR_loss 0.6117380857467651 reg_loss 0.012753666378557682
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 337.8073785305023 | 211.86507058143616 | 383.77508544921875 | [0.07123109 0.11599279 0.1531724 ] | [0.05896429 0.07577045 0.08875262] | [0.03228811 0.02658046 0.0235169 ] | [0.42146646 0.56984969 0.65703549] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.6328314542770386 BPR_loss 0.6201436519622803 reg_loss 0.012687808834016323
epoch: 24 s: 256000 batch_loss 0.639728307723999 BPR_loss 0.6269600987434387 reg_loss 0.012768193148076534
epoch: 24 s: 512000 batch_loss 0.639456033706665 BPR_loss 0.6266768574714661 reg_loss 0.012779154814779758
epoch: 24 s: 768000 batch_loss 0.6389037370681763 BPR_loss 0.6262933015823364 reg_loss 0.012610452249646187
epoch: 24 s: 1024000 batch_loss 0.640565037727356 BPR_loss 0.6279488205909729 reg_loss 0.01261624600738287
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 373.5825526714325 | 250.2340428829193 | 383.725341796875 | [0.07120705 0.11611525 0.15287718] | [0.05887113 0.07573565 0.08858175] | [0.03225654 0.02659388 0.02347638] | [0.42083491 0.57139699 0.65700392] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.6291089057922363 BPR_loss 0.6163350343704224 reg_loss 0.012773886322975159
epoch: 25 s: 256000 batch_loss 0.64156174659729 BPR_loss 0.6285362839698792 reg_loss 0.01302543468773365
epoch: 25 s: 512000 batch_loss 0.6334668397903442 BPR_loss 0.6205263137817383 reg_loss 0.012940538115799427
epoch: 25 s: 768000 batch_loss 0.6363130211830139 BPR_loss 0.623471200466156 reg_loss 0.012841836549341679
epoch: 25 s: 1024000 batch_loss 0.6405823826789856 BPR_loss 0.6277780532836914 reg_loss 0.012804301455616951
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 374.11072850227356 | 244.85159873962402 | 383.43829345703125 | [0.07094304 0.11562643 0.15254852] | [0.05869541 0.07551391 0.08846556] | [0.03212391 0.02650388 0.02348217] | [0.41988758 0.57003916 0.65482506] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.6324162483215332 BPR_loss 0.6196764707565308 reg_loss 0.012739772908389568
epoch: 26 s: 256000 batch_loss 0.6315627098083496 BPR_loss 0.618516743183136 reg_loss 0.013045948930084705
epoch: 26 s: 512000 batch_loss 0.6265438199043274 BPR_loss 0.6134176850318909 reg_loss 0.013126114383339882
epoch: 26 s: 768000 batch_loss 0.6380271315574646 BPR_loss 0.6251351833343506 reg_loss 0.012891937978565693
epoch: 26 s: 1024000 batch_loss 0.6326109766960144 BPR_loss 0.6196028590202332 reg_loss 0.013008099980652332
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 337.92755222320557 | 165.7451639175415 | 383.2587585449219 | [0.07060509 0.11569285 0.15211381] | [0.05841803 0.07532818 0.08811279] | [0.03198813 0.02640126 0.02333691] | [0.41840344 0.56877605 0.65520399] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.07060509041811741
early stopping at 26, recall@20:0.0716
