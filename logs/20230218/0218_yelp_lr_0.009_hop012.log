Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='yelp2018', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=2, l2=0.001, lr=0.009, mess_dropout=False, mess_dropout_rate=0.1, n_negs=64, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上进行softmax自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.693148136138916 BPR_loss 0.6931480169296265 reg_loss 1.4682098026241874e-07
epoch: 0 s: 256000 batch_loss 0.6849678158760071 BPR_loss 0.6831660270690918 reg_loss 0.0018018141854554415
epoch: 0 s: 512000 batch_loss 0.6852509379386902 BPR_loss 0.6820688247680664 reg_loss 0.0031820982694625854
epoch: 0 s: 768000 batch_loss 0.6839618682861328 BPR_loss 0.679958164691925 reg_loss 0.004003731068223715
epoch: 0 s: 1024000 batch_loss 0.678859293460846 BPR_loss 0.6736745238304138 reg_loss 0.005184791050851345
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 206.58312368392944 | 44.71055603027344 | 411.76788330078125 | [0.06163957 0.10242772 0.13580867] | [0.05032936 0.06570092 0.07741262] | [0.02823355 0.02365637 0.02107332] | [0.37889984 0.52895668 0.61768978] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6732763648033142 BPR_loss 0.6677430868148804 reg_loss 0.005533253308385611
epoch: 1 s: 256000 batch_loss 0.667650043964386 BPR_loss 0.661004900932312 reg_loss 0.006645125336945057
epoch: 1 s: 512000 batch_loss 0.668072521686554 BPR_loss 0.6609750390052795 reg_loss 0.007097506895661354
epoch: 1 s: 768000 batch_loss 0.6647518277168274 BPR_loss 0.6572303175926208 reg_loss 0.007521480787545443
epoch: 1 s: 1024000 batch_loss 0.6660863161087036 BPR_loss 0.6580654978752136 reg_loss 0.008020827546715736
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 221.07917833328247 | 45.17629337310791 | 404.8180847167969 | [0.0657733  0.10816177 0.14329444] | [0.05407068 0.07008688 0.08239209] | [0.03000347 0.02502605 0.02224591] | [0.3974359  0.54701907 0.63622584] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6615489721298218 BPR_loss 0.6531919240951538 reg_loss 0.008357025682926178
epoch: 2 s: 256000 batch_loss 0.6636269688606262 BPR_loss 0.6550217866897583 reg_loss 0.008605210110545158
epoch: 2 s: 512000 batch_loss 0.6687559485435486 BPR_loss 0.6599379777908325 reg_loss 0.008817948400974274
epoch: 2 s: 768000 batch_loss 0.6664846539497375 BPR_loss 0.656998872756958 reg_loss 0.009485773742198944
epoch: 2 s: 1024000 batch_loss 0.6561614274978638 BPR_loss 0.6464813947677612 reg_loss 0.00968003086745739
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 218.37694787979126 | 41.49448347091675 | 401.2657775878906 | [0.0679553  0.11118896 0.14713312] | [0.0557622  0.07210831 0.08471323] | [0.03081502 0.02563155 0.02278115] | [0.40754074 0.55725022 0.64459391] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6550843119621277 BPR_loss 0.6451740264892578 reg_loss 0.009910299442708492
epoch: 3 s: 256000 batch_loss 0.663432240486145 BPR_loss 0.6534905433654785 reg_loss 0.00994172040373087
epoch: 3 s: 512000 batch_loss 0.6538510918617249 BPR_loss 0.6434606313705444 reg_loss 0.010390463285148144
epoch: 3 s: 768000 batch_loss 0.6604698896408081 BPR_loss 0.6499470472335815 reg_loss 0.01052284799516201
epoch: 3 s: 1024000 batch_loss 0.6620619297027588 BPR_loss 0.6514349579811096 reg_loss 0.010626960545778275
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 221.5252549648285 | 40.81299591064453 | 398.8957214355469 | [0.06951737 0.11382714 0.14934057] | [0.05722769 0.07397836 0.08638273] | [0.03153815 0.02625047 0.02307324] | [0.41404572 0.5639131  0.648699  ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.6598208546638489 BPR_loss 0.6488877534866333 reg_loss 0.010933085344731808
epoch: 4 s: 256000 batch_loss 0.6501638889312744 BPR_loss 0.6386518478393555 reg_loss 0.011512037366628647
epoch: 4 s: 512000 batch_loss 0.6580770015716553 BPR_loss 0.6468378305435181 reg_loss 0.011239167302846909
epoch: 4 s: 768000 batch_loss 0.6577885150909424 BPR_loss 0.6461461782455444 reg_loss 0.01164232287555933
epoch: 4 s: 1024000 batch_loss 0.6629913449287415 BPR_loss 0.6513398885726929 reg_loss 0.011651478707790375
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 223.65776658058167 | 101.0523087978363 | 397.1133728027344 | [0.06978787 0.11447793 0.15064708] | [0.0575027  0.07433799 0.08700319] | [0.0316913  0.02628679 0.02322639] | [0.41600354 0.56637615 0.653783  ] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.6527711153030396 BPR_loss 0.6407836079597473 reg_loss 0.011987521313130856
epoch: 5 s: 256000 batch_loss 0.6513791084289551 BPR_loss 0.638885498046875 reg_loss 0.012493596412241459
epoch: 5 s: 512000 batch_loss 0.6569207310676575 BPR_loss 0.6448853015899658 reg_loss 0.01203544158488512
epoch: 5 s: 768000 batch_loss 0.6550567150115967 BPR_loss 0.6429024934768677 reg_loss 0.01215420663356781
epoch: 5 s: 1024000 batch_loss 0.6541993021965027 BPR_loss 0.641852080821991 reg_loss 0.012347220443189144
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 367.0920171737671 | 194.03087067604065 | 395.60992431640625 | [0.07067193 0.11499538 0.15154475] | [0.05824089 0.07497284 0.08775772] | [0.03205602 0.02647941 0.0233948 ] | [0.41878237 0.56666035 0.65173045] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.6496374607086182 BPR_loss 0.6367306113243103 reg_loss 0.012906822375953197
epoch: 6 s: 256000 batch_loss 0.6529073715209961 BPR_loss 0.64019376039505 reg_loss 0.01271361019462347
epoch: 6 s: 512000 batch_loss 0.6445373296737671 BPR_loss 0.6313004493713379 reg_loss 0.01323690451681614
epoch: 6 s: 768000 batch_loss 0.6533079743385315 BPR_loss 0.6403723955154419 reg_loss 0.012935571372509003
epoch: 6 s: 1024000 batch_loss 0.6577091813087463 BPR_loss 0.6448372602462769 reg_loss 0.012871931307017803
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 410.35751509666443 | 180.32245635986328 | 394.5058898925781 | [0.07091846 0.11593425 0.15228455] | [0.05836403 0.07531267 0.08803284] | [0.03219022 0.0266444  0.02347533] | [0.42115069 0.57101806 0.65580397] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.6480605602264404 BPR_loss 0.6346620321273804 reg_loss 0.013398525305092335
epoch: 7 s: 256000 batch_loss 0.6508676409721375 BPR_loss 0.6370183229446411 reg_loss 0.01384932640939951
epoch: 7 s: 512000 batch_loss 0.6470012068748474 BPR_loss 0.6331281661987305 reg_loss 0.013873032294213772
epoch: 7 s: 768000 batch_loss 0.6531468629837036 BPR_loss 0.6395167708396912 reg_loss 0.01363008189946413
epoch: 7 s: 1024000 batch_loss 0.6605865955352783 BPR_loss 0.6470887660980225 reg_loss 0.013497830368578434
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 407.90338110923767 | 175.25149250030518 | 393.60296630859375 | [0.07098224 0.11590729 0.15207803] | [0.0585585  0.07548595 0.08818497] | [0.0321918  0.02661441 0.02347322] | [0.4215612  0.57044967 0.65441455] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.6481024622917175 BPR_loss 0.6343461275100708 reg_loss 0.013756363652646542
epoch: 8 s: 256000 batch_loss 0.6468596458435059 BPR_loss 0.6327033042907715 reg_loss 0.014156368561089039
epoch: 8 s: 512000 batch_loss 0.6431735157966614 BPR_loss 0.6284225583076477 reg_loss 0.01475093699991703
epoch: 8 s: 768000 batch_loss 0.6426776647567749 BPR_loss 0.6283197402954102 reg_loss 0.014357914216816425
epoch: 8 s: 1024000 batch_loss 0.6551173329353333 BPR_loss 0.6407821178436279 reg_loss 0.014335193671286106
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 409.0510938167572 | 147.3368628025055 | 392.8777770996094 | [0.07122313 0.11666724 0.15337114] | [0.05869868 0.07582078 0.08868534] | [0.03222338 0.02673914 0.02362532] | [0.42108753 0.57297587 0.65804598] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.6403809785842896 BPR_loss 0.6254386901855469 reg_loss 0.014942310750484467
epoch: 9 s: 256000 batch_loss 0.6505855917930603 BPR_loss 0.6360830664634705 reg_loss 0.014502541162073612
epoch: 9 s: 512000 batch_loss 0.646105945110321 BPR_loss 0.6314378976821899 reg_loss 0.014668050222098827
epoch: 9 s: 768000 batch_loss 0.6463545560836792 BPR_loss 0.6315187215805054 reg_loss 0.014835861511528492
epoch: 9 s: 1024000 batch_loss 0.646228551864624 BPR_loss 0.6310420036315918 reg_loss 0.015186536125838757
+-------+------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 398.649893283844 | 116.34412503242493 | 392.044189453125 | [0.07147577 0.11617175 0.15341736] | [0.05891231 0.0757474  0.08879206] | [0.0324239  0.02668782 0.02363637] | [0.42143489 0.57177593 0.65776178] |
+-------+------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.6497698426246643 BPR_loss 0.6348531246185303 reg_loss 0.01491672731935978
epoch: 10 s: 256000 batch_loss 0.6481509208679199 BPR_loss 0.6330904960632324 reg_loss 0.015060421079397202
epoch: 10 s: 512000 batch_loss 0.6492888927459717 BPR_loss 0.6342228055000305 reg_loss 0.015066099353134632
epoch: 10 s: 768000 batch_loss 0.6451014876365662 BPR_loss 0.6300690174102783 reg_loss 0.015032490715384483
epoch: 10 s: 1024000 batch_loss 0.6525570750236511 BPR_loss 0.6372984647750854 reg_loss 0.015258620493113995
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 423.9561998844147 | 221.94139003753662 | 391.544677734375 | [0.07128876 0.11667188 0.15323128] | [0.05890202 0.07599064 0.08879549] | [0.03232601 0.02674151 0.02357953] | [0.42048756 0.57259694 0.65788809] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.6459692716598511 BPR_loss 0.6306954622268677 reg_loss 0.01527381595224142
epoch: 11 s: 256000 batch_loss 0.6427167057991028 BPR_loss 0.627199649810791 reg_loss 0.015517067164182663
epoch: 11 s: 512000 batch_loss 0.6493165493011475 BPR_loss 0.6340391635894775 reg_loss 0.015277395024895668
epoch: 11 s: 768000 batch_loss 0.6466888785362244 BPR_loss 0.6313257813453674 reg_loss 0.015363105572760105
epoch: 11 s: 1024000 batch_loss 0.6542661786079407 BPR_loss 0.6387132406234741 reg_loss 0.015552914701402187
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 409.66497826576233 | 213.43509316444397 | 391.0403137207031 | [0.07137105 0.11611631 0.1523489 ] | [0.05885191 0.07571719 0.08842138] | [0.03228338 0.02661204 0.02345164] | [0.42203486 0.57041809 0.65624605] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.6448169946670532 BPR_loss 0.6293299794197083 reg_loss 0.015487044118344784
epoch: 12 s: 256000 batch_loss 0.6393441557884216 BPR_loss 0.6238012313842773 reg_loss 0.015542950481176376
epoch: 12 s: 512000 batch_loss 0.6419035196304321 BPR_loss 0.6261352300643921 reg_loss 0.015768272802233696
epoch: 12 s: 768000 batch_loss 0.6503336429595947 BPR_loss 0.6349982023239136 reg_loss 0.015335427597165108
epoch: 12 s: 1024000 batch_loss 0.6370278596878052 BPR_loss 0.6206963062286377 reg_loss 0.01633155159652233
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 373.77304100990295 | 228.7768006324768 | 390.6329345703125 | [0.07164259 0.11671414 0.15330167] | [0.05918184 0.07618692 0.08900462] | [0.03245863 0.0268165  0.0236469 ] | [0.42326639 0.57199697 0.65709865] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.6392402648925781 BPR_loss 0.6230341196060181 reg_loss 0.016206154599785805
epoch: 13 s: 256000 batch_loss 0.6452890634536743 BPR_loss 0.6296660900115967 reg_loss 0.015622979030013084
epoch: 13 s: 512000 batch_loss 0.6481083631515503 BPR_loss 0.632112979888916 reg_loss 0.015995364636182785
epoch: 13 s: 768000 batch_loss 0.6424333453178406 BPR_loss 0.6260179281234741 reg_loss 0.016415389254689217
epoch: 13 s: 1024000 batch_loss 0.6564276218414307 BPR_loss 0.6404872536659241 reg_loss 0.01594039425253868
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 344.5572910308838 | 231.64942574501038 | 390.22222900390625 | [0.07134395 0.11651255 0.15304496] | [0.0588893  0.07590968 0.08871567] | [0.03227864 0.02667046 0.02352217] | [0.42175066 0.57063913 0.65675129] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.642558217048645 BPR_loss 0.6263914704322815 reg_loss 0.016166722401976585
epoch: 14 s: 256000 batch_loss 0.6397753953933716 BPR_loss 0.6233158111572266 reg_loss 0.01645960845053196
epoch: 14 s: 512000 batch_loss 0.6419378519058228 BPR_loss 0.6254580020904541 reg_loss 0.016479846090078354
epoch: 14 s: 768000 batch_loss 0.6458784341812134 BPR_loss 0.6294022798538208 reg_loss 0.016476154327392578
epoch: 14 s: 1024000 batch_loss 0.6452897787094116 BPR_loss 0.6288052797317505 reg_loss 0.016484497115015984
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 341.67667984962463 | 257.6388039588928 | 389.77496337890625 | [0.07139536 0.11645875 0.15278121] | [0.05895181 0.07595132 0.08868929] | [0.0322739  0.02668309 0.0235248 ] | [0.42171909 0.57123911 0.65567766] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.6437876224517822 BPR_loss 0.6273209452629089 reg_loss 0.016466686502099037
epoch: 15 s: 256000 batch_loss 0.6456572413444519 BPR_loss 0.629065990447998 reg_loss 0.01659124530851841
epoch: 15 s: 512000 batch_loss 0.6479162573814392 BPR_loss 0.6313362121582031 reg_loss 0.016580069437623024
epoch: 15 s: 768000 batch_loss 0.6413846015930176 BPR_loss 0.6250460743904114 reg_loss 0.01633850298821926
epoch: 15 s: 1024000 batch_loss 0.6496949791908264 BPR_loss 0.6333553791046143 reg_loss 0.016339609399437904
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 372.46882152557373 | 265.67295932769775 | 389.5877685546875 | [0.07183796 0.11672753 0.15283695] | [0.05919277 0.07612791 0.08878434] | [0.0325281  0.02678492 0.02356164] | [0.42459265 0.57234432 0.65548819] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.640938937664032 BPR_loss 0.6242938041687012 reg_loss 0.016645124182105064
epoch: 16 s: 256000 batch_loss 0.6369655728340149 BPR_loss 0.6200093030929565 reg_loss 0.016956258565187454
epoch: 16 s: 512000 batch_loss 0.6455108523368835 BPR_loss 0.6284903287887573 reg_loss 0.01702052354812622
epoch: 16 s: 768000 batch_loss 0.6406159996986389 BPR_loss 0.62370765209198 reg_loss 0.016908328980207443
epoch: 16 s: 1024000 batch_loss 0.6478263139724731 BPR_loss 0.63075852394104 reg_loss 0.017067791894078255
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 352.3420045375824 | 259.46980333328247 | 389.3071594238281 | [0.07184069 0.11628198 0.15330119] | [0.05928727 0.07604621 0.08899548] | [0.03249495 0.02668309 0.02358427] | [0.42437161 0.57000758 0.65678287] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.6394458413124084 BPR_loss 0.6225583553314209 reg_loss 0.016887471079826355
epoch: 17 s: 256000 batch_loss 0.6459921002388 BPR_loss 0.6288038492202759 reg_loss 0.01718827337026596
epoch: 17 s: 512000 batch_loss 0.642704963684082 BPR_loss 0.6258039474487305 reg_loss 0.016901012510061264
epoch: 17 s: 768000 batch_loss 0.6499313712120056 BPR_loss 0.6326234936714172 reg_loss 0.017307884991168976
epoch: 17 s: 1024000 batch_loss 0.6428338289260864 BPR_loss 0.6255648136138916 reg_loss 0.01726900227367878
+-------+------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |  tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 337.489458322525 | 241.298424243927 | 389.1249694824219 | [0.07141942 0.11639741 0.15321784] | [0.05907954 0.07605728 0.08894512] | [0.03228969 0.02666809 0.02354638] | [0.42067702 0.56959707 0.65719338] |
+-------+------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.6396427750587463 BPR_loss 0.6223741173744202 reg_loss 0.017268642783164978
epoch: 18 s: 256000 batch_loss 0.6456228494644165 BPR_loss 0.6282361149787903 reg_loss 0.017386743798851967
epoch: 18 s: 512000 batch_loss 0.6395765542984009 BPR_loss 0.6225628852844238 reg_loss 0.0170136708766222
epoch: 18 s: 768000 batch_loss 0.6517841219902039 BPR_loss 0.6348912715911865 reg_loss 0.016892878338694572
epoch: 18 s: 1024000 batch_loss 0.6491860747337341 BPR_loss 0.6321721076965332 reg_loss 0.017013952136039734
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 336.1109335422516 | 271.0700671672821 | 388.927001953125 | [0.071567   0.11627639 0.15291213] | [0.05929787 0.07613555 0.08895851] | [0.03240021 0.02665388 0.02352375] | [0.4228243  0.57089175 0.65570923] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.6388546824455261 BPR_loss 0.6217371225357056 reg_loss 0.01711755245923996
epoch: 19 s: 256000 batch_loss 0.6423176527023315 BPR_loss 0.6249599456787109 reg_loss 0.017357703298330307
epoch: 19 s: 512000 batch_loss 0.6444363594055176 BPR_loss 0.6274141073226929 reg_loss 0.017022253945469856
epoch: 19 s: 768000 batch_loss 0.6423787474632263 BPR_loss 0.6252990961074829 reg_loss 0.01707964390516281
epoch: 19 s: 1024000 batch_loss 0.6404443383216858 BPR_loss 0.6228156685829163 reg_loss 0.017628667876124382
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 370.0732355117798 | 270.4586269855499 | 388.6440734863281 | [0.07151376 0.11634501 0.15245451] | [0.05919236 0.07606048 0.08871944] | [0.03242074 0.02668703 0.02349164] | [0.42377163 0.57010231 0.65473033] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.6417533755302429 BPR_loss 0.6245936155319214 reg_loss 0.01715976931154728
epoch: 20 s: 256000 batch_loss 0.6442493200302124 BPR_loss 0.6267573237419128 reg_loss 0.017492009326815605
epoch: 20 s: 512000 batch_loss 0.6362695097923279 BPR_loss 0.6184787750244141 reg_loss 0.01779075525701046
epoch: 20 s: 768000 batch_loss 0.6426069736480713 BPR_loss 0.6248289942741394 reg_loss 0.017777958884835243
epoch: 20 s: 1024000 batch_loss 0.6407383680343628 BPR_loss 0.6230912208557129 reg_loss 0.017647158354520798
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 360.4453139305115 | 254.80550527572632 | 388.4639892578125 | [0.07104867 0.1164307  0.15296545] | [0.05881317 0.0759054  0.08869797] | [0.03221549 0.02669256 0.02353427] | [0.42115069 0.57029178 0.65700392] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.637901782989502 BPR_loss 0.6200735569000244 reg_loss 0.01782822608947754
epoch: 21 s: 256000 batch_loss 0.6466759443283081 BPR_loss 0.6288869380950928 reg_loss 0.017789024859666824
epoch: 21 s: 512000 batch_loss 0.6410728693008423 BPR_loss 0.6229311227798462 reg_loss 0.018141770735383034
epoch: 21 s: 768000 batch_loss 0.6375293135643005 BPR_loss 0.6194848418235779 reg_loss 0.018044447526335716
epoch: 21 s: 1024000 batch_loss 0.6429453492164612 BPR_loss 0.6250686645507812 reg_loss 0.01787669025361538
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 344.60700273513794 | 193.21447229385376 | 388.1859436035156 | [0.0710135  0.1162019  0.15295453] | [0.05876849 0.07579718 0.08866846] | [0.03215549 0.02661362 0.02348954] | [0.42096122 0.56928129 0.65634079] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.6411550045013428 BPR_loss 0.6235175132751465 reg_loss 0.017637470737099648
epoch: 22 s: 256000 batch_loss 0.6397799253463745 BPR_loss 0.6219775676727295 reg_loss 0.017802361398935318
epoch: 22 s: 512000 batch_loss 0.6441905498504639 BPR_loss 0.6264280080795288 reg_loss 0.017762530595064163
epoch: 22 s: 768000 batch_loss 0.6502529382705688 BPR_loss 0.6321269273757935 reg_loss 0.018125999718904495
epoch: 22 s: 1024000 batch_loss 0.6512109637260437 BPR_loss 0.6337924003601074 reg_loss 0.017418568953871727
+-------+--------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 370.77700090408325 | 198.3676369190216 | 388.17333984375 | [0.07110212 0.11601655 0.15277917] | [0.05898079 0.07589848 0.08877478] | [0.03223917 0.02662941 0.02353901] | [0.41988758 0.57044967 0.65583554] |
+-------+--------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.6353332996368408 BPR_loss 0.6173855662345886 reg_loss 0.017947738990187645
epoch: 23 s: 256000 batch_loss 0.6468984484672546 BPR_loss 0.6290813088417053 reg_loss 0.017817115411162376
epoch: 23 s: 512000 batch_loss 0.6407044529914856 BPR_loss 0.6227536201477051 reg_loss 0.01795082539319992
epoch: 23 s: 768000 batch_loss 0.6463638544082642 BPR_loss 0.6285015344619751 reg_loss 0.01786232553422451
epoch: 23 s: 1024000 batch_loss 0.6315038800239563 BPR_loss 0.6134065389633179 reg_loss 0.01809731312096119
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 382.6676404476166 | 260.69408321380615 | 387.9280700683594 | [0.07122759 0.11597257 0.15254719] | [0.05882587 0.07570894 0.08850515] | [0.0322518  0.02660651 0.02346006] | [0.42140331 0.56956549 0.65586712] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.6389216780662537 BPR_loss 0.620908796787262 reg_loss 0.018012860789895058
epoch: 24 s: 256000 batch_loss 0.6462082266807556 BPR_loss 0.628258466720581 reg_loss 0.017949778586626053
epoch: 24 s: 512000 batch_loss 0.6465556025505066 BPR_loss 0.6287021636962891 reg_loss 0.017853425815701485
epoch: 24 s: 768000 batch_loss 0.6456586122512817 BPR_loss 0.6277976036071777 reg_loss 0.017861023545265198
epoch: 24 s: 1024000 batch_loss 0.6479246020317078 BPR_loss 0.6301449537277222 reg_loss 0.017779624089598656
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 372.0923659801483 | 257.0252230167389 | 387.8848571777344 | [0.07121481 0.11591868 0.15242105] | [0.05874765 0.07564133 0.08840427] | [0.03214601 0.02657493 0.02341901] | [0.42058229 0.57092333 0.65653025] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.6362680196762085 BPR_loss 0.617965817451477 reg_loss 0.018302232027053833
epoch: 25 s: 256000 batch_loss 0.6476182341575623 BPR_loss 0.6292431950569153 reg_loss 0.018375063315033913
epoch: 25 s: 512000 batch_loss 0.6405133008956909 BPR_loss 0.6221859455108643 reg_loss 0.018327340483665466
epoch: 25 s: 768000 batch_loss 0.6436915993690491 BPR_loss 0.6254859566688538 reg_loss 0.0182056687772274
epoch: 25 s: 1024000 batch_loss 0.6457837224006653 BPR_loss 0.6275604963302612 reg_loss 0.01822320744395256
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 332.8575584888458 | 194.37368273735046 | 387.60809326171875 | [0.07105881 0.11594377 0.15229989] | [0.05882963 0.07574111 0.08846975] | [0.03220128 0.02657493 0.02343112] | [0.41995074 0.56887078 0.65441455] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.6394050121307373 BPR_loss 0.6213924288749695 reg_loss 0.01801256462931633
epoch: 26 s: 256000 batch_loss 0.6386251449584961 BPR_loss 0.6201117634773254 reg_loss 0.018513401970267296
epoch: 26 s: 512000 batch_loss 0.63462895154953 BPR_loss 0.6159701347351074 reg_loss 0.018658842891454697
epoch: 26 s: 768000 batch_loss 0.6454343795776367 BPR_loss 0.627124547958374 reg_loss 0.018309827893972397
epoch: 26 s: 1024000 batch_loss 0.6394104957580566 BPR_loss 0.6211155652999878 reg_loss 0.018294917419552803
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 308.2923150062561 | 193.68489456176758 | 387.4820556640625 | [0.07100253 0.11558351 0.15177864] | [0.05859572 0.07538095 0.08805941] | [0.03213496 0.02644389 0.02330218] | [0.4201402  0.56735506 0.65387773] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.07100253231497042
early stopping at 26, recall@20:0.0718
