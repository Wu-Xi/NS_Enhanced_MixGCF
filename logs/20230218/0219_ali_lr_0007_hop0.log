Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ali', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.001, lr=0.007, mess_dropout=False, mess_dropout_rate=0.1, n_negs=32, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上进行softmax自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931480169296265 BPR_loss 0.6931477785110474 reg_loss 2.222623010084135e-07
epoch: 0 s: 256000 batch_loss 0.6733982563018799 BPR_loss 0.6713975667953491 reg_loss 0.0020007030107080936
epoch: 0 s: 512000 batch_loss 0.648474395275116 BPR_loss 0.643828272819519 reg_loss 0.004646110348403454
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 48.480000257492065 | 196.15002179145813 | 236.6737518310547 | [0.06549381 0.09597974 0.1176871 ] | [0.0294897  0.03604203 0.04011494] | [0.00390285 0.00292007 0.00241437] | [0.07626441 0.11194915 0.13718217] |
|   0   | 48.480000257492065 | 285.2848744392395  | 236.6737518310547 | [0.00917513 0.0159586  0.02273493] | [0.0037272  0.00513937 0.00636933] | [0.00049133 0.00043666 0.00041843] | [0.009738   0.01724469 0.0247366 ] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6045570373535156 BPR_loss 0.5969530940055847 reg_loss 0.007603922393172979
epoch: 1 s: 256000 batch_loss 0.5744822025299072 BPR_loss 0.5634684562683105 reg_loss 0.011013749055564404
epoch: 1 s: 512000 batch_loss 0.5559266805648804 BPR_loss 0.541966438293457 reg_loss 0.013960260897874832
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 67.87747383117676 | 365.9306914806366  | 204.52455139160156 | [0.0727415  0.10251799 0.12315032] | [0.03389044 0.04030669 0.04416652] | [0.00429375 0.00308588 0.00249963] | [0.08380674 0.11882963 0.14279411] |
|   1   | 67.87747383117676 | 350.13641452789307 | 204.52455139160156 | [0.01366178 0.02216172 0.03040746] | [0.00557881 0.00733872 0.00884089] | [0.00072629 0.00059736 0.00055537] | [0.01443707 0.02371699 0.03289347] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.5167629718780518 BPR_loss 0.5009254217147827 reg_loss 0.015837576240301132
epoch: 2 s: 256000 batch_loss 0.5070364475250244 BPR_loss 0.48928260803222656 reg_loss 0.017753850668668747
epoch: 2 s: 512000 batch_loss 0.4992905855178833 BPR_loss 0.47957682609558105 reg_loss 0.019713744521141052
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 69.73002338409424 | 365.58269572257996 | 180.2252655029297 | [0.07317931 0.10216314 0.12267144] | [0.03438686 0.04062271 0.04446159] | [0.0043165  0.00307036 0.00248745] | [0.08426176 0.1182643  0.14207711] |
|   2   | 69.73002338409424 | 349.4164402484894  | 180.2252655029297 | [0.01553415 0.02530268 0.03302719] | [0.00638721 0.00841638 0.00982698] | [0.00082825 0.00068306 0.00060487] | [0.01647629 0.02711569 0.03583408] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.4737028479576111 BPR_loss 0.4530060589313507 reg_loss 0.02069677785038948
epoch: 3 s: 256000 batch_loss 0.46560534834861755 BPR_loss 0.44335293769836426 reg_loss 0.02225240133702755
epoch: 3 s: 512000 batch_loss 0.4656530022621155 BPR_loss 0.4428960084915161 reg_loss 0.02275698445737362
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 67.13778781890869 | 375.5655801296234  | 167.52955627441406 | [0.07243474 0.09931287 0.11882024] | [0.03418905 0.03997713 0.04362895] | [0.0042648  0.00298039 0.00240863] | [0.08308974 0.11473443 0.13749931] |
|   3   | 67.13778781890869 | 350.54389333724976 | 167.52955627441406 | [0.01651091 0.02653976 0.03471964] | [0.00682343 0.00890267 0.01040072] | [0.00088071 0.00071853 0.00063861] | [0.01748112 0.02853428 0.03779942] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.44627079367637634 BPR_loss 0.4226497411727905 reg_loss 0.02362104505300522
epoch: 4 s: 256000 batch_loss 0.44124653935432434 BPR_loss 0.41696402430534363 reg_loss 0.024282528087496758
epoch: 4 s: 512000 batch_loss 0.4498901069164276 BPR_loss 0.425007700920105 reg_loss 0.02488241158425808
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 68.20839524269104 | 372.3100411891937  | 160.66209411621094 | [0.07050799 0.09749697 0.11592527] | [0.03356966 0.0393696  0.04281617] | [0.00417448 0.00293455 0.00235095] | [0.08131101 0.11288677 0.13447962] |
|   4   | 68.20839524269104 | 344.06905937194824 | 160.66209411621094 | [0.01641535 0.02658518 0.03486949] | [0.00688534 0.00900244 0.01051394] | [0.00087923 0.00072185 0.0006423 ] | [0.01748112 0.02862294 0.03802107] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.4291152358055115 BPR_loss 0.40378910303115845 reg_loss 0.025326134636998177
epoch: 5 s: 256000 batch_loss 0.43474045395851135 BPR_loss 0.40930378437042236 reg_loss 0.02543666400015354
epoch: 5 s: 512000 batch_loss 0.4379480183124542 BPR_loss 0.41228365898132324 reg_loss 0.02566436119377613
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 65.72134327888489 | 394.1751878261566 | 156.5081329345703 | [0.07024446 0.09648132 0.11520226] | [0.03340218 0.03904966 0.04255019] | [0.00415518 0.00290456 0.00233578] | [0.08081463 0.11167338 0.1334179 ] |
|   5   | 65.72134327888489 | 364.7719190120697 | 156.5081329345703 | [0.01665005 0.02707884 0.03523994] | [0.00691979 0.00909109 0.01058635] | [0.00089031 0.00073515 0.00065068] | [0.01770278 0.02916968 0.03852349] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.424175888299942 BPR_loss 0.39817413687705994 reg_loss 0.026001764461398125
epoch: 6 s: 256000 batch_loss 0.4202577471733093 BPR_loss 0.3941992521286011 reg_loss 0.026058504357933998
epoch: 6 s: 512000 batch_loss 0.4356142580509186 BPR_loss 0.40915635228157043 reg_loss 0.026457909494638443
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 65.44445300102234 |  379.981502532959 | 153.4082489013672 | [0.06925487 0.09631587 0.11497309] | [0.03301187 0.03883958 0.04233753] | [0.00410071 0.00290352 0.00233555] | [0.07978049 0.1115217  0.13323865] |
|   6   | 65.44445300102234 | 352.1161620616913 | 153.4082489013672 | [0.01616809 0.0266948  0.03514079] | [0.00672988 0.00892345 0.01047039] | [0.00086223 0.00072407 0.00064846] | [0.01715603 0.0287116  0.03836094] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.404498815536499 BPR_loss 0.3776713013648987 reg_loss 0.026827502995729446
epoch: 7 s: 256000 batch_loss 0.4221242368221283 BPR_loss 0.3954721689224243 reg_loss 0.02665206417441368
epoch: 7 s: 512000 batch_loss 0.4276030659675598 BPR_loss 0.40071871876716614 reg_loss 0.026884347200393677
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 64.25857877731323 | 380.77798795700073 | 151.4805908203125 | [0.06884938 0.09471535 0.11333863] | [0.03272094 0.03829877 0.04179467] | [0.00406486 0.00285492 0.00230521] | [0.07904969 0.10943963 0.13140478] |
|   7   | 64.25857877731323 | 349.6055042743683  | 151.4805908203125 | [0.0163459  0.02670565 0.03487135] | [0.00677413 0.0089433  0.0104352 ] | [0.00086962 0.00072592 0.0006423 ] | [0.0173038  0.02881504 0.03799152] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.40819305181503296 BPR_loss 0.3812870979309082 reg_loss 0.026905953884124756
epoch: 8 s: 256000 batch_loss 0.4122439920902252 BPR_loss 0.38499149680137634 reg_loss 0.027252504602074623
epoch: 8 s: 512000 batch_loss 0.42167073488235474 BPR_loss 0.3943125307559967 reg_loss 0.02735821157693863
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 66.98808407783508 | 385.2416887283325 | 149.9137420654297 | [0.06860779 0.09472066 0.11340249] | [0.03252327 0.03814998 0.04164003] | [0.00405314 0.00285285 0.00229878] | [0.07898075 0.10957752 0.13143235] |
|   8   | 66.98808407783508 | 349.5888526439667 | 149.9137420654297 | [0.01623691 0.0260563  0.03406849] | [0.00673115 0.00877882 0.01023839] | [0.00086445 0.00070966 0.00062753] | [0.01717081 0.02816485 0.03714923] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.40991905331611633 BPR_loss 0.382601797580719 reg_loss 0.027317263185977936
epoch: 9 s: 256000 batch_loss 0.41571706533432007 BPR_loss 0.38826897740364075 reg_loss 0.027448080480098724
epoch: 9 s: 512000 batch_loss 0.42010125517845154 BPR_loss 0.39283037185668945 reg_loss 0.02727089449763298
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 66.48476910591125 | 389.3603138923645  | 148.61520385742188 | [0.06861526 0.09472697 0.11295163] | [0.03275544 0.03838765 0.04180126] | [0.00406279 0.00286043 0.00229924] | [0.07910485 0.10964646 0.13096354] |
|   9   | 66.48476910591125 | 343.84522461891174 | 148.61520385742188 | [0.0159202  0.02606839 0.03373255] | [0.00664484 0.00877321 0.01017947] | [0.00084672 0.00070966 0.00062408] | [0.01683094 0.02817963 0.03686847] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.3984966576099396 BPR_loss 0.37093234062194824 reg_loss 0.027564316987991333
epoch: 10 s: 256000 batch_loss 0.40060877799987793 BPR_loss 0.37299346923828125 reg_loss 0.027615301311016083
epoch: 10 s: 512000 batch_loss 0.41319921612739563 BPR_loss 0.385528028011322 reg_loss 0.02767118252813816
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 63.665748834609985 | 389.1394073963165 | 147.44638061523438 | [0.0676869  0.09398388 0.11183457] | [0.03204043 0.03772593 0.04108163] | [0.00399385 0.00283389 0.00227672] | [0.07791903 0.10884673 0.12975015] |
|   10  | 63.665748834609985 |  339.994393825531 | 147.44638061523438 | [0.01590875 0.02590483 0.03387392] | [0.00658474 0.00866776 0.01012972] | [0.00084746 0.00070523 0.0006263 ] | [0.01684571 0.02798753 0.03695713] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.40277308225631714 BPR_loss 0.37529289722442627 reg_loss 0.027480188757181168
epoch: 11 s: 256000 batch_loss 0.3964838981628418 BPR_loss 0.36872267723083496 reg_loss 0.027761230245232582
epoch: 11 s: 512000 batch_loss 0.40041473507881165 BPR_loss 0.3726215958595276 reg_loss 0.02779313363134861
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 63.4826922416687 | 396.9041368961334 | 146.6625518798828 | [0.067375   0.09411748 0.11181098] | [0.03201278 0.03777712 0.0411047 ] | [0.00399109 0.00284664 0.00228407] | [0.07772599 0.10898461 0.12999835] |
|   11  | 63.4826922416687 |  331.708833694458 | 146.6625518798828 | [0.01564277 0.02560487 0.03373798] | [0.00651165 0.00859055 0.01008034] | [0.00082899 0.00069673 0.00062359] | [0.01646151 0.02760333 0.03683892] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.40046805143356323 BPR_loss 0.37245598435401917 reg_loss 0.028012052178382874
epoch: 12 s: 256000 batch_loss 0.406750351190567 BPR_loss 0.37890002131462097 reg_loss 0.02785031870007515
epoch: 12 s: 512000 batch_loss 0.4133886694908142 BPR_loss 0.3856581449508667 reg_loss 0.027730511501431465
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 64.02461910247803 | 389.48355436325073 | 146.0247802734375 | [0.06710871 0.09301608 0.1105686 ] | [0.03179084 0.03738334 0.04068016] | [0.00398144 0.00280873 0.00225121] | [0.07749159 0.10768849 0.12826099] |
|   12  | 64.02461910247803 | 317.3718283176422  | 146.0247802734375 | [0.01558392 0.02544887 0.03365437] | [0.00644422 0.00850375 0.0100045 ] | [0.00082677 0.00069119 0.00062063] | [0.01643196 0.027426   0.03670592] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.39686697721481323 BPR_loss 0.36890867352485657 reg_loss 0.02795831300318241
epoch: 13 s: 256000 batch_loss 0.4051860272884369 BPR_loss 0.3772609531879425 reg_loss 0.02792508341372013
epoch: 13 s: 512000 batch_loss 0.4122234582901001 BPR_loss 0.38429775834083557 reg_loss 0.027925698086619377
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 63.91700267791748 | 410.0838940143585  | 145.26026916503906 | [0.06694686 0.09391628 0.11078267] | [0.03168796 0.03748814 0.04066012] | [0.00396489 0.00283665 0.00225833] | [0.07727097 0.10869505 0.12857813] |
|   13  | 63.91700267791748 | 329.20781087875366 | 145.26026916503906 | [0.01516758 0.02498586 0.0328548 ] | [0.00640474 0.00846116 0.00990335] | [0.0008083  0.00068085 0.00060807] | [0.01604776 0.02699747 0.03593752] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.39054787158966064 BPR_loss 0.36243996024131775 reg_loss 0.028107900172472
epoch: 14 s: 256000 batch_loss 0.39724355936050415 BPR_loss 0.36914005875587463 reg_loss 0.02810351364314556
epoch: 14 s: 512000 batch_loss 0.41196030378341675 BPR_loss 0.3840115964412689 reg_loss 0.027948694303631783
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 64.23370027542114 | 396.4032874107361  | 144.7471466064453 | [0.06629011 0.092317   0.10929117] | [0.03153239 0.03714801 0.04034033] | [0.00392491 0.00279149 0.0022303 ] | [0.07648503 0.10697149 0.12688214] |
|   14  | 64.23370027542114 | 316.65195631980896 | 144.7471466064453 | [0.01508983 0.0246094  0.03289139] | [0.00634059 0.00833366 0.00984742] | [0.00080313 0.00067124 0.00060782] | [0.01592954 0.02658372 0.03593752] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.39747002720832825 BPR_loss 0.3694230616092682 reg_loss 0.028046971186995506
epoch: 15 s: 256000 batch_loss 0.39469167590141296 BPR_loss 0.36675459146499634 reg_loss 0.027937084436416626
epoch: 15 s: 512000 batch_loss 0.4061509966850281 BPR_loss 0.37794697284698486 reg_loss 0.02820403128862381
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 62.33040809631348 | 330.2708625793457 | 144.14801025390625 | [0.06647904 0.09196462 0.10902474] | [0.03154674 0.03704285 0.04024555] | [0.00394076 0.00277667 0.00221858] | [0.07677458 0.106351   0.12653742] |
|   15  | 62.33040809631348 | 229.4113142490387 | 144.14801025390625 | [0.01504908 0.02461248 0.03252714] | [0.00628663 0.00829478 0.00974272] | [0.00080091 0.00067309 0.0006029 ] | [0.01592954 0.0266576  0.03561243] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.01504908407587468
early stopping at 15, recall@20:0.0167
