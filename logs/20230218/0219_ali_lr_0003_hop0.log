Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ali', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.001, lr=0.003, mess_dropout=False, mess_dropout_rate=0.1, n_negs=32, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上进行softmax自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931480169296265 BPR_loss 0.6931477785110474 reg_loss 2.222623010084135e-07
epoch: 0 s: 256000 batch_loss 0.6831721663475037 BPR_loss 0.6825000047683716 reg_loss 0.0006721911486238241
epoch: 0 s: 512000 batch_loss 0.6718044281005859 BPR_loss 0.6699244976043701 reg_loss 0.0018799424869939685
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 42.73780274391174 | 142.30502343177795 | 242.95298767089844 | [0.05253056 0.07957693 0.10195232] | [0.02346235 0.02928081 0.03347471] | [0.00321824 0.00246884 0.00212826] | [0.06236556 0.09427224 0.12040152] |
|   0   | 42.73780274391174 | 192.19448900222778 | 242.95298767089844 | [0.00677338 0.01239896 0.01758381] | [0.00274048 0.00390531 0.00484598] | [0.00036351 0.00034024 0.00032583] | [0.00718159 0.01344702 0.01919525] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6582699418067932 BPR_loss 0.6555805802345276 reg_loss 0.002689348766580224
epoch: 1 s: 256000 batch_loss 0.6482771039009094 BPR_loss 0.6445798873901367 reg_loss 0.0036972372326999903
epoch: 1 s: 512000 batch_loss 0.6351379752159119 BPR_loss 0.6299424767494202 reg_loss 0.0051954942755401134
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 62.52302837371826 | 330.10337924957275 | 231.20213317871094 | [0.06679983 0.09948598 0.12135733] | [0.03049743 0.0375067  0.04161088] | [0.00397868 0.00301211 0.00248102] | [0.07761569 0.11564448 0.14097402] |
|   1   | 62.52302837371826 | 333.4807095527649  | 231.20213317871094 | [0.00950514 0.01665694 0.02433774] | [0.00382548 0.00531498 0.00671351] | [0.00050463 0.00045291 0.00044774] | [0.01001877 0.01790965 0.02645073] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.621071457862854 BPR_loss 0.6149100065231323 reg_loss 0.006161450408399105
epoch: 2 s: 256000 batch_loss 0.6071736812591553 BPR_loss 0.5996581315994263 reg_loss 0.007515576668083668
epoch: 2 s: 512000 batch_loss 0.5950203537940979 BPR_loss 0.5857124328613281 reg_loss 0.00930794421583414
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 68.68568778038025 | 375.2014389038086 | 214.9158172607422 | [0.07339435 0.10584594 0.12857336] | [0.03349229 0.0404921  0.04473971] | [0.00432615 0.00319515 0.00261592] | [0.0845789  0.12255253 0.14880591] |
|   2   | 68.68568778038025 | 351.3930358886719 | 214.9158172607422 | [0.01184113 0.02020205 0.02788322] | [0.00471243 0.00644099 0.00783719] | [0.00063319 0.00054749 0.00051104] | [0.0125604  0.02169255 0.03023362] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.5777033567428589 BPR_loss 0.5674542188644409 reg_loss 0.010249124839901924
epoch: 3 s: 256000 batch_loss 0.5614491105079651 BPR_loss 0.549691915512085 reg_loss 0.011757203377783298
epoch: 3 s: 512000 batch_loss 0.5488654971122742 BPR_loss 0.5361433029174805 reg_loss 0.012722201645374298
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 71.96987390518188 | 373.1802134513855  | 199.7404022216797 | [0.07562536 0.1069906  0.12886284] | [0.03490365 0.04166635 0.04575464] | [0.00444956 0.00322342 0.00261132] | [0.0868678  0.12377971 0.14898516] |
|   3   | 71.96987390518188 | 339.85519886016846 | 199.7404022216797 | [0.01356449 0.02245479 0.03085065] | [0.00541641 0.00726229 0.00878861] | [0.00072481 0.00060807 0.00056497] | [0.01439274 0.02407164 0.033455  ] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.5374770760536194 BPR_loss 0.5237021446228027 reg_loss 0.013774916529655457
epoch: 4 s: 256000 batch_loss 0.518243670463562 BPR_loss 0.5033435225486755 reg_loss 0.0149001469835639
epoch: 4 s: 512000 batch_loss 0.5212082862854004 BPR_loss 0.5052907466888428 reg_loss 0.015917569398880005
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 69.67744040489197 | 378.68161392211914 | 187.67074584960938 | [0.07622123 0.10767364 0.12866541] | [0.0353728  0.04213607 0.04606447] | [0.00448265 0.00323341 0.00260282] | [0.08743313 0.1242761  0.14879212] |
|   4   | 69.67744040489197 | 347.0508015155792  | 187.67074584960938 | [0.0148262  0.0243333  0.03283862] | [0.0059586  0.00792967 0.00947167] | [0.000795   0.00065942 0.00060093] | [0.01578177 0.02612563 0.0355681 ] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.5044118762016296 BPR_loss 0.4874992072582245 reg_loss 0.016912655904889107
epoch: 5 s: 256000 batch_loss 0.5043092966079712 BPR_loss 0.48742935061454773 reg_loss 0.016879944130778313
epoch: 5 s: 512000 batch_loss 0.49356186389923096 BPR_loss 0.47559797763824463 reg_loss 0.017963893711566925
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 68.15674948692322 | 380.2707703113556 | 178.5343475341797 | [0.07662064 0.10798937 0.12871381] | [0.03585183 0.04258302 0.0464608 ] | [0.00451161 0.00323583 0.00260052] | [0.08798467 0.12456566 0.1486956 ] |
|   5   | 68.15674948692322 |  340.855343580246 | 178.5343475341797 | [0.01567206 0.02568909 0.03416916] | [0.00634142 0.00842572 0.00996651] | [0.00083637 0.00069562 0.00062482] | [0.01663884 0.02760333 0.03701624] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.4860531985759735 BPR_loss 0.467363178730011 reg_loss 0.01869003102183342
epoch: 6 s: 256000 batch_loss 0.48015856742858887 BPR_loss 0.461396187543869 reg_loss 0.018762389197945595
epoch: 6 s: 512000 batch_loss 0.48229876160621643 BPR_loss 0.4625595808029175 reg_loss 0.019739169627428055
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 66.76603412628174 | 373.5026345252991  | 171.4104461669922 | [0.07616236 0.10712832 0.12766258] | [0.03583718 0.04249386 0.04634277] | [0.00447231 0.00320411 0.00257823] | [0.08725387 0.12346258 0.14723402] |
|   6   | 66.76603412628174 | 350.48714327812195 | 171.4104461669922 | [0.01620969 0.02670919 0.03524628] | [0.0066493  0.00883141 0.01038859] | [0.00086076 0.00072001 0.00064477] | [0.01712648 0.02857861 0.0381984 ] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.4580122232437134 BPR_loss 0.4374469518661499 reg_loss 0.02056528627872467
epoch: 7 s: 256000 batch_loss 0.4665839672088623 BPR_loss 0.44618451595306396 reg_loss 0.020399464294314384
epoch: 7 s: 512000 batch_loss 0.4650079905986786 BPR_loss 0.4437863230705261 reg_loss 0.021221669390797615
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 66.77046942710876 | 359.98307728767395 | 166.129638671875 | [0.07592536 0.10639547 0.12703128] | [0.03564493 0.04218408 0.04604672] | [0.00446128 0.00318343 0.0025649 ] | [0.08708841 0.12241465 0.14636534] |
|   7   | 66.77046942710876 | 357.56679010391235 | 166.129638671875 | [0.01673045 0.02769074 0.03606026] | [0.00687709 0.00915583 0.01068294] | [0.00088883 0.00074771 0.00066004] | [0.01770278 0.02968688 0.03907023] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.45898938179016113 BPR_loss 0.4376104772090912 reg_loss 0.0213788989931345
epoch: 8 s: 256000 batch_loss 0.4446764290332794 BPR_loss 0.42251306772232056 reg_loss 0.02216337062418461
epoch: 8 s: 512000 batch_loss 0.44676968455314636 BPR_loss 0.42425793409347534 reg_loss 0.022511756047606468
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 62.39130902290344 | 372.7066128253937 | 162.0970001220703 | [0.07569584 0.10521508 0.12563373] | [0.03551463 0.04184948 0.04568105] | [0.00444611 0.00314482 0.00253732] | [0.08675749 0.1211461  0.14493133] |
|   8   | 62.39130902290344 | 364.2728102207184 | 162.0970001220703 | [0.01717068 0.02799377 0.03639019] | [0.00702623 0.00927306 0.01080931] | [0.00091322 0.00075436 0.00066767] | [0.01816086 0.02995286 0.03952832] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.4472975730895996 BPR_loss 0.4246416389942169 reg_loss 0.022655948996543884
epoch: 9 s: 256000 batch_loss 0.4445633590221405 BPR_loss 0.4214572310447693 reg_loss 0.023106126114726067
epoch: 9 s: 512000 batch_loss 0.44530385732650757 BPR_loss 0.4220932722091675 reg_loss 0.023210586979985237
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 61.40528678894043 | 393.11596059799194 | 158.8756561279297 | [0.07545259 0.10449915 0.12443125] | [0.03555987 0.04180864 0.04555784] | [0.00443233 0.0031269  0.00251825] | [0.08646793 0.12016712 0.14342838] |
|   9   | 61.40528678894043 | 363.16102266311646 | 158.8756561279297 | [0.0174741  0.02810818 0.03695713] | [0.00717067 0.00938467 0.01100001] | [0.00092873 0.00075953 0.00067925] | [0.01847118 0.03017452 0.04016373] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.4309144616127014 BPR_loss 0.40727296471595764 reg_loss 0.02364148385822773
epoch: 10 s: 256000 batch_loss 0.4283905625343323 BPR_loss 0.404506653547287 reg_loss 0.023883914574980736
epoch: 10 s: 512000 batch_loss 0.43759360909461975 BPR_loss 0.41346845030784607 reg_loss 0.02412516623735428
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 61.994240522384644 | 371.60079741477966 | 156.24716186523438 | [0.07430305 0.10377867 0.12374708] | [0.03503898 0.04138465 0.04512988] | [0.004362   0.00310483 0.00250101] | [0.08508907 0.11939496 0.14258728] |
|   10  | 61.994240522384644 | 364.67405557632446 | 156.24716186523438 | [0.01748346 0.02830709 0.03724776] | [0.00717057 0.00942961 0.01106725] | [0.00092873 0.00076655 0.00068664] | [0.01848595 0.03041095 0.04060704] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.4312613904476166 BPR_loss 0.40725278854370117 reg_loss 0.024008601903915405
epoch: 11 s: 256000 batch_loss 0.4238625466823578 BPR_loss 0.3994264602661133 reg_loss 0.024436086416244507
epoch: 11 s: 512000 batch_loss 0.42540135979652405 BPR_loss 0.40075916051864624 reg_loss 0.024642201140522957
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 61.82928419113159 | 385.37289547920227 | 154.27699279785156 | [0.07424675 0.10293412 0.1227156 ] | [0.03518209 0.0413558  0.04506876] | [0.00436269 0.00308105 0.00248194] | [0.08503392 0.11848492 0.14147041] |
|   11  | 61.82928419113159 | 363.2016832828522  | 154.27699279785156 | [0.01762926 0.02832445 0.03733679] | [0.00720657 0.00943897 0.01108835] | [0.00093316 0.00076803 0.0006891 ] | [0.01857462 0.03047005 0.04071048] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.42060163617134094 BPR_loss 0.3954949378967285 reg_loss 0.025106696411967278
epoch: 12 s: 256000 batch_loss 0.42594626545906067 BPR_loss 0.40101057291030884 reg_loss 0.024935686960816383
epoch: 12 s: 512000 batch_loss 0.42637354135513306 BPR_loss 0.40138429403305054 reg_loss 0.024989241734147072
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 62.15119218826294 | 382.24689173698425 | 152.51893615722656 | [0.07378469 0.10230799 0.12150625] | [0.0349022  0.04102952 0.04463127] | [0.00434408 0.00306278 0.00245666] | [0.08470299 0.11776791 0.1399123 ] |
|   12  | 62.15119218826294 | 354.86030173301697 | 152.51893615722656 | [0.01753333 0.02837693 0.03748271] | [0.00722515 0.00949512 0.01116114] | [0.00092799 0.00076988 0.00069181] | [0.01848595 0.03057349 0.04087302] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.41813403367996216 BPR_loss 0.392723947763443 reg_loss 0.025410091504454613
epoch: 13 s: 256000 batch_loss 0.4236564338207245 BPR_loss 0.3982701897621155 reg_loss 0.025386251509189606
epoch: 13 s: 512000 batch_loss 0.4206579625606537 BPR_loss 0.39519691467285156 reg_loss 0.025461040437221527
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 62.92891788482666 | 390.7956347465515  | 150.96681213378906 | [0.07362919 0.10137758 0.12047315] | [0.03486655 0.04083396 0.04441667] | [0.00433581 0.00303899 0.00243643] | [0.08450996 0.11669241 0.13875407] |
|   13  | 62.92891788482666 | 354.43703389167786 | 150.96681213378906 | [0.01760179 0.02859107 0.03743555] | [0.00723613 0.00952796 0.01114908] | [0.0009339  0.00077468 0.00069205] | [0.01858939 0.03078037 0.04081391] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.409716933965683 BPR_loss 0.3839130401611328 reg_loss 0.02580389380455017
epoch: 14 s: 256000 batch_loss 0.41616344451904297 BPR_loss 0.3902991712093353 reg_loss 0.02586427330970764
epoch: 14 s: 512000 batch_loss 0.4237619936466217 BPR_loss 0.39792197942733765 reg_loss 0.025840017944574356
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 62.944918394088745 | 384.1928553581238  | 149.83729553222656 | [0.07329321 0.1010751  0.11964527] | [0.03468412 0.04065951 0.04415069] | [0.00430754 0.00302831 0.00242012] | [0.08401357 0.11619602 0.13791297] |
|   14  | 62.944918394088745 | 354.58460211753845 | 149.83729553222656 | [0.01764589 0.0283849  0.03739776] | [0.00728859 0.00953249 0.01118127] | [0.00093612 0.00076988 0.00069058] | [0.01861895 0.03055872 0.04079914] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.41240689158439636 BPR_loss 0.386366605758667 reg_loss 0.02604028582572937
epoch: 15 s: 256000 batch_loss 0.4101254343986511 BPR_loss 0.3843194842338562 reg_loss 0.025805959478020668
epoch: 15 s: 512000 batch_loss 0.4151712954044342 BPR_loss 0.3888145685195923 reg_loss 0.02635672315955162
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 63.784249782562256 | 369.3653883934021  | 148.6452178955078 | [0.07262998 0.10014034 0.11929163] | [0.03442319 0.04033861 0.04393358] | [0.00427376 0.00300039 0.00241345] | [0.08331035 0.11516188 0.13748552] |
|   15  | 63.784249782562256 | 286.41673612594604 | 148.6452178955078 | [0.01763172 0.02828605 0.03738348] | [0.00728481 0.00951137 0.01117289] | [0.0009376  0.00076988 0.00068984] | [0.01863372 0.03054394 0.04076958] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.4070222079753876 BPR_loss 0.38060691952705383 reg_loss 0.02641529217362404
epoch: 16 s: 256000 batch_loss 0.41698870062828064 BPR_loss 0.390423446893692 reg_loss 0.026565251871943474
epoch: 16 s: 512000 batch_loss 0.4122101068496704 BPR_loss 0.38587620854377747 reg_loss 0.026333913207054138
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 56.57492280006409 | 255.6103596687317 | 147.70460510253906 | [0.07226675 0.09966192 0.1193179 ] | [0.03419523 0.04009885 0.04378867] | [0.00425514 0.00299211 0.00241759] | [0.08296564 0.1147758  0.13778887] |
|   16  | 56.57492280006409 | 201.1172375679016 | 147.70460510253906 | [0.01761325 0.02800541 0.03693463] | [0.00729005 0.00946534 0.01110121] | [0.00093464 0.0007599  0.00068122] | [0.01858939 0.03015974 0.04026717] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.4070768356323242 BPR_loss 0.38054341077804565 reg_loss 0.02653343416750431
epoch: 17 s: 256000 batch_loss 0.4062083959579468 BPR_loss 0.37967824935913086 reg_loss 0.026530131697654724
epoch: 17 s: 512000 batch_loss 0.4089038670063019 BPR_loss 0.3822287619113922 reg_loss 0.026675114408135414
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 48.10070037841797 | 236.63516402244568 | 147.07643127441406 | [0.07221843 0.09885109 0.11893579] | [0.03412781 0.03986464 0.0436217 ] | [0.00424894 0.0029666  0.00240449] | [0.08285533 0.11404501 0.13716839] |
|   17  | 48.10070037841797 | 192.51459980010986 | 147.07643127441406 | [0.01765389 0.02831967 0.03688092] | [0.007246   0.00946995 0.01103557] | [0.00093686 0.00076951 0.00067974] | [0.01866328 0.03054394 0.04020806] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.4035223126411438 BPR_loss 0.37683025002479553 reg_loss 0.026692047715187073
epoch: 18 s: 256000 batch_loss 0.4135488271713257 BPR_loss 0.38675791025161743 reg_loss 0.026790905743837357
epoch: 18 s: 512000 batch_loss 0.4205021560192108 BPR_loss 0.39384275674819946 reg_loss 0.02665940299630165
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 49.87546968460083 | 224.50925302505493 | 146.20066833496094 | [0.07186695 0.09903509 0.11829272] | [0.03402369 0.03986589 0.04347242] | [0.00424135 0.00297246 0.00239185] | [0.08259335 0.11422426 0.1363135 ] |
|   18  | 49.87546968460083 | 188.60721683502197 | 146.20066833496094 | [0.01737559 0.02815403 0.03688203] | [0.00719522 0.00944692 0.01104344] | [0.0009243  0.00076582 0.00067999] | [0.01839729 0.03039617 0.04025239] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.40286630392074585 BPR_loss 0.37601131200790405 reg_loss 0.026854997500777245
epoch: 19 s: 256000 batch_loss 0.40517938137054443 BPR_loss 0.37833836674690247 reg_loss 0.02684100717306137
epoch: 19 s: 512000 batch_loss 0.404316782951355 BPR_loss 0.3775349259376526 reg_loss 0.026781849563121796
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 50.74023914337158 | 227.54073452949524 | 145.5469207763672 | [0.07152906 0.09898801 0.11740953] | [0.03393261 0.03983558 0.04329608] | [0.00422136 0.00297143 0.00237875] | [0.08219348 0.11412774 0.13540345] |
|   19  | 50.74023914337158 | 186.50387740135193 | 145.5469207763672 | [0.01729259 0.02814208 0.03672342] | [0.00712798 0.00939376 0.01096098] | [0.00091839 0.00076655 0.00067678] | [0.01827908 0.03039617 0.04000118] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.40144243836402893 BPR_loss 0.37455886602401733 reg_loss 0.026883576065301895
epoch: 20 s: 256000 batch_loss 0.4085926115512848 BPR_loss 0.3818050026893616 reg_loss 0.026787621900439262
epoch: 20 s: 512000 batch_loss 0.3956705927848816 BPR_loss 0.36858052015304565 reg_loss 0.02709007076919079
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 46.85728454589844 | 186.6218023300171  | 144.9647216796875 | [0.07073922 0.09815016 0.11714039] | [0.0334149  0.03931163 0.04287321] | [0.00418069 0.0029473  0.00237255] | [0.08135238 0.1130936  0.13508632] |
|   20  | 46.85728454589844 | 144.92589950561523 | 144.9647216796875 | [0.01713251 0.02797055 0.03664868] | [0.00710176 0.00936883 0.01095432] | [0.00091026 0.00076101 0.00067555] | [0.01811653 0.03017452 0.03991252] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.4004511535167694 BPR_loss 0.37340375781059265 reg_loss 0.027047401294112206
epoch: 21 s: 256000 batch_loss 0.4188377857208252 BPR_loss 0.39161229133605957 reg_loss 0.02722548320889473
epoch: 21 s: 512000 batch_loss 0.401266872882843 BPR_loss 0.37434613704681396 reg_loss 0.02692073956131935
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 43.67259073257446 | 146.2602460384369  | 144.47206115722656 | [0.07050455 0.0977456  0.11640504] | [0.03349292 0.03935667 0.04285476] | [0.00417379 0.00293765 0.00235853] | [0.08110419 0.11263857 0.1341487 ] |
|   21  | 43.67259073257446 | 138.45235180854797 | 144.47206115722656 | [0.01706982 0.02785701 0.03652245] | [0.00703033 0.00928765 0.01087459] | [0.0009073  0.00075806 0.00067457] | [0.01805742 0.03004152 0.03988297] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.3974948823451996 BPR_loss 0.3702723979949951 reg_loss 0.02722248248755932
epoch: 22 s: 256000 batch_loss 0.4029880166053772 BPR_loss 0.37563514709472656 reg_loss 0.02735288441181183
epoch: 22 s: 512000 batch_loss 0.4050385653972626 BPR_loss 0.37770798802375793 reg_loss 0.02733057737350464
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 44.17806386947632 | 148.57165336608887 | 143.93153381347656 | [0.0704023  0.09768135 0.11608529] | [0.03334066 0.03919413 0.04264809] | [0.00416552 0.00293592 0.00235416] | [0.08102145 0.11251448 0.13391429] |
|   22  | 44.17806386947632 | 132.79439997673035 | 143.93153381347656 | [0.01707094 0.02806451 0.03638367] | [0.00702306 0.00931598 0.01084247] | [0.0009073  0.00076212 0.00067309] | [0.01805742 0.03020407 0.03970564] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.40219399333000183 BPR_loss 0.3748185932636261 reg_loss 0.02737540565431118
epoch: 23 s: 256000 batch_loss 0.40389347076416016 BPR_loss 0.3765774369239807 reg_loss 0.02731601893901825
epoch: 23 s: 512000 batch_loss 0.3955721855163574 BPR_loss 0.36835432052612305 reg_loss 0.027217872440814972
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 43.580896854400635 | 153.58619713783264 | 143.65142822265625 | [0.07015059 0.09712347 0.11580073] | [0.03340543 0.03919579 0.04270607] | [0.00415793 0.00291972 0.00235164] | [0.08080084 0.11186642 0.13380398] |
|   23  | 43.580896854400635 | 134.0431671142578  | 143.65142822265625 | [0.01695765 0.02783928 0.03604947] | [0.00702394 0.00929306 0.01080073] | [0.00089918 0.00075473 0.00066521] | [0.01789488 0.02992331 0.03930667] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.4057009518146515 BPR_loss 0.3782750368118286 reg_loss 0.027425913140177727
epoch: 24 s: 256000 batch_loss 0.3990655541419983 BPR_loss 0.3717307448387146 reg_loss 0.027334818616509438
epoch: 24 s: 512000 batch_loss 0.4009089171886444 BPR_loss 0.3736640512943268 reg_loss 0.02724486216902733
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 42.77199912071228 | 151.9671266078949 | 143.0611114501953 | [0.06960817 0.09652746 0.11523196] | [0.03310282 0.03888694 0.04239013] | [0.0041207  0.00290318 0.00233532] | [0.08011141 0.11120457 0.13294909] |
|   24  | 42.77199912071228 | 132.1373794078827 | 143.0611114501953 | [0.0167089  0.02755926 0.03617816] | [0.00690697 0.00916902 0.01075497] | [0.00088662 0.00074771 0.00067013] | [0.01762889 0.02962777 0.03952832] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.3881084620952606 BPR_loss 0.3605702519416809 reg_loss 0.027538197115063667
epoch: 25 s: 256000 batch_loss 0.4040832221508026 BPR_loss 0.37640392780303955 reg_loss 0.027679281309247017
epoch: 25 s: 512000 batch_loss 0.4002003073692322 BPR_loss 0.37269148230552673 reg_loss 0.02750883251428604
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 44.432727336883545 | 157.77057075500488 | 142.70762634277344 | [0.06964416 0.09642678 0.11447306] | [0.03318334 0.03893549 0.04232459] | [0.00412415 0.00290283 0.00232521] | [0.08019414 0.11108047 0.13231482] |
|   25  | 44.432727336883545 | 135.39465427398682 | 142.70762634277344 | [0.01663009 0.02774311 0.03592004] | [0.00691644 0.00922622 0.01072913] | [0.00088366 0.00075252 0.00066398] | [0.01755501 0.02984942 0.03923278] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.3975728154182434 BPR_loss 0.37012434005737305 reg_loss 0.027448464184999466
epoch: 26 s: 256000 batch_loss 0.39229679107666016 BPR_loss 0.36472365260124207 reg_loss 0.027573151513934135
epoch: 26 s: 512000 batch_loss 0.3978081941604614 BPR_loss 0.3703022003173828 reg_loss 0.027505984529852867
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 41.97772693634033 | 152.96699953079224 | 142.30319213867188 | [0.06950429 0.09651571 0.1146    ] | [0.03312965 0.038932   0.04232326] | [0.00412208 0.00290973 0.00233049] | [0.08001489 0.11131488 0.13250786] |
|   26  | 41.97772693634033 | 141.08425664901733 | 142.30319213867188 | [0.0165205  0.02720769 0.0359038 ] | [0.0068642  0.00908891 0.01068647] | [0.00087775 0.00073589 0.00066348] | [0.01743679 0.02919924 0.03918845] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.38057053089141846 BPR_loss 0.3528621792793274 reg_loss 0.02770836651325226
epoch: 27 s: 256000 batch_loss 0.3919332027435303 BPR_loss 0.3643763065338135 reg_loss 0.027556907385587692
epoch: 27 s: 512000 batch_loss 0.4031119644641876 BPR_loss 0.3753085136413574 reg_loss 0.027803460136055946
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 42.928170919418335 | 154.19693756103516 | 142.02285766601562 | [0.06904828 0.09577636 0.11400644] | [0.03288945 0.038639   0.04205328] | [0.00408899 0.00288456 0.00231326] | [0.0795185  0.11050135 0.13177707] |
|   27  | 42.928170919418335 | 136.3112301826477  | 142.02285766601562 | [0.01669782 0.02718711 0.03569704] | [0.00691133 0.00909267 0.01065762] | [0.00088809 0.00073515 0.00066028] | [0.01765845 0.02914013 0.03901113] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.016697821386175565
early stopping at 27, recall@20:0.0177
