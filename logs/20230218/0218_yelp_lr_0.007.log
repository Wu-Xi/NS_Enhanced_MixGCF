Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='yelp2018', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.001, lr=0.007, mess_dropout=False, mess_dropout_rate=0.1, n_negs=64, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上进行softmax自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.693148136138916 BPR_loss 0.6931480169296265 reg_loss 1.323738700875765e-07
epoch: 0 s: 256000 batch_loss 0.6854456067085266 BPR_loss 0.6846020221710205 reg_loss 0.0008435931522399187
epoch: 0 s: 512000 batch_loss 0.6852319836616516 BPR_loss 0.6835886836051941 reg_loss 0.0016433056443929672
epoch: 0 s: 768000 batch_loss 0.6838281154632568 BPR_loss 0.6816877126693726 reg_loss 0.002140382770448923
epoch: 0 s: 1024000 batch_loss 0.6783338785171509 BPR_loss 0.6754794120788574 reg_loss 0.0028544922824949026
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 202.59002137184143 | 38.19164037704468 | 411.6624450683594 | [0.06034208 0.10029182 0.13314929] | [0.04928533 0.06434924 0.07587046] | [0.02769515 0.02322218 0.02070544] | [0.3742895  0.52270431 0.61197423] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6736482977867126 BPR_loss 0.6705584526062012 reg_loss 0.0030898733530193567
epoch: 1 s: 256000 batch_loss 0.6669480800628662 BPR_loss 0.6631807088851929 reg_loss 0.0037673860788345337
epoch: 1 s: 512000 batch_loss 0.6665937900543213 BPR_loss 0.6625066995620728 reg_loss 0.004087100271135569
epoch: 1 s: 768000 batch_loss 0.6631375551223755 BPR_loss 0.6587599515914917 reg_loss 0.004377576056867838
epoch: 1 s: 1024000 batch_loss 0.664315402507782 BPR_loss 0.6596851348876953 reg_loss 0.004630288574844599
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 209.24756503105164 | 59.75880241394043 | 404.3537292480469 | [0.06463799 0.10651176 0.14085269] | [0.05298038 0.06875979 0.08081811] | [0.02956139 0.0246487  0.02191171] | [0.39358343 0.54310345 0.63221549] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6611419320106506 BPR_loss 0.6562560200691223 reg_loss 0.004885928239673376
epoch: 2 s: 256000 batch_loss 0.6626654863357544 BPR_loss 0.6575755476951599 reg_loss 0.005089913960546255
epoch: 2 s: 512000 batch_loss 0.6680018901824951 BPR_loss 0.6627436876296997 reg_loss 0.005258217919617891
epoch: 2 s: 768000 batch_loss 0.6643185019493103 BPR_loss 0.6586301326751709 reg_loss 0.0056883483193814754
epoch: 2 s: 1024000 batch_loss 0.6536394953727722 BPR_loss 0.647875189781189 reg_loss 0.0057643018662929535
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 213.56416273117065 | 50.981420278549194 | 400.4646911621094 | [0.06669101 0.10990155 0.14532858] | [0.05483389 0.07114158 0.08352735] | [0.03041556 0.02538919 0.02249747] | [0.4029304  0.55365037 0.64219401] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6532925963401794 BPR_loss 0.6473845839500427 reg_loss 0.00590800866484642
epoch: 3 s: 256000 batch_loss 0.6624552011489868 BPR_loss 0.656429648399353 reg_loss 0.006025536917150021
epoch: 3 s: 512000 batch_loss 0.6518371105194092 BPR_loss 0.6455602049827576 reg_loss 0.00627690926194191
epoch: 3 s: 768000 batch_loss 0.658109188079834 BPR_loss 0.6517480611801147 reg_loss 0.006361114326864481
epoch: 3 s: 1024000 batch_loss 0.6603758931159973 BPR_loss 0.6538976430892944 reg_loss 0.006478229537606239
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 213.5335795879364 | 47.07898783683777 | 397.7843322753906 | [0.06826581 0.11277655 0.14824627] | [0.05623437 0.07303265 0.08542683] | [0.03111501 0.02600575 0.02292746] | [0.40962486 0.56097638 0.64787798] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.6576781868934631 BPR_loss 0.6510348916053772 reg_loss 0.006643314845860004
epoch: 4 s: 256000 batch_loss 0.6482810378074646 BPR_loss 0.6413018703460693 reg_loss 0.006979172118008137
epoch: 4 s: 512000 batch_loss 0.6558589935302734 BPR_loss 0.6489906907081604 reg_loss 0.006868303753435612
epoch: 4 s: 768000 batch_loss 0.6546429395675659 BPR_loss 0.647556722164154 reg_loss 0.007086224388331175
epoch: 4 s: 1024000 batch_loss 0.6601573824882507 BPR_loss 0.6529541015625 reg_loss 0.007203252520412207
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 217.7706696987152 | 43.54701566696167 | 395.7186584472656 | [0.06937578 0.11365198 0.14942509] | [0.05700829 0.07362547 0.08618637] | [0.03159341 0.02611074 0.02309797] | [0.4135089  0.56293419 0.65005684] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.6514664888381958 BPR_loss 0.6441128253936768 reg_loss 0.007353656925261021
epoch: 5 s: 256000 batch_loss 0.6489585638046265 BPR_loss 0.6412606239318848 reg_loss 0.0076979175209999084
epoch: 5 s: 512000 batch_loss 0.6542848944664001 BPR_loss 0.6468385457992554 reg_loss 0.007446350995451212
epoch: 5 s: 768000 batch_loss 0.6524879932403564 BPR_loss 0.6448440551757812 reg_loss 0.007643943186849356
epoch: 5 s: 1024000 batch_loss 0.6517500281333923 BPR_loss 0.6440159678459167 reg_loss 0.007734032813459635
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 242.08261442184448 | 161.08095359802246 | 393.9740905761719 | [0.07016639 0.11465279 0.15066345] | [0.05758979 0.0743433  0.08693066] | [0.0319076  0.02641231 0.0232727 ] | [0.41710875 0.56564987 0.65251989] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.6470802426338196 BPR_loss 0.639033317565918 reg_loss 0.008046898990869522
epoch: 6 s: 256000 batch_loss 0.6507658958435059 BPR_loss 0.6427906155586243 reg_loss 0.007975303567945957
epoch: 6 s: 512000 batch_loss 0.6402987837791443 BPR_loss 0.6320300102233887 reg_loss 0.008268767036497593
epoch: 6 s: 768000 batch_loss 0.6494132876396179 BPR_loss 0.6412276029586792 reg_loss 0.008185693994164467
epoch: 6 s: 1024000 batch_loss 0.6546609401702881 BPR_loss 0.6465327739715576 reg_loss 0.008128153160214424
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 364.40768122673035 | 255.66774940490723 | 392.6282653808594 | [0.07054543 0.1153386  0.15155868] | [0.0578947  0.07478411 0.08744889] | [0.03197234 0.0265323  0.02338849] | [0.41726664 0.56770241 0.6529304 ] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.6459954977035522 BPR_loss 0.6375629901885986 reg_loss 0.008432531729340553
epoch: 7 s: 256000 batch_loss 0.6473982334136963 BPR_loss 0.6387230157852173 reg_loss 0.00867521669715643
epoch: 7 s: 512000 batch_loss 0.6426047086715698 BPR_loss 0.6339224576950073 reg_loss 0.00868224911391735
epoch: 7 s: 768000 batch_loss 0.6493410468101501 BPR_loss 0.6407009959220886 reg_loss 0.008640030398964882
epoch: 7 s: 1024000 batch_loss 0.656762421131134 BPR_loss 0.6482205986976624 reg_loss 0.00854179821908474
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 359.4884283542633 | 244.32928109169006 | 391.53387451171875 | [0.07066591 0.11561372 0.15218994] | [0.0581862  0.07511339 0.08793503] | [0.03208128 0.02657178 0.0235148 ] | [0.4188771  0.56994442 0.65450928] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.645483672618866 BPR_loss 0.6367306113243103 reg_loss 0.008753090165555477
epoch: 8 s: 256000 batch_loss 0.6436396241188049 BPR_loss 0.634671688079834 reg_loss 0.008967959322035313
epoch: 8 s: 512000 batch_loss 0.6393522620201111 BPR_loss 0.6300661563873291 reg_loss 0.009286129847168922
epoch: 8 s: 768000 batch_loss 0.6381630301475525 BPR_loss 0.629074215888977 reg_loss 0.009088820777833462
epoch: 8 s: 1024000 batch_loss 0.6503058671951294 BPR_loss 0.6411739587783813 reg_loss 0.009131904691457748
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 366.8154067993164 | 244.02350425720215 | 390.610595703125 | [0.07102462 0.11642502 0.15309804] | [0.05844741 0.07554843 0.08837199] | [0.03221706 0.02673598 0.02360269] | [0.42026652 0.5718075  0.65665656] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.6366521716117859 BPR_loss 0.6271980404853821 reg_loss 0.00945415161550045
epoch: 9 s: 256000 batch_loss 0.6472023725509644 BPR_loss 0.637924075126648 reg_loss 0.009278308600187302
epoch: 9 s: 512000 batch_loss 0.6421716213226318 BPR_loss 0.632817268371582 reg_loss 0.009354379028081894
epoch: 9 s: 768000 batch_loss 0.6422258615493774 BPR_loss 0.6326662302017212 reg_loss 0.009559623897075653
epoch: 9 s: 1024000 batch_loss 0.6398662328720093 BPR_loss 0.6301892995834351 reg_loss 0.009676958434283733
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 348.55738496780396 | 220.12701630592346 | 389.5738830566406 | [0.07128532 0.1165636  0.153589  ] | [0.05883874 0.07588844 0.08882207] | [0.032386   0.02680545 0.02367585] | [0.42045598 0.5732285  0.65725654] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.6467157602310181 BPR_loss 0.6371826529502869 reg_loss 0.009533104486763477
epoch: 10 s: 256000 batch_loss 0.6445408463478088 BPR_loss 0.6348541975021362 reg_loss 0.009686634875833988
epoch: 10 s: 512000 batch_loss 0.6435954570770264 BPR_loss 0.6339137554168701 reg_loss 0.009681710973381996
epoch: 10 s: 768000 batch_loss 0.6398550868034363 BPR_loss 0.6301475763320923 reg_loss 0.00970752164721489
epoch: 10 s: 1024000 batch_loss 0.6479328274726868 BPR_loss 0.6380223035812378 reg_loss 0.009910501539707184
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 348.37287878990173 | 215.15171003341675 | 388.871337890625 | [0.07120984 0.11682737 0.15356488] | [0.05888449 0.07601615 0.08887465] | [0.03242074 0.02679124 0.02364164] | [0.42181382 0.57341796 0.65870911] |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.6436887979507446 BPR_loss 0.633733868598938 reg_loss 0.009954904206097126
epoch: 11 s: 256000 batch_loss 0.6397637128829956 BPR_loss 0.6297176480293274 reg_loss 0.010046062991023064
epoch: 11 s: 512000 batch_loss 0.6434332132339478 BPR_loss 0.6335071325302124 reg_loss 0.009926100261509418
epoch: 11 s: 768000 batch_loss 0.6413490772247314 BPR_loss 0.6312891244888306 reg_loss 0.010059949941933155
epoch: 11 s: 1024000 batch_loss 0.6479536294937134 BPR_loss 0.6378238797187805 reg_loss 0.010129720903933048
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 410.2864716053009 | 199.49545168876648 | 388.2091979980469 | [0.07118922 0.11625767 0.15328921] | [0.05868355 0.07568732 0.08862415] | [0.03224391 0.02669335 0.02357164] | [0.42134015 0.57231274 0.65851964] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.6396281123161316 BPR_loss 0.6295890212059021 reg_loss 0.01003911904990673
epoch: 12 s: 256000 batch_loss 0.6335679888725281 BPR_loss 0.6234821081161499 reg_loss 0.010085901245474815
epoch: 12 s: 512000 batch_loss 0.6367881298065186 BPR_loss 0.626519501209259 reg_loss 0.010268616490066051
epoch: 12 s: 768000 batch_loss 0.6450065970420837 BPR_loss 0.634935736656189 reg_loss 0.010070865973830223
epoch: 12 s: 1024000 batch_loss 0.6317507028579712 BPR_loss 0.6211491823196411 reg_loss 0.010601512156426907
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 405.1164572238922 | 185.53166270256042 | 387.6542663574219 | [0.07136848 0.11680955 0.15368286] | [0.05894476 0.07607637 0.08900235] | [0.0323939  0.02684176 0.02372111] | [0.42266641 0.57389163 0.65934066] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.6349192261695862 BPR_loss 0.6243308782577515 reg_loss 0.010588320903480053
epoch: 13 s: 256000 batch_loss 0.6406083106994629 BPR_loss 0.6303640604019165 reg_loss 0.010244256816804409
epoch: 13 s: 512000 batch_loss 0.6435142159461975 BPR_loss 0.6330239772796631 reg_loss 0.01049020979553461
epoch: 13 s: 768000 batch_loss 0.63670814037323 BPR_loss 0.6259758472442627 reg_loss 0.010732322931289673
epoch: 13 s: 1024000 batch_loss 0.6516389846801758 BPR_loss 0.641029953956604 reg_loss 0.010609016753733158
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 409.6371076107025 | 144.83158135414124 | 387.1053771972656 | [0.07157848 0.11680061 0.15364805] | [0.05906148 0.07611447 0.08902263] | [0.03237653 0.02678098 0.02366006] | [0.42370848 0.57291272 0.65807755] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.6372939348220825 BPR_loss 0.626742959022522 reg_loss 0.010550999082624912
epoch: 14 s: 256000 batch_loss 0.6337569952011108 BPR_loss 0.6228947639465332 reg_loss 0.010862204246222973
epoch: 14 s: 512000 batch_loss 0.6367241740226746 BPR_loss 0.6258682012557983 reg_loss 0.01085595041513443
epoch: 14 s: 768000 batch_loss 0.6406252980232239 BPR_loss 0.6297272443771362 reg_loss 0.010898055508732796
epoch: 14 s: 1024000 batch_loss 0.6397702693939209 BPR_loss 0.6288943886756897 reg_loss 0.010875873267650604
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 397.9132444858551 | 130.00717163085938 | 386.5265808105469 | [0.0717703  0.11725829 0.15373386] | [0.05911148 0.07620072 0.08898874] | [0.03255179 0.02686308 0.02367321] | [0.42411898 0.5744916  0.6595617 ] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.6397103071212769 BPR_loss 0.6289273500442505 reg_loss 0.01078295148909092
epoch: 15 s: 256000 batch_loss 0.6429122686386108 BPR_loss 0.6319407224655151 reg_loss 0.01097156759351492
epoch: 15 s: 512000 batch_loss 0.6430922746658325 BPR_loss 0.6320912837982178 reg_loss 0.011000966653227806
epoch: 15 s: 768000 batch_loss 0.6376394033432007 BPR_loss 0.6268065571784973 reg_loss 0.01083284430205822
epoch: 15 s: 1024000 batch_loss 0.6429464817047119 BPR_loss 0.6321361064910889 reg_loss 0.010810401290655136
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 420.2101137638092 | 198.73320508003235 | 386.23583984375 | [0.07193416 0.11726987 0.15374221] | [0.05934403 0.0764026  0.0892046 ] | [0.03262599 0.02689308 0.02372847] | [0.42557155 0.57281799 0.65908804] |
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.6364527940750122 BPR_loss 0.6253560185432434 reg_loss 0.011096779257059097
epoch: 16 s: 256000 batch_loss 0.6313768029212952 BPR_loss 0.6201772689819336 reg_loss 0.01119950506836176
epoch: 16 s: 512000 batch_loss 0.6395861506462097 BPR_loss 0.6283958554267883 reg_loss 0.011190294288098812
epoch: 16 s: 768000 batch_loss 0.6349976062774658 BPR_loss 0.6236718893051147 reg_loss 0.011325722560286522
epoch: 16 s: 1024000 batch_loss 0.6419256925582886 BPR_loss 0.6306478977203369 reg_loss 0.011277805082499981
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 410.79920840263367 | 200.47134709358215 | 385.84515380859375 | [0.0716198  0.1171194  0.15359912] | [0.05924941 0.07639519 0.0891883 ] | [0.03246969 0.02684413 0.023669  ] | [0.42298219 0.57490211 0.65788809] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.6340305209159851 BPR_loss 0.6228009462356567 reg_loss 0.011229551397264004
epoch: 17 s: 256000 batch_loss 0.6390247344970703 BPR_loss 0.6274988651275635 reg_loss 0.011525874957442284
epoch: 17 s: 512000 batch_loss 0.6366274356842041 BPR_loss 0.6252766847610474 reg_loss 0.011350729502737522
epoch: 17 s: 768000 batch_loss 0.6426730155944824 BPR_loss 0.6311917304992676 reg_loss 0.011481262743473053
epoch: 17 s: 1024000 batch_loss 0.6371989250183105 BPR_loss 0.6256866455078125 reg_loss 0.01151227205991745
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 385.0140104293823 | 216.56606149673462 | 385.5742492675781 | [0.07181565 0.11693133 0.15365292] | [0.05935161 0.07634126 0.08920326] | [0.03252653 0.02679124 0.02364427] | [0.42332954 0.57307061 0.65659341] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.6347029209136963 BPR_loss 0.623218297958374 reg_loss 0.011484610848128796
epoch: 18 s: 256000 batch_loss 0.6389607191085815 BPR_loss 0.6273165345191956 reg_loss 0.011644194833934307
epoch: 18 s: 512000 batch_loss 0.6336686611175537 BPR_loss 0.6223136186599731 reg_loss 0.011355056427419186
epoch: 18 s: 768000 batch_loss 0.6471665501594543 BPR_loss 0.63582444190979 reg_loss 0.011342127807438374
epoch: 18 s: 1024000 batch_loss 0.6430770754814148 BPR_loss 0.6317284107208252 reg_loss 0.011348672211170197
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 359.4492754936218 | 225.89814472198486 | 385.2989807128906 | [0.07171683 0.11669949 0.15340219] | [0.05939561 0.07632616 0.08919183] | [0.03247126 0.02673598 0.02361006] | [0.42411898 0.57067071 0.65630921] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.6323787569999695 BPR_loss 0.620847761631012 reg_loss 0.011530998162925243
epoch: 19 s: 256000 batch_loss 0.6369205713272095 BPR_loss 0.6252303719520569 reg_loss 0.01169018354266882
epoch: 19 s: 512000 batch_loss 0.6398912072181702 BPR_loss 0.6283709406852722 reg_loss 0.011520253494381905
epoch: 19 s: 768000 batch_loss 0.6363932490348816 BPR_loss 0.6249020099639893 reg_loss 0.011491219513118267
epoch: 19 s: 1024000 batch_loss 0.6348040103912354 BPR_loss 0.623056173324585 reg_loss 0.011747807264328003
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 348.6552896499634 | 254.20195889472961 | 384.94708251953125 | [0.07146508 0.11678198 0.15349196] | [0.05927518 0.07631028 0.08919225] | [0.03240021 0.0267565  0.02365164] | [0.42329797 0.57092333 0.6564671 ] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.6364498734474182 BPR_loss 0.6248610615730286 reg_loss 0.011588791385293007
epoch: 20 s: 256000 batch_loss 0.6375494599342346 BPR_loss 0.6257953643798828 reg_loss 0.011754118837416172
epoch: 20 s: 512000 batch_loss 0.6306644082069397 BPR_loss 0.6187441945075989 reg_loss 0.011920228600502014
epoch: 20 s: 768000 batch_loss 0.6361852884292603 BPR_loss 0.6243037581443787 reg_loss 0.011881520971655846
epoch: 20 s: 1024000 batch_loss 0.6347834467887878 BPR_loss 0.6229351162910461 reg_loss 0.011848317459225655
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 372.74343824386597 | 258.27898120880127 | 384.6549377441406 | [0.07154744 0.11676028 0.1534353 ] | [0.05920815 0.07622074 0.08907592] | [0.03237495 0.02674466 0.0236069 ] | [0.42329797 0.57123911 0.65782493] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.6320813894271851 BPR_loss 0.6201390624046326 reg_loss 0.011942300945520401
epoch: 21 s: 256000 batch_loss 0.6405414342880249 BPR_loss 0.6286251544952393 reg_loss 0.01191629096865654
epoch: 21 s: 512000 batch_loss 0.6330130696296692 BPR_loss 0.620852530002594 reg_loss 0.012160548008978367
epoch: 21 s: 768000 batch_loss 0.6299039125442505 BPR_loss 0.6177396178245544 reg_loss 0.012164288200438023
epoch: 21 s: 1024000 batch_loss 0.6372400522232056 BPR_loss 0.6252197623252869 reg_loss 0.012020274065434933
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 358.14906096458435 | 245.96501231193542 | 384.3500061035156 | [0.07147483 0.1164971  0.15356412] | [0.05928201 0.07619187 0.0891684 ] | [0.03239548 0.02666967 0.02357217] | [0.42244537 0.57063913 0.65659341] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.6356611251831055 BPR_loss 0.6236476898193359 reg_loss 0.012013458646833897
epoch: 22 s: 256000 batch_loss 0.633608341217041 BPR_loss 0.6215845346450806 reg_loss 0.01202380657196045
epoch: 22 s: 512000 batch_loss 0.6370830535888672 BPR_loss 0.62518709897995 reg_loss 0.011895942501723766
epoch: 22 s: 768000 batch_loss 0.6450494527816772 BPR_loss 0.6329315304756165 reg_loss 0.012117923237383366
epoch: 22 s: 1024000 batch_loss 0.644842267036438 BPR_loss 0.6329745054244995 reg_loss 0.0118677644059062
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 337.1759252548218 | 229.94771647453308 | 384.2252502441406 | [0.07174245 0.11652789 0.1532885 ] | [0.05942981 0.07626451 0.0891608 ] | [0.03246337 0.02670124 0.02361901] | [0.42358216 0.57079702 0.65637236] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.6288344860076904 BPR_loss 0.6167171001434326 reg_loss 0.012117413803935051
epoch: 23 s: 256000 batch_loss 0.6425185799598694 BPR_loss 0.6304647922515869 reg_loss 0.012053783982992172
epoch: 23 s: 512000 batch_loss 0.6340851783752441 BPR_loss 0.6219712495803833 reg_loss 0.01211394090205431
epoch: 23 s: 768000 batch_loss 0.6402202248573303 BPR_loss 0.6281145215034485 reg_loss 0.01210572849959135
epoch: 23 s: 1024000 batch_loss 0.623423159122467 BPR_loss 0.6111756563186646 reg_loss 0.012247507460415363
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 339.59805250167847 | 225.17880630493164 | 383.9610290527344 | [0.07161434 0.11642001 0.15379464] | [0.05927192 0.07607984 0.08918318] | [0.03246495 0.02664362 0.02365216] | [0.42301377 0.56991285 0.65915119] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.6341124176979065 BPR_loss 0.6219099164009094 reg_loss 0.012202523648738861
epoch: 24 s: 256000 batch_loss 0.6384491324424744 BPR_loss 0.6262145042419434 reg_loss 0.01223462913185358
epoch: 24 s: 512000 batch_loss 0.6401789784431458 BPR_loss 0.62794029712677 reg_loss 0.012238702736794949
epoch: 24 s: 768000 batch_loss 0.6387563347816467 BPR_loss 0.6266250610351562 reg_loss 0.012131273746490479
epoch: 24 s: 1024000 batch_loss 0.640761137008667 BPR_loss 0.6286368370056152 reg_loss 0.012124317698180676
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 376.7894718647003 | 259.70689582824707 | 383.87481689453125 | [0.0713245  0.11648439 0.15365444] | [0.05915121 0.07616857 0.08917878] | [0.03229917 0.02669809 0.02363006] | [0.42143489 0.57212328 0.65899331] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.6285226345062256 BPR_loss 0.6162353754043579 reg_loss 0.012287248857319355
epoch: 25 s: 256000 batch_loss 0.641334056854248 BPR_loss 0.6288034915924072 reg_loss 0.01253057736903429
epoch: 25 s: 512000 batch_loss 0.6354336738586426 BPR_loss 0.6230276823043823 reg_loss 0.012405981309711933
epoch: 25 s: 768000 batch_loss 0.6348696351051331 BPR_loss 0.6225408911705017 reg_loss 0.012328756973147392
epoch: 25 s: 1024000 batch_loss 0.6390064358711243 BPR_loss 0.6266894340515137 reg_loss 0.012317003682255745
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 363.51240611076355 | 254.03000402450562 | 383.55999755859375 | [0.07129996 0.11632278 0.15291061] | [0.05914708 0.07608724 0.08892437] | [0.03229917 0.02664993 0.0235469 ] | [0.4207086  0.57003916 0.65630921] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.07129995627228919
early stopping at 25, recall@20:0.0719
