Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ali', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=0, l2=0.0001, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=32, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931495666503906 BPR_loss 0.6931495666503906 reg_loss 2.6514008766298502e-08
epoch: 0 s: 256000 batch_loss 0.6931414008140564 BPR_loss 0.6931412220001221 reg_loss 1.6718033180040948e-07
epoch: 0 s: 512000 batch_loss 0.6929386854171753 BPR_loss 0.692935585975647 reg_loss 3.11961093757418e-06
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 41.83826184272766 | 116.51784873008728 | 248.08351135253906 | [0.03423962 0.05360507 0.06885699] | [0.01510611 0.01930285 0.02213842] | [0.00213033 0.00169358 0.00144872] | [0.0410209  0.06411671 0.081573  ] |
|   0   | 41.83826184272766 | 116.40115189552307 | 248.08351135253906 | [0.00794545 0.01366793 0.01944456] | [0.00336035 0.00456528 0.00563202] | [0.00044035 0.00038974 0.00037755] | [0.00865929 0.01523503 0.02192898] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.691925048828125 BPR_loss 0.6919100880622864 reg_loss 1.4944380382075906e-05
epoch: 1 s: 256000 batch_loss 0.6899517774581909 BPR_loss 0.6899087429046631 reg_loss 4.3041967728640884e-05
epoch: 1 s: 512000 batch_loss 0.6867825388908386 BPR_loss 0.6866897344589233 reg_loss 9.28090448724106e-05
+-------+-------------------+--------------------+---------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |      Loss     |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+---------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 43.38456177711487 | 141.88612914085388 | 246.564453125 | [0.04921969 0.07221187 0.09038051] | [0.02205318 0.02698784 0.03038495] | [0.00298177 0.00221513 0.00186559] | [0.05758094 0.08420661 0.10520655] |
|   1   | 43.38456177711487 | 160.0557246208191  | 246.564453125 | [0.01114254 0.01932157 0.02663454] | [0.00459608 0.00630014 0.00765155] | [0.0006029  0.00053529 0.00050414] | [0.01191022 0.02102759 0.02950955] |
+-------+-------------------+--------------------+---------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.683255136013031 BPR_loss 0.6831173896789551 reg_loss 0.00013775922707282007
epoch: 2 s: 256000 batch_loss 0.6805760860443115 BPR_loss 0.6803717613220215 reg_loss 0.0002043450513156131
epoch: 2 s: 512000 batch_loss 0.6750569343566895 BPR_loss 0.6747540235519409 reg_loss 0.0003029360086657107
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 45.569560050964355 | 132.31616735458374 | 242.47662353515625 | [0.05354136 0.07914424 0.09798789] | [0.02430284 0.02980195 0.03332093] | [0.00322721 0.00241851 0.00201336] | [0.0624345  0.09223154 0.1139347 ] |
|   2   | 45.569560050964355 | 130.62719416618347 | 242.47662353515625 | [0.01274819 0.02112808 0.02876308] | [0.00517071 0.0069145  0.00831683] | [0.00068713 0.00058221 0.00053911] | [0.01358001 0.02290426 0.03165221] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6722594499588013 BPR_loss 0.6718853116035461 reg_loss 0.00037416350096464157
epoch: 3 s: 256000 batch_loss 0.665059506893158 BPR_loss 0.6645877361297607 reg_loss 0.0004717705596704036
epoch: 3 s: 512000 batch_loss 0.6600909233093262 BPR_loss 0.6595311164855957 reg_loss 0.0005597806884907186
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 45.30284881591797 | 136.19029188156128 | 237.0181427001953 | [0.05623271 0.082379   0.10139468] | [0.02555474 0.03116921 0.03471357] | [0.00337474 0.00250814 0.00207127] | [0.06545419 0.09587171 0.1176576 ] |
|   3   | 45.30284881591797 | 121.05208826065063 | 237.0181427001953 | [0.01378245 0.02257151 0.03030284] | [0.00557796 0.00741091 0.00883253] | [0.0007455  0.00062285 0.00056867] | [0.01471783 0.02452972 0.03338111] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.6547279357910156 BPR_loss 0.6540478467941284 reg_loss 0.0006800942355766892
epoch: 4 s: 256000 batch_loss 0.6425710916519165 BPR_loss 0.6417887210845947 reg_loss 0.0007823651540093124
epoch: 4 s: 512000 batch_loss 0.6414898037910461 BPR_loss 0.6405770778656006 reg_loss 0.0009126966469921172
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 43.08130478858948 | 134.97068405151367 | 230.40921020507812 | [0.05819981 0.08446622 0.1039124 ] | [0.02632478 0.03197716 0.03559447] | [0.00347471 0.0025688  0.0021193 ] | [0.06739838 0.09802272 0.12037395] |
|   4   | 43.08130478858948 | 154.87108898162842 | 230.40921020507812 | [0.01441725 0.02369948 0.03163422] | [0.00585416 0.00778867 0.00924285] | [0.00077727 0.00065203 0.00059108] | [0.01535324 0.02571188 0.03472581] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.6391271948814392 BPR_loss 0.6380934715270996 reg_loss 0.0010337384883314371
epoch: 5 s: 256000 batch_loss 0.6304798722267151 BPR_loss 0.6293841600418091 reg_loss 0.0010957227787002921
epoch: 5 s: 512000 batch_loss 0.6171362400054932 BPR_loss 0.6158530116081238 reg_loss 0.0012832345673814416
+-------+-------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |      Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 48.44550347328186 | 146.29543614387512 | 223.0986328125 | [0.05999976 0.08715333 0.10627082] | [0.0272826  0.03311962 0.03669102] | [0.00357744 0.00264051 0.00216687] | [0.06937014 0.10087695 0.12313165] |
|   5   | 48.44550347328186 | 123.61289429664612 | 223.0986328125 | [0.01470232 0.02452872 0.03240597] | [0.0060102  0.00806788 0.00950862] | [0.00079204 0.00067568 0.00060413] | [0.01564878 0.02661327 0.03550899] |
+-------+-------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.6124406456947327 BPR_loss 0.6110171675682068 reg_loss 0.0014234811533242464
epoch: 6 s: 256000 batch_loss 0.6091153621673584 BPR_loss 0.6076130867004395 reg_loss 0.0015022787265479565
epoch: 6 s: 512000 batch_loss 0.5993977785110474 BPR_loss 0.5977019667625427 reg_loss 0.0016958328196778893
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 44.453551054000854 | 135.70560932159424 | 214.9720001220703 | [0.06119278 0.08853534 0.10798457] | [0.02802699 0.03391284 0.03753932] | [0.00364431 0.00268394 0.00219812] | [0.07077657 0.10255915 0.12497932] |
|   6   | 44.453551054000854 | 120.30383086204529 | 214.9720001220703 | [0.01516102 0.02489433 0.03307276] | [0.00624246 0.00827634 0.0097733 ] | [0.00081569 0.00068269 0.00061521] | [0.01612164 0.02690881 0.03617395] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.5796542167663574 BPR_loss 0.577768087387085 reg_loss 0.0018861552234739065
epoch: 7 s: 256000 batch_loss 0.5829753279685974 BPR_loss 0.580992579460144 reg_loss 0.0019827778451144695
epoch: 7 s: 512000 batch_loss 0.5682902932167053 BPR_loss 0.5660886168479919 reg_loss 0.0022016840521246195
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 42.33568215370178 | 131.91561269760132 | 206.50392150878906 | [0.062438   0.08998868 0.10886824] | [0.02857642 0.03450723 0.03803077] | [0.00370774 0.00272462 0.00221375] | [0.07198996 0.1041862  0.125848  ] |
|   7   | 42.33568215370178 | 156.03096652030945 | 206.50392150878906 | [0.015427   0.02545216 0.03366445] | [0.00634784 0.00844204 0.00994364] | [0.00082825 0.0006971  0.0006258 ] | [0.01637285 0.02747034 0.03675025] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.5632432699203491 BPR_loss 0.560961127281189 reg_loss 0.0022821566089987755
epoch: 8 s: 256000 batch_loss 0.5492984652519226 BPR_loss 0.5467265248298645 reg_loss 0.0025719371624290943
epoch: 8 s: 512000 batch_loss 0.5451639294624329 BPR_loss 0.5424193143844604 reg_loss 0.002744642086327076
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 48.93002438545227 | 155.74042105674744 | 197.82557678222656 | [0.06317112 0.09115135 0.109515  ] | [0.02914374 0.03516261 0.03859763] | [0.0037491  0.00275288 0.00222501] | [0.07287243 0.10541338 0.12666152] |
|   8   | 48.93002438545227 | 119.37337875366211 | 197.82557678222656 | [0.01582844 0.02571445 0.03410331] | [0.00651201 0.00857368 0.01010625] | [0.0008482  0.00070227 0.00063295] | [0.01678661 0.02769199 0.03717879] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.538342297077179 BPR_loss 0.5355451703071594 reg_loss 0.0027971272356808186
epoch: 9 s: 256000 batch_loss 0.5365104675292969 BPR_loss 0.5333907604217529 reg_loss 0.003119679866358638
epoch: 9 s: 512000 batch_loss 0.5244899392127991 BPR_loss 0.5212287902832031 reg_loss 0.003261128207668662
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 44.300196170806885 | 135.52606892585754 | 188.84500122070312 | [0.06447184 0.09214232 0.11058759] | [0.02973314 0.03568581 0.0391299 ] | [0.00382356 0.00278356 0.00224546] | [0.07432023 0.10665435 0.12780597] |
|   9   | 44.300196170806885 | 118.83866047859192 | 188.84500122070312 | [0.01607719 0.02582405 0.03421883] | [0.00662686 0.00865599 0.01019129] | [0.0008615  0.00070486 0.00063516] | [0.01705259 0.02779543 0.03728222] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.5145841240882874 BPR_loss 0.511236310005188 reg_loss 0.003347839927300811
epoch: 10 s: 256000 batch_loss 0.5064039826393127 BPR_loss 0.502816915512085 reg_loss 0.00358703825622797
epoch: 10 s: 512000 batch_loss 0.4978248178958893 BPR_loss 0.4939672350883484 reg_loss 0.003857590025290847
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 42.47752857208252 | 133.24828624725342 | 179.96961975097656 | [0.06526894 0.09283051 0.11196237] | [0.03013107 0.03605461 0.03962558] | [0.003867   0.00279907 0.00227028] | [0.07516133 0.10742651 0.12929513] |
|   10  | 42.47752857208252 | 144.84946250915527 | 179.96961975097656 | [0.01605749 0.02614594 0.03449294] | [0.00665449 0.00875785 0.01028224] | [0.00086002 0.00071336 0.00063935] | [0.01702304 0.0281353  0.03756299] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.491769403219223 BPR_loss 0.48791491985321045 reg_loss 0.0038544905837625265
epoch: 11 s: 256000 batch_loss 0.4818408191204071 BPR_loss 0.47766435146331787 reg_loss 0.0041764783672988415
epoch: 11 s: 512000 batch_loss 0.4715527892112732 BPR_loss 0.46722888946533203 reg_loss 0.004323901142925024
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 49.56020426750183 | 165.50366735458374 | 171.24819946289062 | [0.0655973  0.09360477 0.11229493] | [0.03036383 0.03638029 0.03987288] | [0.00389182 0.00282182 0.00227971] | [0.07563014 0.10840549 0.12986046] |
|   11  | 49.56020426750183 | 124.48858642578125 | 171.24819946289062 | [0.01611105 0.02629505 0.03456885] | [0.00669173 0.00881727 0.01032928] | [0.00086223 0.00071705 0.00063984] | [0.01705259 0.02826829 0.03757776] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.4671753942966461 BPR_loss 0.46248167753219604 reg_loss 0.004693704657256603
epoch: 12 s: 256000 batch_loss 0.4544109106063843 BPR_loss 0.4496424198150635 reg_loss 0.004768498241901398
epoch: 12 s: 512000 batch_loss 0.45218604803085327 BPR_loss 0.44724488258361816 reg_loss 0.0049411519430577755
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 42.42926383018494 | 128.9012987613678  | 162.52523803710938 | [0.06608055 0.09406353 0.1132196 ] | [0.03067994 0.03669392 0.04027013] | [0.00391663 0.00283389 0.0022951 ] | [0.07612652 0.108764   0.13083945] |
|   12  | 42.42926383018494 | 126.48876810073853 | 162.52523803710938 | [0.01635352 0.02627461 0.03466674] | [0.00679777 0.00886977 0.01040559] | [0.00087553 0.00071705 0.00064255] | [0.01733335 0.02826829 0.03772553] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.43986865878105164 BPR_loss 0.43461874127388 reg_loss 0.005249909125268459
epoch: 13 s: 256000 batch_loss 0.43755441904067993 BPR_loss 0.4321590065956116 reg_loss 0.005395407322794199
epoch: 13 s: 512000 batch_loss 0.42395442724227905 BPR_loss 0.41832613945007324 reg_loss 0.005628288257867098
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 43.36690330505371 | 135.82354307174683 | 154.11260986328125 | [0.06647685 0.09436668 0.11356948] | [0.03093552 0.03692885 0.0405153 ] | [0.00393387 0.00283699 0.00229947] | [0.07655397 0.10898461 0.13115658] |
|   13  | 43.36690330505371 | 141.37639379501343 | 154.11260986328125 | [0.01651987 0.02652705 0.03472117] | [0.00681231 0.00890022 0.01040169] | [0.00088366 0.00072296 0.00064354] | [0.0174959  0.02848994 0.03774031] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.41392049193382263 BPR_loss 0.4081020653247833 reg_loss 0.005818431731313467
epoch: 14 s: 256000 batch_loss 0.40899714827537537 BPR_loss 0.4030032455921173 reg_loss 0.005993897095322609
epoch: 14 s: 512000 batch_loss 0.4082877039909363 BPR_loss 0.4020223915576935 reg_loss 0.006265315692871809
+-------+------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |      Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 49.4073166847229 | 168.67616295814514 | 146.0361328125 | [0.06688113 0.09496502 0.11427315] | [0.03119711 0.0372334  0.04083361] | [0.00395869 0.00285561 0.00231257] | [0.07705036 0.10964646 0.13184601] |
|   14  | 49.4073166847229 | 134.58767199516296 | 146.0361328125 | [0.01660102 0.02662015 0.03458202] | [0.00683093 0.00891657 0.01037654] | [0.00088809 0.00072481 0.00064058] | [0.01759934 0.02856383 0.03757776] |
+-------+------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.3937023878097534 BPR_loss 0.38722729682922363 reg_loss 0.006475084461271763
epoch: 15 s: 256000 batch_loss 0.3873896598815918 BPR_loss 0.3808774948120117 reg_loss 0.006512160412967205
epoch: 15 s: 512000 batch_loss 0.3834320604801178 BPR_loss 0.3764497637748718 reg_loss 0.006982305087149143
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 42.95737338066101 | 124.68606042861938 | 138.06134033203125 | [0.06706417 0.09522204 0.11444794] | [0.03133672 0.03739784 0.04098808] | [0.00396765 0.00286043 0.00231579] | [0.07731234 0.10992223 0.13203905] |
|   15  | 42.95737338066101 | 122.40909481048584 | 138.06134033203125 | [0.01638688 0.0267029  0.03448673] | [0.00678816 0.00893879 0.01036623] | [0.00087479 0.00072739 0.00063886] | [0.01734813 0.02865249 0.03742999] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.3749951124191284 BPR_loss 0.36785292625427246 reg_loss 0.00714217871427536
epoch: 16 s: 256000 batch_loss 0.3732937276363373 BPR_loss 0.36576056480407715 reg_loss 0.007533169351518154
epoch: 16 s: 512000 batch_loss 0.3585425019264221 BPR_loss 0.3510715961456299 reg_loss 0.007470907177776098
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 42.86598014831543 | 136.6174440383911  | 130.5287322998047 | [0.06747172 0.09560563 0.11515612] | [0.03150725 0.03755535 0.04119949] | [0.00399178 0.0028725  0.00232796] | [0.07771221 0.11034968 0.13278363] |
|   16  | 42.86598014831543 | 134.74511241912842 | 130.5287322998047 | [0.01629969 0.02653901 0.0345069 ] | [0.00675998 0.0088992  0.01036219] | [0.00086888 0.00072148 0.00063886] | [0.01722991 0.02844561 0.03747433] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.3602440357208252 BPR_loss 0.3524390459060669 reg_loss 0.0078049818985164165
epoch: 17 s: 256000 batch_loss 0.35050463676452637 BPR_loss 0.34261518716812134 reg_loss 0.007889438420534134
epoch: 17 s: 512000 batch_loss 0.3380914330482483 BPR_loss 0.32979997992515564 reg_loss 0.0082914549857378
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 48.78404211997986 | 166.49970483779907 | 123.50890350341797 | [0.06806016 0.0960838  0.11580401] | [0.03180758 0.03782997 0.04149862] | [0.00402143 0.00288629 0.00233831] | [0.0783189  0.11091501 0.1334179 ] |
|   17  | 48.78404211997986 | 147.8989598751068  | 123.50890350341797 | [0.01625832 0.0267289  0.03472314] | [0.0067568  0.00893792 0.0104044 ] | [0.00086667 0.00072629 0.0006428 ] | [0.01718558 0.02863771 0.03771076] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.33028528094291687 BPR_loss 0.3218764066696167 reg_loss 0.008408869616687298
epoch: 18 s: 256000 batch_loss 0.32854947447776794 BPR_loss 0.31970909237861633 reg_loss 0.008840395137667656
epoch: 18 s: 512000 batch_loss 0.3261377811431885 BPR_loss 0.31733936071395874 reg_loss 0.00879841111600399
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 41.61019706726074 | 122.32704973220825 | 116.67317199707031 | [0.06838666 0.09619725 0.11592214] | [0.0320215  0.03799596 0.04166741] | [0.00404487 0.00288904 0.0023406 ] | [0.07877392 0.11109426 0.13352821] |
|   18  | 41.61019706726074 | 122.19812941551208 | 116.67317199707031 | [0.01619773 0.02671412 0.03457586] | [0.006735   0.00892695 0.01036963] | [0.00086445 0.00072555 0.0006396 ] | [0.01714125 0.02865249 0.03750388] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.312457799911499 BPR_loss 0.3031623363494873 reg_loss 0.009295451454818249
epoch: 19 s: 256000 batch_loss 0.3107662498950958 BPR_loss 0.30126088857650757 reg_loss 0.009505356661975384
epoch: 19 s: 512000 batch_loss 0.3015543818473816 BPR_loss 0.29217809438705444 reg_loss 0.009376291185617447
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 42.28130555152893 | 132.20670628547668 | 110.26315307617188 | [0.06876588 0.09657811 0.11615165] | [0.03210798 0.03807877 0.04172214] | [0.00406004 0.0028987  0.00234359] | [0.07909106 0.11146655 0.13387292] |
|   19  | 42.28130555152893 | 144.2703137397766  | 110.26315307617188 | [0.01627063 0.0266635  0.03464348] | [0.00675716 0.00892096 0.01038122] | [0.00086667 0.00072407 0.00064009] | [0.01720036 0.02856383 0.03753343] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.2965553104877472 BPR_loss 0.2868390381336212 reg_loss 0.0097162751480937
epoch: 20 s: 256000 batch_loss 0.2943529188632965 BPR_loss 0.2846143841743469 reg_loss 0.009738548658788204
epoch: 20 s: 512000 batch_loss 0.28400254249572754 BPR_loss 0.2736867368221283 reg_loss 0.010315807536244392
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 45.54688858985901 | 165.35463571548462 | 104.19477844238281 | [0.06894419 0.09655746 0.11591232] | [0.03222247 0.03816069 0.04176504] | [0.00407038 0.00289939 0.00233923] | [0.07935304 0.11141139 0.13363852] |
|   20  | 45.54688858985901 | 153.96808648109436 | 104.19477844238281 | [0.0162066  0.02661117 0.03442367] | [0.00673138 0.00890045 0.01033184] | [0.00086297 0.00072222 0.00063516] | [0.01712648 0.02850472 0.03726745] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.2811494767665863 BPR_loss 0.2708461880683899 reg_loss 0.01030330266803503
epoch: 21 s: 256000 batch_loss 0.2860228419303894 BPR_loss 0.2751516103744507 reg_loss 0.010871241800487041
epoch: 21 s: 512000 batch_loss 0.2717856466770172 BPR_loss 0.2610028386116028 reg_loss 0.010782795026898384
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 45.411513328552246 | 120.46537756919861 | 98.54792022705078 | [0.0692611  0.09690972 0.11622842] | [0.03236476 0.03830346 0.04189719] | [0.00408417 0.00290697 0.00234313] | [0.0796426  0.11178369 0.13387292] |
|   21  | 45.411513328552246 | 116.75080943107605 | 98.54792022705078 | [0.01623911 0.02658715 0.03429778] | [0.0067265  0.0088823  0.01029865] | [0.00086445 0.00072185 0.00063442] | [0.01715603 0.02847517 0.03717879] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.2654382288455963 BPR_loss 0.25437822937965393 reg_loss 0.011060011573135853
epoch: 22 s: 256000 batch_loss 0.25566238164901733 BPR_loss 0.24408137798309326 reg_loss 0.011581012047827244
epoch: 22 s: 512000 batch_loss 0.2506595551967621 BPR_loss 0.2389339804649353 reg_loss 0.01172557007521391
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 42.92429208755493 | 132.9569869041443  | 93.1956558227539 | [0.06940875 0.09722111 0.1164062 ] | [0.03244432 0.03841666 0.04198408] | [0.00409726 0.00291869 0.00234727] | [0.07984943 0.11214219 0.13409354] |
|   22  | 42.92429208755493 | 135.56850385665894 | 93.1956558227539 | [0.01611351 0.02634633 0.03419289] | [0.00667698 0.00881175 0.01025361] | [0.0008578  0.00071447 0.00063171] | [0.01700826 0.02823874 0.03706057] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.2516365051269531 BPR_loss 0.2396179735660553 reg_loss 0.012018545530736446
epoch: 23 s: 256000 batch_loss 0.24692140519618988 BPR_loss 0.23480096459388733 reg_loss 0.012120445258915424
epoch: 23 s: 512000 batch_loss 0.23715655505657196 BPR_loss 0.22493329644203186 reg_loss 0.01222325675189495
+-------+------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 45.5215060710907 | 149.63772892951965 | 88.3194351196289 | [0.06943914 0.09702339 0.11618147] | [0.03257481 0.0385064  0.04206625] | [0.00409657 0.00291248 0.0023406 ] | [0.07983564 0.11192157 0.13384535] |
|   23  | 45.5215060710907 | 136.11809396743774 | 88.3194351196289 | [0.01617458 0.0262951  0.03416591] | [0.00668671 0.0087967  0.01024124] | [0.00085928 0.00071373 0.00063098] | [0.01705259 0.02820918 0.03703102] |
+-------+------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.24460291862487793 BPR_loss 0.23210564255714417 reg_loss 0.012497269548475742
epoch: 24 s: 256000 batch_loss 0.2376713901758194 BPR_loss 0.22492477297782898 reg_loss 0.012746619991958141
epoch: 24 s: 512000 batch_loss 0.22842353582382202 BPR_loss 0.21550758183002472 reg_loss 0.012915960513055325
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 45.59783983230591 |  121.582852602005 | 83.56303405761719 | [0.06987326 0.09739609 0.1162475 ] | [0.0327196  0.03863128 0.04213946] | [0.00411864 0.00292041 0.00234198] | [0.08027687 0.11221113 0.13372125] |
|   24  | 45.59783983230591 | 112.4851222038269 | 83.56303405761719 | [0.01608703 0.02617689 0.03397997] | [0.00666089 0.00876247 0.01019772] | [0.00085558 0.00071003 0.00062851] | [0.01699348 0.02804664 0.03686847] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.016087029919725337
early stopping at 24, recall@20:0.0166
