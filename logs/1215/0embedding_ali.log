Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ali', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.0001, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=32, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931579113006592 BPR_loss 0.6931576132774353 reg_loss 2.823701379384147e-07
epoch: 0 s: 256000 batch_loss 0.6931613683700562 BPR_loss 0.6931607127189636 reg_loss 6.693200020890799e-07
epoch: 0 s: 512000 batch_loss 0.6931354403495789 BPR_loss 0.6931335926055908 reg_loss 1.8494293954063323e-06
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 81.25468349456787 | 186.42306447029114 | 248.14254760742188 | [0.01906284 0.02939622 0.03815351] | [0.00872826 0.01099168 0.01264658] | [0.00124993 0.00097382 0.00084501] | [0.02359219 0.03611218 0.04646738] |
|   0   | 81.25468349456787 | 177.41893219947815 | 248.14254760742188 | [0.00300045 0.00604868 0.008965  ] | [0.00117563 0.00183509 0.00238633] | [0.0001788  0.00019025 0.0001921 ] | [0.00351691 0.00725548 0.01092016] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6928656697273254 BPR_loss 0.6928611993789673 reg_loss 4.4515531953948084e-06
epoch: 1 s: 256000 batch_loss 0.6923937201499939 BPR_loss 0.6923834085464478 reg_loss 1.0339310392737389e-05
epoch: 1 s: 512000 batch_loss 0.6915222406387329 BPR_loss 0.6915019750595093 reg_loss 2.029202187259216e-05
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 82.68329000473022 | 191.09519267082214 | 247.74241638183594 | [0.03279444 0.05007602 0.06401573] | [0.01486962 0.01860739 0.02121835] | [0.00210068 0.00160843 0.00137127] | [0.04023496 0.06043517 0.07684353] |
|   1   | 82.68329000473022 | 179.21397995948792 | 247.74241638183594 | [0.00537756 0.01019915 0.01503022] | [0.00220423 0.00322003 0.00412219] | [0.00030367 0.00029812 0.00030096] | [0.00594033 0.01161468 0.01736291] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6898828148841858 BPR_loss 0.6898525953292847 reg_loss 3.01997297356138e-05
epoch: 2 s: 256000 batch_loss 0.6890219449996948 BPR_loss 0.6889764070510864 reg_loss 4.5544042222900316e-05
epoch: 2 s: 512000 batch_loss 0.686396598815918 BPR_loss 0.6863284707069397 reg_loss 6.811885396018624e-05
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 78.89076542854309 | 192.55576491355896 | 246.15284729003906 | [0.04007338 0.06073993 0.07646917] | [0.01842418 0.02287318 0.02582356] | [0.00250469 0.00190523 0.0016105 ] | [0.04817716 0.07216921 0.09079753] |
|   2   | 78.89076542854309 | 175.60992622375488 | 246.15284729003906 | [0.00750164 0.01376816 0.01880533] | [0.00307373 0.00438736 0.00532206] | [0.0004108  0.00039122 0.0003645 ] | [0.00806821 0.01526458 0.0211458 ] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6846953630447388 BPR_loss 0.6846091747283936 reg_loss 8.619714935775846e-05
epoch: 3 s: 256000 batch_loss 0.6816707253456116 BPR_loss 0.6815643310546875 reg_loss 0.00010639413085300475
epoch: 3 s: 512000 batch_loss 0.6798567771911621 BPR_loss 0.67972731590271 reg_loss 0.00012947902723681182
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 81.93060302734375 | 196.41915106773376 | 243.5303497314453 | [0.04432608 0.06589934 0.08157154] | [0.02026196 0.02491701 0.02784499] | [0.0027253  0.00205587 0.00170197] | [0.05268601 0.0779604  0.09614748] |
|   3   | 81.93060302734375 | 175.9178056716919  | 243.5303497314453 | [0.00854785 0.01537762 0.02102495] | [0.00356845 0.00500586 0.00604852] | [0.00046695 0.00043629 0.00040513] | [0.00920603 0.01705259 0.02364311] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.6762393116950989 BPR_loss 0.6760770082473755 reg_loss 0.00016231696645263582
epoch: 4 s: 256000 batch_loss 0.6701001524925232 BPR_loss 0.6699135303497314 reg_loss 0.0001866105303633958
epoch: 4 s: 512000 batch_loss 0.6718150973320007 BPR_loss 0.6715993285179138 reg_loss 0.00021575747814495116
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 81.02744126319885 | 193.0721845626831 | 240.152587890625 | [0.0470645  0.06921495 0.08573752] | [0.02149183 0.02626921 0.02935386] | [0.00287284 0.00214412 0.00178171] | [0.05562297 0.08154542 0.1006977 ] |
|   4   | 81.02744126319885 | 175.5508279800415 | 240.152587890625 | [0.00943249 0.01703622 0.0227854 ] | [0.00389404 0.00548433 0.00654359] | [0.00051498 0.00047766 0.00043543] | [0.01016654 0.01872239 0.02541634] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.6677799820899963 BPR_loss 0.6675336360931396 reg_loss 0.0002463391574565321
epoch: 5 s: 256000 batch_loss 0.6636427044868469 BPR_loss 0.6633683443069458 reg_loss 0.0002743628283496946
epoch: 5 s: 512000 batch_loss 0.6573664546012878 BPR_loss 0.6570528149604797 reg_loss 0.00031365957693196833
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 79.76022672653198 | 189.74632930755615 | 236.35801696777344 | [0.04974941 0.07229334 0.08830063] | [0.02263819 0.02750296 0.03048748] | [0.00301969 0.00223305 0.00182721] | [0.05851856 0.08496498 0.10351056] |
|   5   | 79.76022672653198 | 175.15957856178284 | 236.35801696777344 | [0.01001987 0.01767606 0.02376684] | [0.00416014 0.00575936 0.00688386] | [0.00054453 0.00049392 0.00045365] | [0.01077239 0.0194169  0.02652461] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.6538767218589783 BPR_loss 0.6535263061523438 reg_loss 0.0003504084888845682
epoch: 6 s: 256000 batch_loss 0.6532953381538391 BPR_loss 0.6529169082641602 reg_loss 0.00037843623431399465
epoch: 6 s: 512000 batch_loss 0.6479872465133667 BPR_loss 0.6475609540939331 reg_loss 0.0004262714646756649
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 79.33669877052307 | 192.36887431144714 | 232.0998077392578 | [0.05087511 0.07382543 0.09054105] | [0.02334381 0.02830259 0.0314248 ] | [0.00308794 0.00227511 0.00187202] | [0.05981468 0.08657824 0.1059925 ] |
|   6   | 79.33669877052307 | 175.79014492034912 | 232.0998077392578 | [0.01035974 0.01825209 0.02458511] | [0.00433498 0.005989   0.00715753] | [0.00056226 0.0005087  0.0004672 ] | [0.01112704 0.01993409 0.02735212] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.6367748975753784 BPR_loss 0.6363021731376648 reg_loss 0.00047270749928429723
epoch: 7 s: 256000 batch_loss 0.6393924951553345 BPR_loss 0.6388853788375854 reg_loss 0.0005070980987511575
epoch: 7 s: 512000 batch_loss 0.6296594142913818 BPR_loss 0.6291114687919617 reg_loss 0.0005479400861077011
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 78.05366015434265 | 193.00700664520264 | 227.54153442382812 | [0.05238664 0.07554113 0.0919298 ] | [0.02397696 0.02896252 0.03202913] | [0.00316723 0.00231923 0.00189592] | [0.06134521 0.08828802 0.10728862] |
|   7   | 78.05366015434265 | 176.6795370578766  | 227.54153442382812 | [0.01088309 0.01876312 0.02561176] | [0.00450344 0.00614718 0.00740895] | [0.00059034 0.00052163 0.00048518] | [0.01168856 0.02048084 0.02840128] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.6253495216369629 BPR_loss 0.624763548374176 reg_loss 0.0005859715747646987
epoch: 8 s: 256000 batch_loss 0.6206558346748352 BPR_loss 0.6200258135795593 reg_loss 0.0006300460081547499
epoch: 8 s: 512000 batch_loss 0.6170550584793091 BPR_loss 0.6163731217384338 reg_loss 0.0006819305126555264
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 81.74877882003784 | 188.77522230148315 | 222.79347229003906 | [0.05312236 0.07682867 0.09340563] | [0.02439684 0.02951364 0.03261551] | [0.00320308 0.00235612 0.00192396] | [0.06204843 0.08970823 0.1089984 ] |
|   8   | 81.74877882003784 | 176.18123483657837 | 222.79347229003906 | [0.0110486  0.01921948 0.02573317] | [0.00460412 0.00631345 0.00751213] | [0.00060068 0.00053493 0.00048665] | [0.01189544 0.02098326 0.02847517] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.6140633225440979 BPR_loss 0.6133599281311035 reg_loss 0.0007034192676655948
epoch: 9 s: 256000 batch_loss 0.6116730570793152 BPR_loss 0.6109071969985962 reg_loss 0.0007658723625354469
epoch: 9 s: 512000 batch_loss 0.6076172590255737 BPR_loss 0.6068075895309448 reg_loss 0.0008096713572740555
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 79.6223692893982 | 191.87776517868042 | 217.69210815429688 | [0.0539891  0.07844491 0.09489833] | [0.02479706 0.03006219 0.03314453] | [0.00325341 0.00240196 0.00195384] | [0.06297226 0.0915559  0.11072197] |
|   9   | 79.6223692893982 |  174.706196308136  | 217.69210815429688 | [0.01128306 0.01945087 0.0261921 ] | [0.00466946 0.00638487 0.00762393] | [0.00061103 0.00054157 0.00049453] | [0.01210232 0.02124924 0.02899236] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.6012340784072876 BPR_loss 0.6003758907318115 reg_loss 0.0008581984438933432
epoch: 10 s: 256000 batch_loss 0.5941501259803772 BPR_loss 0.5932535529136658 reg_loss 0.0008965605520643294
epoch: 10 s: 512000 batch_loss 0.5927200317382812 BPR_loss 0.5917634963989258 reg_loss 0.0009565597283653915
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 81.4817111492157 | 192.41250586509705 | 212.47239685058594 | [0.05447938 0.07936162 0.09570417] | [0.02498883 0.03033577 0.03339789] | [0.00328098 0.00242403 0.00196854] | [0.06355138 0.09243837 0.1115217 ] |
|   10  | 81.4817111492157 | 175.72976756095886 | 212.47239685058594 | [0.01147516 0.01999515 0.02670942] | [0.00475636 0.00653958 0.00776823] | [0.00062137 0.00055635 0.00050266] | [0.01229442 0.02182554 0.02950955] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.5849711894989014 BPR_loss 0.5839844942092896 reg_loss 0.0009867213666439056
epoch: 11 s: 256000 batch_loss 0.5781058073043823 BPR_loss 0.5770528316497803 reg_loss 0.001052957959473133
epoch: 11 s: 512000 batch_loss 0.5751610398292542 BPR_loss 0.5740669965744019 reg_loss 0.0010940695647150278
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 82.83760094642639 | 188.8500463962555  | 207.19577026367188 | [0.05513936 0.08015732 0.09696149] | [0.02518091 0.03055675 0.03370238] | [0.00331545 0.00244712 0.00199451] | [0.06426838 0.09325189 0.11303844] |
|   11  | 82.83760094642639 | 177.32386898994446 | 207.19577026367188 | [0.01164214 0.02013345 0.02708823] | [0.00480368 0.0065812  0.00785656] | [0.00062802 0.00055857 0.00050956] | [0.01244219 0.02194376 0.02989375] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.5700913667678833 BPR_loss 0.5689202547073364 reg_loss 0.0011711005354300141
epoch: 12 s: 256000 batch_loss 0.5648738145828247 BPR_loss 0.5636622309684753 reg_loss 0.0012115983990952373
epoch: 12 s: 512000 batch_loss 0.5640102028846741 BPR_loss 0.5627659559249878 reg_loss 0.001244256505742669
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 78.31328892707825 | 188.1553692817688  | 201.615966796875 | [0.05592051 0.08081983 0.09740159] | [0.02553431 0.03089185 0.03400062] | [0.00335475 0.00246505 0.00200347] | [0.06513706 0.09402405 0.11350725] |
|   12  | 78.31328892707825 | 175.76876020431519 | 201.615966796875 | [0.01187611 0.02025413 0.02722824] | [0.00490218 0.00665511 0.00793604] | [0.00064132 0.00056005 0.00051251] | [0.01269339 0.02201764 0.03004152] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.553014874458313 BPR_loss 0.5516878962516785 reg_loss 0.0013269487535580993
epoch: 13 s: 256000 batch_loss 0.5547488927841187 BPR_loss 0.5533788204193115 reg_loss 0.0013700849376618862
epoch: 13 s: 512000 batch_loss 0.546448290348053 BPR_loss 0.545019805431366 reg_loss 0.0014285118086263537
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 80.6442620754242 | 189.93826460838318 | 196.04759216308594 | [0.05646847 0.08125406 0.09823648] | [0.02577426 0.03109811 0.03427662] | [0.00339129 0.00247608 0.00201703] | [0.06575754 0.09450665 0.11438972] |
|   13  | 80.6442620754242 | 175.23625493049622 | 196.04759216308594 | [0.01184704 0.02040362 0.02725334] | [0.00490857 0.00669587 0.00795204] | [0.00064058 0.00056448 0.00051227] | [0.01267862 0.02218019 0.03004152] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.5390057563781738 BPR_loss 0.5375227928161621 reg_loss 0.0014829663559794426
epoch: 14 s: 256000 batch_loss 0.5300098657608032 BPR_loss 0.5284645557403564 reg_loss 0.0015453218948096037
epoch: 14 s: 512000 batch_loss 0.5331040024757385 BPR_loss 0.5314993262290955 reg_loss 0.0016046548262238503
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 78.0978889465332 | 188.54213285446167 | 190.46421813964844 | [0.05655253 0.08145629 0.09857864] | [0.02589413 0.03126078 0.03446893] | [0.00339543 0.00248332 0.0020237 ] | [0.06578512 0.09485136 0.11470686] |
|   14  | 78.0978889465332 | 177.3002541065216  | 190.46421813964844 | [0.01187167 0.02044426 0.02750493] | [0.0049243  0.00671576 0.00800809] | [0.00064132 0.00056633 0.0005167 ] | [0.01270817 0.02226885 0.03027795] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.5206998586654663 BPR_loss 0.5190309286117554 reg_loss 0.0016689149197191
epoch: 15 s: 256000 batch_loss 0.5142053961753845 BPR_loss 0.512505054473877 reg_loss 0.00170031504239887
epoch: 15 s: 512000 batch_loss 0.5171791911125183 BPR_loss 0.515404224395752 reg_loss 0.0017749377293512225
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 80.71573424339294 |  189.787682056427  | 184.7700653076172 | [0.05697486 0.08152471 0.09869837] | [0.02606667 0.0313557  0.03457104] | [0.00341473 0.00248263 0.00202416] | [0.06618499 0.09490651 0.11485853] |
|   15  | 80.71573424339294 | 176.00062012672424 | 184.7700653076172 | [0.01178006 0.02049844 0.02744216] | [0.00492651 0.00675244 0.00802198] | [0.00063541 0.0005678  0.00051498] | [0.01258995 0.02232796 0.03017452] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.5061779618263245 BPR_loss 0.5043407082557678 reg_loss 0.0018372682388871908
epoch: 16 s: 256000 batch_loss 0.5039803385734558 BPR_loss 0.5020686388015747 reg_loss 0.00191171292681247
epoch: 16 s: 512000 batch_loss 0.49343234300613403 BPR_loss 0.4914678931236267 reg_loss 0.001964451279491186
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 77.96507358551025 | 191.80780696868896 | 179.09463500976562 | [0.05733894 0.08172969 0.09894128] | [0.02623575 0.03149227 0.03471202] | [0.00343473 0.00248849 0.00202737] | [0.06666759 0.09511334 0.11506536] |
|   16  | 77.96507358551025 | 178.60850548744202 | 179.09463500976562 | [0.01190073 0.02064005 0.02738379] | [0.00492687 0.00675417 0.00798716] | [0.00064058 0.00057076 0.00051301] | [0.01269339 0.02244617 0.03008585] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.4962846636772156 BPR_loss 0.4942575693130493 reg_loss 0.002027107635512948
epoch: 17 s: 256000 batch_loss 0.4878670871257782 BPR_loss 0.4857975244522095 reg_loss 0.002069566398859024
epoch: 17 s: 512000 batch_loss 0.48182255029678345 BPR_loss 0.47967100143432617 reg_loss 0.0021515449043363333
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 80.69724488258362 |  191.052184343338  | 173.62631225585938 | [0.05760877 0.08187802 0.09962879] | [0.02640316 0.03163392 0.03494206] | [0.00345472 0.00249435 0.00203864] | [0.06699851 0.09538911 0.11583752] |
|   17  | 80.69724488258362 | 175.00423336029053 | 173.62631225585938 | [0.01187118 0.02072576 0.02719264] | [0.00490919 0.00676169 0.00794666] | [0.0006391  0.00057261 0.00050931] | [0.01266384 0.02254961 0.0298642 ] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.471095472574234 BPR_loss 0.4688870310783386 reg_loss 0.002208456164225936
epoch: 18 s: 256000 batch_loss 0.468493789434433 BPR_loss 0.46620702743530273 reg_loss 0.0022867671214044094
epoch: 18 s: 512000 batch_loss 0.4698117971420288 BPR_loss 0.4674738645553589 reg_loss 0.0023379316553473473
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 81.37200903892517 | 188.81276988983154 | 168.0512237548828 | [0.05777956 0.08216271 0.09957133] | [0.02644697 0.03170538 0.03495308] | [0.00345954 0.00250159 0.00203634] | [0.06708124 0.09559594 0.11569963] |
|   18  | 81.37200903892517 |  176.02676653862   | 168.0512237548828 | [0.01203668 0.020743   0.02725187] | [0.00492951 0.00674806 0.00793645] | [0.00064797 0.00057261 0.00050833] | [0.01284116 0.02257917 0.02983465] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.4579876959323883 BPR_loss 0.4555797874927521 reg_loss 0.0024078967981040478
epoch: 19 s: 256000 batch_loss 0.45681241154670715 BPR_loss 0.4543435573577881 reg_loss 0.0024688600096851587
epoch: 19 s: 512000 batch_loss 0.4517354369163513 BPR_loss 0.4492075443267822 reg_loss 0.0025278835091739893
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 79.93907380104065 | 188.97965478897095 | 162.5999755859375 | [0.05802988 0.0823352  0.09980807] | [0.02661853 0.03185644 0.03511216] | [0.0034754  0.00250469 0.00203864] | [0.06741217 0.09572004 0.11594782] |
|   19  | 79.93907380104065 | 180.47678875923157 | 162.5999755859375 | [0.01196033 0.02045991 0.02740876] | [0.00490561 0.00668598 0.00795701] | [0.00064354 0.00056559 0.00051251] | [0.0127525  0.02231318 0.0300563 ] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.44534239172935486 BPR_loss 0.4427604377269745 reg_loss 0.0025819428265094757
epoch: 20 s: 256000 batch_loss 0.4429016411304474 BPR_loss 0.4402496814727783 reg_loss 0.002651963382959366
epoch: 20 s: 512000 batch_loss 0.4328112006187439 BPR_loss 0.43006354570388794 reg_loss 0.002747669816017151
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 81.07650947570801 | 190.9330129623413 | 157.18511962890625 | [0.05821796 0.08228808 0.0998877 ] | [0.02664922 0.03182765 0.03510703] | [0.00348643 0.00250124 0.00203841] | [0.06759142 0.09565109 0.11596161] |
|   20  | 81.07650947570801 | 172.6752381324768 | 157.18511962890625 | [0.01206426 0.02049351 0.02714942] | [0.00492356 0.00668449 0.00790295] | [0.00065019 0.00056522 0.00050685] | [0.01288549 0.02229841 0.02971643] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.43035340309143066 BPR_loss 0.4275604486465454 reg_loss 0.002792959101498127
epoch: 21 s: 256000 batch_loss 0.4368203580379486 BPR_loss 0.43396395444869995 reg_loss 0.002856394974514842
epoch: 21 s: 512000 batch_loss 0.4202255606651306 BPR_loss 0.4172895848751068 reg_loss 0.0029359643813222647
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 82.76818442344666 | 190.87445378303528 | 151.98231506347656 | [0.05818802 0.08240503 0.09986889] | [0.02667429 0.03189105 0.03514416] | [0.00348367 0.00250572 0.00203795] | [0.06755005 0.09577519 0.11592025] |
|   21  | 82.76818442344666 | 179.05854487419128 | 151.98231506347656 | [0.01204456 0.02057356 0.02709832] | [0.00490936 0.00668983 0.00788352] | [0.00064797 0.00056707 0.00050611] | [0.01284116 0.02237229 0.0296721 ] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.41155222058296204 BPR_loss 0.40853455662727356 reg_loss 0.0030176599975675344
epoch: 22 s: 256000 batch_loss 0.4073883593082428 BPR_loss 0.4042956233024597 reg_loss 0.003092739498242736
epoch: 22 s: 512000 batch_loss 0.40372005105018616 BPR_loss 0.40056440234184265 reg_loss 0.0031556428875774145
+-------+-------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |      Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 81.01397252082825 | 193.33589601516724 | 146.8193359375 | [0.05828316 0.08250277 0.09991233] | [0.02673084 0.03194686 0.03519018] | [0.00349471 0.00250882 0.00203749] | [0.06774309 0.09591308 0.11593404] |
|   22  | 81.01397252082825 | 178.66174578666687 | 146.8193359375 | [0.01191896 0.0205243  0.02709044] | [0.00488259 0.00667938 0.00787913] | [0.00064206 0.00056522 0.00050562] | [0.01272295 0.02232796 0.02962777] |
+-------+-------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.40119636058807373 BPR_loss 0.3979763686656952 reg_loss 0.0032200049608945847
epoch: 23 s: 256000 batch_loss 0.39795175194740295 BPR_loss 0.39466094970703125 reg_loss 0.0032908134162425995
epoch: 23 s: 512000 batch_loss 0.3843052089214325 BPR_loss 0.38094890117645264 reg_loss 0.003356315428391099
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 83.16354370117188 | 192.53538012504578 | 141.86776733398438 | [0.05845473 0.08249002 0.10015132] | [0.02684238 0.03201265 0.03530351] | [0.00350505 0.002504   0.00204001] | [0.06792234 0.09577519 0.11616844] |
|   23  | 83.16354370117188 | 181.60098266601562 | 141.86776733398438 | [0.01194851 0.0203013  0.02720422] | [0.00485141 0.00659827 0.00785788] | [0.00064354 0.00055857 0.0005071 ] | [0.0127525  0.02206197 0.02973121] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.3945426046848297 BPR_loss 0.39111995697021484 reg_loss 0.0034226607531309128
epoch: 24 s: 256000 batch_loss 0.3846839368343353 BPR_loss 0.38119542598724365 reg_loss 0.003488512709736824
epoch: 24 s: 512000 batch_loss 0.3771336078643799 BPR_loss 0.3735782206058502 reg_loss 0.003555389354005456
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 79.32112789154053 | 191.87727284431458 | 136.97244262695312 | [0.05854285 0.08278371 0.09968573] | [0.02686995 0.03208877 0.03524254] | [0.00350505 0.00251365 0.0020322 ] | [0.0678534  0.09614748 0.11571342] |
|   24  | 79.32112789154053 | 178.92646050453186 | 136.97244262695312 | [0.01178597 0.02023861 0.02710644] | [0.00479021 0.00655533 0.00780814] | [0.00063615 0.00055746 0.00050537] | [0.01260473 0.02200287 0.02962777] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.36245590448379517 BPR_loss 0.35882389545440674 reg_loss 0.0036320053040981293
epoch: 25 s: 256000 batch_loss 0.3758591413497925 BPR_loss 0.3721199035644531 reg_loss 0.0037392359226942062
epoch: 25 s: 512000 batch_loss 0.36920568346977234 BPR_loss 0.3653986155986786 reg_loss 0.0038070823065936565
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 100.00770664215088 | 181.99779653549194 | 132.29446411132812 | [0.05853797 0.0824706  0.09968205] | [0.02689579 0.03205572 0.03526505] | [0.00350091 0.00250434 0.00203128] | [0.06789477 0.0957614  0.115741  ] |
|   25  | 100.00770664215088 | 144.93825793266296 | 132.29446411132812 | [0.01185246 0.02015452 0.02705325] | [0.00478475 0.00651421 0.00777281] | [0.0006391  0.0005545  0.00050463] | [0.01266384 0.02188465 0.02955388] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.3574661612510681 BPR_loss 0.3536260724067688 reg_loss 0.0038401030469685793
epoch: 26 s: 256000 batch_loss 0.3542800843715668 BPR_loss 0.35034358501434326 reg_loss 0.003936511464416981
epoch: 26 s: 512000 batch_loss 0.3526311218738556 BPR_loss 0.34862861037254333 reg_loss 0.004002524074167013
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 66.24449348449707 | 124.12961769104004 | 127.73419189453125 | [0.05849606 0.08248069 0.09949167] | [0.02696455 0.03212816 0.03530034] | [0.00350298 0.00250434 0.00202623] | [0.06789477 0.09569246 0.11532734] |
|   26  | 66.24449348449707 | 120.2394015789032  | 127.73419189453125 | [0.01175641 0.02004616 0.02691114] | [0.00474606 0.00647376 0.00772381] | [0.00063393 0.00055118 0.00050118] | [0.0125604  0.02173688 0.02939134] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.3387375473976135 BPR_loss 0.33465254306793213 reg_loss 0.004085011780261993
epoch: 27 s: 256000 batch_loss 0.343683660030365 BPR_loss 0.339521586894989 reg_loss 0.00416206382215023
epoch: 27 s: 512000 batch_loss 0.3454982340335846 BPR_loss 0.3412529528141022 reg_loss 0.004245282616466284
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 55.318888664245605 |  122.883948802948  | 123.38298034667969 | [0.05860235 0.0824152  0.09939898] | [0.02695501 0.03208319 0.03524404] | [0.00350918 0.00250296 0.00202324] | [0.06801886 0.09569246 0.11527219] |
|   27  | 55.318888664245605 | 119.16860508918762 | 123.38298034667969 | [0.0116813  0.01987622 0.02684834] |  [0.0046933 0.0064008 0.0076717]   | [0.0006295  0.00054527 0.00049971] | [0.01247174 0.02151523 0.02930268] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 28 s: 0 batch_loss 0.33309170603752136 BPR_loss 0.3288005590438843 reg_loss 0.004291138611733913
epoch: 28 s: 256000 batch_loss 0.3335740268230438 BPR_loss 0.32922014594078064 reg_loss 0.0043538836762309074
epoch: 28 s: 512000 batch_loss 0.33457931876182556 BPR_loss 0.3301580250263214 reg_loss 0.004421284422278404
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   28  | 49.248263359069824 | 185.9901053905487  | 119.03235626220703 | [0.05864417 0.08222986 0.09927026] | [0.02696778 0.03204663 0.03521738] | [0.00351125 0.00249641 0.00201933] | [0.06800507 0.09545806 0.11510672] |
|   28  | 49.248263359069824 | 183.54444313049316 | 119.03235626220703 | [0.01171947 0.01967181 0.02668579] | [0.0046845  0.00634197 0.00762233] | [0.00063171 0.00053936 0.00049651] | [0.01251607 0.0212788  0.02911058] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 29 s: 0 batch_loss 0.3376675546169281 BPR_loss 0.3331264853477478 reg_loss 0.004541067406535149
epoch: 29 s: 256000 batch_loss 0.3182006776332855 BPR_loss 0.3135843276977539 reg_loss 0.004616336897015572
epoch: 29 s: 512000 batch_loss 0.32400456070899963 BPR_loss 0.31934529542922974 reg_loss 0.0046592773869633675
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   29  | 82.01319718360901 | 190.74374532699585 | 115.02186584472656 | [0.05827912 0.08212334 0.0990103 ] | [0.02688022 0.03201343 0.03515524] | [0.00348988 0.0024909  0.00201336] | [0.06763278 0.09532017 0.11480338] |
|   29  | 82.01319718360901 | 184.5249786376953  | 115.02186584472656 | [0.01155323 0.01963129 0.0265916 ] | [0.00462034 0.00630724 0.00757637] | [0.00062359 0.00053936 0.00049478] | [0.01235352 0.02123447 0.02899236] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 30 s: 0 batch_loss 0.30609890818595886 BPR_loss 0.3014029562473297 reg_loss 0.00469596404582262
epoch: 30 s: 256000 batch_loss 0.31742748618125916 BPR_loss 0.3126510977745056 reg_loss 0.004776375368237495
epoch: 30 s: 512000 batch_loss 0.30581849813461304 BPR_loss 0.30091744661331177 reg_loss 0.004901066422462463
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   30  | 82.32864189147949 | 188.41484093666077 | 111.1422119140625 | [0.0581691  0.08217045 0.09875988] | [0.02686788 0.03203146 0.03512135] | [0.00348092 0.00249159 0.00200876] | [0.06750869 0.09534775 0.11447245] |
|   30  | 82.32864189147949 | 182.77756357192993 | 111.1422119140625 | [0.01148304 0.01935545 0.02647166] | [0.00459263 0.00624248 0.00753886] | [0.00061768 0.00053197 0.00049183] | [0.01223531 0.0209537  0.02884459] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.011483038533339257
early stopping at 30, recall@20:0.0121
