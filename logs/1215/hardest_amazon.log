Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='amazon', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.0001, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931480169296265 BPR_loss 0.6931480169296265 reg_loss 1.3972920598348537e-08
epoch: 0 s: 256000 batch_loss 0.6931473612785339 BPR_loss 0.6931473016738892 reg_loss 4.5336641107951436e-08
epoch: 0 s: 512000 batch_loss 0.6931449770927429 BPR_loss 0.6931447982788086 reg_loss 1.648364360562482e-07
epoch: 0 s: 768000 batch_loss 0.6931293606758118 BPR_loss 0.6931283473968506 reg_loss 9.876739568426274e-07
epoch: 0 s: 1024000 batch_loss 0.6930476427078247 BPR_loss 0.6930422782897949 reg_loss 5.3640246733266395e-06
epoch: 0 s: 1280000 batch_loss 0.6928003430366516 BPR_loss 0.6927787065505981 reg_loss 2.1632889911415987e-05
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 69.08169674873352 | 245.11193370819092 | 462.2760314941406 | [0.03671577 0.0577599  0.0727543 ] | [0.01671043 0.02113708 0.02387992] | [0.00208587 0.00165577 0.00139667] | [0.04110409 0.06470481 0.0815802 ] |
|   0   | 69.08169674873352 | 223.74409174919128 | 462.2760314941406 | [0.05293247 0.07508902 0.09302268] | [0.02323807 0.02791786 0.03120368] | [0.00308403 0.00219554 0.00182006] | [0.06032554 0.08544214 0.10557166] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6924635171890259 BPR_loss 0.6924312114715576 reg_loss 3.232106246287003e-05
epoch: 1 s: 256000 batch_loss 0.6916683912277222 BPR_loss 0.6915878057479858 reg_loss 8.060682739596814e-05
epoch: 1 s: 512000 batch_loss 0.6899871230125427 BPR_loss 0.6898149251937866 reg_loss 0.00017219998699147254
epoch: 1 s: 768000 batch_loss 0.6876277923583984 BPR_loss 0.6873511672019958 reg_loss 0.0002766424440778792
epoch: 1 s: 1024000 batch_loss 0.6848166584968567 BPR_loss 0.684387743473053 reg_loss 0.00042891473276540637
epoch: 1 s: 1280000 batch_loss 0.6817910075187683 BPR_loss 0.6811736226081848 reg_loss 0.000617374200373888
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 67.60773944854736 | 241.02332019805908 | 458.9007568359375 | [0.03994297 0.06148629 0.07772162] | [0.01816452 0.02270454 0.02566974] | [0.00225711 0.0017591  0.00148904] | [0.04447771 0.06875023 0.08695462] |
|   1   | 67.60773944854736 | 229.0013222694397  | 458.9007568359375 | [0.0562082  0.08196036 0.10054745] | [0.02507446 0.03049427 0.03390569] | [0.00326327 0.00237714 0.00195623] | [0.06392601 0.09245399 0.11342651] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6803833246231079 BPR_loss 0.6797215938568115 reg_loss 0.0006617558537982404
epoch: 2 s: 256000 batch_loss 0.6764937043190002 BPR_loss 0.675643801689148 reg_loss 0.0008498826064169407
epoch: 2 s: 512000 batch_loss 0.6746262311935425 BPR_loss 0.6735617518424988 reg_loss 0.001064493553712964
epoch: 2 s: 768000 batch_loss 0.6667114496231079 BPR_loss 0.6654652953147888 reg_loss 0.001246124622412026
epoch: 2 s: 1024000 batch_loss 0.6641422510147095 BPR_loss 0.6625661849975586 reg_loss 0.0015760837122797966
epoch: 2 s: 1280000 batch_loss 0.6572834253311157 BPR_loss 0.6554552912712097 reg_loss 0.001828105072490871
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 67.48937344551086 | 236.2859799861908  | 446.9537353515625 | [0.04075973 0.06240206 0.07895497] | [0.01854727 0.02310221 0.02612483] | [0.00230859 0.00178375 0.00150973] | [0.04549272 0.06970682 0.08810836] |
|   2   | 67.48937344551086 | 224.26484179496765 | 446.9537353515625 | [0.05830415 0.08457252 0.10402373] | [0.02596943 0.03150961 0.03507078] | [0.00336923 0.00245474 0.00202057] | [0.06602168 0.09548721 0.11733424] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6561285853385925 BPR_loss 0.6541235446929932 reg_loss 0.002005012007430196
epoch: 3 s: 256000 batch_loss 0.6492999792098999 BPR_loss 0.6471269130706787 reg_loss 0.002173088723793626
epoch: 3 s: 512000 batch_loss 0.6458858251571655 BPR_loss 0.6433976888656616 reg_loss 0.002488139783963561
epoch: 3 s: 768000 batch_loss 0.646625816822052 BPR_loss 0.6439841389656067 reg_loss 0.0026416629552841187
epoch: 3 s: 1024000 batch_loss 0.6396529078483582 BPR_loss 0.6367110013961792 reg_loss 0.00294188573025167
epoch: 3 s: 1280000 batch_loss 0.6362335085868835 BPR_loss 0.6331546306610107 reg_loss 0.0030788832809776068
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 67.38963317871094 | 235.62297677993774 | 431.1471252441406 | [0.04228013 0.0640861  0.0807921 ] | [0.01922207 0.02380349 0.02685354] | [0.0023933  0.00183103 0.00154527] | [0.04715762 0.07156888 0.09024061] |
|   3   | 67.38963317871094 | 229.0098614692688  | 431.1471252441406 | [0.05952892 0.08598626 0.10534015] | [0.02644596 0.03200673 0.0355597 ] | [0.00343541 0.00248487 0.00204486] | [0.06735315 0.09670049 0.11873661] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.6353124976158142 BPR_loss 0.6319741606712341 reg_loss 0.0033383406698703766
epoch: 4 s: 256000 batch_loss 0.6244534254074097 BPR_loss 0.6205525398254395 reg_loss 0.003900890937075019
epoch: 4 s: 512000 batch_loss 0.6226106286048889 BPR_loss 0.618793249130249 reg_loss 0.003817368298768997
epoch: 4 s: 768000 batch_loss 0.6218796372413635 BPR_loss 0.6176283359527588 reg_loss 0.0042513092048466206
epoch: 4 s: 1024000 batch_loss 0.6181673407554626 BPR_loss 0.6136726140975952 reg_loss 0.00449471827596426
epoch: 4 s: 1280000 batch_loss 0.6087567210197449 BPR_loss 0.6040839552879333 reg_loss 0.004672740586102009
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 67.66798877716064 | 240.85594511032104 | 414.6441650390625 | [0.04274064 0.06448855 0.08137632] | [0.01952138 0.02409174 0.02717989] | [0.00241557 0.00183924 0.00155427] | [0.04763956 0.07189748 0.09086129] |
|   4   | 67.66798877716064 | 222.70599508285522 | 414.6441650390625 | [0.06042344 0.08714184 0.10675711] | [0.02678156 0.03240562 0.03600108] | [0.0034815  0.0025219  0.00207099] | [0.06825129 0.09816589 0.12026503] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.6100921034812927 BPR_loss 0.6053224802017212 reg_loss 0.0047696433030068874
epoch: 5 s: 256000 batch_loss 0.6000766754150391 BPR_loss 0.5948066711425781 reg_loss 0.005270009394735098
epoch: 5 s: 512000 batch_loss 0.6036290526390076 BPR_loss 0.597926676273346 reg_loss 0.005702379159629345
epoch: 5 s: 768000 batch_loss 0.5961461663246155 BPR_loss 0.5905148386955261 reg_loss 0.005631349980831146
epoch: 5 s: 1024000 batch_loss 0.5896297693252563 BPR_loss 0.5835425853729248 reg_loss 0.006087210029363632
epoch: 5 s: 1280000 batch_loss 0.5841699242591858 BPR_loss 0.5780713558197021 reg_loss 0.006098567042499781
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 67.29914283752441 | 235.52354216575623 | 398.24658203125 | [0.04344952 0.06516842 0.08222007] | [0.01969997 0.02425869 0.02737702] | [0.00245427 0.00185567 0.00156949] | [0.04838439 0.07259849 0.09182519] |
|   5   | 67.29914283752441 | 227.34584283828735 | 398.24658203125 | [0.06088164 0.08789795 0.1076459 ] | [0.02711811 0.03280551 0.03642691] | [0.00350592 0.00254061 0.00208635] | [0.06875551 0.09894586 0.12121045] |
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.5763293504714966 BPR_loss 0.5699353814125061 reg_loss 0.006393975578248501
epoch: 6 s: 256000 batch_loss 0.5816597938537598 BPR_loss 0.5751557946205139 reg_loss 0.006504009012132883
epoch: 6 s: 512000 batch_loss 0.5719122290611267 BPR_loss 0.5645201802253723 reg_loss 0.0073920669965445995
epoch: 6 s: 768000 batch_loss 0.5737285614013672 BPR_loss 0.5667069554328918 reg_loss 0.007021618541330099
epoch: 6 s: 1024000 batch_loss 0.5668339133262634 BPR_loss 0.5595400333404541 reg_loss 0.007293865084648132
epoch: 6 s: 1280000 batch_loss 0.5569406151771545 BPR_loss 0.5492197275161743 reg_loss 0.0077208904549479485
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 67.27481198310852 | 237.2020070552826  | 382.35784912109375 | [0.043725   0.06563227 0.08188532] | [0.01980819 0.02440558 0.02737922] | [0.00246924 0.00186973 0.00156279] | [0.04866187 0.07317536 0.09132864] |
|   6   | 67.27481198310852 | 223.19174098968506 | 382.35784912109375 | [0.06139752 0.08879712 0.10849671] | [0.02745786 0.0332238  0.0368349 ] | [0.00352917 0.00256346 0.00210093] | [0.06924398 0.09994643 0.1220692 ] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.5522823333740234 BPR_loss 0.5442742109298706 reg_loss 0.00800812616944313
epoch: 7 s: 256000 batch_loss 0.5549911856651306 BPR_loss 0.5466179847717285 reg_loss 0.008373182266950607
epoch: 7 s: 512000 batch_loss 0.5580487847328186 BPR_loss 0.550042986869812 reg_loss 0.008005826734006405
epoch: 7 s: 768000 batch_loss 0.5468420386314392 BPR_loss 0.5383954644203186 reg_loss 0.008446584455668926
epoch: 7 s: 1024000 batch_loss 0.5424811244010925 BPR_loss 0.5334948897361755 reg_loss 0.00898623839020729
epoch: 7 s: 1280000 batch_loss 0.5386760830879211 BPR_loss 0.5298947691917419 reg_loss 0.008781340904533863
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 67.60295391082764 | 236.13057231903076 | 367.1577453613281 | [0.04402117 0.06644747 0.08264302] | [0.01998048 0.02468428 0.02764561] | [0.00248494 0.00188999 0.00157703] | [0.04901238 0.07403702 0.09224871] |
|   7   | 67.60295391082764 | 222.59885501861572 | 367.1577453613281 | [0.06211165 0.08951502 0.10933797] | [0.02785791 0.0336261  0.03725262] | [0.00356974 0.00258631 0.00211603] | [0.07007122 0.10078942 0.12292008] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.5454728007316589 BPR_loss 0.5361541509628296 reg_loss 0.009318658150732517
epoch: 8 s: 256000 batch_loss 0.5337318778038025 BPR_loss 0.5239995718002319 reg_loss 0.009732292033731937
epoch: 8 s: 512000 batch_loss 0.5319927334785461 BPR_loss 0.5226606726646423 reg_loss 0.009332059882581234
epoch: 8 s: 768000 batch_loss 0.5333653688430786 BPR_loss 0.5233234167098999 reg_loss 0.010041946545243263
epoch: 8 s: 1024000 batch_loss 0.5347118377685547 BPR_loss 0.5244502425193787 reg_loss 0.01026157010346651
epoch: 8 s: 1280000 batch_loss 0.520118772983551 BPR_loss 0.5092136859893799 reg_loss 0.010905076749622822
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 67.50613117218018 | 236.8161644935608  | 352.3757019042969 | [0.04418988 0.06661372 0.08321072] | [0.02011919 0.02483161 0.02786292] | [0.00249334 0.00189492 0.00158616] | [0.04923144 0.07422688 0.0928621 ] |
|   8   | 67.50613117218018 | 220.55799221992493 | 352.3757019042969 | [0.06204721 0.08921553 0.10952784] | [0.02770241 0.03342181 0.03714542] | [0.00356226 0.00257193 0.00211852] | [0.0698585  0.10030884 0.12304614] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.5316035151481628 BPR_loss 0.5211732387542725 reg_loss 0.010430285707116127
epoch: 9 s: 256000 batch_loss 0.510566234588623 BPR_loss 0.4992743730545044 reg_loss 0.011291848495602608
epoch: 9 s: 512000 batch_loss 0.5062394142150879 BPR_loss 0.4951154887676239 reg_loss 0.011123948730528355
epoch: 9 s: 768000 batch_loss 0.5044792890548706 BPR_loss 0.49303513765335083 reg_loss 0.011444132775068283
epoch: 9 s: 1024000 batch_loss 0.49387410283088684 BPR_loss 0.4823608100414276 reg_loss 0.011513288132846355
epoch: 9 s: 1280000 batch_loss 0.5109496116638184 BPR_loss 0.4989783763885498 reg_loss 0.011971225962042809
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 68.13447904586792 | 237.23191595077515 | 338.1524658203125 | [0.04489038 0.06699737 0.08371909] | [0.02040821 0.0250506  0.02810595] | [0.00253021 0.00190314 0.00159407] | [0.04996897 0.07457008 0.09335865] |
|   9   | 68.13447904586792 | 225.9563205242157  | 338.1524658203125 | [0.06224199 0.08980381 0.10987025] | [0.02788198 0.03367823 0.03736296] | [0.00357368 0.00258473 0.00212496] | [0.07008698 0.1007973  0.12344794] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.4986285865306854 BPR_loss 0.48651671409606934 reg_loss 0.012111874297261238
epoch: 10 s: 256000 batch_loss 0.48734331130981445 BPR_loss 0.47521716356277466 reg_loss 0.012126133777201176
epoch: 10 s: 512000 batch_loss 0.4906114339828491 BPR_loss 0.47773808240890503 reg_loss 0.012873358093202114
epoch: 10 s: 768000 batch_loss 0.4768840968608856 BPR_loss 0.4640659689903259 reg_loss 0.012818126007914543
epoch: 10 s: 1024000 batch_loss 0.48135441541671753 BPR_loss 0.46862584352493286 reg_loss 0.012728557921946049
epoch: 10 s: 1280000 batch_loss 0.4795931577682495 BPR_loss 0.46658557653427124 reg_loss 0.013007568195462227
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 67.47569680213928 | 240.06923651695251 | 324.5506286621094 | [0.04505337 0.06741439 0.08377922] | [0.02048673 0.0251871  0.02817849] | [0.00253642 0.00191555 0.00159699] | [0.05010041 0.07505933 0.0935412 ] |
|   10  | 67.47569680213928 | 226.25876903533936 | 324.5506286621094 | [0.06258237 0.08994039 0.11014876] | [0.02799613 0.03374712 0.03744998] | [0.00359298 0.00259044 0.00212798] | [0.07047302 0.10097851 0.12370005] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.4759708046913147 BPR_loss 0.4625628590583801 reg_loss 0.013407949358224869
epoch: 11 s: 256000 batch_loss 0.4737864136695862 BPR_loss 0.46014025807380676 reg_loss 0.013646166771650314
epoch: 11 s: 512000 batch_loss 0.4669683873653412 BPR_loss 0.45288193225860596 reg_loss 0.014086449518799782
epoch: 11 s: 768000 batch_loss 0.471931129693985 BPR_loss 0.4578912854194641 reg_loss 0.014039849862456322
epoch: 11 s: 1024000 batch_loss 0.469487726688385 BPR_loss 0.45493847131729126 reg_loss 0.014549248851835728
epoch: 11 s: 1280000 batch_loss 0.4510146379470825 BPR_loss 0.436206579208374 reg_loss 0.014808057807385921
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 67.53124499320984 | 238.82897996902466 | 311.9768371582031 | [0.0452711  0.06769818 0.08408301] | [0.02067287 0.02538954 0.02838464] | [0.00254956 0.00192103 0.00160125] | [0.05037059 0.07532951 0.09380408] |
|   11  | 67.53124499320984 | 225.35086035728455 | 311.9768371582031 | [0.06275976 0.09001168 0.11025705] | [0.02802988 0.0337557  0.03746536] | [0.00360165 0.00259163 0.00213021] | [0.07063847 0.10107305 0.12387338] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.4644245207309723 BPR_loss 0.4495967626571655 reg_loss 0.014827767387032509
epoch: 12 s: 256000 batch_loss 0.4484628438949585 BPR_loss 0.4331972002983093 reg_loss 0.015265635214745998
epoch: 12 s: 512000 batch_loss 0.4441388249397278 BPR_loss 0.42863428592681885 reg_loss 0.01550452969968319
epoch: 12 s: 768000 batch_loss 0.45178303122520447 BPR_loss 0.4363909661769867 reg_loss 0.01539206225425005
epoch: 12 s: 1024000 batch_loss 0.440466970205307 BPR_loss 0.4245022237300873 reg_loss 0.015964748337864876
epoch: 12 s: 1280000 batch_loss 0.4362417459487915 BPR_loss 0.4199749827384949 reg_loss 0.016266752034425735
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 67.18707871437073 | 242.64767718315125 | 299.29608154296875 | [0.04560989 0.06801036 0.08423302] | [0.02069254 0.02540091 0.02836477] | [0.00256453 0.00192924 0.0016032 ] | [0.05068458 0.07566541 0.09396473] |
|   12  | 67.18707871437073 | 223.55936574935913 | 299.29608154296875 | [0.06274735 0.09011563 0.11040867] | [0.02817795 0.03392447 0.03764044] | [0.00359771 0.00258985 0.00213021] | [0.07056757 0.10103366 0.12387338] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.4349319040775299 BPR_loss 0.41887199878692627 reg_loss 0.01605989597737789
epoch: 13 s: 256000 batch_loss 0.4308337867259979 BPR_loss 0.4149726927280426 reg_loss 0.015861088410019875
epoch: 13 s: 512000 batch_loss 0.43455612659454346 BPR_loss 0.4185384511947632 reg_loss 0.016017664223909378
epoch: 13 s: 768000 batch_loss 0.42804330587387085 BPR_loss 0.4113312363624573 reg_loss 0.01671207882463932
epoch: 13 s: 1024000 batch_loss 0.42780032753944397 BPR_loss 0.4107905626296997 reg_loss 0.017009766772389412
epoch: 13 s: 1280000 batch_loss 0.4188869297504425 BPR_loss 0.40127962827682495 reg_loss 0.0176073145121336
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 67.35921812057495 | 241.7961299419403 | 287.5273742675781 | [0.04574945 0.06797786 0.08397741] | [0.02082166 0.02549408 0.02842017] | [0.00257111 0.00192742 0.00159723] | [0.05081602 0.07559239 0.09368725] |
|   13  | 67.35921812057495 | 218.8159158229828 | 287.5273742675781 | [0.06280174 0.09005082 0.11053339] | [0.02811227 0.03383691 0.03758696] | [0.0035981  0.00258828 0.00213126] | [0.0705912  0.10095487 0.12390489] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.4163932502269745 BPR_loss 0.39867502450942993 reg_loss 0.017718227580189705
epoch: 14 s: 256000 batch_loss 0.42260289192199707 BPR_loss 0.404828816652298 reg_loss 0.01777406968176365
epoch: 14 s: 512000 batch_loss 0.4193783700466156 BPR_loss 0.40148043632507324 reg_loss 0.017897937446832657
epoch: 14 s: 768000 batch_loss 0.4077085256576538 BPR_loss 0.38957202434539795 reg_loss 0.018136490136384964
epoch: 14 s: 1024000 batch_loss 0.40335631370544434 BPR_loss 0.3848256766796112 reg_loss 0.018530625849962234
epoch: 14 s: 1280000 batch_loss 0.40434330701828003 BPR_loss 0.38619500398635864 reg_loss 0.01814831793308258
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 67.21097040176392 | 239.98631405830383 | 275.9602355957031 | [0.04563311 0.06811048 0.08401925] | [0.02083278 0.02555649 0.02846984] | [0.00256271 0.00192869 0.00159736] | [0.05064077 0.07571653 0.09372376] |
|   14  | 67.21097040176392 | 218.95210552215576 | 275.9602355957031 | [0.06300083 0.08980966 0.11040596] | [0.02820268 0.03383086 0.03760369] | [0.00360992 0.00258119 0.00212877] | [0.07083543 0.100687   0.1237552 ] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.3978798985481262 BPR_loss 0.3793182969093323 reg_loss 0.01856158673763275
epoch: 15 s: 256000 batch_loss 0.38884422183036804 BPR_loss 0.3699469566345215 reg_loss 0.01889726333320141
epoch: 15 s: 512000 batch_loss 0.4098755121231079 BPR_loss 0.3918710947036743 reg_loss 0.018004409968852997
epoch: 15 s: 768000 batch_loss 0.4002891182899475 BPR_loss 0.3809371292591095 reg_loss 0.01935199834406376
epoch: 15 s: 1024000 batch_loss 0.38629019260406494 BPR_loss 0.36598557233810425 reg_loss 0.02030463144183159
epoch: 15 s: 1280000 batch_loss 0.3949825167655945 BPR_loss 0.37553009390830994 reg_loss 0.01945243775844574
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 67.54267954826355 | 241.6349015235901  | 265.0238952636719 | [0.04585917 0.06812137 0.08409201] | [0.02090595 0.02558382 0.02850771] | [0.00257403 0.00192924 0.0015993 ] | [0.05091825 0.07573844 0.0938479 ] |
|   15  | 67.54267954826355 | 221.89247632026672 | 265.0238952636719 | [0.06287798 0.08972552 0.11012191] | [0.02822074 0.03386447 0.037601  ] | [0.00359692 0.0025804  0.00212312] | [0.0705912  0.10066337 0.12343218] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.385377436876297 BPR_loss 0.36596399545669556 reg_loss 0.019413450732827187
epoch: 16 s: 256000 batch_loss 0.38879355788230896 BPR_loss 0.36873888969421387 reg_loss 0.020054658874869347
epoch: 16 s: 512000 batch_loss 0.38153988122940063 BPR_loss 0.36107176542282104 reg_loss 0.020468126982450485
epoch: 16 s: 768000 batch_loss 0.3767522871494293 BPR_loss 0.3557877838611603 reg_loss 0.020964516326785088
epoch: 16 s: 1024000 batch_loss 0.3815727233886719 BPR_loss 0.36106550693511963 reg_loss 0.02050722762942314
epoch: 16 s: 1280000 batch_loss 0.3769989311695099 BPR_loss 0.3566223978996277 reg_loss 0.020376522094011307
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 67.21583604812622 | 241.40310072898865 | 254.74234008789062 | [0.04580126 0.06815541 0.08394922] | [0.02084587 0.02554658 0.02843513] | [0.00256891 0.00192997 0.00159553] | [0.05079411 0.07576764 0.09362153] |
|   16  | 67.21583604812622 | 225.7068383693695  | 254.74234008789062 | [0.06287103 0.08953629 0.11024881] | [0.0281918  0.03380163 0.03759372] | [0.00359495 0.00257587 0.0021268 ] | [0.07055181 0.10043489 0.12362127] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.3664363920688629 BPR_loss 0.34563350677490234 reg_loss 0.020802892744541168
epoch: 17 s: 256000 batch_loss 0.37185147404670715 BPR_loss 0.3504570722579956 reg_loss 0.021394405514001846
epoch: 17 s: 512000 batch_loss 0.36019450426101685 BPR_loss 0.3391900360584259 reg_loss 0.021004464477300644
epoch: 17 s: 768000 batch_loss 0.3594166934490204 BPR_loss 0.33767420053482056 reg_loss 0.021742500364780426
epoch: 17 s: 1024000 batch_loss 0.36167019605636597 BPR_loss 0.34027618169784546 reg_loss 0.021393999457359314
epoch: 17 s: 1280000 batch_loss 0.3588969111442566 BPR_loss 0.33714601397514343 reg_loss 0.021750900894403458
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 67.19829630851746 | 244.85656070709229 | 244.56117248535156 | [0.04592143 0.06838498 0.08404479] | [0.02095999 0.02568315 0.02854557] | [0.00257293 0.00193399 0.00159553] | [0.05085983 0.0759648  0.09367994] |
|   17  | 67.19829630851746 | 227.61741614341736 | 244.56117248535156 | [0.06295247 0.08953917 0.11020863] | [0.02822555 0.03381626 0.03760196] | [0.0036048  0.00257745 0.00212614] | [0.07075665 0.10049004 0.12358975] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.36689963936805725 BPR_loss 0.3450359106063843 reg_loss 0.02186371572315693
epoch: 18 s: 256000 batch_loss 0.350502610206604 BPR_loss 0.3286541998386383 reg_loss 0.021848395466804504
epoch: 18 s: 512000 batch_loss 0.3604167699813843 BPR_loss 0.3377534747123718 reg_loss 0.022663304582238197
epoch: 18 s: 768000 batch_loss 0.35494890809059143 BPR_loss 0.3326575756072998 reg_loss 0.02229134552180767
epoch: 18 s: 1024000 batch_loss 0.33522936701774597 BPR_loss 0.3122153878211975 reg_loss 0.023013969883322716
epoch: 18 s: 1280000 batch_loss 0.3541596233844757 BPR_loss 0.3315269947052002 reg_loss 0.022632628679275513
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 67.4273419380188 |  240.979079246521 | 235.69735717773438 | [0.04575606 0.0683012  0.08398283] | [0.020971   0.02571375 0.02857751] | [0.00256636 0.00193198 0.00159261] | [0.0507357  0.07588448 0.09356311] |
|   18  | 67.4273419380188 | 224.2724483013153 | 235.69735717773438 | [0.06271811 0.089547   0.11001982] | [0.02820978 0.03384694 0.03759141] | [0.00358747 0.00257449 0.00212076] | [0.07037848 0.10040338 0.12325886] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.34829089045524597 BPR_loss 0.32563430070877075 reg_loss 0.022656576707959175
epoch: 19 s: 256000 batch_loss 0.3357604742050171 BPR_loss 0.31198686361312866 reg_loss 0.02377360500395298
epoch: 19 s: 512000 batch_loss 0.3331094980239868 BPR_loss 0.3099430203437805 reg_loss 0.023166479542851448
epoch: 19 s: 768000 batch_loss 0.33899518847465515 BPR_loss 0.31523412466049194 reg_loss 0.02376105822622776
epoch: 19 s: 1024000 batch_loss 0.3441227674484253 BPR_loss 0.3201563060283661 reg_loss 0.023966452106833458
epoch: 19 s: 1280000 batch_loss 0.33483725786209106 BPR_loss 0.31090742349624634 reg_loss 0.023929838091135025
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 66.8528323173523 | 241.41632986068726 | 226.72047424316406 | [0.04557551 0.06796507 0.08397422] | [0.02089247 0.02560215 0.02852373] | [0.00255395 0.00192157 0.00159164] | [0.05050203 0.07547556 0.09347548] |
|   19  | 66.8528323173523 | 221.51264572143555 | 226.72047424316406 | [0.06261651 0.08933762 0.10984237] | [0.02820522 0.03382538 0.03757527] | [0.00358195 0.00256779 0.00211655] | [0.07028394 0.10013551 0.12306977] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.33973321318626404 BPR_loss 0.316418319940567 reg_loss 0.023314889520406723
epoch: 20 s: 256000 batch_loss 0.32520976662635803 BPR_loss 0.3009513020515442 reg_loss 0.024258453398942947
epoch: 20 s: 512000 batch_loss 0.323857843875885 BPR_loss 0.299631267786026 reg_loss 0.024226561188697815
epoch: 20 s: 768000 batch_loss 0.3239561915397644 BPR_loss 0.2996062934398651 reg_loss 0.024349883198738098
epoch: 20 s: 1024000 batch_loss 0.32994550466537476 BPR_loss 0.3053598999977112 reg_loss 0.024585606530308723
epoch: 20 s: 1280000 batch_loss 0.3246181905269623 BPR_loss 0.3001789152622223 reg_loss 0.024439284577965736
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 67.54740357398987 | 235.60768032073975 | 218.31246948242188 | [0.04562359 0.06796924 0.0836833 ] | [0.02090722 0.02560833 0.02847317] | [0.00255358 0.00192176 0.00158446] | [0.05048742 0.07549016 0.09305926] |
|   20  | 67.54740357398987 | 223.4952051639557  | 218.31246948242188 | [0.06270599 0.08969329 0.10972245] | [0.02821076 0.03388041 0.03754313] | [0.00358353 0.00257784 0.00211367] | [0.07033121 0.10060034 0.12295947] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.31874194741249084 BPR_loss 0.29367950558662415 reg_loss 0.025062447413802147
epoch: 21 s: 256000 batch_loss 0.30930235981941223 BPR_loss 0.2846272885799408 reg_loss 0.02467508427798748
epoch: 21 s: 512000 batch_loss 0.31657400727272034 BPR_loss 0.29135966300964355 reg_loss 0.025214357301592827
epoch: 21 s: 768000 batch_loss 0.3065973222255707 BPR_loss 0.28078693151474 reg_loss 0.025810401886701584
epoch: 21 s: 1024000 batch_loss 0.3165144920349121 BPR_loss 0.290949285030365 reg_loss 0.025565197691321373
epoch: 21 s: 1280000 batch_loss 0.30663272738456726 BPR_loss 0.2814488410949707 reg_loss 0.02518388070166111
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 67.01098370552063 | 242.55040621757507 | 210.41680908203125 | [0.04578917 0.06800052 0.0838196 ] | [0.02098006 0.02565284 0.02854039] | [0.00256125 0.00192249 0.00158859] | [0.05066267 0.07554858 0.09331483] |
|   21  | 67.01098370552063 | 219.32390689849854 | 210.41680908203125 | [0.06256499 0.08934826 0.10933189] | [0.02813505 0.03376342 0.03741883] | [0.0035721  0.00256701 0.00210526] | [0.07013425 0.10019066 0.12249464] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.3114211857318878 BPR_loss 0.2851974070072174 reg_loss 0.026223784312605858
epoch: 22 s: 256000 batch_loss 0.30062755942344666 BPR_loss 0.27520617842674255 reg_loss 0.02542138658463955
epoch: 22 s: 512000 batch_loss 0.31047695875167847 BPR_loss 0.284934401512146 reg_loss 0.025542553514242172
epoch: 22 s: 768000 batch_loss 0.3010198175907135 BPR_loss 0.27520492672920227 reg_loss 0.025814885273575783
epoch: 22 s: 1024000 batch_loss 0.3009507358074188 BPR_loss 0.2745046615600586 reg_loss 0.026446063071489334
epoch: 22 s: 1280000 batch_loss 0.2971515655517578 BPR_loss 0.2700071334838867 reg_loss 0.027144426479935646
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 67.65984678268433 | 234.9199869632721 | 203.1332244873047 | [0.04554315 0.06773002 0.0830958 ] | [0.02079926 0.02546589 0.02827323] | [0.00254372 0.00191372 0.00157496] | [0.05034138 0.07521268 0.09251889] |
|   22  | 67.65984678268433 |  224.534606218338 | 203.1332244873047 | [0.06233741 0.08909105 0.10915655] | [0.02809298 0.03371535 0.03738404] | [0.0035658  0.00256149 0.0021029 ] | [0.06999244 0.09993067 0.12232132] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.2987959384918213 BPR_loss 0.27168041467666626 reg_loss 0.027115533128380775
epoch: 23 s: 256000 batch_loss 0.29537469148635864 BPR_loss 0.26857468485832214 reg_loss 0.026800017803907394
epoch: 23 s: 512000 batch_loss 0.2872406840324402 BPR_loss 0.25980105996131897 reg_loss 0.027439633384346962
epoch: 23 s: 768000 batch_loss 0.2919531464576721 BPR_loss 0.2643585205078125 reg_loss 0.027594633400440216
epoch: 23 s: 1024000 batch_loss 0.29549258947372437 BPR_loss 0.2681184411048889 reg_loss 0.027374133467674255
epoch: 23 s: 1280000 batch_loss 0.2840390205383301 BPR_loss 0.25663524866104126 reg_loss 0.02740376815199852
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 67.73492574691772 | 237.59743762016296 | 195.674560546875 | [0.04552672 0.0674089  0.08289031] | [0.02085174 0.02545413 0.02828226] | [0.00254445 0.00190496 0.00157095] | [0.05034868 0.07484757 0.09228522] |
|   23  | 67.73492574691772 | 227.76318073272705 | 195.674560546875 | [0.06219236 0.08865256 0.10888804] | [0.02805017 0.03361603 0.03731563] | [0.00355556 0.00254987 0.00209686] | [0.06979547 0.0994816  0.12205345] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.2826155126094818 BPR_loss 0.2554606795310974 reg_loss 0.0271548330783844
epoch: 24 s: 256000 batch_loss 0.2817962169647217 BPR_loss 0.2543921172618866 reg_loss 0.02740410342812538
epoch: 24 s: 512000 batch_loss 0.2772555947303772 BPR_loss 0.2493220716714859 reg_loss 0.02793353796005249
epoch: 24 s: 768000 batch_loss 0.27827340364456177 BPR_loss 0.24960865080356598 reg_loss 0.02866474539041519
epoch: 24 s: 1024000 batch_loss 0.2764928340911865 BPR_loss 0.24787402153015137 reg_loss 0.02861880697309971
epoch: 24 s: 1280000 batch_loss 0.27976930141448975 BPR_loss 0.25085628032684326 reg_loss 0.02891300618648529
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 67.46353936195374 | 238.22398853302002 | 189.2285614013672 | [0.04546909 0.06722089 0.08250652] | [0.0208018  0.02537005 0.02816272] | [0.00254153 0.00189802 0.00156243] | [0.05030487 0.0746285  0.091869  ] |
|   24  | 67.46353936195374 | 221.04638600349426 | 189.2285614013672 | [0.06196935 0.08861981 0.10874564] | [0.02802694 0.03363379 0.0373134 ] | [0.00354335 0.00254751 0.00209397] | [0.06955912 0.09940281 0.121888  ] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.061969351295944254
early stopping at 24, recall@20:0.0630
