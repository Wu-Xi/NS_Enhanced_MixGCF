Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='amazon', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.0001, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931530833244324 BPR_loss 0.6931528449058533 reg_loss 2.204578777309507e-07
epoch: 0 s: 256000 batch_loss 0.6931544542312622 BPR_loss 0.6931537389755249 reg_loss 7.121087719497154e-07
epoch: 0 s: 512000 batch_loss 0.6931576132774353 BPR_loss 0.6931560039520264 reg_loss 1.6078579392342363e-06
epoch: 0 s: 768000 batch_loss 0.6931475400924683 BPR_loss 0.6931443214416504 reg_loss 3.2161774470296223e-06
epoch: 0 s: 1024000 batch_loss 0.6931300759315491 BPR_loss 0.6931244134902954 reg_loss 5.675407919625286e-06
epoch: 0 s: 1280000 batch_loss 0.6930639147758484 BPR_loss 0.6930544376373291 reg_loss 9.492925528320484e-06
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 125.34708094596863 | 366.2244119644165  | 462.32147216796875 | [0.0267031  0.0417553  0.05252421] | [0.0120411  0.01521643 0.01718804] | [0.00152653 0.00120961 0.00101793] | [0.03010698 0.0474132  0.05965168] |
|   0   | 125.34708094596863 | 338.53854990005493 | 462.32147216796875 | [0.04040163 0.05777818 0.07033024] | [0.01825846 0.02193005 0.02424287] | [0.00235803 0.00169328 0.00138451] | [0.04607336 0.06591138 0.08046294] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6928114891052246 BPR_loss 0.6928001642227173 reg_loss 1.1320747034915257e-05
epoch: 1 s: 256000 batch_loss 0.6925983428955078 BPR_loss 0.692579448223114 reg_loss 1.887248072307557e-05
epoch: 1 s: 512000 batch_loss 0.6922511458396912 BPR_loss 0.6922207474708557 reg_loss 3.0396193324122578e-05
epoch: 1 s: 768000 batch_loss 0.6916746497154236 BPR_loss 0.6916322112083435 reg_loss 4.246016760589555e-05
epoch: 1 s: 1024000 batch_loss 0.6909881830215454 BPR_loss 0.6909304857254028 reg_loss 5.770499410573393e-05
epoch: 1 s: 1280000 batch_loss 0.6903963685035706 BPR_loss 0.6903207302093506 reg_loss 7.56320368964225e-05
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 121.84922409057617 | 368.10633182525635 | 461.40191650390625 | [0.034452   0.05167683 0.06448535] | [0.01592786 0.01957681 0.0219277 ] | [0.00197232 0.0014944  0.00124989] | [0.03882581 0.0583884  0.07300011] |
|   1   | 121.84922409057617 | 338.56774401664734 | 461.40191650390625 | [0.0482421  0.06874317 0.08437525] | [0.02178951 0.02611699 0.0289851 ] | [0.00280356 0.00200429 0.00164831] | [0.0549209  0.07806    0.09588901] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6888695359230042 BPR_loss 0.6887875199317932 reg_loss 8.199961303034797e-05
epoch: 2 s: 256000 batch_loss 0.6875547766685486 BPR_loss 0.6874508261680603 reg_loss 0.00010394534911029041
epoch: 2 s: 512000 batch_loss 0.6867645382881165 BPR_loss 0.6866357326507568 reg_loss 0.00012880157737527043
epoch: 2 s: 768000 batch_loss 0.6846943497657776 BPR_loss 0.6845406293869019 reg_loss 0.00015369817265309393
epoch: 2 s: 1024000 batch_loss 0.6834205985069275 BPR_loss 0.6832331418991089 reg_loss 0.00018746058049146086
epoch: 2 s: 1280000 batch_loss 0.6809503436088562 BPR_loss 0.6807312965393066 reg_loss 0.0002190587401855737
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 123.49146056175232 | 359.37239384651184 | 457.13946533203125 | [0.03648475 0.05468588 0.06812551] | [0.0170899  0.02093237 0.02338984] | [0.00209354 0.00157928 0.00131671] | [0.04115521 0.06165979 0.07676805] |
|   2   | 123.49146056175232 | 333.10553073883057 | 457.13946533203125 | [0.05085569 0.07270647 0.08922547] | [0.02285262 0.02747117 0.0304947 ] | [0.00295089 0.00212483 0.00174114] | [0.05778079 0.08270043 0.10107305] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6781207919120789 BPR_loss 0.6778830289840698 reg_loss 0.00023777343449182808
epoch: 3 s: 256000 batch_loss 0.6756071448326111 BPR_loss 0.6753406524658203 reg_loss 0.0002665171050466597
epoch: 3 s: 512000 batch_loss 0.6740384697914124 BPR_loss 0.6737314462661743 reg_loss 0.00030704677919857204
epoch: 3 s: 768000 batch_loss 0.673263669013977 BPR_loss 0.6729261875152588 reg_loss 0.00033745841938070953
epoch: 3 s: 1024000 batch_loss 0.6717699766159058 BPR_loss 0.671393871307373 reg_loss 0.0003761339175980538
epoch: 3 s: 1280000 batch_loss 0.6694396734237671 BPR_loss 0.669031023979187 reg_loss 0.0004086615517735481
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 124.74342846870422 | 363.5825617313385 | 449.345458984375 | [0.03779548 0.05596315 0.06970482] | [0.01775081 0.02159021 0.0241    ] | [0.00216218 0.00161762 0.00134531] | [0.04252072 0.06313484 0.07847676] |
|   3   | 124.74342846870422 | 341.2885844707489 | 449.345458984375 | [0.05216517 0.07419294 0.09113973] | [0.02345611 0.02809785 0.03120827] | [0.00301982 0.00215792 0.00177725] | [0.05915952 0.08402401 0.10312145] |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.6662588715553284 BPR_loss 0.6658235788345337 reg_loss 0.00043529662070795894
epoch: 4 s: 256000 batch_loss 0.6606316566467285 BPR_loss 0.6601272225379944 reg_loss 0.000504424620885402
epoch: 4 s: 512000 batch_loss 0.6594465374946594 BPR_loss 0.6589325666427612 reg_loss 0.0005139925633557141
epoch: 4 s: 768000 batch_loss 0.6584347486495972 BPR_loss 0.6578660011291504 reg_loss 0.000568736344575882
epoch: 4 s: 1024000 batch_loss 0.6558170318603516 BPR_loss 0.6551927328109741 reg_loss 0.0006243123789317906
epoch: 4 s: 1280000 batch_loss 0.6535962820053101 BPR_loss 0.6529449224472046 reg_loss 0.0006513750413432717
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 125.58852314949036 | 359.2645242214203 | 439.2262878417969 | [0.0381325  0.05685841 0.07104623] | [0.01795429 0.02191172 0.0245022 ] | [0.00217971 0.00164135 0.00136953] | [0.04285662 0.06408412 0.07987148] |
|   4   | 125.58852314949036 | 335.1572256088257 | 439.2262878417969 | [0.05300196 0.0749315  0.09227454] | [0.02380062 0.02842358 0.03159778] | [0.00307103 0.00218254 0.00179708] | [0.06019948 0.0850167  0.10436625] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.648948609828949 BPR_loss 0.6482731103897095 reg_loss 0.0006754955393262208
epoch: 5 s: 256000 batch_loss 0.6444632411003113 BPR_loss 0.6437090635299683 reg_loss 0.0007542032981291413
epoch: 5 s: 512000 batch_loss 0.6436212062835693 BPR_loss 0.6428227424621582 reg_loss 0.0007984856492839754
epoch: 5 s: 768000 batch_loss 0.6407256126403809 BPR_loss 0.6398968696594238 reg_loss 0.0008287627715617418
epoch: 5 s: 1024000 batch_loss 0.6362351775169373 BPR_loss 0.6353350877761841 reg_loss 0.0009000957943499088
epoch: 5 s: 1280000 batch_loss 0.6351557374000549 BPR_loss 0.6342297792434692 reg_loss 0.0009259562357328832
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 123.78374814987183 | 361.3712418079376  | 427.7483215332031 | [0.03866538 0.05743423 0.07137638] | [0.01821657 0.02218228 0.02473447] | [0.00220636 0.00165413 0.00137573] | [0.04338238 0.06463179 0.08033882] |
|   5   | 123.78374814987183 | 349.68991231918335 | 427.7483215332031 | [0.05337685 0.0757231  0.09339317] | [0.02399998 0.02871165 0.03194547] | [0.00309309 0.00220046 0.00181822] | [0.06060129 0.08574152 0.10561893] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.6278669238090515 BPR_loss 0.6269025802612305 reg_loss 0.0009643567609600723
epoch: 6 s: 256000 batch_loss 0.6292118430137634 BPR_loss 0.6282079219818115 reg_loss 0.0010039048502221704
epoch: 6 s: 512000 batch_loss 0.622460126876831 BPR_loss 0.6213597655296326 reg_loss 0.0011003885883837938
epoch: 6 s: 768000 batch_loss 0.6225156784057617 BPR_loss 0.621414840221405 reg_loss 0.0011008341098204255
epoch: 6 s: 1024000 batch_loss 0.6183679103851318 BPR_loss 0.6172235608100891 reg_loss 0.0011443586554378271
epoch: 6 s: 1280000 batch_loss 0.6117256879806519 BPR_loss 0.610492467880249 reg_loss 0.00123322824947536
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 122.63362789154053 | 368.14417338371277 | 415.4683837890625 | [0.03901569 0.0578879  0.07212851] | [0.01834185 0.02232675 0.02492614] | [0.00222681 0.00166837 0.00138864] | [0.04382781 0.06520136 0.08112016] |
|   6   | 122.63362789154053 | 337.96771597862244 | 415.4683837890625 | [0.05355956 0.07604887 0.09331431] | [0.0240657  0.02881089 0.03197606] | [0.00309664 0.00220716 0.00181468] | [0.06072734 0.08597788 0.10547712] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.607723593711853 BPR_loss 0.6064624786376953 reg_loss 0.0012611335841938853
epoch: 7 s: 256000 batch_loss 0.6087899804115295 BPR_loss 0.6074650287628174 reg_loss 0.0013249288313090801
epoch: 7 s: 512000 batch_loss 0.6079355478286743 BPR_loss 0.6066175699234009 reg_loss 0.0013179992092773318
epoch: 7 s: 768000 batch_loss 0.6027218699455261 BPR_loss 0.6013322472572327 reg_loss 0.001389641547575593
epoch: 7 s: 1024000 batch_loss 0.59876948595047 BPR_loss 0.5973045825958252 reg_loss 0.0014648978831246495
epoch: 7 s: 1280000 batch_loss 0.5975094437599182 BPR_loss 0.5960232615470886 reg_loss 0.00148620770778507
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 124.61525869369507 | 362.77375769615173 | 402.767822265625 | [0.03907457 0.05810568 0.07225964] | [0.01835634 0.02237421 0.02496226] | [0.002229   0.00167275 0.00139241] | [0.04391544 0.06538391 0.08131732] |
|   7   | 124.61525869369507 | 338.96722292900085 | 402.767822265625 | [0.0541041  0.07670895 0.09392529] | [0.0242172  0.02898088 0.03213068] | [0.00312697 0.00223119 0.00182663] | [0.06129459 0.08684451 0.10616255] |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.5969282388687134 BPR_loss 0.5953669548034668 reg_loss 0.0015612952411174774
epoch: 8 s: 256000 batch_loss 0.5901873111724854 BPR_loss 0.5885767936706543 reg_loss 0.0016105136601254344
epoch: 8 s: 512000 batch_loss 0.5885516405105591 BPR_loss 0.5869413614273071 reg_loss 0.0016102908411994576
epoch: 8 s: 768000 batch_loss 0.5862064957618713 BPR_loss 0.5844709277153015 reg_loss 0.0017355859745293856
epoch: 8 s: 1024000 batch_loss 0.5857377648353577 BPR_loss 0.583974301815033 reg_loss 0.0017634379910305142
epoch: 8 s: 1280000 batch_loss 0.5753500461578369 BPR_loss 0.5734779238700867 reg_loss 0.00187210482545197
+-------+--------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |      Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 122.08864331245422 | 362.38423562049866 | 389.8037109375 | [0.03909307 0.05816828 0.07249305] | [0.01837906 0.02240509 0.02503054] | [0.00222425 0.00167111 0.00139642] | [0.04382781 0.06536201 0.0815802 ] |
|   8   | 122.08864331245422 | 339.94695949554443 | 389.8037109375 | [0.05387586 0.07687074 0.09368317] | [0.02421788 0.02906587 0.03214926] | [0.00311476 0.00223158 0.00182203] | [0.0610346  0.08686815 0.10583165] |
+-------+--------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.578556478023529 BPR_loss 0.5767067670822144 reg_loss 0.001849703025072813
epoch: 9 s: 256000 batch_loss 0.5688565373420715 BPR_loss 0.5669252872467041 reg_loss 0.001931232400238514
epoch: 9 s: 512000 batch_loss 0.5651971101760864 BPR_loss 0.5632342100143433 reg_loss 0.001962898764759302
epoch: 9 s: 768000 batch_loss 0.5622076988220215 BPR_loss 0.5601519346237183 reg_loss 0.002055755816400051
epoch: 9 s: 1024000 batch_loss 0.5569884777069092 BPR_loss 0.5549115538597107 reg_loss 0.002076895674690604
epoch: 9 s: 1280000 batch_loss 0.5601551532745361 BPR_loss 0.5579909086227417 reg_loss 0.002164251171052456
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 124.63153600692749 | 362.67375230789185 | 376.91070556640625 | [0.03921831 0.05862455 0.07267107] | [0.01845364 0.02254528 0.02511708] | [0.00223484 0.00168425 0.00139874] | [0.04403228 0.06589507 0.08177736] |
|   9   | 124.63153600692749 | 333.92274808883667 | 376.91070556640625 | [0.05390801 0.07679315 0.09363951] | [0.02418595 0.029017   0.03210246] | [0.00311279 0.0022302  0.00182098] | [0.06097945 0.08683663 0.1058159 ] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.5548441410064697 BPR_loss 0.552666187286377 reg_loss 0.0021779462695121765
epoch: 10 s: 256000 batch_loss 0.5492995977401733 BPR_loss 0.5470798015594482 reg_loss 0.0022198038641363382
epoch: 10 s: 512000 batch_loss 0.5550833344459534 BPR_loss 0.5527578592300415 reg_loss 0.0023254570551216602
epoch: 10 s: 768000 batch_loss 0.5450627207756042 BPR_loss 0.5426934361457825 reg_loss 0.0023693081457167864
epoch: 10 s: 1024000 batch_loss 0.5431573390960693 BPR_loss 0.540758490562439 reg_loss 0.00239887204952538
epoch: 10 s: 1280000 batch_loss 0.5358595252037048 BPR_loss 0.5333791971206665 reg_loss 0.0024803385604172945
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 124.08103704452515 | 360.83415150642395 | 364.17230224609375 | [0.03931299 0.05877431 0.07288076] | [0.01847519 0.02257666 0.02516014] | [0.00223849 0.0016879  0.0014036 ] | [0.0441126  0.06603381 0.08208405] |
|   10  | 124.08103704452515 | 341.51546359062195 | 364.17230224609375 | [0.05408557 0.07674468 0.09359133] | [0.02423505 0.02901715 0.03210262] | [0.00311988 0.00222922 0.00181993] | [0.06116066 0.08682875 0.10572923] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.5319868326187134 BPR_loss 0.5294381380081177 reg_loss 0.0025486876256763935
epoch: 11 s: 256000 batch_loss 0.5277353525161743 BPR_loss 0.5251712799072266 reg_loss 0.002564097987487912
epoch: 11 s: 512000 batch_loss 0.5189189314842224 BPR_loss 0.5162639617919922 reg_loss 0.0026549806352704763
epoch: 11 s: 768000 batch_loss 0.5303866863250732 BPR_loss 0.5276786088943481 reg_loss 0.0027081037405878305
epoch: 11 s: 1024000 batch_loss 0.5271764993667603 BPR_loss 0.5243691205978394 reg_loss 0.002807373646646738
epoch: 11 s: 1280000 batch_loss 0.5122000575065613 BPR_loss 0.5093346834182739 reg_loss 0.0028653487097471952
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 120.7737820148468 | 360.3301467895508  | 351.60699462890625 | [0.03939931 0.05897745 0.07307054] | [0.01845849 0.02258361 0.02516525] | [0.00224214 0.00169356 0.00140774] | [0.04420753 0.06630399 0.08234693] |
|   11  | 120.7737820148468 | 349.42188477516174 | 351.60699462890625 | [0.05398065 0.07672976 0.093491  ] | [0.02418167 0.02898442 0.03205189] | [0.00311239 0.00222863 0.00181717] | [0.06102672 0.08686815 0.10557954] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.5190561413764954 BPR_loss 0.5162254571914673 reg_loss 0.0028306960593909025
epoch: 12 s: 256000 batch_loss 0.5086877942085266 BPR_loss 0.5057343244552612 reg_loss 0.002953458810225129
epoch: 12 s: 512000 batch_loss 0.5093597173690796 BPR_loss 0.5063526034355164 reg_loss 0.0030071367509663105
epoch: 12 s: 768000 batch_loss 0.5104584097862244 BPR_loss 0.5074014663696289 reg_loss 0.0030569196678698063
epoch: 12 s: 1024000 batch_loss 0.5020838975906372 BPR_loss 0.49892163276672363 reg_loss 0.003162254113703966
epoch: 12 s: 1280000 batch_loss 0.5016449093818665 BPR_loss 0.49843934178352356 reg_loss 0.0032055408228188753
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 120.80300307273865 | 362.3969898223877 | 339.12286376953125 | [0.03939398 0.05889257 0.0729827 ] | [0.01842599 0.0225338  0.02511856] | [0.00224397 0.00168991 0.00140555] | [0.04423674 0.06627478 0.08227391] |
|   12  | 120.80300307273865 | 343.2432837486267 | 339.12286376953125 | [0.05378348 0.07651113 0.0932091 ] | [0.02412571 0.02891918 0.03197841] | [0.00310136 0.00221976 0.001811  ] | [0.0608534  0.08660028 0.10527228] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.4929606318473816 BPR_loss 0.4897303581237793 reg_loss 0.00323027023114264
epoch: 13 s: 256000 batch_loss 0.4965033531188965 BPR_loss 0.4932933449745178 reg_loss 0.003210000926628709
epoch: 13 s: 512000 batch_loss 0.4953464865684509 BPR_loss 0.49207818508148193 reg_loss 0.003268302883952856
epoch: 13 s: 768000 batch_loss 0.4866308569908142 BPR_loss 0.48326703906059265 reg_loss 0.003363810246810317
epoch: 13 s: 1024000 batch_loss 0.4882236421108246 BPR_loss 0.484756737947464 reg_loss 0.003466913942247629
epoch: 13 s: 1280000 batch_loss 0.47969451546669006 BPR_loss 0.4761323928833008 reg_loss 0.00356211606413126
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 121.77850651741028 | 359.2338490486145 | 327.04620361328125 | [0.03941202 0.05873068 0.07309353] | [0.01847323 0.02254607 0.02517554] | [0.00224579 0.00168535 0.00140616] | [0.04428785 0.06611413 0.08233963] |
|   13  | 121.77850651741028 | 332.2728912830353 | 327.04620361328125 | [0.05365939 0.07628617 0.0929833 ] | [0.02399629 0.02877379 0.03183387] | [0.0030923  0.00221307 0.00180772] | [0.06064856 0.08631665 0.10507532] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.4767986238002777 BPR_loss 0.4731976389884949 reg_loss 0.0036009931936860085
epoch: 14 s: 256000 batch_loss 0.4769664406776428 BPR_loss 0.47335630655288696 reg_loss 0.0036101241130381823
epoch: 14 s: 512000 batch_loss 0.4805181920528412 BPR_loss 0.47684478759765625 reg_loss 0.0036733958404511213
epoch: 14 s: 768000 batch_loss 0.4710831344127655 BPR_loss 0.4673275649547577 reg_loss 0.0037555808667093515
epoch: 14 s: 1024000 batch_loss 0.46577751636505127 BPR_loss 0.4619152247905731 reg_loss 0.00386227760463953
epoch: 14 s: 1280000 batch_loss 0.46183985471725464 BPR_loss 0.4580116868019104 reg_loss 0.003828176064416766
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 120.23230314254761 | 360.4386832714081  | 315.19183349609375 | [0.03940189 0.05871297 0.07292721] | [0.0184548  0.02252972 0.02512952] | [0.00224506 0.00168517 0.00140178] | [0.04430246 0.06610683 0.08209865] |
|   14  | 120.23230314254761 | 331.79142236709595 | 315.19183349609375 | [0.05353621 0.07616508 0.09276584] | [0.02393409 0.02870812 0.03175108] | [0.00308521 0.00221031 0.00180365] | [0.06054614 0.08611181 0.10483109] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.45695629715919495 BPR_loss 0.45308351516723633 reg_loss 0.003872796194627881
epoch: 15 s: 256000 batch_loss 0.44554436206817627 BPR_loss 0.4415595531463623 reg_loss 0.003984819632023573
epoch: 15 s: 512000 batch_loss 0.45956581830978394 BPR_loss 0.4556759297847748 reg_loss 0.003889894811436534
epoch: 15 s: 768000 batch_loss 0.4575541019439697 BPR_loss 0.45348185300827026 reg_loss 0.004072248935699463
epoch: 15 s: 1024000 batch_loss 0.4448727071285248 BPR_loss 0.44065988063812256 reg_loss 0.004212832078337669
epoch: 15 s: 1280000 batch_loss 0.4460364580154419 BPR_loss 0.4418647885322571 reg_loss 0.004171656910330057
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 125.51729917526245 | 370.05966329574585 | 303.54302978515625 | [0.03916002 0.05870646 0.07277819] | [0.01838861 0.02251436 0.025085  ] | [0.00223228 0.00168736 0.00139886] | [0.04404688 0.06618716 0.0819234 ] |
|   15  | 125.51729917526245 | 344.19837498664856 | 303.54302978515625 | [0.05339544 0.07586712 0.09259716] | [0.02385878 0.02860054 0.03166418] | [0.00307418 0.00220105 0.00180023] | [0.0603413  0.08577304 0.10461837] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.44280365109443665 BPR_loss 0.4386116862297058 reg_loss 0.004191963002085686
epoch: 16 s: 256000 batch_loss 0.44392186403274536 BPR_loss 0.4396377205848694 reg_loss 0.004284142982214689
epoch: 16 s: 512000 batch_loss 0.43942251801490784 BPR_loss 0.43504518270492554 reg_loss 0.004377332516014576
epoch: 16 s: 768000 batch_loss 0.43711528182029724 BPR_loss 0.432660847902298 reg_loss 0.004454442765563726
epoch: 16 s: 1024000 batch_loss 0.43777957558631897 BPR_loss 0.43329787254333496 reg_loss 0.004481696989387274
epoch: 16 s: 1280000 batch_loss 0.4322487413883209 BPR_loss 0.4277290999889374 reg_loss 0.004519640933722258
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 136.20777225494385 | 394.23072695732117 | 292.489501953125 | [0.039071   0.05859541 0.07260854] | [0.01834263 0.0224639  0.02502618] | [0.00222608 0.00168371 0.00139521] | [0.04392274 0.06603381 0.08173354] |
|   16  | 136.20777225494385 | 255.23483872413635 | 292.489501953125 | [0.05327462 0.07549427 0.09226251] | [0.02383467 0.02852185 0.03159105] | [0.00306906 0.00219002 0.00179275] | [0.06021524 0.08537911 0.10417717] |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.42218178510665894 BPR_loss 0.41761261224746704 reg_loss 0.004569176584482193
epoch: 17 s: 256000 batch_loss 0.4216665029525757 BPR_loss 0.41700559854507446 reg_loss 0.004660910461097956
epoch: 17 s: 512000 batch_loss 0.419088751077652 BPR_loss 0.4144197702407837 reg_loss 0.00466898363083601
epoch: 17 s: 768000 batch_loss 0.4104944169521332 BPR_loss 0.40572983026504517 reg_loss 0.004764578305184841
epoch: 17 s: 1024000 batch_loss 0.41959458589553833 BPR_loss 0.4148081839084625 reg_loss 0.004786413162946701
epoch: 17 s: 1280000 batch_loss 0.41725754737854004 BPR_loss 0.4123736619949341 reg_loss 0.004883878398686647
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 85.41847658157349 |  257.473997592926 | 281.4001159667969 | [0.03903762 0.05834507 0.07257179] | [0.01836373 0.02243857 0.02504094] | [0.00222243 0.00167567 0.00139399] | [0.04386433 0.06574172 0.08166052] |
|   17  | 85.41847658157349 | 305.7402009963989 | 281.4001159667969 | [0.05299279 0.07522595 0.09187379] | [0.02372886 0.02842099 0.03146829] | [0.00305606 0.00218293 0.0017854 ] | [0.05997101 0.08515852 0.103799  ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.05299279277789509
early stopping at 17, recall@20:0.0541
