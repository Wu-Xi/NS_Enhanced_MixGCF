Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ifashion', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.0001, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.693148136138916 BPR_loss 0.693148136138916 reg_loss 1.5493888838591374e-08
epoch: 0 s: 256000 batch_loss 0.6931412816047668 BPR_loss 0.693140983581543 reg_loss 3.0515755611304485e-07
epoch: 0 s: 512000 batch_loss 0.6930648684501648 BPR_loss 0.6930620670318604 reg_loss 2.7851494905917207e-06
epoch: 0 s: 768000 batch_loss 0.6927325129508972 BPR_loss 0.692717432975769 reg_loss 1.508051445853198e-05
epoch: 0 s: 1024000 batch_loss 0.6916202902793884 BPR_loss 0.6915653944015503 reg_loss 5.489361865329556e-05
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 115.55777430534363 | 1005.2360670566559 | 424.49591064453125 | [0.07719368 0.11493668 0.14300919] | [0.03534985 0.04346348 0.04870402] | [0.00480998 0.0036146  0.00301411] | [0.0934844  0.13831659 0.17121262] |
|   0   | 115.55777430534363 | 1037.1284375190735 | 424.49591064453125 | [0.07719368 0.11493668 0.14300919] | [0.03534985 0.04346348 0.04870402] | [0.00480998 0.0036146  0.00301411] | [0.0934844  0.13831659 0.17121262] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6893851161003113 BPR_loss 0.6892555356025696 reg_loss 0.0001295526308240369
epoch: 1 s: 256000 batch_loss 0.6863332390785217 BPR_loss 0.6860858201980591 reg_loss 0.0002474223729223013
epoch: 1 s: 512000 batch_loss 0.6815222501754761 BPR_loss 0.6810803413391113 reg_loss 0.00044192999484948814
epoch: 1 s: 768000 batch_loss 0.6766830086708069 BPR_loss 0.6760223507881165 reg_loss 0.0006606362294405699
epoch: 1 s: 1024000 batch_loss 0.6710618734359741 BPR_loss 0.6701365113258362 reg_loss 0.0009253582684323192
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 113.29422116279602 | 1031.9538879394531 | 415.8717041015625 | [0.0834266  0.12310697 0.1526844 ] | [0.03821153 0.04673302 0.05225628] | [0.00519143 0.00386614 0.00321496] | [0.10077479 0.14786477 0.18218913] |
|   1   | 113.29422116279602 | 1032.5830507278442 | 415.8717041015625 | [0.0834266  0.12310697 0.1526844 ] | [0.03821153 0.04673302 0.05225628] | [0.00519143 0.00386614 0.00321496] | [0.10077479 0.14786477 0.18218913] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.664287269115448 BPR_loss 0.6630982756614685 reg_loss 0.0011890113819390535
epoch: 2 s: 256000 batch_loss 0.6555037498474121 BPR_loss 0.6540365815162659 reg_loss 0.0014671594835817814
epoch: 2 s: 512000 batch_loss 0.6464618444442749 BPR_loss 0.6445052027702332 reg_loss 0.001956660533323884
epoch: 2 s: 768000 batch_loss 0.6397876143455505 BPR_loss 0.6375887393951416 reg_loss 0.0021988926455378532
epoch: 2 s: 1024000 batch_loss 0.6283791661262512 BPR_loss 0.6257577538490295 reg_loss 0.0026213976088911295
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 112.92928862571716 |  1003.74556016922  | 394.2898864746094 | [0.08671524 0.12763335 0.15820292] | [0.039886   0.04866643 0.0543803 ] | [0.00540047 0.00400916 0.00333405] | [0.10475103 0.15300524 0.18858682] |
|   2   | 112.92928862571716 | 1019.6181988716125 | 394.2898864746094 | [0.08671524 0.12763335 0.15820292] | [0.039886   0.04866643 0.0543803 ] | [0.00540047 0.00400916 0.00333405] | [0.10475103 0.15300524 0.18858682] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6213046908378601 BPR_loss 0.6183823347091675 reg_loss 0.0029223484452813864
epoch: 3 s: 256000 batch_loss 0.6160880327224731 BPR_loss 0.6126943826675415 reg_loss 0.003393620951101184
epoch: 3 s: 512000 batch_loss 0.6055631041526794 BPR_loss 0.6018757820129395 reg_loss 0.0036873184144496918
epoch: 3 s: 768000 batch_loss 0.5973355770111084 BPR_loss 0.5932369828224182 reg_loss 0.004098597448319197
epoch: 3 s: 1024000 batch_loss 0.587694525718689 BPR_loss 0.5832881331443787 reg_loss 0.004406410735100508
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 129.75069975852966 | 1068.358329296112 | 368.4571533203125 | [0.08880348 0.13062894 0.16177672] | [0.04115379 0.05014655 0.05596862] | [0.00552973 0.00410642 0.00341074] | [0.10720224 0.15660208 0.19265233] |
|   3   | 129.75069975852966 | 942.2382524013519 | 368.4571533203125 | [0.08880348 0.13062894 0.16177672] | [0.04115379 0.05014655 0.05596862] | [0.00552973 0.00410642 0.00341074] | [0.10720224 0.15660208 0.19265233] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.577695369720459 BPR_loss 0.5729871988296509 reg_loss 0.004708187188953161
epoch: 4 s: 256000 batch_loss 0.5707643628120422 BPR_loss 0.565529465675354 reg_loss 0.005234881304204464
epoch: 4 s: 512000 batch_loss 0.5607976317405701 BPR_loss 0.5550482869148254 reg_loss 0.005749370437115431
epoch: 4 s: 768000 batch_loss 0.5498814582824707 BPR_loss 0.5440226793289185 reg_loss 0.005858793389052153
epoch: 4 s: 1024000 batch_loss 0.5419825315475464 BPR_loss 0.5357962846755981 reg_loss 0.006186221726238728
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 131.16954851150513 | 1152.3349833488464 | 342.8063659667969 | [0.09104965 0.13356043 0.16436876] | [0.04219377 0.05133356 0.05709209] | [0.00567497 0.00419895 0.00346734] | [0.10986918 0.16005386 0.19570611] |
|   4   | 131.16954851150513 | 1157.7238552570343 | 342.8063659667969 | [0.09104965 0.13356043 0.16436876] | [0.04219377 0.05133356 0.05709209] | [0.00567497 0.00419895 0.00346734] | [0.10986918 0.16005386 0.19570611] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.5365059971809387 BPR_loss 0.5301375389099121 reg_loss 0.006368441507220268
epoch: 5 s: 256000 batch_loss 0.5340781807899475 BPR_loss 0.5271697044372559 reg_loss 0.00690848845988512
epoch: 5 s: 512000 batch_loss 0.5289976000785828 BPR_loss 0.5218403339385986 reg_loss 0.007157252170145512
epoch: 5 s: 768000 batch_loss 0.5168362259864807 BPR_loss 0.5092624425888062 reg_loss 0.007573795039206743
epoch: 5 s: 1024000 batch_loss 0.5011024475097656 BPR_loss 0.4931875169277191 reg_loss 0.007914952002465725
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 131.1080346107483 | 1148.504890680313  | 319.352783203125 | [0.09286171 0.13536091 0.16647072] | [0.04304    0.0521916  0.05800366] | [0.00578842 0.00426246 0.00351526] | [0.11201166 0.16221494 0.19816476] |
|   5   | 131.1080346107483 | 1134.0580549240112 | 319.352783203125 | [0.09286171 0.13536091 0.16647072] | [0.04304    0.0521916  0.05800366] | [0.00578842 0.00426246 0.00351526] | [0.11201166 0.16221494 0.19816476] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.5052037835121155 BPR_loss 0.4969504475593567 reg_loss 0.008253330364823341
epoch: 6 s: 256000 batch_loss 0.49058717489242554 BPR_loss 0.4821764826774597 reg_loss 0.008410688489675522
epoch: 6 s: 512000 batch_loss 0.48907002806663513 BPR_loss 0.4804123640060425 reg_loss 0.008657668717205524
epoch: 6 s: 768000 batch_loss 0.4863170087337494 BPR_loss 0.4770660996437073 reg_loss 0.009250913746654987
epoch: 6 s: 1024000 batch_loss 0.47553542256355286 BPR_loss 0.466270387172699 reg_loss 0.00926502700895071
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 122.65144991874695 | 1142.1310296058655 | 298.2099304199219 | [0.09416622 0.13717414 0.16812427] | [0.04375935 0.0530201  0.05880619] | [0.00587193 0.00432105 0.00355128] | [0.1135181  0.16434626 0.20003571] |
|   6   | 122.65144991874695 | 1154.003017425537  | 298.2099304199219 | [0.09416622 0.13717414 0.16812427] | [0.04375935 0.0530201  0.05880619] | [0.00587193 0.00432105 0.00355128] | [0.1135181  0.16434626 0.20003571] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.4728928208351135 BPR_loss 0.4633564054965973 reg_loss 0.009536425583064556
epoch: 7 s: 256000 batch_loss 0.4666787087917328 BPR_loss 0.45661500096321106 reg_loss 0.010063721798360348
epoch: 7 s: 512000 batch_loss 0.45151421427726746 BPR_loss 0.4409547448158264 reg_loss 0.010559474118053913
epoch: 7 s: 768000 batch_loss 0.4415084421634674 BPR_loss 0.4306125044822693 reg_loss 0.0108959274366498
epoch: 7 s: 1024000 batch_loss 0.44466763734817505 BPR_loss 0.4340932369232178 reg_loss 0.01057438738644123
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 117.26316547393799 | 1162.6365358829498 | 278.7015075683594 | [0.09531878 0.13860935 0.1692452 ] | [0.0443533  0.05366842 0.05940019] | [0.00594613 0.0043668  0.00357657] | [0.11488319 0.16591965 0.20137476] |
|   7   | 117.26316547393799 | 1125.4608023166656 | 278.7015075683594 | [0.09531878 0.13860935 0.1692452 ] | [0.0443533  0.05366842 0.05940019] | [0.00594613 0.0043668  0.00357657] | [0.11488319 0.16591965 0.20137476] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.44192588329315186 BPR_loss 0.43063443899154663 reg_loss 0.011291447095572948
epoch: 8 s: 256000 batch_loss 0.4222210645675659 BPR_loss 0.41076892614364624 reg_loss 0.011452137492597103
epoch: 8 s: 512000 batch_loss 0.42010486125946045 BPR_loss 0.40800726413726807 reg_loss 0.012097598053514957
epoch: 8 s: 768000 batch_loss 0.42706623673439026 BPR_loss 0.41522061824798584 reg_loss 0.011845620349049568
epoch: 8 s: 1024000 batch_loss 0.4078940451145172 BPR_loss 0.3954187035560608 reg_loss 0.012475332245230675
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 123.57155847549438 |  1142.03586935997  | 261.08441162109375 | [0.09612093 0.13911899 0.17020341] | [0.0447612  0.05402757 0.05984465] | [0.00599616 0.00438679 0.00359951] | [0.11589491 0.16660405 0.20241624] |
|   8   | 123.57155847549438 | 1161.5001459121704 | 261.08441162109375 | [0.09612093 0.13911899 0.17020341] | [0.0447612  0.05402757 0.05984465] | [0.00599616 0.00438679 0.00359951] | [0.11589491 0.16660405 0.20241624] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.41194552183151245 BPR_loss 0.39912837743759155 reg_loss 0.012817151844501495
epoch: 9 s: 256000 batch_loss 0.40034356713294983 BPR_loss 0.3875375986099243 reg_loss 0.012805975042283535
epoch: 9 s: 512000 batch_loss 0.3971927762031555 BPR_loss 0.3845680058002472 reg_loss 0.012624767608940601
epoch: 9 s: 768000 batch_loss 0.39898818731307983 BPR_loss 0.3859913945198059 reg_loss 0.012996796518564224
epoch: 9 s: 1024000 batch_loss 0.3855302929878235 BPR_loss 0.37183815240859985 reg_loss 0.013692150823771954
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 120.22061514854431 | 1153.2074699401855 | 245.76194763183594 | [0.0969083  0.14013318 0.17097802] | [0.04518463 0.05450046 0.06027367] | [0.00604824 0.0044211  0.00361928] | [0.11686573 0.16783152 0.20340937] |
|   9   | 120.22061514854431 | 1170.5581228733063 | 245.76194763183594 | [0.0969083  0.14013318 0.17097802] | [0.04518463 0.05450046 0.06027367] | [0.00604824 0.0044211  0.00361928] | [0.11686573 0.16783152 0.20340937] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.39851102232933044 BPR_loss 0.3852846920490265 reg_loss 0.013226327486336231
epoch: 10 s: 256000 batch_loss 0.40359747409820557 BPR_loss 0.3899117112159729 reg_loss 0.013685761950910091
epoch: 10 s: 512000 batch_loss 0.37485918402671814 BPR_loss 0.3608754575252533 reg_loss 0.013983731158077717
epoch: 10 s: 768000 batch_loss 0.3788706064224243 BPR_loss 0.3647899031639099 reg_loss 0.014080691151320934
epoch: 10 s: 1024000 batch_loss 0.3700215220451355 BPR_loss 0.35544973611831665 reg_loss 0.014571771025657654
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 119.2988953590393 | 1139.6132640838623 | 231.55538940429688 | [0.09743839 0.14066936 0.17172979] | [0.04550703 0.05482572 0.06063526] | [0.00608804 0.00444119 0.00363596] | [0.11758361 0.16851964 0.20427976] |
|   10  | 119.2988953590393 | 1148.5486154556274 | 231.55538940429688 | [0.09743839 0.14066936 0.17172979] | [0.04550703 0.05482572 0.06063526] | [0.00608804 0.00444119 0.00363596] | [0.11758361 0.16851964 0.20427976] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.3767993152141571 BPR_loss 0.3620857000350952 reg_loss 0.014713608659803867
epoch: 11 s: 256000 batch_loss 0.3656769394874573 BPR_loss 0.3510258197784424 reg_loss 0.014651129022240639
epoch: 11 s: 512000 batch_loss 0.3484640121459961 BPR_loss 0.33296167850494385 reg_loss 0.01550234667956829
epoch: 11 s: 768000 batch_loss 0.35638976097106934 BPR_loss 0.341590017080307 reg_loss 0.014799758791923523
epoch: 11 s: 1024000 batch_loss 0.3488525450229645 BPR_loss 0.33366361260414124 reg_loss 0.015188932418823242
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 121.80940842628479 | 1160.9313926696777 | 219.08224487304688 | [0.09795238 0.14097205 0.17204399] | [0.04585156 0.05513872 0.06094395] | [0.00611947 0.00445597 0.0036421 ] | [0.11819734 0.16892508 0.20461452] |
|   11  | 121.80940842628479 | 1150.7927227020264 | 219.08224487304688 | [0.09795238 0.14097205 0.17204399] | [0.04585156 0.05513872 0.06094395] | [0.00611947 0.00445597 0.0036421 ] | [0.11819734 0.16892508 0.20461452] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.3490663170814514 BPR_loss 0.33327358961105347 reg_loss 0.015792720019817352
epoch: 12 s: 256000 batch_loss 0.34807607531547546 BPR_loss 0.3320251405239105 reg_loss 0.01605093479156494
epoch: 12 s: 512000 batch_loss 0.3396586775779724 BPR_loss 0.32396185398101807 reg_loss 0.0156968105584383
epoch: 12 s: 768000 batch_loss 0.33619385957717896 BPR_loss 0.3198404908180237 reg_loss 0.016353372484445572
epoch: 12 s: 1024000 batch_loss 0.3389908969402313 BPR_loss 0.32254523038864136 reg_loss 0.01644567959010601
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 121.85654926300049 | 1132.0603475570679 | 207.13088989257812 | [0.09824716 0.14139958 0.17246658] | [0.04609426 0.05540636 0.06121304] | [0.00614234 0.0044715  0.00365332] | [0.11852838 0.16944954 0.20516874] |
|   12  | 121.85654926300049 | 1152.1765224933624 | 207.13088989257812 | [0.09824716 0.14139958 0.17246658] | [0.04609426 0.05540636 0.06121304] | [0.00614234 0.0044715  0.00365332] | [0.11852838 0.16944954 0.20516874] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.32475516200065613 BPR_loss 0.30800312757492065 reg_loss 0.01675204187631607
epoch: 13 s: 256000 batch_loss 0.32498034834861755 BPR_loss 0.30749255418777466 reg_loss 0.017487801611423492
epoch: 13 s: 512000 batch_loss 0.3315528929233551 BPR_loss 0.3147968053817749 reg_loss 0.0167560912668705
epoch: 13 s: 768000 batch_loss 0.312089204788208 BPR_loss 0.2943877577781677 reg_loss 0.017701447010040283
epoch: 13 s: 1024000 batch_loss 0.3175700902938843 BPR_loss 0.30030161142349243 reg_loss 0.017268486320972443
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 124.2656877040863 | 1125.7767188549042 | 197.08885192871094 | [0.09857997 0.14174505 0.17275017] | [0.04631429 0.0556259  0.06142193] | [0.00616447 0.00448257 0.00366045] | [0.11888174 0.16984009 0.20552582] |
|   13  | 124.2656877040863 | 1148.9827015399933 | 197.08885192871094 | [0.09857997 0.14174505 0.17275017] | [0.04631429 0.0556259  0.06142193] | [0.00616447 0.00448257 0.00366045] | [0.11888174 0.16984009 0.20552582] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.3119114637374878 BPR_loss 0.2943406105041504 reg_loss 0.017570860683918
epoch: 14 s: 256000 batch_loss 0.31177207827568054 BPR_loss 0.2941729724407196 reg_loss 0.01759910210967064
epoch: 14 s: 512000 batch_loss 0.3191579282283783 BPR_loss 0.30179131031036377 reg_loss 0.017366629093885422
epoch: 14 s: 768000 batch_loss 0.3053765892982483 BPR_loss 0.2873765826225281 reg_loss 0.01800002157688141
epoch: 14 s: 1024000 batch_loss 0.29833701252937317 BPR_loss 0.280463308095932 reg_loss 0.01787370815873146
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 120.98926973342896 | 1146.7966668605804 | 187.26266479492188 | [0.09874751 0.14177781 0.1727392 ] | [0.04642316 0.05569979 0.06149841] | [0.00618121 0.00448248 0.00366355] | [0.11922023 0.16970991 0.20565229] |
|   14  | 120.98926973342896 | 1164.4978120326996 | 187.26266479492188 | [0.09874751 0.14177781 0.1727392 ] | [0.04642316 0.05569979 0.06149841] | [0.00618121 0.00448248 0.00366355] | [0.11922023 0.16970991 0.20565229] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.3052520155906677 BPR_loss 0.28698408603668213 reg_loss 0.01826791651546955
epoch: 15 s: 256000 batch_loss 0.29259687662124634 BPR_loss 0.27386531233787537 reg_loss 0.018731556832790375
epoch: 15 s: 512000 batch_loss 0.29116883873939514 BPR_loss 0.2724481523036957 reg_loss 0.01872069574892521
epoch: 15 s: 768000 batch_loss 0.29312950372695923 BPR_loss 0.2744901180267334 reg_loss 0.018639400601387024
epoch: 15 s: 1024000 batch_loss 0.2905459702014923 BPR_loss 0.27171817421913147 reg_loss 0.018827782943844795
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 123.3904857635498 | 1123.2746436595917 | 178.49099731445312 | [0.09912785 0.14208706 0.17287805] | [0.04664665 0.05590866 0.06166388] | [0.0062052  0.00449856 0.0036659 ] | [0.1196331  0.17024181 0.20574899] |
|   15  | 123.3904857635498 | 1174.7634675502777 | 178.49099731445312 | [0.09912785 0.14208706 0.17287805] | [0.04664665 0.05590866 0.06166388] | [0.0062052  0.00449856 0.0036659 ] | [0.1196331  0.17024181 0.20574899] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.28389546275138855 BPR_loss 0.2649000287055969 reg_loss 0.018995434045791626
epoch: 16 s: 256000 batch_loss 0.29177868366241455 BPR_loss 0.27271151542663574 reg_loss 0.019067158922553062
epoch: 16 s: 512000 batch_loss 0.28589653968811035 BPR_loss 0.26703208684921265 reg_loss 0.0188644640147686
epoch: 16 s: 768000 batch_loss 0.2766011655330658 BPR_loss 0.25724470615386963 reg_loss 0.019356466829776764
epoch: 16 s: 1024000 batch_loss 0.2745077610015869 BPR_loss 0.25453925132751465 reg_loss 0.01996849663555622
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 122.63342690467834 |  1145.08362865448 | 170.4673309326172 | [0.09918946 0.14193979 0.17262549] | [0.04672923 0.05594296 0.06168788] | [0.00621525 0.00449363 0.00366479] | [0.11981908 0.17010047 0.20553326] |
|   16  | 122.63342690467834 | 1000.763622045517 | 170.4673309326172 | [0.09918946 0.14193979 0.17262549] | [0.04672923 0.05594296 0.06168788] | [0.00621525 0.00449363 0.00366479] | [0.11981908 0.17010047 0.20553326] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.27165713906288147 BPR_loss 0.25195491313934326 reg_loss 0.019702229648828506
epoch: 17 s: 256000 batch_loss 0.26715999841690063 BPR_loss 0.24740657210350037 reg_loss 0.01975342445075512
epoch: 17 s: 512000 batch_loss 0.2736065089702606 BPR_loss 0.25336140394210815 reg_loss 0.02024509385228157
epoch: 17 s: 768000 batch_loss 0.2562479078769684 BPR_loss 0.23607897758483887 reg_loss 0.020168932154774666
epoch: 17 s: 1024000 batch_loss 0.2690083384513855 BPR_loss 0.24853554368019104 reg_loss 0.020472781732678413
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 83.1615080833435 | 722.5553987026215 | 162.7417755126953 | [0.09916189 0.14195853 0.17241313] | [0.04681712 0.05604378 0.06173974] | [0.00621655 0.00449782 0.00366032] | [0.11981164 0.17017858 0.20527289] |
|   17  | 83.1615080833435 | 721.3293309211731 | 162.7417755126953 | [0.09916189 0.14195853 0.17241313] | [0.04681712 0.05604378 0.06173974] | [0.00621655 0.00449782 0.00366032] | [0.11981164 0.17017858 0.20527289] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.2521834075450897 BPR_loss 0.2317267507314682 reg_loss 0.02045666240155697
epoch: 18 s: 256000 batch_loss 0.25508204102516174 BPR_loss 0.23490044474601746 reg_loss 0.020181598141789436
epoch: 18 s: 512000 batch_loss 0.2547608017921448 BPR_loss 0.23411819338798523 reg_loss 0.020642613992094994
epoch: 18 s: 768000 batch_loss 0.24614658951759338 BPR_loss 0.2250148057937622 reg_loss 0.02113177813589573
epoch: 18 s: 1024000 batch_loss 0.25173652172088623 BPR_loss 0.23087945580482483 reg_loss 0.020857060328125954
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 64.48535776138306 | 713.9662752151489 | 155.785888671875 | [0.0991385  0.14174734 0.17201105] | [0.04683801 0.05602355 0.06168988] | [0.00622064 0.00449317 0.0036548 ] | [0.11979676 0.1699554  0.20490093] |
|   18  | 64.48535776138306 |  719.599524974823 | 155.785888671875 | [0.0991385  0.14174734 0.17201105] | [0.04683801 0.05602355 0.06168988] | [0.00622064 0.00449317 0.0036548 ] | [0.11979676 0.1699554  0.20490093] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.25721418857574463 BPR_loss 0.23646938800811768 reg_loss 0.020744793117046356
epoch: 19 s: 256000 batch_loss 0.2441178262233734 BPR_loss 0.22287186980247498 reg_loss 0.02124594897031784
epoch: 19 s: 512000 batch_loss 0.27157580852508545 BPR_loss 0.25030168890953064 reg_loss 0.021274104714393616
epoch: 19 s: 768000 batch_loss 0.2395014762878418 BPR_loss 0.21785783767700195 reg_loss 0.021643633022904396
epoch: 19 s: 1024000 batch_loss 0.23131120204925537 BPR_loss 0.21028345823287964 reg_loss 0.021027741953730583
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 65.1034574508667 | 712.4052066802979 | 149.70513916015625 | [0.09913496 0.14159139 0.17197568] | [0.0468223  0.05597755 0.06166367] | [0.00621878 0.00448852 0.00365307] | [0.11983024 0.16974711 0.20482282] |
|   19  | 65.1034574508667 |  711.286319732666 | 149.70513916015625 | [0.09913496 0.14159139 0.17197568] | [0.0468223  0.05597755 0.06166367] | [0.00621878 0.00448852 0.00365307] | [0.11983024 0.16974711 0.20482282] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.23844194412231445 BPR_loss 0.21663928031921387 reg_loss 0.021802658215165138
epoch: 20 s: 256000 batch_loss 0.23249869048595428 BPR_loss 0.21069462597370148 reg_loss 0.02180406078696251
epoch: 20 s: 512000 batch_loss 0.2502153515815735 BPR_loss 0.22875778377056122 reg_loss 0.021457552909851074
epoch: 20 s: 768000 batch_loss 0.23989339172840118 BPR_loss 0.21821916103363037 reg_loss 0.021674230694770813
epoch: 20 s: 1024000 batch_loss 0.2392764538526535 BPR_loss 0.21730650961399078 reg_loss 0.02196994237601757
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 64.34497022628784 | 713.1248800754547 | 143.94708251953125 | [0.09897025 0.14143533 0.17148539] | [0.04678557 0.05594373 0.06157106] | [0.00621041 0.00448443 0.00364495] | [0.11963682 0.16951649 0.20432439] |
|   20  | 64.34497022628784 | 733.2621002197266 | 143.94708251953125 | [0.09897025 0.14143533 0.17148539] | [0.04678557 0.05594373 0.06157106] | [0.00621041 0.00448443 0.00364495] | [0.11963682 0.16951649 0.20432439] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.23236466944217682 BPR_loss 0.2103913426399231 reg_loss 0.021973324939608574
epoch: 21 s: 256000 batch_loss 0.22499828040599823 BPR_loss 0.20255064964294434 reg_loss 0.022447625175118446
epoch: 21 s: 512000 batch_loss 0.223412424325943 BPR_loss 0.20107436180114746 reg_loss 0.022338060662150383
epoch: 21 s: 768000 batch_loss 0.21961650252342224 BPR_loss 0.19687938690185547 reg_loss 0.022737111896276474
epoch: 21 s: 1024000 batch_loss 0.20744732022285461 BPR_loss 0.18494608998298645 reg_loss 0.022501230239868164
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 65.12586045265198 |  713.293952703476 | 138.7409210205078 | [0.09885858 0.14106277 0.17133852] | [0.04675207 0.05585708 0.06152294] | [0.00620371 0.00447531 0.00364203] | [0.119462   0.16910362 0.20415701] |
|   21  | 65.12586045265198 | 730.9220261573792 | 138.7409210205078 | [0.09885858 0.14106277 0.17133852] | [0.04675207 0.05585708 0.06152294] | [0.00620371 0.00447531 0.00364203] | [0.119462   0.16910362 0.20415701] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.2327888160943985 BPR_loss 0.21011821925640106 reg_loss 0.022670594975352287
epoch: 22 s: 256000 batch_loss 0.21620813012123108 BPR_loss 0.19390659034252167 reg_loss 0.022301532328128815
epoch: 22 s: 512000 batch_loss 0.21185287833213806 BPR_loss 0.18897035717964172 reg_loss 0.02288251370191574
epoch: 22 s: 768000 batch_loss 0.21249346435070038 BPR_loss 0.18947061896324158 reg_loss 0.0230228453874588
epoch: 22 s: 1024000 batch_loss 0.21703305840492249 BPR_loss 0.19372761249542236 reg_loss 0.023305438458919525
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 64.89850902557373 | 719.1318407058716 | 133.601806640625 | [0.09859092 0.14068986 0.17073808] | [0.04670936 0.05579128 0.06142506] | [0.00619163 0.00446155 0.00363218] | [0.11926486 0.16866471 0.20347261] |
|   22  | 64.89850902557373 | 736.7762305736542 | 133.601806640625 | [0.09859092 0.14068986 0.17073808] | [0.04670936 0.05579128 0.06142506] | [0.00619163 0.00446155 0.00363218] | [0.11926486 0.16866471 0.20347261] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.21300776302814484 BPR_loss 0.18979591131210327 reg_loss 0.023211855441331863
epoch: 23 s: 256000 batch_loss 0.21134702861309052 BPR_loss 0.1877909004688263 reg_loss 0.023556126281619072
epoch: 23 s: 512000 batch_loss 0.21500270068645477 BPR_loss 0.1920802742242813 reg_loss 0.02292243018746376
epoch: 23 s: 768000 batch_loss 0.20917820930480957 BPR_loss 0.18569415807724 reg_loss 0.02348405495285988
epoch: 23 s: 1024000 batch_loss 0.19298535585403442 BPR_loss 0.16965344548225403 reg_loss 0.023331910371780396
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 64.92007875442505 | 712.4463279247284 | 129.24981689453125 | [0.09839511 0.14038946 0.17053171] | [0.04663792 0.05569993 0.06134661] | [0.00618344 0.00445532 0.0036279 ] | [0.119064   0.1683411  0.20312669] |
|   23  | 64.92007875442505 | 718.1123507022858 | 129.24981689453125 | [0.09839511 0.14038946 0.17053171] | [0.04663792 0.05569993 0.06134661] | [0.00618344 0.00445532 0.0036279 ] | [0.119064   0.1683411  0.20312669] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.21559061110019684 BPR_loss 0.1916588991880417 reg_loss 0.023931706324219704
epoch: 24 s: 256000 batch_loss 0.2100837379693985 BPR_loss 0.1866455227136612 reg_loss 0.023438217118382454
epoch: 24 s: 512000 batch_loss 0.2144995927810669 BPR_loss 0.19070389866828918 reg_loss 0.02379569225013256
epoch: 24 s: 768000 batch_loss 0.20212048292160034 BPR_loss 0.17750518023967743 reg_loss 0.02461530640721321
epoch: 24 s: 1024000 batch_loss 0.1985318511724472 BPR_loss 0.1751757115125656 reg_loss 0.023356135934591293
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 64.60187983512878 | 713.8086473941803 | 124.973876953125 | [0.0983101  0.14016259 0.17007733] | [0.04655106 0.05558512 0.06118277] | [0.00617433 0.00445067 0.00361718] | [0.11886686 0.16816256 0.20257991] |
|   24  | 64.60187983512878 | 716.0857951641083 | 124.973876953125 | [0.0983101  0.14016259 0.17007733] | [0.04655106 0.05558512 0.06118277] | [0.00617433 0.00445067 0.00361718] | [0.11886686 0.16816256 0.20257991] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.21485735476016998 BPR_loss 0.19134967029094696 reg_loss 0.02350769005715847
epoch: 25 s: 256000 batch_loss 0.18975362181663513 BPR_loss 0.1663098931312561 reg_loss 0.023443732410669327
epoch: 25 s: 512000 batch_loss 0.18885749578475952 BPR_loss 0.1648954600095749 reg_loss 0.023962030187249184
epoch: 25 s: 768000 batch_loss 0.18600988388061523 BPR_loss 0.1617562472820282 reg_loss 0.02425363101065159
epoch: 25 s: 1024000 batch_loss 0.1901240348815918 BPR_loss 0.166243314743042 reg_loss 0.023880718275904655
+-------+-------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 64.48151302337646 | 705.5238513946533 | 121.15283203125 | [0.09791264 0.14010793 0.16965911] | [0.04641159 0.05551718 0.06105195] | [0.00615424 0.00444798 0.00361023] | [0.11849491 0.16802494 0.20217075] |
|   25  | 64.48151302337646 | 735.1630098819733 | 121.15283203125 | [0.09791264 0.14010793 0.16965911] | [0.04641159 0.05551718 0.06105195] | [0.00615424 0.00444798 0.00361023] | [0.11849491 0.16802494 0.20217075] |
+-------+-------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.19875144958496094 BPR_loss 0.17430900037288666 reg_loss 0.024442454800009727
epoch: 26 s: 256000 batch_loss 0.18391530215740204 BPR_loss 0.15937182307243347 reg_loss 0.02454347535967827
epoch: 26 s: 512000 batch_loss 0.19173143804073334 BPR_loss 0.16756650805473328 reg_loss 0.02416493371129036
epoch: 26 s: 768000 batch_loss 0.21082276105880737 BPR_loss 0.18611697852611542 reg_loss 0.024705788120627403
epoch: 26 s: 1024000 batch_loss 0.18868227303028107 BPR_loss 0.16420960426330566 reg_loss 0.02447267435491085
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 64.3433825969696 | 695.6052567958832 | 117.5610122680664 | [0.09765827 0.13978908 0.16915225] | [0.04637823 0.05546552 0.06096869] | [0.00613992 0.00443672 0.00359976] | [0.11818246 0.16766414 0.20151982] |
|   26  | 64.3433825969696 | 708.4185709953308 | 117.5610122680664 | [0.09765827 0.13978908 0.16915225] | [0.04637823 0.05546552 0.06096869] | [0.00613992 0.00443672 0.00359976] | [0.11818246 0.16766414 0.20151982] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.0976582686615055
early stopping at 26, recall@20:0.0992
