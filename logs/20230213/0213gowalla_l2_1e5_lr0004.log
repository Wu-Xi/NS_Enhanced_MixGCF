Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='gowalla', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=3, l2=1e-05, lr=0.004, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931487321853638 BPR_loss 0.6931487321853638 reg_loss 2.4288397959537633e-09
epoch: 0 s: 256000 batch_loss 0.6132137775421143 BPR_loss 0.6131480932235718 reg_loss 6.566565571120009e-05
epoch: 0 s: 512000 batch_loss 0.5362331867218018 BPR_loss 0.5360549688339233 reg_loss 0.00017819309141486883
epoch: 0 s: 768000 batch_loss 0.49583059549331665 BPR_loss 0.49558091163635254 reg_loss 0.0002496864181011915
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 67.77390003204346 | 62.2723650932312 | 228.54660034179688 | [0.12372304 0.17781621 0.21718725] | [0.10323538 0.12018792 0.13194145] | [0.03955556 0.02860875 0.023403  ] | [0.46356085 0.56681626 0.62720209] |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.5073974132537842 BPR_loss 0.5071359872817993 reg_loss 0.0002614008553791791
epoch: 1 s: 256000 batch_loss 0.46256545186042786 BPR_loss 0.4622271955013275 reg_loss 0.0003382448048796505
epoch: 1 s: 512000 batch_loss 0.4442071318626404 BPR_loss 0.4438076317310333 reg_loss 0.00039949247729964554
epoch: 1 s: 768000 batch_loss 0.41941484808921814 BPR_loss 0.4189434051513672 reg_loss 0.00047145618009380996
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 68.1611840724945 | 69.83516573905945 | 183.38040161132812 | [0.13145851 0.18886171 0.22979155] | [0.11008562 0.12807318 0.14029506] | [0.04179449 0.03019124 0.02464108] | [0.48285217 0.58912184 0.64796704] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.4381965100765228 BPR_loss 0.4377228617668152 reg_loss 0.00047364001511596143
epoch: 2 s: 256000 batch_loss 0.4424718916416168 BPR_loss 0.4419592320919037 reg_loss 0.000512651342432946
epoch: 2 s: 512000 batch_loss 0.39917826652526855 BPR_loss 0.3985847532749176 reg_loss 0.0005935195949859917
epoch: 2 s: 768000 batch_loss 0.3831680715084076 BPR_loss 0.38250911235809326 reg_loss 0.0006589563563466072
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 69.31770873069763 | 87.6434473991394 | 162.99356079101562 | [0.13717507 0.19630056 0.23873226] | [0.11535852 0.13395945 0.14658527] | [0.04351765 0.03135424 0.02554815] | [0.49584701 0.60318843 0.66273695] |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.3850930333137512 BPR_loss 0.38441002368927 reg_loss 0.000683003047015518
epoch: 3 s: 256000 batch_loss 0.3796440660953522 BPR_loss 0.3789229691028595 reg_loss 0.0007210873882286251
epoch: 3 s: 512000 batch_loss 0.36054137349128723 BPR_loss 0.35975533723831177 reg_loss 0.0007860502228140831
epoch: 3 s: 768000 batch_loss 0.36137354373931885 BPR_loss 0.36052536964416504 reg_loss 0.0008481625118292868
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 68.83315539360046 | 81.63916993141174 | 147.40460205078125 | [0.14161669 0.20231518 0.24507858] | [0.1192397  0.13826345 0.15101558] | [0.04489919 0.03221666 0.02622022] | [0.50626298 0.61393931 0.67157881] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.35314860939979553 BPR_loss 0.35234397649765015 reg_loss 0.0008046289440244436
epoch: 4 s: 256000 batch_loss 0.3395102620124817 BPR_loss 0.33863118290901184 reg_loss 0.000879087601788342
epoch: 4 s: 512000 batch_loss 0.3393492102622986 BPR_loss 0.33842381834983826 reg_loss 0.0009253900498151779
epoch: 4 s: 768000 batch_loss 0.33810853958129883 BPR_loss 0.3370959758758545 reg_loss 0.0010125621920451522
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 67.91235542297363 | 72.88577818870544 | 134.47169494628906 | [0.14509193 0.20630622 0.25038075] | [0.12193719 0.14118108 0.1543117 ] | [0.04581017 0.03284212 0.02675776] | [0.51507134 0.62053721 0.67854511] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.3236110210418701 BPR_loss 0.3226284384727478 reg_loss 0.0009825738379731774
epoch: 5 s: 256000 batch_loss 0.3281964361667633 BPR_loss 0.32713237404823303 reg_loss 0.0010640524560585618
epoch: 5 s: 512000 batch_loss 0.3190688490867615 BPR_loss 0.31794923543930054 reg_loss 0.001119615393690765
epoch: 5 s: 768000 batch_loss 0.2954650819301605 BPR_loss 0.2942606210708618 reg_loss 0.001204463536851108
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 68.18745446205139 | 74.98910713195801 | 124.07462310791016 | [0.14780669 0.20942803 0.25390204] | [0.12415187 0.14353148 0.15678448] | [0.0464867  0.03327835 0.02708989] | [0.52036305 0.62525956 0.68306651] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.29475948214530945 BPR_loss 0.29353803396224976 reg_loss 0.0012214580783620477
epoch: 6 s: 256000 batch_loss 0.26816049218177795 BPR_loss 0.2669498920440674 reg_loss 0.0012105905916541815
epoch: 6 s: 512000 batch_loss 0.2904665470123291 BPR_loss 0.2891293168067932 reg_loss 0.001337221241556108
epoch: 6 s: 768000 batch_loss 0.28641021251678467 BPR_loss 0.28503134846687317 reg_loss 0.0013788746437057853
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 66.44666314125061 | 83.36408734321594 | 114.75511169433594 | [0.15052717 0.21295503 0.25771494] | [0.12666629 0.14628525 0.15959804] | [0.04737089 0.03387283 0.02749124] | [0.5263246  0.63035032 0.68809029] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.29354000091552734 BPR_loss 0.29219040274620056 reg_loss 0.0013496085302904248
epoch: 7 s: 256000 batch_loss 0.2746833860874176 BPR_loss 0.2732883095741272 reg_loss 0.001395082683302462
epoch: 7 s: 512000 batch_loss 0.269819438457489 BPR_loss 0.26829221844673157 reg_loss 0.0015272197779268026
epoch: 7 s: 768000 batch_loss 0.27182304859161377 BPR_loss 0.2703075408935547 reg_loss 0.0015154957072809339
+-------+-------------------+-----------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s) |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-----------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 67.30878973007202 | 76.733158826828 | 107.15475463867188 | [0.15256405 0.21568759 0.26117729] | [0.1283963  0.14821069 0.16175053] | [0.04797039 0.03422198 0.02781722] | [0.53091299 0.63393395 0.69294661] |
+-------+-------------------+-----------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.26396188139915466 BPR_loss 0.2624363899230957 reg_loss 0.0015254936879500747
epoch: 8 s: 256000 batch_loss 0.2591314911842346 BPR_loss 0.2575520873069763 reg_loss 0.0015793978236615658
epoch: 8 s: 512000 batch_loss 0.23101982474327087 BPR_loss 0.22933636605739594 reg_loss 0.001683462760411203
epoch: 8 s: 768000 batch_loss 0.2366921454668045 BPR_loss 0.23501601815223694 reg_loss 0.0016761337174102664
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 67.30873942375183 | 75.60831689834595 | 100.06303405761719 | [0.15440344 0.21785986 0.26381798] | [0.1299335  0.14985156 0.16352428] | [0.04847445 0.03455188 0.02807734] | [0.53352535 0.63678076 0.69619532] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.24594463407993317 BPR_loss 0.2442871779203415 reg_loss 0.0016574569744989276
epoch: 9 s: 256000 batch_loss 0.2513877749443054 BPR_loss 0.24969343841075897 reg_loss 0.0016943367663770914
epoch: 9 s: 512000 batch_loss 0.2430303543806076 BPR_loss 0.24127143621444702 reg_loss 0.0017589251510798931
epoch: 9 s: 768000 batch_loss 0.22029931843280792 BPR_loss 0.21844609081745148 reg_loss 0.0018532241228967905
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 67.46809816360474 | 72.12682104110718 | 94.06753540039062 | [0.15609473 0.21997359 0.26601328] | [0.13122363 0.15125779 0.16501257] | [0.04889309 0.03478967 0.02828109] | [0.53697502 0.64083328 0.69857325] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.24844518303871155 BPR_loss 0.24661150574684143 reg_loss 0.0018336712382733822
epoch: 10 s: 256000 batch_loss 0.2066541463136673 BPR_loss 0.20483312010765076 reg_loss 0.0018210255075246096
epoch: 10 s: 512000 batch_loss 0.2152964174747467 BPR_loss 0.2133011519908905 reg_loss 0.0019952687434852123
epoch: 10 s: 768000 batch_loss 0.21246404945850372 BPR_loss 0.2105483114719391 reg_loss 0.0019157369388267398
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 67.467200756073  | 81.51201152801514 | 87.49061584472656 | [0.15684828 0.22218158 0.26842871] | [0.13221609 0.15270986 0.16649191] | [0.04910409 0.0350777  0.02845413] | [0.53811374 0.64264184 0.70135307] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.2040773183107376 BPR_loss 0.2020348608493805 reg_loss 0.0020424569956958294
epoch: 11 s: 256000 batch_loss 0.2153611034154892 BPR_loss 0.21316814422607422 reg_loss 0.002192957093939185
epoch: 11 s: 512000 batch_loss 0.21080917119979858 BPR_loss 0.20868366956710815 reg_loss 0.0021254955790936947
epoch: 11 s: 768000 batch_loss 0.19320286810398102 BPR_loss 0.19105732440948486 reg_loss 0.0021455413661897182
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 66.57287311553955 | 68.02453875541687 | 82.87420654296875 | [0.15862753 0.22341225 0.27041623] | [0.13335841 0.15367344 0.16768382] | [0.04955456 0.03523344 0.02862549] | [0.54112801 0.64508674 0.70316163] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.2103404551744461 BPR_loss 0.20821434259414673 reg_loss 0.0021261193323880434
epoch: 12 s: 256000 batch_loss 0.19654929637908936 BPR_loss 0.1943349540233612 reg_loss 0.0022143456153571606
epoch: 12 s: 512000 batch_loss 0.18701359629631042 BPR_loss 0.18475255370140076 reg_loss 0.0022610402666032314
epoch: 12 s: 768000 batch_loss 0.1994807869195938 BPR_loss 0.19711139798164368 reg_loss 0.0023693896364420652
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 66.28736448287964 | 81.77908945083618 | 78.1814956665039 | [0.15906573 0.2247467  0.27190808] | [0.13416574 0.15478201 0.16886905] | [0.0496902  0.03540425 0.02878514] | [0.54303704 0.64696229 0.70520464] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.1752837896347046 BPR_loss 0.17292630672454834 reg_loss 0.0023574859369546175
epoch: 13 s: 256000 batch_loss 0.18401257693767548 BPR_loss 0.18164588510990143 reg_loss 0.0023666969500482082
epoch: 13 s: 512000 batch_loss 0.19474835693836212 BPR_loss 0.1923159658908844 reg_loss 0.0024323861580342054
epoch: 13 s: 768000 batch_loss 0.21114112436771393 BPR_loss 0.20860081911087036 reg_loss 0.002540306420996785
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 66.27177333831787 | 80.79874801635742 | 73.95618438720703 | [0.16022349 0.22579762 0.2732133 ] | [0.13528178 0.15586011 0.16999532] | [0.05000335 0.03556668 0.02888059] | [0.54497957 0.6493737  0.7070132 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.17072764039039612 BPR_loss 0.16833916306495667 reg_loss 0.0023884838446974754
epoch: 14 s: 256000 batch_loss 0.18085363507270813 BPR_loss 0.1784161776304245 reg_loss 0.0024374565109610558
epoch: 14 s: 512000 batch_loss 0.18115772306919098 BPR_loss 0.17871889472007751 reg_loss 0.0024388274177908897
epoch: 14 s: 768000 batch_loss 0.1733659952878952 BPR_loss 0.17073220014572144 reg_loss 0.0026337974704802036
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 66.24576997756958 | 72.89140033721924 | 70.21853637695312 | [0.16132382 0.22627544 0.2739776 ] | [0.13584945 0.15623484 0.17044898] | [0.05027128 0.03563869 0.02894199] | [0.54641972 0.64944069 0.70768303] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.15953566133975983 BPR_loss 0.15691769123077393 reg_loss 0.0026179698761552572
epoch: 15 s: 256000 batch_loss 0.17279204726219177 BPR_loss 0.17009678483009338 reg_loss 0.002695260336622596
epoch: 15 s: 512000 batch_loss 0.17336957156658173 BPR_loss 0.17057538032531738 reg_loss 0.0027941912412643433
epoch: 15 s: 768000 batch_loss 0.16153424978256226 BPR_loss 0.1588168740272522 reg_loss 0.002717378782108426
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 66.83880710601807 | 72.74834418296814 | 66.63353729248047 | [0.16247413 0.22805371 0.27573471] | [0.13688465 0.15747794 0.17170207] | [0.05051577 0.03581285 0.0290821 ] | [0.54986938 0.65319177 0.71093174] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.1555272936820984 BPR_loss 0.15269824862480164 reg_loss 0.0028290492482483387
epoch: 16 s: 256000 batch_loss 0.18119961023330688 BPR_loss 0.1784442961215973 reg_loss 0.002755306661128998
epoch: 16 s: 512000 batch_loss 0.1715007871389389 BPR_loss 0.16868507862091064 reg_loss 0.002815714105963707
epoch: 16 s: 768000 batch_loss 0.13593526184558868 BPR_loss 0.13295269012451172 reg_loss 0.0029825731180608273
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 67.72068452835083 | 83.97988033294678 | 63.42502212524414 | [0.16293422 0.22885221 0.27603173] | [0.13717687 0.15788004 0.17198645] | [0.05064974 0.03591835 0.02913904] | [0.54876415 0.65376114 0.7098935 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.15251465141773224 BPR_loss 0.14952972531318665 reg_loss 0.002984922146424651
epoch: 17 s: 256000 batch_loss 0.16305291652679443 BPR_loss 0.16013556718826294 reg_loss 0.002917354926466942
epoch: 17 s: 512000 batch_loss 0.16190117597579956 BPR_loss 0.1587643325328827 reg_loss 0.0031368406489491463
epoch: 17 s: 768000 batch_loss 0.16525833308696747 BPR_loss 0.16220945119857788 reg_loss 0.0030488756019622087
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 65.89005088806152 | 74.47237420082092 | 60.71644592285156 | [0.16423496 0.2303485  0.27787868] | [0.13828583 0.15907393 0.17330562] | [0.05097461 0.03611009 0.02930315] | [0.55177842 0.65590462 0.7127403 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.1469019651412964 BPR_loss 0.14384564757347107 reg_loss 0.003056319197639823
epoch: 18 s: 256000 batch_loss 0.14085863530635834 BPR_loss 0.13768844306468964 reg_loss 0.0031701980624347925
epoch: 18 s: 512000 batch_loss 0.13133496046066284 BPR_loss 0.128139466047287 reg_loss 0.003195498837158084
epoch: 18 s: 768000 batch_loss 0.13521482050418854 BPR_loss 0.13182860612869263 reg_loss 0.0033862090203911066
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 67.02305197715759 | 79.95853900909424 | 57.6987419128418 | [0.16410811 0.230481   0.27846812] | [0.13816544 0.15909873 0.17342677] | [0.05085907 0.03611344 0.02928473] | [0.55154397 0.65630652 0.71314221] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.1399284303188324 BPR_loss 0.13668552041053772 reg_loss 0.0032429047860205173
epoch: 19 s: 256000 batch_loss 0.13176564872264862 BPR_loss 0.1283876895904541 reg_loss 0.0033779582008719444
epoch: 19 s: 512000 batch_loss 0.1352357566356659 BPR_loss 0.13203462958335876 reg_loss 0.0032011233270168304
epoch: 19 s: 768000 batch_loss 0.1260683238506317 BPR_loss 0.12277355045080185 reg_loss 0.0032947768922895193
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 66.7325119972229 | 76.73248505592346 | 55.08502960205078 | [0.16517461 0.23151437 0.27955989] | [0.13901868 0.15994752 0.17429279] | [0.05119231 0.0363035  0.02942204] | [0.55341952 0.65734477 0.71438141] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.1406179815530777 BPR_loss 0.1373048722743988 reg_loss 0.0033131097443401814
epoch: 20 s: 256000 batch_loss 0.13418938219547272 BPR_loss 0.13089808821678162 reg_loss 0.00329129071906209
epoch: 20 s: 512000 batch_loss 0.1345045566558838 BPR_loss 0.1308947503566742 reg_loss 0.0036097990814596415
epoch: 20 s: 768000 batch_loss 0.12141025811433792 BPR_loss 0.11789083480834961 reg_loss 0.003519423073157668
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 67.60060501098633 | 82.78949999809265 | 52.7828483581543 | [0.16580332 0.23270657 0.28066469] | [0.13969479 0.16080394 0.17513051] | [0.05136479 0.03645254 0.02953647] | [0.55489316 0.65995713 0.71595552] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.12647360563278198 BPR_loss 0.12320579588413239 reg_loss 0.0032678062561899424
epoch: 21 s: 256000 batch_loss 0.13753381371498108 BPR_loss 0.1340673565864563 reg_loss 0.0034664529375731945
epoch: 21 s: 512000 batch_loss 0.12328914552927017 BPR_loss 0.11983045190572739 reg_loss 0.00345869199372828
epoch: 21 s: 768000 batch_loss 0.11460388451814651 BPR_loss 0.11089639365673065 reg_loss 0.0037074913270771503
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 66.55723643302917 | 71.09457063674927 | 50.5864372253418 | [0.16596275 0.23251586 0.2810236 ] | [0.13953381 0.16054222 0.17504348] | [0.05129446 0.03635625 0.02951247] | [0.55442427 0.65831603 0.71622346] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.10983666032552719 BPR_loss 0.10620427131652832 reg_loss 0.0036323925014585257
epoch: 22 s: 256000 batch_loss 0.1120121031999588 BPR_loss 0.10832704603672028 reg_loss 0.0036850585602223873
epoch: 22 s: 512000 batch_loss 0.10932591557502747 BPR_loss 0.10568597912788391 reg_loss 0.0036399338860064745
epoch: 22 s: 768000 batch_loss 0.12646923959255219 BPR_loss 0.12276406586170197 reg_loss 0.0037051744293421507
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 65.32382702827454 | 76.88325476646423 | 48.55364990234375 | [0.16679521 0.23301588 0.2816683 ] | [0.14001654 0.16090097 0.17546629] | [0.05152723 0.03637635 0.02957834] | [0.5568022  0.65995713 0.71756313] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.12644144892692566 BPR_loss 0.12265140563249588 reg_loss 0.0037900384049862623
epoch: 23 s: 256000 batch_loss 0.11894872039556503 BPR_loss 0.11517344415187836 reg_loss 0.003775273449718952
epoch: 23 s: 512000 batch_loss 0.1151125505566597 BPR_loss 0.11128582060337067 reg_loss 0.0038267290219664574
epoch: 23 s: 768000 batch_loss 0.1149723157286644 BPR_loss 0.11112996935844421 reg_loss 0.0038423435762524605
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 66.52620911598206 | 78.49997305870056 | 46.59413146972656 | [0.16725545 0.23447509 0.28275989] | [0.14062023 0.16184296 0.17629511] | [0.05156574 0.03652874 0.02962634] | [0.55717061 0.66220109 0.7189363 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.11238522082567215 BPR_loss 0.10851161181926727 reg_loss 0.0038736071437597275
epoch: 24 s: 256000 batch_loss 0.10914777219295502 BPR_loss 0.10541185736656189 reg_loss 0.003735917853191495
epoch: 24 s: 512000 batch_loss 0.11484109610319138 BPR_loss 0.11084786057472229 reg_loss 0.0039932322688400745
epoch: 24 s: 768000 batch_loss 0.11443713307380676 BPR_loss 0.11040152609348297 reg_loss 0.0040356069803237915
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 66.46893072128296 | 78.97621059417725 | 44.793338775634766 | [0.16697842 0.23463207 0.28302412] | [0.14054658 0.1619773  0.17637448] | [0.05146694 0.03658483 0.02958504] | [0.55629982 0.66136379 0.71910376] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.11495985090732574 BPR_loss 0.11091075837612152 reg_loss 0.004049091134220362
epoch: 25 s: 256000 batch_loss 0.11324021220207214 BPR_loss 0.10917270928621292 reg_loss 0.004067499190568924
epoch: 25 s: 512000 batch_loss 0.11420437693595886 BPR_loss 0.1101853996515274 reg_loss 0.004018978215754032
epoch: 25 s: 768000 batch_loss 0.12249897420406342 BPR_loss 0.11818268150091171 reg_loss 0.004316292703151703
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 64.4268012046814 | 69.88679361343384 | 43.32139205932617 | [0.16728427 0.23440566 0.28319823] | [0.14057284 0.16180114 0.17636728] | [0.05150378 0.03649357 0.02961518] | [0.55616585 0.66139728 0.71920423] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.0887954905629158 BPR_loss 0.08467373996973038 reg_loss 0.004121753852814436
epoch: 26 s: 256000 batch_loss 0.1078321784734726 BPR_loss 0.10365021228790283 reg_loss 0.004181968048214912
epoch: 26 s: 512000 batch_loss 0.1082882508635521 BPR_loss 0.1041591539978981 reg_loss 0.004129100125283003
epoch: 26 s: 768000 batch_loss 0.10067718476057053 BPR_loss 0.0964808315038681 reg_loss 0.004196351859718561
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 62.85012197494507 | 73.98798656463623 | 41.7175407409668 | [0.16741398 0.23530045 0.28387427] | [0.14048185 0.16198306 0.17649968] | [0.05153895 0.03658483 0.02966821] | [0.55733807 0.66310537 0.72027597] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.09977738559246063 BPR_loss 0.0956648588180542 reg_loss 0.00411252910271287
epoch: 27 s: 256000 batch_loss 0.10188468545675278 BPR_loss 0.09766611456871033 reg_loss 0.004218571353703737
epoch: 27 s: 512000 batch_loss 0.10356255620718002 BPR_loss 0.09916840493679047 reg_loss 0.004394153133034706
epoch: 27 s: 768000 batch_loss 0.11655071377754211 BPR_loss 0.11235761642456055 reg_loss 0.004193098749965429
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 61.793415784835815 | 65.44905257225037 | 40.1837043762207 | [0.16766251 0.23588816 0.2844465 ] | [0.14099546 0.16260211 0.1770988 ] | [0.05156407 0.03662251 0.029671  ] | [0.55780695 0.66260299 0.72044343] |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 28 s: 0 batch_loss 0.11657660454511642 BPR_loss 0.11225297302007675 reg_loss 0.0043236324563622475
epoch: 28 s: 256000 batch_loss 0.1006828099489212 BPR_loss 0.09618669003248215 reg_loss 0.004496123641729355
epoch: 28 s: 512000 batch_loss 0.08918558806180954 BPR_loss 0.08469647914171219 reg_loss 0.004489109851419926
epoch: 28 s: 768000 batch_loss 0.08501939475536346 BPR_loss 0.08046569675207138 reg_loss 0.004553694743663073
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   28  | 58.32835388183594 | 58.923388957977295 | 38.969417572021484 | [0.16812358 0.23662215 0.28490968] | [0.14128121 0.16304427 0.17747408] | [0.05158584 0.03672048 0.02973352] | [0.55740505 0.66370822 0.72104629] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 29 s: 0 batch_loss 0.09486356377601624 BPR_loss 0.09026224166154861 reg_loss 0.004601320717483759
epoch: 29 s: 256000 batch_loss 0.08897065371274948 BPR_loss 0.0844251960515976 reg_loss 0.004545457661151886
epoch: 29 s: 512000 batch_loss 0.09591913968324661 BPR_loss 0.09134788811206818 reg_loss 0.004571249708533287
epoch: 29 s: 768000 batch_loss 0.08924899250268936 BPR_loss 0.08466806262731552 reg_loss 0.004580926615744829
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   29  | 57.09256553649902 | 62.82593035697937 | 37.60076141357422 | [0.16897743 0.23683963 0.28513937] | [0.14151764 0.16304409 0.17747931] | [0.05179516 0.03674895 0.02975752] | [0.55907964 0.6641771  0.72245294] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 30 s: 0 batch_loss 0.09418987482786179 BPR_loss 0.08957996964454651 reg_loss 0.004609902389347553
epoch: 30 s: 256000 batch_loss 0.08347981423139572 BPR_loss 0.0786207765340805 reg_loss 0.0048590367659926414
epoch: 30 s: 512000 batch_loss 0.09323494881391525 BPR_loss 0.08838486671447754 reg_loss 0.00485008442774415
epoch: 30 s: 768000 batch_loss 0.09568912535905838 BPR_loss 0.09100453555583954 reg_loss 0.004684589337557554
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   30  | 57.94816064834595 | 67.41729807853699 | 36.279205322265625 | [0.16891271 0.23691071 0.2856311 ] | [0.14141692 0.16301599 0.17757855] | [0.05170641 0.03673387 0.02975864] | [0.5596825  0.66384219 0.72335722] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 31 s: 0 batch_loss 0.08206287026405334 BPR_loss 0.07745563983917236 reg_loss 0.00460723415017128
epoch: 31 s: 256000 batch_loss 0.0818314179778099 BPR_loss 0.07683699578046799 reg_loss 0.004994422663003206
epoch: 31 s: 512000 batch_loss 0.09183979779481888 BPR_loss 0.08711947500705719 reg_loss 0.004720322787761688
epoch: 31 s: 768000 batch_loss 0.08336510509252548 BPR_loss 0.07846836745738983 reg_loss 0.004896737169474363
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   31  | 58.46969962120056 | 57.75908875465393 | 35.4752082824707 | [0.16870671 0.23662592 0.28526461] | [0.14099091 0.16256849 0.17710235] | [0.05166622 0.03667861 0.02969891] | [0.55991694 0.66250251 0.72302231] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 32 s: 0 batch_loss 0.08879347890615463 BPR_loss 0.08409516513347626 reg_loss 0.004698316100984812
epoch: 32 s: 256000 batch_loss 0.09289702773094177 BPR_loss 0.0879339799284935 reg_loss 0.004963048733770847
epoch: 32 s: 512000 batch_loss 0.08950725197792053 BPR_loss 0.08464628458023071 reg_loss 0.004860967397689819
epoch: 32 s: 768000 batch_loss 0.0899675041437149 BPR_loss 0.08478157222270966 reg_loss 0.005185931921005249
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   32  | 57.02421569824219 | 55.99174928665161 | 34.031776428222656 | [0.16883105 0.23655783 0.28516039] | [0.14107575 0.16262704 0.17716586] | [0.05151383 0.03659991 0.02964644] | [0.55961551 0.66310537 0.72302231] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 33 s: 0 batch_loss 0.08109769970178604 BPR_loss 0.07653322070837021 reg_loss 0.004564477596431971
epoch: 33 s: 256000 batch_loss 0.0687839537858963 BPR_loss 0.06390298157930374 reg_loss 0.004880968481302261
epoch: 33 s: 512000 batch_loss 0.07758751511573792 BPR_loss 0.07254185527563095 reg_loss 0.005045660771429539
epoch: 33 s: 768000 batch_loss 0.07918940484523773 BPR_loss 0.07436547428369522 reg_loss 0.004823928698897362
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   33  | 50.20329523086548 | 42.91384673118591 | 32.91425704956055 | [0.16900855 0.23672671 0.28615957] | [0.14124671 0.16282767 0.17757626] | [0.05158919 0.03666605 0.02973407] | [0.55988345 0.66414361 0.72362516] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 34 s: 0 batch_loss 0.08244731277227402 BPR_loss 0.07730866223573685 reg_loss 0.005138651002198458
epoch: 34 s: 256000 batch_loss 0.08431875705718994 BPR_loss 0.07931233197450638 reg_loss 0.005006426014006138
epoch: 34 s: 512000 batch_loss 0.07994768023490906 BPR_loss 0.07499006390571594 reg_loss 0.004957612603902817
epoch: 34 s: 768000 batch_loss 0.0850922167301178 BPR_loss 0.0800936371088028 reg_loss 0.004998579155653715
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   34  | 52.22957706451416 | 43.57523155212402 | 32.00041580200195 | [0.16897248 0.23694254 0.28604688] | [0.14117832 0.16279438 0.1774753 ] | [0.05159254 0.03660744 0.02969165] | [0.56028535 0.66394266 0.72268739] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 35 s: 0 batch_loss 0.08106803148984909 BPR_loss 0.07602594792842865 reg_loss 0.005042086821049452
epoch: 35 s: 256000 batch_loss 0.07270863652229309 BPR_loss 0.06773344427347183 reg_loss 0.004975190851837397
epoch: 35 s: 512000 batch_loss 0.07942169159650803 BPR_loss 0.07424814999103546 reg_loss 0.0051735397428274155
epoch: 35 s: 768000 batch_loss 0.08323769271373749 BPR_loss 0.07798472791910172 reg_loss 0.0052529675886034966
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   35  | 50.807260274887085 | 54.137924671173096 | 30.955387115478516 | [0.16934762 0.23733737 0.28625207] | [0.14137811 0.16301685 0.17764797] | [0.05159589 0.03664428 0.02969612] | [0.55928059 0.66407663 0.7230558 ] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 36 s: 0 batch_loss 0.07458444684743881 BPR_loss 0.06941106915473938 reg_loss 0.0051733762957155704
epoch: 36 s: 256000 batch_loss 0.07733329385519028 BPR_loss 0.07196875661611557 reg_loss 0.005364539567381144
epoch: 36 s: 512000 batch_loss 0.06792052090167999 BPR_loss 0.06286640465259552 reg_loss 0.005054116249084473
epoch: 36 s: 768000 batch_loss 0.06326328217983246 BPR_loss 0.058167338371276855 reg_loss 0.0050959475338459015
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   36  | 52.71585249900818 | 56.26706004142761 | 30.282676696777344 | [0.1688428  0.23761544 0.2863412 ] | [0.14098637 0.16291285 0.17753056] | [0.05132795 0.03659572 0.02969333] | [0.55871123 0.6641771  0.72339072] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 37 s: 0 batch_loss 0.07706498354673386 BPR_loss 0.07181505113840103 reg_loss 0.005249932873994112
epoch: 37 s: 256000 batch_loss 0.08167050778865814 BPR_loss 0.07652253657579422 reg_loss 0.005147967953234911
epoch: 37 s: 512000 batch_loss 0.07933979481458664 BPR_loss 0.07390672713518143 reg_loss 0.005433070473372936
epoch: 37 s: 768000 batch_loss 0.06655194610357285 BPR_loss 0.06086837500333786 reg_loss 0.005683572962880135
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   37  | 50.782695293426514 | 56.73541975021362 | 29.359785079956055 | [0.16920205 0.23769936 0.28652248] | [0.14128872 0.16316691 0.17778773] | [0.05139661 0.03664596 0.0297017 ] | [0.55951504 0.66508139 0.72392659] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 38 s: 0 batch_loss 0.07505428791046143 BPR_loss 0.06964169442653656 reg_loss 0.005412590689957142
epoch: 38 s: 256000 batch_loss 0.07840646058320999 BPR_loss 0.07314631342887878 reg_loss 0.005260143894702196
epoch: 38 s: 512000 batch_loss 0.07032608240842819 BPR_loss 0.0648060292005539 reg_loss 0.005520056467503309
epoch: 38 s: 768000 batch_loss 0.07452093064785004 BPR_loss 0.06924133002758026 reg_loss 0.005279599688947201
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   38  | 51.348737716674805 | 60.22312569618225 | 28.517866134643555 | [0.16879783 0.2375522  0.28621922] | [0.14089397 0.1628599  0.17743   ] | [0.05125762 0.03656725 0.02961574] | [0.55693616 0.66467948 0.7230558 ] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 39 s: 0 batch_loss 0.06255431473255157 BPR_loss 0.057141028344631195 reg_loss 0.005413290113210678
epoch: 39 s: 256000 batch_loss 0.07542135566473007 BPR_loss 0.07002244889736176 reg_loss 0.005398906301707029
epoch: 39 s: 512000 batch_loss 0.06469699740409851 BPR_loss 0.05933617055416107 reg_loss 0.005360828246921301
epoch: 39 s: 768000 batch_loss 0.07134819775819778 BPR_loss 0.06572917103767395 reg_loss 0.005619027651846409
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   39  | 46.355623722076416 | 51.46078443527222 | 28.14910316467285 | [0.16864703 0.23775614 0.28665641] | [0.14067651 0.16280798 0.17742702] | [0.05117054 0.03659656 0.02963472] | [0.55747203 0.66394266 0.72355818] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 40 s: 0 batch_loss 0.07206080108880997 BPR_loss 0.0664764791727066 reg_loss 0.005584320984780788
epoch: 40 s: 256000 batch_loss 0.06341328471899033 BPR_loss 0.0579770989716053 reg_loss 0.005436182953417301
epoch: 40 s: 512000 batch_loss 0.07261183112859726 BPR_loss 0.06690152734518051 reg_loss 0.005710305646061897
epoch: 40 s: 768000 batch_loss 0.06639500707387924 BPR_loss 0.06085909157991409 reg_loss 0.005535914562642574
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   40  | 48.84498047828674 | 75.43829655647278 | 27.12641716003418 | [0.16930735 0.23764704 0.28684803] | [0.14088975 0.16268939 0.17741717] | [0.05140331 0.03655888 0.02966597] | [0.55877822 0.66360774 0.7238596 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 41 s: 0 batch_loss 0.07085897028446198 BPR_loss 0.0653587356209755 reg_loss 0.005500235594809055
epoch: 41 s: 256000 batch_loss 0.06602470576763153 BPR_loss 0.060268584638834 reg_loss 0.00575611786916852
epoch: 41 s: 512000 batch_loss 0.06320658326148987 BPR_loss 0.05759037658572197 reg_loss 0.005616209469735622
epoch: 41 s: 768000 batch_loss 0.07215258479118347 BPR_loss 0.06660860776901245 reg_loss 0.005543977487832308
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   41  | 58.09740591049194 | 94.14089035987854 | 26.59459686279297 | [0.16898916 0.23724211 0.28692247] | [0.14076925 0.1626015  0.17744687] | [0.05120738 0.03645087 0.02960011] | [0.55784044 0.66287092 0.72375913] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 42 s: 0 batch_loss 0.07009659707546234 BPR_loss 0.06441733241081238 reg_loss 0.005679262336343527
epoch: 42 s: 256000 batch_loss 0.07293231040239334 BPR_loss 0.06711848080158234 reg_loss 0.005813829600811005
epoch: 42 s: 512000 batch_loss 0.060624945908784866 BPR_loss 0.054828863590955734 reg_loss 0.005796083714812994
epoch: 42 s: 768000 batch_loss 0.06868180632591248 BPR_loss 0.0631767213344574 reg_loss 0.00550508638843894
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   42  | 66.2011046409607 | 76.00473737716675 | 25.813425064086914 | [0.16955533 0.23813323 0.28746631] | [0.14106424 0.16299043 0.17771434] | [0.05134805 0.03657897 0.02964588] | [0.55998392 0.66488043 0.7242615 ] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 43 s: 0 batch_loss 0.06479790061712265 BPR_loss 0.05889252573251724 reg_loss 0.005905373953282833
epoch: 43 s: 256000 batch_loss 0.07684346288442612 BPR_loss 0.07131002843379974 reg_loss 0.005533434916287661
epoch: 43 s: 512000 batch_loss 0.05778437852859497 BPR_loss 0.05210871994495392 reg_loss 0.0056756590493023396
epoch: 43 s: 768000 batch_loss 0.062159474939107895 BPR_loss 0.05606434866786003 reg_loss 0.0060951258055865765
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   43  | 69.24646067619324 | 97.02490544319153 | 25.408472061157227 | [0.16944722 0.23819734 0.28733857] | [0.14095863 0.1629219  0.17764241] | [0.05131456 0.03656725 0.02965537] | [0.55914663 0.66474647 0.72392659] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 44 s: 0 batch_loss 0.06814631819725037 BPR_loss 0.06226222962141037 reg_loss 0.005884084850549698
epoch: 44 s: 256000 batch_loss 0.059876032173633575 BPR_loss 0.05382663011550903 reg_loss 0.006049402989447117
epoch: 44 s: 512000 batch_loss 0.05955187976360321 BPR_loss 0.053806185722351074 reg_loss 0.005745695438235998
epoch: 44 s: 768000 batch_loss 0.05383748188614845 BPR_loss 0.04777415469288826 reg_loss 0.006063328590244055
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   44  | 69.13308477401733 | 105.5098819732666 | 24.62228012084961 | [0.16885932 0.23798337 0.28674734] | [0.13996386 0.1620818  0.17670121] | [0.05106504 0.03649357 0.02959006] | [0.55753902 0.6629714  0.72308929] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 45 s: 0 batch_loss 0.05970975011587143 BPR_loss 0.05369926616549492 reg_loss 0.006010483019053936
epoch: 45 s: 256000 batch_loss 0.06401638686656952 BPR_loss 0.05812251940369606 reg_loss 0.005893871188163757
epoch: 45 s: 512000 batch_loss 0.06503394991159439 BPR_loss 0.05890612304210663 reg_loss 0.006127829663455486
epoch: 45 s: 768000 batch_loss 0.0665411576628685 BPR_loss 0.060364458709955215 reg_loss 0.006176700349897146
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   45  | 61.17469668388367 | 117.17246890068054 | 24.171998977661133 | [0.16911791 0.23752238 0.28651598] | [0.14006158 0.16196521 0.17662265] | [0.05102485 0.03634621 0.0294667 ] | [0.5572041  0.66210061 0.7218166 ] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 46 s: 0 batch_loss 0.06574276834726334 BPR_loss 0.059787899255752563 reg_loss 0.005954869091510773
epoch: 46 s: 256000 batch_loss 0.05631987005472183 BPR_loss 0.050332583487033844 reg_loss 0.00598728796467185
epoch: 46 s: 512000 batch_loss 0.0526384636759758 BPR_loss 0.046625129878520966 reg_loss 0.006013335194438696
epoch: 46 s: 768000 batch_loss 0.05919076129794121 BPR_loss 0.05304457247257233 reg_loss 0.006146188825368881
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   46  | 58.073500633239746 | 122.11569952964783 | 23.514528274536133 | [0.1694299  0.23754424 0.28649065] | [0.14019644 0.16201435 0.17666243] | [0.0510215  0.03630183 0.02944046] | [0.55904615 0.66169871 0.72282135] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 47 s: 0 batch_loss 0.06735902279615402 BPR_loss 0.06111041456460953 reg_loss 0.006248610094189644
epoch: 47 s: 256000 batch_loss 0.06391984969377518 BPR_loss 0.0577201172709465 reg_loss 0.006199733819812536
epoch: 47 s: 512000 batch_loss 0.05415797606110573 BPR_loss 0.04804578423500061 reg_loss 0.006112190894782543
epoch: 47 s: 768000 batch_loss 0.05867789685726166 BPR_loss 0.05267943814396858 reg_loss 0.0059984601102769375
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   47  | 54.89293885231018 | 98.12202072143555 | 23.164583206176758 | [0.16879373 0.23741232 0.28611048] | [0.1397694  0.16178341 0.17636098] | [0.05080046 0.0362742  0.02939804] | [0.55690267 0.662536   0.72335722] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 48 s: 0 batch_loss 0.05134648457169533 BPR_loss 0.04491961747407913 reg_loss 0.006426867563277483
epoch: 48 s: 256000 batch_loss 0.058797452598810196 BPR_loss 0.05244619399309158 reg_loss 0.006351259537041187
epoch: 48 s: 512000 batch_loss 0.06494954973459244 BPR_loss 0.05888005346059799 reg_loss 0.006069497670978308
epoch: 48 s: 768000 batch_loss 0.05719833821058273 BPR_loss 0.051119282841682434 reg_loss 0.006079056300222874
+-------+--------------------+-----------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |  tesing time(s) |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-----------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   48  | 56.715227127075195 | 80.746267080307 | 22.61380386352539 | [0.16933085 0.23794328 0.28736155] | [0.14019189 0.16222477 0.17700295] | [0.05093107 0.03641989 0.02957052] | [0.55851028 0.66387568 0.72526626] |
+-------+--------------------+-----------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 49 s: 0 batch_loss 0.05709489434957504 BPR_loss 0.05073915421962738 reg_loss 0.00635574059560895
epoch: 49 s: 256000 batch_loss 0.05622920021414757 BPR_loss 0.0499325692653656 reg_loss 0.006296631880104542
epoch: 49 s: 512000 batch_loss 0.054573338478803635 BPR_loss 0.0482584573328495 reg_loss 0.00631487974897027
epoch: 49 s: 768000 batch_loss 0.06035306304693222 BPR_loss 0.054006390273571014 reg_loss 0.006346670910716057
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   49  | 62.195741415023804 | 69.78474473953247 | 21.958600997924805 | [0.16889183 0.23749278 0.28630754] | [0.13957076 0.16155657 0.17619581] | [0.05085069 0.03629262 0.02944939] | [0.55640029 0.66313886 0.72248644] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 50 s: 0 batch_loss 0.049415893852710724 BPR_loss 0.04320084676146507 reg_loss 0.006215048488229513
epoch: 50 s: 256000 batch_loss 0.05236274003982544 BPR_loss 0.04598785191774368 reg_loss 0.006374888587743044
epoch: 50 s: 512000 batch_loss 0.05912001430988312 BPR_loss 0.05277436599135399 reg_loss 0.006345647852867842
epoch: 50 s: 768000 batch_loss 0.057074740529060364 BPR_loss 0.05034426227211952 reg_loss 0.006730480119585991
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   50  | 63.49870419502258 | 79.47414541244507 | 21.63747787475586 | [0.16900787 0.2374225  0.28646033] | [0.13945628 0.16139313 0.17609417] | [0.05077534 0.03623652 0.02941702] | [0.55737156 0.6625695  0.72282135] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 51 s: 0 batch_loss 0.049030475318431854 BPR_loss 0.0428471714258194 reg_loss 0.006183302961289883
epoch: 51 s: 256000 batch_loss 0.0548119954764843 BPR_loss 0.048169322311878204 reg_loss 0.0066426717676222324
epoch: 51 s: 512000 batch_loss 0.05737124755978584 BPR_loss 0.05100739747285843 reg_loss 0.006363850552588701
epoch: 51 s: 768000 batch_loss 0.05812956765294075 BPR_loss 0.051854148507118225 reg_loss 0.006275417748838663
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |  tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   51  | 58.282148599624634 | 86.4326479434967 | 21.13698387145996 | [0.16835508 0.23701467 0.28603844] | [0.13905494 0.16112673 0.17581923] | [0.05048563 0.03611595 0.02930984] | [0.55606538 0.66220109 0.72225199] |
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 52 s: 0 batch_loss 0.05093935877084732 BPR_loss 0.044434644281864166 reg_loss 0.006504715885967016
epoch: 52 s: 256000 batch_loss 0.056596044450998306 BPR_loss 0.04991381615400314 reg_loss 0.006682227831333876
epoch: 52 s: 512000 batch_loss 0.04906089976429939 BPR_loss 0.042527489364147186 reg_loss 0.006533409468829632
epoch: 52 s: 768000 batch_loss 0.04839586466550827 BPR_loss 0.04184868931770325 reg_loss 0.006547173950821161
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   52  | 55.15357327461243 | 94.41355180740356 | 20.842313766479492 | [0.16859918 0.23715941 0.28590773] | [0.1391873  0.16123487 0.1758581 ] | [0.05052247 0.03609418 0.02928026] | [0.55529506 0.66210061 0.72195057] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.1685991769513815
early stopping at 52, recall@20:0.1696
