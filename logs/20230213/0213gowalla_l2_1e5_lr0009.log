Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='gowalla', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=3, l2=1e-05, lr=0.009, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931487321853638 BPR_loss 0.6931487321853638 reg_loss 2.4288397959537633e-09
epoch: 0 s: 256000 batch_loss 0.5473811626434326 BPR_loss 0.5472002625465393 reg_loss 0.0001809279347071424
epoch: 0 s: 512000 batch_loss 0.46791699528694153 BPR_loss 0.46755480766296387 reg_loss 0.0003621937066782266
epoch: 0 s: 768000 batch_loss 0.4252561330795288 BPR_loss 0.4247542917728424 reg_loss 0.0005018529482185841
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 50.18331289291382 | 38.85012698173523 | 204.69000244140625 | [0.13337214 0.19183319 0.23358793] | [0.11218573 0.13051664 0.14292739] | [0.042394   0.03062161 0.02498605] | [0.4868377  0.59488244 0.65500033] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.44137388467788696 BPR_loss 0.44085395336151123 reg_loss 0.0005199449951760471
epoch: 1 s: 256000 batch_loss 0.37644749879837036 BPR_loss 0.37576723098754883 reg_loss 0.0006802741554565728
epoch: 1 s: 512000 batch_loss 0.359245628118515 BPR_loss 0.35842365026474 reg_loss 0.0008219743031077087
epoch: 1 s: 768000 batch_loss 0.32645219564437866 BPR_loss 0.325462281703949 reg_loss 0.0009899019496515393
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 59.40781760215759 | 50.73574757575989 | 150.608642578125 | [0.14268622 0.20340585 0.24715533] | [0.11993308 0.13895075 0.1520124 ] | [0.0450633  0.03229871 0.02638266] | [0.50880836 0.6144082  0.67348784] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.33905115723609924 BPR_loss 0.33807849884033203 reg_loss 0.0009726658463478088
epoch: 2 s: 256000 batch_loss 0.34373408555984497 BPR_loss 0.3426682651042938 reg_loss 0.001065824762918055
epoch: 2 s: 512000 batch_loss 0.29394516348838806 BPR_loss 0.292703241109848 reg_loss 0.0012419340200722218
epoch: 2 s: 768000 batch_loss 0.28222155570983887 BPR_loss 0.2808123230934143 reg_loss 0.0014092301717028022
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 67.99757075309753 | 66.32852816581726 | 123.17219543457031 | [0.14941745 0.2119016  0.25684463] | [0.12539932 0.1449902  0.15839293] | [0.04703932 0.03361746 0.02737625] | [0.52367875 0.6275705  0.68527698] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.2778336703777313 BPR_loss 0.27637702226638794 reg_loss 0.0014566500904038548
epoch: 3 s: 256000 batch_loss 0.27280816435813904 BPR_loss 0.2712715268135071 reg_loss 0.0015366508159786463
epoch: 3 s: 512000 batch_loss 0.24237293004989624 BPR_loss 0.24067550897598267 reg_loss 0.0016974169993773103
epoch: 3 s: 768000 batch_loss 0.2440679371356964 BPR_loss 0.24225184321403503 reg_loss 0.0018160877516493201
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 65.73315811157227 | 68.05125856399536 | 103.40972137451172 | [0.15395901 0.21770182 0.26396694] | [0.12952354 0.14957519 0.16334774] | [0.04825507 0.0345008  0.0280606 ] | [0.53282202 0.6358095  0.69442026] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.23285889625549316 BPR_loss 0.23112012445926666 reg_loss 0.001738778781145811
epoch: 4 s: 256000 batch_loss 0.2170034497976303 BPR_loss 0.21510878205299377 reg_loss 0.0018946651834994555
epoch: 4 s: 512000 batch_loss 0.22524212300777435 BPR_loss 0.22325026988983154 reg_loss 0.001991858473047614
epoch: 4 s: 768000 batch_loss 0.2157057821750641 BPR_loss 0.2135164439678192 reg_loss 0.0021893316879868507
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 68.94083213806152 | 89.67203450202942 | 88.40428161621094 | [0.15721598 0.22204757 0.26809836] | [0.13230678 0.15265914 0.16640713] | [0.04916605 0.03505174 0.02844687] | [0.54079309 0.64250787 0.70118561] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.20468321442604065 BPR_loss 0.20255598425865173 reg_loss 0.002127236919477582
epoch: 5 s: 256000 batch_loss 0.2042386531829834 BPR_loss 0.20193767547607422 reg_loss 0.002300977474078536
epoch: 5 s: 512000 batch_loss 0.1968422681093216 BPR_loss 0.1944180130958557 reg_loss 0.002424253849312663
epoch: 5 s: 768000 batch_loss 0.18005022406578064 BPR_loss 0.1774752289056778 reg_loss 0.0025750002823770046
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 69.83069634437561 | 82.26377630233765 | 77.28225708007812 | [0.15901817 0.22454341 0.27123144] | [0.13371043 0.15426033 0.16821133] | [0.04968518 0.03535401 0.02869694] | [0.54263514 0.64545515 0.70419988] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.17607863247394562 BPR_loss 0.1734544038772583 reg_loss 0.002624229993671179
epoch: 6 s: 256000 batch_loss 0.151244655251503 BPR_loss 0.14863602817058563 reg_loss 0.0026086291763931513
epoch: 6 s: 512000 batch_loss 0.18379610776901245 BPR_loss 0.1809377670288086 reg_loss 0.002858347725123167
epoch: 6 s: 768000 batch_loss 0.17144882678985596 BPR_loss 0.16852940618991852 reg_loss 0.0029194157104939222
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+---------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |            precision            |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+---------------------------------+------------------------------------+
|   6   | 68.52012395858765 | 75.59933066368103 | 68.25877380371094 | [0.16193904 0.22811851 0.27591887] | [0.13628112 0.15709252 0.17131788] | [0.050494  0.0359083 0.0291262] | [0.54883113 0.65255543 0.71126666] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+---------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.18360579013824463 BPR_loss 0.1807180941104889 reg_loss 0.002887699520215392
epoch: 7 s: 256000 batch_loss 0.15790018439292908 BPR_loss 0.15494561195373535 reg_loss 0.0029545659199357033
epoch: 7 s: 512000 batch_loss 0.15782219171524048 BPR_loss 0.15458452701568604 reg_loss 0.0032376586459577084
epoch: 7 s: 768000 batch_loss 0.15422499179840088 BPR_loss 0.1510140597820282 reg_loss 0.003210933180525899
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 66.2620677947998 | 75.29376578330994 | 61.375057220458984 | [0.16286302 0.22942427 0.2772369 ] | [0.13700175 0.1580096  0.17227388] | [0.05057271 0.03596775 0.02918146] | [0.54970192 0.65382812 0.71190301] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.1476140320301056 BPR_loss 0.14438509941101074 reg_loss 0.0032289379741996527
epoch: 8 s: 256000 batch_loss 0.148777037858963 BPR_loss 0.14543917775154114 reg_loss 0.0033378642983734608
epoch: 8 s: 512000 batch_loss 0.12498471885919571 BPR_loss 0.12146975100040436 reg_loss 0.00351496459916234
epoch: 8 s: 768000 batch_loss 0.12326637655496597 BPR_loss 0.11975674331188202 reg_loss 0.003509634407237172
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 66.70449781417847 | 81.65272831916809 | 55.46620178222656 | [0.16413135 0.23034544 0.27773571] | [0.1373224  0.15817516 0.17236649] | [0.05077869 0.03598533 0.02917644] | [0.55164445 0.65386161 0.71059682] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.138564333319664 BPR_loss 0.13509303331375122 reg_loss 0.0034713041968643665
epoch: 9 s: 256000 batch_loss 0.1371518075466156 BPR_loss 0.1336403787136078 reg_loss 0.0035114292986691
epoch: 9 s: 512000 batch_loss 0.13027562201023102 BPR_loss 0.12663039565086365 reg_loss 0.0036452324129641056
epoch: 9 s: 768000 batch_loss 0.11247391998767853 BPR_loss 0.10866037011146545 reg_loss 0.0038135491777211428
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 67.93652486801147 | 77.62184834480286 | 50.530479431152344 | [0.16536372 0.232089   0.28083313] | [0.1383945  0.15938933 0.17397133] | [0.0512258  0.03619633 0.02943544] | [0.55355349 0.65670842 0.71572108] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.12230636179447174 BPR_loss 0.11851465702056885 reg_loss 0.003791703376919031
epoch: 10 s: 256000 batch_loss 0.1018381118774414 BPR_loss 0.09809906780719757 reg_loss 0.0037390422075986862
epoch: 10 s: 512000 batch_loss 0.11192622035741806 BPR_loss 0.1078520342707634 reg_loss 0.004074188880622387
epoch: 10 s: 768000 batch_loss 0.10574088990688324 BPR_loss 0.10183409601449966 reg_loss 0.003906795755028725
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 67.05797696113586 | 80.36337685585022 | 45.65174865722656 | [0.16475858 0.23317542 0.28141191] | [0.13797113 0.15964453 0.17405967] | [0.05074519 0.03620554 0.0293679 ] | [0.55117556 0.65697635 0.71518521] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.0999005064368248 BPR_loss 0.09576307982206345 reg_loss 0.004137424752116203
epoch: 11 s: 256000 batch_loss 0.10784100741147995 BPR_loss 0.10343357920646667 reg_loss 0.004407425876706839
epoch: 11 s: 512000 batch_loss 0.10922441631555557 BPR_loss 0.10493585467338562 reg_loss 0.004288562573492527
epoch: 11 s: 768000 batch_loss 0.09546144306659698 BPR_loss 0.09114445000886917 reg_loss 0.004316994454711676
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 66.21366167068481 | 74.00876784324646 | 42.285579681396484 | [0.16574171 0.23383108 0.28228375] | [0.13825321 0.1599122  0.17440624] | [0.05085069 0.03627671 0.02945498] | [0.55335254 0.65811508 0.7185344 ] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.112035371363163 BPR_loss 0.10778582841157913 reg_loss 0.004249542020261288
epoch: 12 s: 256000 batch_loss 0.09820561856031418 BPR_loss 0.09379317611455917 reg_loss 0.004412445705384016
epoch: 12 s: 512000 batch_loss 0.094260074198246 BPR_loss 0.08976137638092041 reg_loss 0.004498699679970741
epoch: 12 s: 768000 batch_loss 0.09899196028709412 BPR_loss 0.09432993829250336 reg_loss 0.00466202525421977
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 67.54519367218018 | 82.22035694122314 | 39.24053192138672 | [0.16627796 0.2348086  0.28345917] | [0.13884727 0.16067479 0.17520524] | [0.0509093  0.03641319 0.02953647] | [0.55368745 0.6596557  0.71913725] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.08168239891529083 BPR_loss 0.07701070606708527 reg_loss 0.004671693779528141
epoch: 13 s: 256000 batch_loss 0.08880779892206192 BPR_loss 0.08413417637348175 reg_loss 0.004673623479902744
epoch: 13 s: 512000 batch_loss 0.09375091642141342 BPR_loss 0.08900486677885056 reg_loss 0.004746051970869303
epoch: 13 s: 768000 batch_loss 0.10719381272792816 BPR_loss 0.10224463045597076 reg_loss 0.004949182737618685
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 66.11277627944946 | 67.83758068084717 | 36.43729782104492 | [0.16648293 0.23465773 0.28431162] | [0.13898189 0.16075471 0.17559229] | [0.05085404 0.03633867 0.02956438] | [0.55452475 0.65985665 0.7197401 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.07794279605150223 BPR_loss 0.07327897101640701 reg_loss 0.004663827363401651
epoch: 14 s: 256000 batch_loss 0.07929994910955429 BPR_loss 0.07457954436540604 reg_loss 0.004720407072454691
epoch: 14 s: 512000 batch_loss 0.08971419185400009 BPR_loss 0.08498416841030121 reg_loss 0.004730022046715021
epoch: 14 s: 768000 batch_loss 0.08021021634340286 BPR_loss 0.07516779005527496 reg_loss 0.0050424267537891865
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 67.07387924194336 | 79.3843641281128 | 34.02010726928711 | [0.16593578 0.23438184 0.28306999] | [0.13831936 0.16015137 0.17471717] | [0.05063635 0.03616954 0.02936399] | [0.55238127 0.65751222 0.71789805] |
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.0706123560667038 BPR_loss 0.06561381369829178 reg_loss 0.004998540040105581
epoch: 15 s: 256000 batch_loss 0.08495008945465088 BPR_loss 0.07980703562498093 reg_loss 0.005143057554960251
epoch: 15 s: 512000 batch_loss 0.08748495578765869 BPR_loss 0.08217205107212067 reg_loss 0.005312907509505749
epoch: 15 s: 768000 batch_loss 0.07688504457473755 BPR_loss 0.07171083986759186 reg_loss 0.005174207501113415
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 66.28679895401001 | 82.26364350318909 | 31.976564407348633 | [0.16600687 0.23406151 0.28297099] | [0.13806834 0.1598703  0.1745098 ] | [0.05035836 0.0360205  0.02928193] | [0.55204635 0.65717731 0.71880233] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.07404004782438278 BPR_loss 0.06871062517166138 reg_loss 0.005329421255737543
epoch: 16 s: 256000 batch_loss 0.09251165390014648 BPR_loss 0.08728618919849396 reg_loss 0.005225466564297676
epoch: 16 s: 512000 batch_loss 0.0871506780385971 BPR_loss 0.08182473480701447 reg_loss 0.005325940903276205
epoch: 16 s: 768000 batch_loss 0.06564030796289444 BPR_loss 0.060079801827669144 reg_loss 0.005560502875596285
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 65.6154158115387 | 75.36105632781982 | 29.94220542907715 | [0.16637582 0.23499339 0.28285881] | [0.13821676 0.16016315 0.17453328] | [0.05054257 0.03611595 0.02929254] | [0.55288365 0.65895237 0.71759662] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.07635873556137085 BPR_loss 0.07080742716789246 reg_loss 0.005551306530833244
epoch: 17 s: 256000 batch_loss 0.074358731508255 BPR_loss 0.06891898810863495 reg_loss 0.005439743399620056
epoch: 17 s: 512000 batch_loss 0.07897777855396271 BPR_loss 0.07319430261850357 reg_loss 0.005783476866781712
epoch: 17 s: 768000 batch_loss 0.07699886709451675 BPR_loss 0.07135139405727386 reg_loss 0.005647474899888039
+-------+------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 67.5418632030487 | 70.88559651374817 | 28.5133113861084 | [0.16640423 0.2352404  0.28426953] | [0.13843775 0.16052241 0.17519759] | [0.05032989 0.03605064 0.02928361] | [0.55197937 0.66042602 0.72121375] |
+-------+------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.06517521291971207 BPR_loss 0.059534523636102676 reg_loss 0.005640690214931965
epoch: 18 s: 256000 batch_loss 0.06223839148879051 BPR_loss 0.056409649550914764 reg_loss 0.005828740540891886
epoch: 18 s: 512000 batch_loss 0.06672980636358261 BPR_loss 0.06090529263019562 reg_loss 0.005824513267725706
epoch: 18 s: 768000 batch_loss 0.07062564045190811 BPR_loss 0.06444566696882248 reg_loss 0.006179973483085632
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 67.5667552947998 | 82.95198583602905 | 26.791152954101562 | [0.16651413 0.23491831 0.28364063] | [0.13783147 0.15985116 0.17441628] | [0.05012392 0.03591918 0.02914797] | [0.55221381 0.65938777 0.71860138] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.06294310837984085 BPR_loss 0.057032261043787 reg_loss 0.005910848267376423
epoch: 19 s: 256000 batch_loss 0.055516257882118225 BPR_loss 0.04937909170985222 reg_loss 0.006137165240943432
epoch: 19 s: 512000 batch_loss 0.06358543783426285 BPR_loss 0.057792890816926956 reg_loss 0.005792547017335892
epoch: 19 s: 768000 batch_loss 0.05549454316496849 BPR_loss 0.049525365233421326 reg_loss 0.005969178397208452
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 66.85285830497742 | 74.33510398864746 | 25.34834861755371 | [0.16656462 0.23425588 0.28319909] | [0.1373731  0.15916271 0.17376873] | [0.05012894 0.03584969 0.02908601] | [0.55080715 0.65754572 0.71588854] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.06605450809001923 BPR_loss 0.06009400635957718 reg_loss 0.005960502661764622
epoch: 20 s: 256000 batch_loss 0.05596662685275078 BPR_loss 0.0500226728618145 reg_loss 0.005943953525274992
epoch: 20 s: 512000 batch_loss 0.06653058528900146 BPR_loss 0.06009242311120033 reg_loss 0.006438163109123707
epoch: 20 s: 768000 batch_loss 0.05534594506025314 BPR_loss 0.04909621179103851 reg_loss 0.006249731872230768
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 67.26349139213562 | 79.46619033813477 | 24.088537216186523 | [0.16635009 0.2348302  0.28297703] | [0.13704076 0.1591131  0.17353224] | [0.04994809 0.03584466 0.02906033] | [0.55197937 0.65808159 0.71679282] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.05694251507520676 BPR_loss 0.051090627908706665 reg_loss 0.00585188576951623
epoch: 21 s: 256000 batch_loss 0.06406033784151077 BPR_loss 0.05791688337922096 reg_loss 0.006143452133983374
epoch: 21 s: 512000 batch_loss 0.051402974873781204 BPR_loss 0.04527143016457558 reg_loss 0.0061315433122217655
epoch: 21 s: 768000 batch_loss 0.04955071955919266 BPR_loss 0.043090421706438065 reg_loss 0.006460297852754593
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 65.35737800598145 | 75.75759816169739 | 22.937528610229492 | [0.16577521 0.23453244 0.283695  ] | [0.13664829 0.1588411  0.17353978] | [0.0497036  0.03576847 0.02907094] | [0.55067319 0.65875142 0.71896979] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.0520707331597805 BPR_loss 0.04571494087576866 reg_loss 0.006355790887027979
epoch: 22 s: 256000 batch_loss 0.0528792142868042 BPR_loss 0.04643845558166504 reg_loss 0.0064407577738165855
epoch: 22 s: 512000 batch_loss 0.04977140575647354 BPR_loss 0.04338391125202179 reg_loss 0.006387496367096901
epoch: 22 s: 768000 batch_loss 0.05353892222046852 BPR_loss 0.047092005610466 reg_loss 0.00644691614434123
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 66.88771986961365 | 81.02974820137024 | 21.905208587646484 | [0.16596318 0.23362102 0.28209245] | [0.13625848 0.15810065 0.17267031] | [0.04967513 0.03556919 0.02893474] | [0.55100811 0.65878492 0.71712774] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.057423945516347885 BPR_loss 0.050885021686553955 reg_loss 0.006538924295455217
epoch: 23 s: 256000 batch_loss 0.04871737211942673 BPR_loss 0.042188987135887146 reg_loss 0.006528385449200869
epoch: 23 s: 512000 batch_loss 0.05172627419233322 BPR_loss 0.04511953890323639 reg_loss 0.00660673389211297
epoch: 23 s: 768000 batch_loss 0.04832234978675842 BPR_loss 0.04164569079875946 reg_loss 0.0066766575910151005
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 66.88852381706238 | 73.07644701004028 | 21.08565902709961 | [0.16572298 0.23460571 0.28318711] | [0.13625341 0.15853099 0.17305425] | [0.04945576 0.03559599 0.02888673] | [0.5498024  0.65942126 0.71826646] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.05050809308886528 BPR_loss 0.04380828142166138 reg_loss 0.006699811667203903
epoch: 24 s: 256000 batch_loss 0.0467127189040184 BPR_loss 0.04025528207421303 reg_loss 0.006457436829805374
epoch: 24 s: 512000 batch_loss 0.05743875727057457 BPR_loss 0.05060790851712227 reg_loss 0.006830847822129726
epoch: 24 s: 768000 batch_loss 0.05077899992465973 BPR_loss 0.04393397271633148 reg_loss 0.00684502674266696
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 65.43078112602234 | 78.03271794319153 | 20.056041717529297 | [0.16541197 0.23352438 0.28201648] | [0.13564523 0.15767118 0.17219269] | [0.04925816 0.03535485 0.02871648] | [0.54876415 0.65747873 0.71612298] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.04931033402681351 BPR_loss 0.04245246201753616 reg_loss 0.006857873871922493
epoch: 25 s: 256000 batch_loss 0.05467601865530014 BPR_loss 0.04778149724006653 reg_loss 0.006894522346556187
epoch: 25 s: 512000 batch_loss 0.050739847123622894 BPR_loss 0.04395498335361481 reg_loss 0.0067848633043468
epoch: 25 s: 768000 batch_loss 0.05928577855229378 BPR_loss 0.052052564918994904 reg_loss 0.007233214098960161
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 67.76741743087769 | 76.8511130809784 | 19.479419708251953 | [0.16472054 0.23247318 0.28205164] | [0.13540829 0.15724437 0.17211975] | [0.04911916 0.0351204  0.02870532] | [0.54836225 0.65567017 0.71649139] |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.037496306002140045 BPR_loss 0.030551902949810028 reg_loss 0.006944403052330017
epoch: 26 s: 256000 batch_loss 0.04404032975435257 BPR_loss 0.03709596022963524 reg_loss 0.00694437138736248
epoch: 26 s: 512000 batch_loss 0.04356490820646286 BPR_loss 0.03668215125799179 reg_loss 0.006882756948471069
epoch: 26 s: 768000 batch_loss 0.041664447635412216 BPR_loss 0.034644342958927155 reg_loss 0.007020103745162487
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 65.7553858757019 | 78.81378316879272 | 18.659944534301758 | [0.16411591 0.23207272 0.28155511] | [0.13435959 0.15638264 0.17117136] | [0.0486754  0.03504086 0.02857581] | [0.54437672 0.65486637 0.71548664] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.042800553143024445 BPR_loss 0.035911060869693756 reg_loss 0.006889493204653263
epoch: 27 s: 256000 batch_loss 0.039616234600543976 BPR_loss 0.0325951874256134 reg_loss 0.0070210471749305725
epoch: 27 s: 512000 batch_loss 0.04699031263589859 BPR_loss 0.039729032665491104 reg_loss 0.007261278107762337
epoch: 27 s: 768000 batch_loss 0.049680858850479126 BPR_loss 0.04278358817100525 reg_loss 0.006897269282490015
+-------+--------------------+-----------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |  tesing time(s) |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-----------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 62.511025190353394 | 69.041184425354 | 17.913232803344727 | [0.163841   0.23126373 0.27966716] | [0.13430423 0.15613084 0.17064716] | [0.04850124 0.03479051 0.02834695] | [0.54246768 0.65215353 0.71217094] |
+-------+--------------------+-----------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 28 s: 0 batch_loss 0.04802930727601051 BPR_loss 0.04094067960977554 reg_loss 0.007088627200573683
epoch: 28 s: 256000 batch_loss 0.04662908986210823 BPR_loss 0.03926308453083038 reg_loss 0.007366006728261709
epoch: 28 s: 512000 batch_loss 0.04413323104381561 BPR_loss 0.03677448630332947 reg_loss 0.00735874380916357
epoch: 28 s: 768000 batch_loss 0.03629631549119949 BPR_loss 0.028928013518452644 reg_loss 0.007368303835391998
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   28  | 63.05776906013489 | 75.62516832351685 | 17.357248306274414 | [0.16458822 0.23281634 0.2810249 ] | [0.1351209  0.15718078 0.17165578] | [0.04877085 0.03504421 0.0285133 ] | [0.54655369 0.65700985 0.71722821] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 29 s: 0 batch_loss 0.0431881844997406 BPR_loss 0.0357624851167202 reg_loss 0.007425700314342976
epoch: 29 s: 256000 batch_loss 0.038296766579151154 BPR_loss 0.03097204491496086 reg_loss 0.0073247202672064304
epoch: 29 s: 512000 batch_loss 0.046945590525865555 BPR_loss 0.03957604616880417 reg_loss 0.007369543891400099
epoch: 29 s: 768000 batch_loss 0.03765393793582916 BPR_loss 0.030237283557653427 reg_loss 0.007416653446853161
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   29  | 61.64674162864685 | 72.41204452514648 | 16.906150817871094 | [0.16496874 0.23189195 0.28049784] | [0.1348612  0.15653823 0.17111972] | [0.04881606 0.03494206 0.0284826 ] | [0.54675464 0.65644048 0.71635743] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.16496873702453035
early stopping at 29, recall@20:0.1666
