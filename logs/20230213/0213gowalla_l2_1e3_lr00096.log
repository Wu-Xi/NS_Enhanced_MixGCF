Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='gowalla', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=3, l2=0.001, lr=0.0096, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931489706039429 BPR_loss 0.6931487321853638 reg_loss 2.4288399913530156e-07
epoch: 0 s: 256000 batch_loss 0.5630198121070862 BPR_loss 0.5475800037384033 reg_loss 0.015439795330166817
epoch: 0 s: 512000 batch_loss 0.5010232925415039 BPR_loss 0.4749033749103546 reg_loss 0.02611992321908474
epoch: 0 s: 768000 batch_loss 0.46802452206611633 BPR_loss 0.4360494613647461 reg_loss 0.03197506070137024
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 44.50523257255554 | 39.89818787574768 | 214.27296447753906 | [0.13256294 0.19076426 0.23323366] | [0.11125543 0.12951754 0.14211141] | [0.04233371 0.03060654 0.02500949] | [0.48536406 0.59253801 0.65252194] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.4845452904701233 BPR_loss 0.4517722427845001 reg_loss 0.03277305141091347
epoch: 1 s: 256000 batch_loss 0.43893396854400635 BPR_loss 0.399242103099823 reg_loss 0.039691850543022156
epoch: 1 s: 512000 batch_loss 0.42817801237106323 BPR_loss 0.3853621780872345 reg_loss 0.04281584545969963
epoch: 1 s: 768000 batch_loss 0.40605252981185913 BPR_loss 0.35760271549224854 reg_loss 0.04844980686903
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 46.18387532234192 | 41.8363618850708 | 175.77967834472656 | [0.14133814 0.20221448 0.2454149 ] | [0.11830893 0.13735825 0.15023842] | [0.04487407 0.03225015 0.02627771] | [0.50586108 0.61142742 0.668732  ] |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.420701265335083 BPR_loss 0.37270429730415344 reg_loss 0.04799697548151016
epoch: 2 s: 256000 batch_loss 0.427927166223526 BPR_loss 0.37681013345718384 reg_loss 0.05111704021692276
epoch: 2 s: 512000 batch_loss 0.38920947909355164 BPR_loss 0.33341819047927856 reg_loss 0.055791281163692474
epoch: 2 s: 768000 batch_loss 0.3843331038951874 BPR_loss 0.32545191049575806 reg_loss 0.05888119712471962
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 46.92729067802429 | 46.177196979522705 | 159.33999633789062 | [0.14850343 0.21079729 0.25559914] | [0.12418514 0.14368083 0.15701539] | [0.0470209  0.03363671 0.02736229] | [0.52254002 0.62606337 0.68370286] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.37941187620162964 BPR_loss 0.31916120648384094 reg_loss 0.0602506659924984
epoch: 3 s: 256000 batch_loss 0.38205525279045105 BPR_loss 0.3203926682472229 reg_loss 0.06166258454322815
epoch: 3 s: 512000 batch_loss 0.3667346239089966 BPR_loss 0.30213621258735657 reg_loss 0.06459842622280121
epoch: 3 s: 768000 batch_loss 0.36779773235321045 BPR_loss 0.3015587031841278 reg_loss 0.06623902916908264
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 47.165579080581665 | 46.62409281730652 | 148.2495574951172 | [0.15227153 0.2168815  0.26367855] | [0.12800521 0.14821551 0.16214615] | [0.0482668  0.03460882 0.02822806] | [0.53017617 0.63490522 0.69364994] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.35369160771369934 BPR_loss 0.28815317153930664 reg_loss 0.0655384287238121
epoch: 4 s: 256000 batch_loss 0.3495904505252838 BPR_loss 0.2810133099555969 reg_loss 0.06857713311910629
epoch: 4 s: 512000 batch_loss 0.3553171157836914 BPR_loss 0.2856699228286743 reg_loss 0.06964719295501709
epoch: 4 s: 768000 batch_loss 0.3577321469783783 BPR_loss 0.2856564223766327 reg_loss 0.07207571715116501
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 46.76938533782959 | 47.89642333984375 | 139.97544860839844 | [0.15661866 0.22118762 0.26848183] | [0.1316823  0.15193215 0.16599678] | [0.04942561 0.03530796 0.02871481] | [0.54149642 0.64177105 0.70162101] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.3384261727333069 BPR_loss 0.2662283182144165 reg_loss 0.07219784706830978
epoch: 5 s: 256000 batch_loss 0.34639009833335876 BPR_loss 0.27132347226142883 reg_loss 0.07506663352251053
epoch: 5 s: 512000 batch_loss 0.3374679684638977 BPR_loss 0.2604817748069763 reg_loss 0.07698620855808258
epoch: 5 s: 768000 batch_loss 0.3315586447715759 BPR_loss 0.2515455484390259 reg_loss 0.08001309633255005
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 46.122605323791504 | 49.92328381538391 | 133.71351623535156 | [0.15771905 0.22437312 0.27123242] | [0.13306279 0.15395235 0.16791569] | [0.04989785 0.03574586 0.02898721] | [0.54179784 0.6464934  0.70386496] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.32086244225502014 BPR_loss 0.24102279543876648 reg_loss 0.07983965426683426
epoch: 6 s: 256000 batch_loss 0.3024676442146301 BPR_loss 0.22262269258499146 reg_loss 0.07984494417905807
epoch: 6 s: 512000 batch_loss 0.3319268524646759 BPR_loss 0.25019657611846924 reg_loss 0.08173027634620667
epoch: 6 s: 768000 batch_loss 0.33278611302375793 BPR_loss 0.24894587695598602 reg_loss 0.08384022861719131
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 47.61656618118286 | 48.04427742958069 | 128.37120056152344 | [0.16107117 0.22766576 0.27589779] | [0.13551547 0.15638616 0.1707658 ] | [0.05072342 0.0362047  0.02942539] | [0.55084065 0.65118226 0.71073079] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.3341880440711975 BPR_loss 0.25161588191986084 reg_loss 0.08257216215133667
epoch: 7 s: 256000 batch_loss 0.32556629180908203 BPR_loss 0.2406141757965088 reg_loss 0.08495210856199265
epoch: 7 s: 512000 batch_loss 0.3188104033470154 BPR_loss 0.23225167393684387 reg_loss 0.08655871450901031
epoch: 7 s: 768000 batch_loss 0.3096216917037964 BPR_loss 0.2242664396762848 reg_loss 0.085355244576931
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 47.22210168838501 | 50.3198459148407 | 124.43038940429688 | [0.16283431 0.22984333 0.27797569] | [0.13715955 0.15817508 0.17250158] | [0.05124087 0.03650529 0.02961127] | [0.55335254 0.65456494 0.71163507] |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.3229176104068756 BPR_loss 0.23735684156417847 reg_loss 0.08556076139211655
epoch: 8 s: 256000 batch_loss 0.3078364133834839 BPR_loss 0.21952290832996368 reg_loss 0.0883135125041008
epoch: 8 s: 512000 batch_loss 0.28974711894989014 BPR_loss 0.2006005048751831 reg_loss 0.08914661407470703
epoch: 8 s: 768000 batch_loss 0.29568225145339966 BPR_loss 0.20632241666316986 reg_loss 0.0893598273396492
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 48.33670425415039 | 51.22316288948059 | 120.94396209716797 | [0.16492122 0.23212122 0.28051786] | [0.13893244 0.15997729 0.1743961 ] | [0.05186885 0.03685863 0.02990488] | [0.55703664 0.65694286 0.71464934] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.29888665676116943 BPR_loss 0.21046382188796997 reg_loss 0.08842283487319946
epoch: 9 s: 256000 batch_loss 0.2960355877876282 BPR_loss 0.20588502287864685 reg_loss 0.09015056490898132
epoch: 9 s: 512000 batch_loss 0.302793949842453 BPR_loss 0.21329382061958313 reg_loss 0.08950013667345047
epoch: 9 s: 768000 batch_loss 0.2878747582435608 BPR_loss 0.19403088092803955 reg_loss 0.09384387731552124
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 47.05234980583191 | 49.05261015892029 | 118.08399200439453 | [0.16604453 0.233664   0.28209894] | [0.13988467 0.16105934 0.17551521] | [0.05215855 0.03701269 0.03004276] | [0.55951504 0.66029205 0.71649139] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.30296266078948975 BPR_loss 0.2111644744873047 reg_loss 0.09179819375276566
epoch: 10 s: 256000 batch_loss 0.2805969715118408 BPR_loss 0.1877933144569397 reg_loss 0.09280365705490112
epoch: 10 s: 512000 batch_loss 0.2934807538986206 BPR_loss 0.19762492179870605 reg_loss 0.09585582464933395
epoch: 10 s: 768000 batch_loss 0.2841390371322632 BPR_loss 0.1897883117198944 reg_loss 0.09435071051120758
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 45.81344532966614 | 47.91315531730652 | 114.69483184814453 | [0.16642978 0.23442173 0.28355721] | [0.14013236 0.1615048  0.1761051 ] | [0.05223391 0.03719857 0.03013542] | [0.55914663 0.66179918 0.71819948] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.2784816026687622 BPR_loss 0.18371523916721344 reg_loss 0.09476636350154877
epoch: 11 s: 256000 batch_loss 0.288404643535614 BPR_loss 0.1928817331790924 reg_loss 0.09552290290594101
epoch: 11 s: 512000 batch_loss 0.28514114022254944 BPR_loss 0.19057050347328186 reg_loss 0.09457062929868698
epoch: 11 s: 768000 batch_loss 0.27886492013931274 BPR_loss 0.18342143297195435 reg_loss 0.09544350206851959
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 46.53054881095886 | 48.23343563079834 | 112.62494659423828 | [0.16792736 0.23681644 0.28597612] | [0.14212165 0.16375614 0.17837348] | [0.05273126 0.03755526 0.03039275] | [0.56269676 0.6650144  0.72148168] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.29058289527893066 BPR_loss 0.19449375569820404 reg_loss 0.09608915448188782
epoch: 12 s: 256000 batch_loss 0.2797776460647583 BPR_loss 0.18151956796646118 reg_loss 0.09825809299945831
epoch: 12 s: 512000 batch_loss 0.2766849994659424 BPR_loss 0.17961819469928741 reg_loss 0.09706681966781616
epoch: 12 s: 768000 batch_loss 0.28814756870269775 BPR_loss 0.1885104775428772 reg_loss 0.09963710606098175
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 47.23049879074097 | 47.690091371536255 | 110.54379272460938 | [0.16996225 0.23800352 0.28770701] | [0.14336077 0.16466841 0.1794939 ] | [0.0531767  0.03767583 0.03058644] | [0.56641436 0.66615312 0.72322326] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.26137375831604004 BPR_loss 0.16365741193294525 reg_loss 0.09771636128425598
epoch: 13 s: 256000 batch_loss 0.2670530676841736 BPR_loss 0.16831433773040771 reg_loss 0.09873874485492706
epoch: 13 s: 512000 batch_loss 0.2757905423641205 BPR_loss 0.17837589979171753 reg_loss 0.09741465002298355
epoch: 13 s: 768000 batch_loss 0.2947951555252075 BPR_loss 0.19603440165519714 reg_loss 0.09876076132059097
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 46.67961931228638 | 48.009012937545776 | 108.82596588134766 | [0.17009548 0.23896524 0.28829961] | [0.14353873 0.16511191 0.17981728] | [0.05322694 0.03776124 0.03059537] | [0.56604595 0.6683301  0.72382611] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.2596205472946167 BPR_loss 0.16147533059120178 reg_loss 0.09814520925283432
epoch: 14 s: 256000 batch_loss 0.27175119519233704 BPR_loss 0.1725756824016571 reg_loss 0.09917552024126053
epoch: 14 s: 512000 batch_loss 0.27281102538108826 BPR_loss 0.1731472611427307 reg_loss 0.09966377168893814
epoch: 14 s: 768000 batch_loss 0.2697451412677765 BPR_loss 0.16887468099594116 reg_loss 0.10087045282125473
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 46.846596240997314 | 48.89770531654358 | 107.19252014160156 | [0.17079457 0.23959153 0.28868726] | [0.14418402 0.16575639 0.18040842] | [0.05346641 0.03788013 0.03067575] | [0.56778753 0.66963628 0.72456293] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.25968480110168457 BPR_loss 0.15885314345359802 reg_loss 0.10083164274692535
epoch: 15 s: 256000 batch_loss 0.2741641402244568 BPR_loss 0.17535215616226196 reg_loss 0.09881198406219482
epoch: 15 s: 512000 batch_loss 0.2753903269767761 BPR_loss 0.1730833500623703 reg_loss 0.10230698436498642
epoch: 15 s: 768000 batch_loss 0.2610146999359131 BPR_loss 0.16055269539356232 reg_loss 0.10046201944351196
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 48.48455476760864 | 52.448017835617065 | 105.77757263183594 | [0.17175861 0.24069997 0.28976083] | [0.14464222 0.16629323 0.18089038] | [0.05365564 0.03804843 0.03073492] | [0.56969656 0.67054056 0.72640498] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.26244714856147766 BPR_loss 0.1602478325366974 reg_loss 0.10219930857419968
epoch: 16 s: 256000 batch_loss 0.27971649169921875 BPR_loss 0.17832982540130615 reg_loss 0.1013866513967514
epoch: 16 s: 512000 batch_loss 0.2747940123081207 BPR_loss 0.17435908317565918 reg_loss 0.10043492168188095
epoch: 16 s: 768000 batch_loss 0.2489541471004486 BPR_loss 0.14451149106025696 reg_loss 0.10444265604019165
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 48.32635474205017 | 52.099239349365234 | 104.41777038574219 | [0.17185477 0.24116652 0.29042639] | [0.14522076 0.16692952 0.18165735] | [0.05379295 0.03809867 0.03086833] | [0.56916069 0.67174627 0.72831402] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.2611974775791168 BPR_loss 0.15814214944839478 reg_loss 0.10305533558130264
epoch: 17 s: 256000 batch_loss 0.26597270369529724 BPR_loss 0.16374284029006958 reg_loss 0.10222986340522766
epoch: 17 s: 512000 batch_loss 0.2717248201370239 BPR_loss 0.1689753234386444 reg_loss 0.10274948179721832
epoch: 17 s: 768000 batch_loss 0.2686314284801483 BPR_loss 0.16579365730285645 reg_loss 0.10283776372671127
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 49.16633605957031 | 51.768009662628174 | 103.45855712890625 | [0.17279292 0.24134081 0.29104095] | [0.14569743 0.16719131 0.18204092] | [0.05393362 0.0380995  0.03089401] | [0.57086878 0.67224864 0.72861545] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.2612465023994446 BPR_loss 0.15802592039108276 reg_loss 0.10322059690952301
epoch: 18 s: 256000 batch_loss 0.2600722908973694 BPR_loss 0.15645115077495575 reg_loss 0.10362115502357483
epoch: 18 s: 512000 batch_loss 0.24917858839035034 BPR_loss 0.14510087668895721 reg_loss 0.10407771915197372
epoch: 18 s: 768000 batch_loss 0.25797605514526367 BPR_loss 0.15283772349357605 reg_loss 0.10513833165168762
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 48.89781212806702 | 52.381389141082764 | 102.23599243164062 | [0.17314942 0.2418491  0.29153289] | [0.14590527 0.16746809 0.18229567] | [0.05395874 0.03813886 0.03089122] | [0.57297877 0.67265055 0.72972068] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.25895214080810547 BPR_loss 0.1540679931640625 reg_loss 0.10488413274288177
epoch: 19 s: 256000 batch_loss 0.25058358907699585 BPR_loss 0.14595089852809906 reg_loss 0.10463270545005798
epoch: 19 s: 512000 batch_loss 0.24757501482963562 BPR_loss 0.14498132467269897 reg_loss 0.10259368270635605
epoch: 19 s: 768000 batch_loss 0.253028005361557 BPR_loss 0.1493743658065796 reg_loss 0.10365363210439682
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 49.861168384552  | 48.983835220336914 | 101.26963806152344 | [0.17354268 0.24273751 0.29355564] | [0.14657021 0.16827955 0.18338512] | [0.05419486 0.03833813 0.0310905 ] | [0.57301226 0.67382276 0.73199812] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.2590477764606476 BPR_loss 0.15466168522834778 reg_loss 0.10438608378171921
epoch: 20 s: 256000 batch_loss 0.25607308745384216 BPR_loss 0.15231890976428986 reg_loss 0.1037541851401329
epoch: 20 s: 512000 batch_loss 0.2565086781978607 BPR_loss 0.1508159041404724 reg_loss 0.10569276660680771
epoch: 20 s: 768000 batch_loss 0.24865113198757172 BPR_loss 0.14248764514923096 reg_loss 0.10616348683834076
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 49.57495045661926 | 48.80756378173828 | 100.37224578857422 | [0.17355946 0.24356893 0.29332422] | [0.14675962 0.16870358 0.18355102] | [0.0542116  0.03837079 0.03106091] | [0.57358162 0.67616719 0.73256749] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.2431299388408661 BPR_loss 0.1387799233198166 reg_loss 0.1043500080704689
epoch: 21 s: 256000 batch_loss 0.2604576051235199 BPR_loss 0.15567241609096527 reg_loss 0.10478519648313522
epoch: 21 s: 512000 batch_loss 0.25073757767677307 BPR_loss 0.1453455686569214 reg_loss 0.10539201647043228
epoch: 21 s: 768000 batch_loss 0.24980157613754272 BPR_loss 0.1433609426021576 reg_loss 0.10644064098596573
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 48.45745778083801 | 45.469277143478394 | 99.54129028320312 | [0.17281895 0.24244741 0.29348213] | [0.14609863 0.16796415 0.1831873 ] | [0.05389008 0.03813635 0.03101681] | [0.57070132 0.67412419 0.73216558] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.23022215068340302 BPR_loss 0.12363888323307037 reg_loss 0.10658326745033264
epoch: 22 s: 256000 batch_loss 0.24923931062221527 BPR_loss 0.14289289712905884 reg_loss 0.10634641349315643
epoch: 22 s: 512000 batch_loss 0.24313972890377045 BPR_loss 0.1371360719203949 reg_loss 0.10600365698337555
epoch: 22 s: 768000 batch_loss 0.2513260245323181 BPR_loss 0.14608368277549744 reg_loss 0.10524234920740128
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 48.42271304130554 | 41.12232947349548 | 98.62338256835938 | [0.17361798 0.24177755 0.29289229] | [0.14630342 0.16770828 0.18293283] | [0.0540994  0.03814053 0.03099114] | [0.57287829 0.67315292 0.73223257] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.2505260705947876 BPR_loss 0.14614436030387878 reg_loss 0.10438172519207001
epoch: 23 s: 256000 batch_loss 0.24587135016918182 BPR_loss 0.13929156959056854 reg_loss 0.10657978057861328
epoch: 23 s: 512000 batch_loss 0.24828584492206573 BPR_loss 0.14049872756004333 reg_loss 0.1077871173620224
epoch: 23 s: 768000 batch_loss 0.242928147315979 BPR_loss 0.135463684797287 reg_loss 0.10746445506811142
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 47.93259358406067 | 39.43745422363281 | 97.96001434326172 | [0.17322309 0.24274497 0.29344616] | [0.14665592 0.1684594  0.18355498] | [0.0541061  0.03825775 0.0310263 ] | [0.57267734 0.6744926  0.73327082] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.24259310960769653 BPR_loss 0.13586261868476868 reg_loss 0.10673049837350845
epoch: 24 s: 256000 batch_loss 0.23724250495433807 BPR_loss 0.13028444349765778 reg_loss 0.1069580614566803
epoch: 24 s: 512000 batch_loss 0.25897517800331116 BPR_loss 0.1521107405424118 reg_loss 0.10686443746089935
epoch: 24 s: 768000 batch_loss 0.24810051918029785 BPR_loss 0.14007678627967834 reg_loss 0.1080237329006195
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 46.32897591590881 | 42.83366513252258 | 97.19932556152344 | [0.17391564 0.24291127 0.29359554] | [0.14687834 0.16852367 0.1835987 ] | [0.05414629 0.03824771 0.03101346] | [0.57291178 0.67522942 0.73384018] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.24379469454288483 BPR_loss 0.13780540227890015 reg_loss 0.10598929226398468
epoch: 25 s: 256000 batch_loss 0.2481447458267212 BPR_loss 0.13987253606319427 reg_loss 0.10827220976352692
epoch: 25 s: 512000 batch_loss 0.24786975979804993 BPR_loss 0.14196863770484924 reg_loss 0.10590112954378128
epoch: 25 s: 768000 batch_loss 0.25430557131767273 BPR_loss 0.14617173373699188 reg_loss 0.10813383758068085
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 46.12313628196716 | 46.23725938796997 | 96.54383087158203 | [0.173127   0.24260079 0.29356135] | [0.14645576 0.16830623 0.1834066 ] | [0.05394869 0.03821924 0.03096881] | [0.57103624 0.67512894 0.73350526] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.22952419519424438 BPR_loss 0.12196390330791473 reg_loss 0.10756029188632965
epoch: 26 s: 256000 batch_loss 0.24582412838935852 BPR_loss 0.1373840719461441 reg_loss 0.10844005644321442
epoch: 26 s: 512000 batch_loss 0.24269947409629822 BPR_loss 0.13636872172355652 reg_loss 0.1063307523727417
epoch: 26 s: 768000 batch_loss 0.240473210811615 BPR_loss 0.13278548419475555 reg_loss 0.10768773406744003
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 45.71295428276062 | 52.092453956604004 | 96.07193756103516 | [0.1736578  0.24270627 0.29347581] | [0.14687893 0.16854507 0.18362864] | [0.05412452 0.03821086 0.0309649 ] | [0.57371559 0.67563132 0.73377319] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.24285036325454712 BPR_loss 0.1348569095134735 reg_loss 0.10799345374107361
epoch: 27 s: 256000 batch_loss 0.23087212443351746 BPR_loss 0.12465519458055496 reg_loss 0.1062169224023819
epoch: 27 s: 512000 batch_loss 0.23754754662513733 BPR_loss 0.13069561123847961 reg_loss 0.10685193538665771
epoch: 27 s: 768000 batch_loss 0.2467229962348938 BPR_loss 0.13924527168273926 reg_loss 0.10747772455215454
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 48.473222970962524 | 53.56805419921875 | 95.47227478027344 | [0.17354627 0.24305652 0.29311111] | [0.14701308 0.16878759 0.18368162] | [0.05417476 0.03829125 0.03097551] | [0.57210798 0.67556434 0.7325005 ] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 28 s: 0 batch_loss 0.24696588516235352 BPR_loss 0.1389702409505844 reg_loss 0.1079956516623497
epoch: 28 s: 256000 batch_loss 0.24043893814086914 BPR_loss 0.1323237270116806 reg_loss 0.10811520367860794
epoch: 28 s: 512000 batch_loss 0.23119376599788666 BPR_loss 0.12228888273239136 reg_loss 0.1089048832654953
epoch: 28 s: 768000 batch_loss 0.2276405692100525 BPR_loss 0.11845757067203522 reg_loss 0.10918300598859787
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   28  | 50.23656749725342 | 60.31456708908081 | 94.95329284667969 | [0.17349444 0.24342955 0.2938084 ] | [0.14724842 0.16916726 0.18415639] | [0.05421997 0.03836744 0.03106649] | [0.57207449 0.67546386 0.73400764] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 29 s: 0 batch_loss 0.23870690166950226 BPR_loss 0.1304333209991455 reg_loss 0.10827358067035675
epoch: 29 s: 256000 batch_loss 0.2349940538406372 BPR_loss 0.12615393102169037 reg_loss 0.10884012281894684
epoch: 29 s: 512000 batch_loss 0.24184265732765198 BPR_loss 0.133201003074646 reg_loss 0.10864164680242538
epoch: 29 s: 768000 batch_loss 0.23429760336875916 BPR_loss 0.12547366321086884 reg_loss 0.10882393270730972
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+---------------------------------+------------------------------------+
| Epoch |  training time(s)  |  tesing time(s)  |        Loss       |               recall               |                ndcg                |            precision            |             hit_ratio              |
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+---------------------------------+------------------------------------+
|   29  | 50.871500730514526 | 56.2985360622406 | 94.47579956054688 | [0.17325653 0.24355503 0.29344046] | [0.14667364 0.16877966 0.18363535] | [0.054014  0.0383306 0.031009 ] | [0.57180655 0.67620068 0.73306986] |
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+---------------------------------+------------------------------------+
epoch: 30 s: 0 batch_loss 0.23698699474334717 BPR_loss 0.127664715051651 reg_loss 0.10932227224111557
epoch: 30 s: 256000 batch_loss 0.2367490530014038 BPR_loss 0.12719985842704773 reg_loss 0.10954920202493668
epoch: 30 s: 512000 batch_loss 0.24314510822296143 BPR_loss 0.13215993344783783 reg_loss 0.110985167324543
epoch: 30 s: 768000 batch_loss 0.24362005293369293 BPR_loss 0.13308405876159668 reg_loss 0.11053599417209625
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   30  | 51.17954158782959 | 61.807032346725464 | 93.88311767578125 | [0.17322615 0.24318541 0.29300564] | [0.146682   0.16877883 0.18361041] | [0.05374104 0.03822259 0.03089513] | [0.57173957 0.67579878 0.73263447] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 31 s: 0 batch_loss 0.22821083664894104 BPR_loss 0.12113551795482635 reg_loss 0.10707531124353409
epoch: 31 s: 256000 batch_loss 0.23455263674259186 BPR_loss 0.1262574940919876 reg_loss 0.10829514265060425
epoch: 31 s: 512000 batch_loss 0.24608103930950165 BPR_loss 0.13535547256469727 reg_loss 0.11072556674480438
epoch: 31 s: 768000 batch_loss 0.2375531941652298 BPR_loss 0.12722498178482056 reg_loss 0.11032821238040924
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   31  | 51.15853977203369 | 61.42176151275635 | 93.79138946533203 | [0.17331976 0.2435126  0.29334997] | [0.14685873 0.16891413 0.1837357 ] | [0.05394199 0.0382544  0.03091634] | [0.57187353 0.67462657 0.73317034] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 32 s: 0 batch_loss 0.24355916678905487 BPR_loss 0.13395676016807556 reg_loss 0.10960240662097931
epoch: 32 s: 256000 batch_loss 0.23277921974658966 BPR_loss 0.12318006157875061 reg_loss 0.10959915816783905
epoch: 32 s: 512000 batch_loss 0.2394188940525055 BPR_loss 0.12972117960453033 reg_loss 0.10969771444797516
epoch: 32 s: 768000 batch_loss 0.2348095327615738 BPR_loss 0.1263962835073471 reg_loss 0.10841324925422668
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |  tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   32  | 51.834123611450195 | 63.5030779838562 | 92.97391510009766 | [0.17275653 0.24364287 0.2931293 ] | [0.14643775 0.16870346 0.18344546] | [0.05378458 0.03823347 0.0308901 ] | [0.57140465 0.67563132 0.7325005 ] |
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 33 s: 0 batch_loss 0.2304864525794983 BPR_loss 0.12012740969657898 reg_loss 0.11035904288291931
epoch: 33 s: 256000 batch_loss 0.22349274158477783 BPR_loss 0.11268579959869385 reg_loss 0.11080693453550339
epoch: 33 s: 512000 batch_loss 0.22817102074623108 BPR_loss 0.11872784793376923 reg_loss 0.10944318026304245
epoch: 33 s: 768000 batch_loss 0.22955554723739624 BPR_loss 0.11948023736476898 reg_loss 0.11007530987262726
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   33  | 52.07210373878479 | 60.7850387096405 | 92.62621307373047 | [0.1728351  0.2429425  0.29321102] | [0.14608064 0.1681554  0.18310902] | [0.0537176  0.03816146 0.03090406] | [0.57133766 0.67445911 0.73384018] |
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 34 s: 0 batch_loss 0.23386940360069275 BPR_loss 0.12383297830820084 reg_loss 0.11003643274307251
epoch: 34 s: 256000 batch_loss 0.23559993505477905 BPR_loss 0.12475317716598511 reg_loss 0.11084675788879395
epoch: 34 s: 512000 batch_loss 0.23093292117118835 BPR_loss 0.12182997912168503 reg_loss 0.10910294204950333
epoch: 34 s: 768000 batch_loss 0.23334434628486633 BPR_loss 0.12420245260000229 reg_loss 0.10914189368486404
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   34  | 51.54315447807312 | 63.5572624206543 | 92.23474884033203 | [0.1725958  0.24353654 0.29301788] | [0.14608633 0.16841983 0.18314466] | [0.05366401 0.03825105 0.03089624] | [0.57029942 0.67532989 0.73357224] |
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.17259580126941995
early stopping at 34, recall@20:0.1739
