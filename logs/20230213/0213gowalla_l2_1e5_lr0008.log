Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='gowalla', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=3, l2=1e-05, lr=0.008, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931487321853638 BPR_loss 0.6931487321853638 reg_loss 2.4288397959537633e-09
epoch: 0 s: 256000 batch_loss 0.5567175149917603 BPR_loss 0.55655837059021 reg_loss 0.00015912094386294484
epoch: 0 s: 512000 batch_loss 0.48007217049598694 BPR_loss 0.47975245118141174 reg_loss 0.00031970819691196084
epoch: 0 s: 768000 batch_loss 0.43826884031295776 BPR_loss 0.43783146142959595 reg_loss 0.00043739081593230367
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 56.211328983306885 | 68.14786434173584 | 208.891357421875 | [0.13181024 0.18948213 0.23095503] | [0.11092447 0.12902957 0.14136482] | [0.04193349 0.03029171 0.02473095] | [0.48335454 0.59056199 0.65064639] |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.45467856526374817 BPR_loss 0.4542243480682373 reg_loss 0.00045421087997965515
epoch: 1 s: 256000 batch_loss 0.39687174558639526 BPR_loss 0.3962801396846771 reg_loss 0.0005916148074902594
epoch: 1 s: 512000 batch_loss 0.37658247351646423 BPR_loss 0.37587404251098633 reg_loss 0.000708419072907418
epoch: 1 s: 768000 batch_loss 0.344485878944397 BPR_loss 0.3436344265937805 reg_loss 0.0008514384389854968
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 55.03029775619507 | 52.21268892288208 | 157.7657012939453 | [0.14113877 0.20117134 0.2444528 ] | [0.11850798 0.13727999 0.15015414] | [0.04467814 0.03198054 0.02607341] | [0.50445442 0.61102552 0.67054056] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.3621264696121216 BPR_loss 0.36128735542297363 reg_loss 0.0008391104056499898
epoch: 2 s: 256000 batch_loss 0.3652658462524414 BPR_loss 0.3643462657928467 reg_loss 0.0009195736492983997
epoch: 2 s: 512000 batch_loss 0.31870386004447937 BPR_loss 0.3176366090774536 reg_loss 0.0010672368807718158
epoch: 2 s: 768000 batch_loss 0.30083167552948 BPR_loss 0.2996278405189514 reg_loss 0.0012038241839036345
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 67.7982394695282 | 90.92296886444092 | 131.83924865722656 | [0.14789726 0.20936246 0.25399887] | [0.12406795 0.14335106 0.15664509] | [0.04655536 0.03324821 0.0270631 ] | [0.52036305 0.62422131 0.68196128] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.300626277923584 BPR_loss 0.29937979578971863 reg_loss 0.0012464732863008976
epoch: 3 s: 256000 batch_loss 0.29733994603157043 BPR_loss 0.29602310061454773 reg_loss 0.0013168547302484512
epoch: 3 s: 512000 batch_loss 0.26990142464637756 BPR_loss 0.26844823360443115 reg_loss 0.0014531872002407908
epoch: 3 s: 768000 batch_loss 0.2677682042121887 BPR_loss 0.26620668172836304 reg_loss 0.0015615292359143496
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 68.4055187702179 | 82.44988203048706 | 112.50286865234375 | [0.15255305 0.2152332  0.26058684] | [0.12826053 0.14792125 0.16147385] | [0.04788834 0.03411481 0.02776029] | [0.53034363 0.63306317 0.69060218] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.2580549418926239 BPR_loss 0.25655779242515564 reg_loss 0.0014971441123634577
epoch: 4 s: 256000 batch_loss 0.24503056704998016 BPR_loss 0.24339179694652557 reg_loss 0.0016387684736400843
epoch: 4 s: 512000 batch_loss 0.24711671471595764 BPR_loss 0.24539560079574585 reg_loss 0.0017211142694577575
epoch: 4 s: 768000 batch_loss 0.24352020025253296 BPR_loss 0.24162808060646057 reg_loss 0.0018921184819191694
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 66.62442803382874 | 68.19215750694275 | 97.29740905761719 | [0.15586683 0.21938659 0.26511853] | [0.13139694 0.15128038 0.16497081] | [0.04891486 0.03472771 0.02822806] | [0.53871659 0.63892424 0.69797039] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.22761167585849762 BPR_loss 0.2257697433233261 reg_loss 0.0018419296247884631
epoch: 5 s: 256000 batch_loss 0.22782695293426514 BPR_loss 0.2258254587650299 reg_loss 0.00200148718431592
epoch: 5 s: 512000 batch_loss 0.220136359333992 BPR_loss 0.2180139720439911 reg_loss 0.0021223891526460648
epoch: 5 s: 768000 batch_loss 0.1992388367652893 BPR_loss 0.19698309898376465 reg_loss 0.0022557342890650034
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 65.03532028198242 | 81.20809483528137 | 85.77577209472656 | [0.15787165 0.22280663 0.26897574] | [0.13269946 0.15306331 0.16686736] | [0.0493737  0.03515138 0.0285239 ] | [0.54005627 0.64314422 0.70255878] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.19243375957012177 BPR_loss 0.19014006853103638 reg_loss 0.002293684519827366
epoch: 6 s: 256000 batch_loss 0.17034946382045746 BPR_loss 0.16806043684482574 reg_loss 0.0022890286054462194
epoch: 6 s: 512000 batch_loss 0.2047504186630249 BPR_loss 0.20224326848983765 reg_loss 0.0025071504060178995
epoch: 6 s: 768000 batch_loss 0.19066527485847473 BPR_loss 0.18810302019119263 reg_loss 0.002562255132943392
+-------+-------------------+------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 65.35296726226807 | 82.7535171508789 | 76.1893081665039 | [0.16020199 0.22614987 0.27229064] | [0.13512286 0.15579476 0.16958925] | [0.05013229 0.03564288 0.02884766] | [0.54615179 0.64950767 0.70718066] |
+-------+-------------------+------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.2025708556175232 BPR_loss 0.20001816749572754 reg_loss 0.002552683698013425
epoch: 7 s: 256000 batch_loss 0.17434704303741455 BPR_loss 0.17173868417739868 reg_loss 0.0026083653792738914
epoch: 7 s: 512000 batch_loss 0.17841728031635284 BPR_loss 0.17555668950080872 reg_loss 0.0028605887200683355
epoch: 7 s: 768000 batch_loss 0.16793684661388397 BPR_loss 0.1650896668434143 reg_loss 0.0028471797704696655
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 66.71867847442627 | 77.58345079421997 | 68.7486801147461 | [0.16154529 0.2278373  0.27492511] | [0.13594669 0.15677383 0.17084929] | [0.05031315 0.03574838 0.02900116] | [0.54712305 0.65024449 0.70919017] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.17245326936244965 BPR_loss 0.16960009932518005 reg_loss 0.002853173529729247
epoch: 8 s: 256000 batch_loss 0.16979284584522247 BPR_loss 0.16683706641197205 reg_loss 0.0029557805974036455
epoch: 8 s: 512000 batch_loss 0.14714358747005463 BPR_loss 0.14401915669441223 reg_loss 0.0031244270503520966
epoch: 8 s: 768000 batch_loss 0.14260970056056976 BPR_loss 0.13948480784893036 reg_loss 0.003124887589365244
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 65.57021164894104 | 76.15677618980408 | 62.46257400512695 | [0.16288455 0.22930335 0.27632043] | [0.13692339 0.15782166 0.17187569] | [0.05060788 0.03594347 0.0291301 ] | [0.54923304 0.65084734 0.71130015] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.1512095034122467 BPR_loss 0.14812567830085754 reg_loss 0.003083824412897229
epoch: 9 s: 256000 batch_loss 0.1511140614748001 BPR_loss 0.14795474708080292 reg_loss 0.0031593081075698137
epoch: 9 s: 512000 batch_loss 0.1475495994091034 BPR_loss 0.14428198337554932 reg_loss 0.0032676171977072954
epoch: 9 s: 768000 batch_loss 0.12293839454650879 BPR_loss 0.11952376365661621 reg_loss 0.003414634382352233
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 66.10199093818665 | 75.60990452766418 | 57.111507415771484 | [0.16379655 0.23084588 0.27825917] | [0.13777016 0.15893765 0.17310125] | [0.05077199 0.03610506 0.02924454] | [0.55114207 0.65546922 0.71431442] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.1445346176624298 BPR_loss 0.1411510854959488 reg_loss 0.0033835358917713165
epoch: 10 s: 256000 batch_loss 0.11694423109292984 BPR_loss 0.11357767134904861 reg_loss 0.0033665599767118692
epoch: 10 s: 512000 batch_loss 0.12125638127326965 BPR_loss 0.11759952455759048 reg_loss 0.0036568602081388235
epoch: 10 s: 768000 batch_loss 0.1196276843547821 BPR_loss 0.1161121129989624 reg_loss 0.003515572054311633
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 64.72647166252136 | 78.95261025428772 | 51.70671844482422 | [0.1642715  0.23196811 0.27973129] | [0.13804706 0.15941484 0.17369425] | [0.05078036 0.03611511 0.02928138] | [0.55221381 0.65520129 0.71404649] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.11698690801858902 BPR_loss 0.11326821148395538 reg_loss 0.00371869676746428
epoch: 11 s: 256000 batch_loss 0.12037622928619385 BPR_loss 0.11640200763940811 reg_loss 0.003974220249801874
epoch: 11 s: 512000 batch_loss 0.11912581324577332 BPR_loss 0.11525432020425797 reg_loss 0.003871495835483074
epoch: 11 s: 768000 batch_loss 0.11017803847789764 BPR_loss 0.10628920793533325 reg_loss 0.0038888324052095413
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 64.80329489707947 | 77.03523397445679 | 47.98705291748047 | [0.16497637 0.23199244 0.2798592 ] | [0.13844923 0.15968194 0.17397378] | [0.05085572 0.03614777 0.02929589] | [0.55194588 0.65577065 0.71384554] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.12303582578897476 BPR_loss 0.11920996755361557 reg_loss 0.003825861494988203
epoch: 12 s: 256000 batch_loss 0.11080611497163773 BPR_loss 0.10680975019931793 reg_loss 0.003996363375335932
epoch: 12 s: 512000 batch_loss 0.10538159310817719 BPR_loss 0.10130809992551804 reg_loss 0.0040734936483204365
epoch: 12 s: 768000 batch_loss 0.11186002939939499 BPR_loss 0.10763300955295563 reg_loss 0.004227017052471638
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 68.32897806167603 | 81.13828802108765 | 44.61550521850586 | [0.16588214 0.23322397 0.28200099] | [0.13914351 0.16043459 0.17498555] | [0.05104495 0.03621308 0.02940362] | [0.55288365 0.65690937 0.71752964] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.09288030862808228 BPR_loss 0.08865103125572205 reg_loss 0.0042292773723602295
epoch: 13 s: 256000 batch_loss 0.1008211225271225 BPR_loss 0.09658639132976532 reg_loss 0.004234732128679752
epoch: 13 s: 512000 batch_loss 0.1064683124423027 BPR_loss 0.10215587913990021 reg_loss 0.004312434233725071
epoch: 13 s: 768000 batch_loss 0.1214723289012909 BPR_loss 0.11696335673332214 reg_loss 0.0045089698396623135
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 65.10186457633972 | 83.03402495384216 | 41.43060302734375 | [0.16654565 0.23452561 0.28342113] | [0.13980832 0.1614175  0.17603538] | [0.05112533 0.03645087 0.02958615] | [0.5551276  0.6596557  0.71927122] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.08874993771314621 BPR_loss 0.08451025933027267 reg_loss 0.004239681176841259
epoch: 14 s: 256000 batch_loss 0.09431807696819305 BPR_loss 0.09003625810146332 reg_loss 0.004281821195036173
epoch: 14 s: 512000 batch_loss 0.09810996055603027 BPR_loss 0.09380818903446198 reg_loss 0.004301771521568298
epoch: 14 s: 768000 batch_loss 0.09432864934206009 BPR_loss 0.08973483741283417 reg_loss 0.004593809600919485
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 66.69918298721313 | 72.89163494110107 | 38.70366287231445 | [0.16566644 0.23344121 0.28252581] | [0.1382492  0.15985881 0.17451791] | [0.05068993 0.03614274 0.02937069] | [0.55231429 0.65580414 0.71863487] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.08342573046684265 BPR_loss 0.07885711640119553 reg_loss 0.0045686159282922745
epoch: 15 s: 256000 batch_loss 0.0944262370467186 BPR_loss 0.08973678946495056 reg_loss 0.004689448047429323
epoch: 15 s: 512000 batch_loss 0.09793414175510406 BPR_loss 0.09309327602386475 reg_loss 0.004840867593884468
epoch: 15 s: 768000 batch_loss 0.08951098471879959 BPR_loss 0.08479618281126022 reg_loss 0.004714801907539368
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 65.57535576820374 | 74.73846864700317 | 36.35057830810547 | [0.16617949 0.23418914 0.28289563] | [0.13891027 0.1605745  0.17514087] | [0.05073347 0.03614442 0.02935059] | [0.55204635 0.65824905 0.71984058] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.08344455808401108 BPR_loss 0.07856440544128418 reg_loss 0.004880153574049473
epoch: 16 s: 256000 batch_loss 0.10449457913637161 BPR_loss 0.09972632676362991 reg_loss 0.004768249578773975
epoch: 16 s: 512000 batch_loss 0.0962979644536972 BPR_loss 0.09143109619617462 reg_loss 0.004866869188845158
epoch: 16 s: 768000 batch_loss 0.07284723967313766 BPR_loss 0.06773797422647476 reg_loss 0.005109267774969339
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 64.15740537643433 | 83.01023173332214 | 34.15580368041992 | [0.16659762 0.23404964 0.28234686] | [0.13903709 0.16053079 0.17495915] | [0.0508038  0.03612432 0.02927635] | [0.55318508 0.65700985 0.71776408] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.08457665145397186 BPR_loss 0.07949326187372208 reg_loss 0.00508338725194335
epoch: 17 s: 256000 batch_loss 0.08259988576173782 BPR_loss 0.07762104272842407 reg_loss 0.004978841636329889
epoch: 17 s: 512000 batch_loss 0.09127950668334961 BPR_loss 0.08594490587711334 reg_loss 0.005334598943591118
epoch: 17 s: 768000 batch_loss 0.09045969694852829 BPR_loss 0.08528108149766922 reg_loss 0.00517861545085907
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 65.41524362564087 | 79.05076217651367 | 32.47804260253906 | [0.16673566 0.23490844 0.28343901] | [0.13897452 0.16082091 0.17530425] | [0.05053922 0.0361059  0.02925905] | [0.55154397 0.65878492 0.7193382 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.07693470269441605 BPR_loss 0.07173894345760345 reg_loss 0.00519575783982873
epoch: 18 s: 256000 batch_loss 0.07331448048353195 BPR_loss 0.06794484704732895 reg_loss 0.005369631107896566
epoch: 18 s: 512000 batch_loss 0.07169333100318909 BPR_loss 0.06631403416395187 reg_loss 0.005379300564527512
epoch: 18 s: 768000 batch_loss 0.07729407399892807 BPR_loss 0.07161024212837219 reg_loss 0.005683834198862314
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 66.24108123779297 | 80.60696530342102 | 30.60540008544922 | [0.16696425 0.23527862 0.28351819] | [0.13880574 0.16068022 0.17511633] | [0.0505141  0.03605064 0.02922221] | [0.55191239 0.65861746 0.71920423] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.07327769696712494 BPR_loss 0.06782475858926773 reg_loss 0.005452936980873346
epoch: 19 s: 256000 batch_loss 0.06468900293111801 BPR_loss 0.059039466083049774 reg_loss 0.005649535451084375
epoch: 19 s: 512000 batch_loss 0.06908411532640457 BPR_loss 0.06374149769544601 reg_loss 0.005342616233974695
epoch: 19 s: 768000 batch_loss 0.06453379988670349 BPR_loss 0.05902679264545441 reg_loss 0.005507006775587797
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 66.73376250267029 | 80.79291439056396 | 28.94386863708496 | [0.16691877 0.23478265 0.28367046] | [0.1385474  0.16032782 0.17489058] | [0.05048898 0.03605734 0.02922835] | [0.55090763 0.65670842 0.71900328] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.07139293849468231 BPR_loss 0.06586529314517975 reg_loss 0.005527646746486425
epoch: 20 s: 256000 batch_loss 0.0679977610707283 BPR_loss 0.06253626197576523 reg_loss 0.00546150142326951
epoch: 20 s: 512000 batch_loss 0.07578393816947937 BPR_loss 0.06982450187206268 reg_loss 0.005959437228739262
epoch: 20 s: 768000 batch_loss 0.058403149247169495 BPR_loss 0.05261668562889099 reg_loss 0.0057864622212946415
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 65.64277672767639 | 74.22371673583984 | 27.462142944335938 | [0.16685728 0.23487738 0.28334982] | [0.13846028 0.16024715 0.17475597] | [0.05041865 0.03595937 0.02918202] | [0.55221381 0.65868444 0.71833344] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.06185039505362511 BPR_loss 0.05643855035305023 reg_loss 0.0054118456318974495
epoch: 21 s: 256000 batch_loss 0.0746162161231041 BPR_loss 0.06888649612665176 reg_loss 0.005729720462113619
epoch: 21 s: 512000 batch_loss 0.06571749597787857 BPR_loss 0.06003361940383911 reg_loss 0.005683876108378172
epoch: 21 s: 768000 batch_loss 0.06241802126169205 BPR_loss 0.05641231685876846 reg_loss 0.006005703471601009
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 67.46213841438293 | 79.76915264129639 | 26.143064498901367 | [0.16670791 0.23458659 0.28278161] | [0.13799554 0.15978822 0.1742343 ] | [0.05023444 0.03588569 0.02910052] | [0.55157747 0.65727778 0.71739567] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.05478978902101517 BPR_loss 0.048889271914958954 reg_loss 0.005900518037378788
epoch: 22 s: 256000 batch_loss 0.059986766427755356 BPR_loss 0.054015155881643295 reg_loss 0.0059716119430959225
epoch: 22 s: 512000 batch_loss 0.05640479177236557 BPR_loss 0.05047820508480072 reg_loss 0.005926588084548712
epoch: 22 s: 768000 batch_loss 0.06944174319505692 BPR_loss 0.06344179809093475 reg_loss 0.005999948363751173
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 65.83030486106873 | 75.27075862884521 | 25.024925231933594 | [0.16689451 0.23490193 0.2840501 ] | [0.13817017 0.16008274 0.1747685 ] | [0.05032989 0.0360004  0.02923728] | [0.55452475 0.66029205 0.71997455] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.06296884268522263 BPR_loss 0.05686723440885544 reg_loss 0.006101611070334911
epoch: 23 s: 256000 batch_loss 0.050918035209178925 BPR_loss 0.04483048617839813 reg_loss 0.0060875494964420795
epoch: 23 s: 512000 batch_loss 0.060702912509441376 BPR_loss 0.054539475589990616 reg_loss 0.006163438782095909
epoch: 23 s: 768000 batch_loss 0.057873256504535675 BPR_loss 0.051664337515830994 reg_loss 0.006208918988704681
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 64.59959053993225 | 80.27141404151917 | 23.89908790588379 | [0.16697464 0.23525502 0.28341793] | [0.13830026 0.16020864 0.17464945] | [0.05016913 0.03581452 0.029038  ] | [0.5530846  0.66086141 0.71984058] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.06021452695131302 BPR_loss 0.05394195392727852 reg_loss 0.006272574421018362
epoch: 24 s: 256000 batch_loss 0.051970791071653366 BPR_loss 0.04595436155796051 reg_loss 0.006016428116708994
epoch: 24 s: 512000 batch_loss 0.06147797033190727 BPR_loss 0.05508333072066307 reg_loss 0.006394638679921627
epoch: 24 s: 768000 batch_loss 0.056258391588926315 BPR_loss 0.04985892027616501 reg_loss 0.006399472709745169
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 65.97180271148682 | 83.35493493080139 | 22.766620635986328 | [0.16672175 0.2350851  0.28390675] | [0.13795977 0.15992085 0.17448316] | [0.05012392 0.03582206 0.02903409] | [0.55187889 0.65838301 0.71880233] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.059523869305849075 BPR_loss 0.05310967564582825 reg_loss 0.006414194591343403
epoch: 25 s: 256000 batch_loss 0.05749210715293884 BPR_loss 0.051010679453611374 reg_loss 0.00648142583668232
epoch: 25 s: 512000 batch_loss 0.059982676059007645 BPR_loss 0.053616974502801895 reg_loss 0.006365700624883175
epoch: 25 s: 768000 batch_loss 0.06304914504289627 BPR_loss 0.05624143406748772 reg_loss 0.0068077086471021175
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 66.96568179130554 | 74.47782325744629 | 22.002227783203125 | [0.16644458 0.23434935 0.28283205] | [0.1371093  0.15897422 0.17348755] | [0.04989785 0.03563618 0.02893418] | [0.5526827  0.65881841 0.71786456] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.04420313984155655 BPR_loss 0.03769746422767639 reg_loss 0.006505674682557583
epoch: 26 s: 256000 batch_loss 0.0509524941444397 BPR_loss 0.04439794644713402 reg_loss 0.0065545495599508286
epoch: 26 s: 512000 batch_loss 0.04785965383052826 BPR_loss 0.04139489680528641 reg_loss 0.006464757025241852
epoch: 26 s: 768000 batch_loss 0.04328377917408943 BPR_loss 0.03668802231550217 reg_loss 0.00659575778990984
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 66.26282453536987 | 76.8230791091919 | 21.232309341430664 | [0.1660389  0.23361824 0.28237643] | [0.1363482  0.15812816 0.17272213] | [0.04954786 0.03542099 0.02880802] | [0.54883113 0.65573716 0.71662536] |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.05410411208868027 BPR_loss 0.0476757176220417 reg_loss 0.006428392603993416
epoch: 27 s: 256000 batch_loss 0.046406351029872894 BPR_loss 0.0398482009768486 reg_loss 0.006558151915669441
epoch: 27 s: 512000 batch_loss 0.053270500153303146 BPR_loss 0.046464286744594574 reg_loss 0.006806212477385998
epoch: 27 s: 768000 batch_loss 0.05743773281574249 BPR_loss 0.05095613747835159 reg_loss 0.006481596734374762
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 61.59952473640442 | 68.54270315170288 | 20.377914428710938 | [0.16548741 0.23385243 0.28230837] | [0.13642777 0.15844431 0.17294823] | [0.04948088 0.03542853 0.028779  ] | [0.54702257 0.65623953 0.71696028] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 28 s: 0 batch_loss 0.058553025126457214 BPR_loss 0.05187297984957695 reg_loss 0.00668004434555769
epoch: 28 s: 256000 batch_loss 0.051084283739328384 BPR_loss 0.04414717108011246 reg_loss 0.006937112659215927
epoch: 28 s: 512000 batch_loss 0.042700886726379395 BPR_loss 0.03578389063477516 reg_loss 0.006916996091604233
epoch: 28 s: 768000 batch_loss 0.04191156476736069 BPR_loss 0.03496623784303665 reg_loss 0.006945326924324036
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   28  | 61.19959473609924 | 60.05910539627075 | 19.708633422851562 | [0.16653741 0.23382939 0.28195788] | [0.13674564 0.15842553 0.17286958] | [0.04965001 0.03541346 0.02876058] | [0.54963494 0.65731127 0.71635743] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 29 s: 0 batch_loss 0.04793611913919449 BPR_loss 0.04092700034379959 reg_loss 0.007009119726717472
epoch: 29 s: 256000 batch_loss 0.042649585753679276 BPR_loss 0.035724103450775146 reg_loss 0.006925480905920267
epoch: 29 s: 512000 batch_loss 0.052898719906806946 BPR_loss 0.045926593244075775 reg_loss 0.006972126197069883
epoch: 29 s: 768000 batch_loss 0.041388340294361115 BPR_loss 0.034395068883895874 reg_loss 0.006993269547820091
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   29  | 61.153173208236694 | 72.80309391021729 | 19.047466278076172 | [0.16685569 0.23431192 0.28291846] | [0.13697023 0.15875482 0.17334653] | [0.04974546 0.03553068 0.02889789] | [0.55120906 0.65865095 0.72020899] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 30 s: 0 batch_loss 0.04880743846297264 BPR_loss 0.04175160452723503 reg_loss 0.007055832538753748
epoch: 30 s: 256000 batch_loss 0.04457731544971466 BPR_loss 0.037251658737659454 reg_loss 0.007325655780732632
epoch: 30 s: 512000 batch_loss 0.04672180861234665 BPR_loss 0.03938969224691391 reg_loss 0.00733211450278759
epoch: 30 s: 768000 batch_loss 0.05315114185214043 BPR_loss 0.0460992194712162 reg_loss 0.007051920983940363
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   30  | 57.86406683921814 | 64.22326469421387 | 18.38611602783203 | [0.16587478 0.23395497 0.28166258] | [0.13622085 0.15820569 0.17257481] | [0.04932681 0.03537662 0.02874327] | [0.5481613  0.65788064 0.71910376] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 31 s: 0 batch_loss 0.03911838307976723 BPR_loss 0.03213927149772644 reg_loss 0.006979112979024649
epoch: 31 s: 256000 batch_loss 0.03969857841730118 BPR_loss 0.03222241252660751 reg_loss 0.007476164493709803
epoch: 31 s: 512000 batch_loss 0.051039084792137146 BPR_loss 0.04393567144870758 reg_loss 0.007103412877768278
epoch: 31 s: 768000 batch_loss 0.04276371747255325 BPR_loss 0.03547125309705734 reg_loss 0.007292464375495911
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   31  | 57.68736028671265 | 57.962136030197144 | 17.956134796142578 | [0.16516703 0.2330749  0.28074518] | [0.13513374 0.15710865 0.17148165] | [0.04895505 0.03508942 0.02854846] | [0.54511354 0.65617255 0.71669234] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 32 s: 0 batch_loss 0.048704709857702255 BPR_loss 0.04162684828042984 reg_loss 0.007077862974256277
epoch: 32 s: 256000 batch_loss 0.04382423684000969 BPR_loss 0.03644353896379471 reg_loss 0.007380699273198843
epoch: 32 s: 512000 batch_loss 0.040451545268297195 BPR_loss 0.03318994119763374 reg_loss 0.007261603605002165
epoch: 32 s: 768000 batch_loss 0.04894911125302315 BPR_loss 0.041312821209430695 reg_loss 0.007636290043592453
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   32  | 57.16903042793274 | 56.05637741088867 | 17.275480270385742 | [0.16549738 0.2325321  0.28067848] | [0.13522357 0.15690246 0.17139098] | [0.04908232 0.03507854 0.0285546 ] | [0.54618528 0.65603858 0.71652488] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 33 s: 0 batch_loss 0.03873462602496147 BPR_loss 0.031844355165958405 reg_loss 0.006890272255986929
epoch: 33 s: 256000 batch_loss 0.032300565391778946 BPR_loss 0.025018498301506042 reg_loss 0.0072820656932890415
epoch: 33 s: 512000 batch_loss 0.03818252310156822 BPR_loss 0.03069544956088066 reg_loss 0.007487073075026274
epoch: 33 s: 768000 batch_loss 0.03993122652173042 BPR_loss 0.03274215757846832 reg_loss 0.007189069874584675
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   33  | 57.48543190956116 | 62.19172668457031 | 16.624677658081055 | [0.1647585  0.23142069 0.27999412] | [0.13497442 0.15650593 0.17109964] | [0.04890649 0.03488429 0.02844464] | [0.54451068 0.65339273 0.71508473] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.16475849514027482
early stopping at 33, recall@20:0.1670
