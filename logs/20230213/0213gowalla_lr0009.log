Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='gowalla', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=3, l2=0.0001, lr=0.009, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931487321853638 BPR_loss 0.6931487321853638 reg_loss 2.4288397071359213e-08
epoch: 0 s: 256000 batch_loss 0.5510415434837341 BPR_loss 0.5492979288101196 reg_loss 0.00174359988886863
epoch: 0 s: 512000 batch_loss 0.4745824635028839 BPR_loss 0.4711683988571167 reg_loss 0.003414059290662408
epoch: 0 s: 768000 batch_loss 0.43269240856170654 BPR_loss 0.4280529022216797 reg_loss 0.004639505408704281
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 89.53686380386353 | 146.13285970687866 | 206.53884887695312 | [0.13318747 0.19159902 0.23324347] | [0.11219012 0.13050826 0.14287034] | [0.04235381 0.03061993 0.02495702] | [0.48586643 0.59434657 0.65382812] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.44683265686035156 BPR_loss 0.44201821088790894 reg_loss 0.004814455285668373
epoch: 1 s: 256000 batch_loss 0.38773974776268005 BPR_loss 0.3815027177333832 reg_loss 0.006237017922103405
epoch: 1 s: 512000 batch_loss 0.3721887171268463 BPR_loss 0.36480847001075745 reg_loss 0.00738024665042758
epoch: 1 s: 768000 batch_loss 0.3421567976474762 BPR_loss 0.3333296775817871 reg_loss 0.008827133104205132
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 85.86318898200989 | 120.58771872520447 | 155.24282836914062 | [0.14214653 0.20301756 0.245835  ] | [0.11938777 0.13846621 0.15125504] | [0.04496115 0.03227694 0.02627046] | [0.50710027 0.61303503 0.67054056] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.3541423976421356 BPR_loss 0.3454385995864868 reg_loss 0.008703810162842274
epoch: 2 s: 256000 batch_loss 0.35916703939437866 BPR_loss 0.3496755063533783 reg_loss 0.009491543285548687
epoch: 2 s: 512000 batch_loss 0.31052166223526 BPR_loss 0.299628883600235 reg_loss 0.010892780497670174
epoch: 2 s: 768000 batch_loss 0.2993852496147156 BPR_loss 0.28717830777168274 reg_loss 0.012206939049065113
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 78.07532382011414 | 58.8129518032074 | 129.6316680908203 | [0.14945025 0.21176285 0.25729578] | [0.12547839 0.14497504 0.15855142] | [0.0470996  0.03360155 0.02740472] | [0.52324335 0.62636479 0.68644919] |
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.2970676124095917 BPR_loss 0.2844510078430176 reg_loss 0.01261659525334835
epoch: 3 s: 256000 batch_loss 0.29146111011505127 BPR_loss 0.2781798243522644 reg_loss 0.013281280174851418
epoch: 3 s: 512000 batch_loss 0.26249226927757263 BPR_loss 0.2479925900697708 reg_loss 0.01449968945235014
epoch: 3 s: 768000 batch_loss 0.2658013701438904 BPR_loss 0.2504710555076599 reg_loss 0.015330322086811066
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 72.85818004608154 | 123.23388481140137 | 111.28500366210938 | [0.15379712 0.21803095 0.26389276] | [0.12950599 0.14960524 0.16331739] | [0.04838234 0.0345276  0.0281047 ] | [0.53315694 0.63694822 0.69482216] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.25693681836128235 BPR_loss 0.24213525652885437 reg_loss 0.014801549725234509
epoch: 4 s: 256000 batch_loss 0.2448517382144928 BPR_loss 0.2288418561220169 reg_loss 0.016009878367185593
epoch: 4 s: 512000 batch_loss 0.2508920729160309 BPR_loss 0.2341935932636261 reg_loss 0.01669849269092083
epoch: 4 s: 768000 batch_loss 0.24239444732666016 BPR_loss 0.224342942237854 reg_loss 0.018051497638225555
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 77.13204026222229 | 137.8959801197052 | 97.5931396484375 | [0.15761287 0.22254965 0.26876238] | [0.13268662 0.1529809  0.16677888] | [0.04946246 0.03516227 0.02854288] | [0.5415634  0.64371358 0.70135307] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.22752441465854645 BPR_loss 0.20988595485687256 reg_loss 0.01763845607638359
epoch: 5 s: 256000 batch_loss 0.232886403799057 BPR_loss 0.21387596428394318 reg_loss 0.019010445103049278
epoch: 5 s: 512000 batch_loss 0.22174257040023804 BPR_loss 0.20189620554447174 reg_loss 0.019846370443701744
epoch: 5 s: 768000 batch_loss 0.2066354602575302 BPR_loss 0.18586143851280212 reg_loss 0.020774023607373238
+-------+------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |  tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 73.8902018070221 | 99.5995581150055 | 87.62076568603516 | [0.15902514 0.22499485 0.27215948] | [0.13369555 0.15437585 0.1684504 ] | [0.04982082 0.03548212 0.02883147] | [0.54330498 0.64659388 0.70557305] |
+-------+------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.20473355054855347 BPR_loss 0.18364320695400238 reg_loss 0.021090351045131683
epoch: 6 s: 256000 batch_loss 0.17973041534423828 BPR_loss 0.1587396264076233 reg_loss 0.020990794524550438
epoch: 6 s: 512000 batch_loss 0.2132168859243393 BPR_loss 0.19068674743175507 reg_loss 0.022530142217874527
epoch: 6 s: 768000 batch_loss 0.2018524408340454 BPR_loss 0.17897866666316986 reg_loss 0.022873781621456146
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 74.29385781288147 | 125.09069418907166 | 79.5201416015625 | [0.16210354 0.22864264 0.27600596] | [0.13643574 0.15729136 0.17141824] | [0.05069161 0.03604562 0.02921997] | [0.55007033 0.652254   0.71099873] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.21099989116191864 BPR_loss 0.1882433295249939 reg_loss 0.022756559774279594
epoch: 7 s: 256000 batch_loss 0.18595345318317413 BPR_loss 0.16274422407150269 reg_loss 0.0232092272490263
epoch: 7 s: 512000 batch_loss 0.18967925012111664 BPR_loss 0.1649070829153061 reg_loss 0.024772167205810547
epoch: 7 s: 768000 batch_loss 0.18748630583286285 BPR_loss 0.16309361159801483 reg_loss 0.024392694234848022
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 77.64776110649109 | 115.75288724899292 | 73.45303344726562 | [0.16365591 0.23051023 0.27780817] | [0.13763809 0.15861902 0.17274519] | [0.05105332 0.03621977 0.02932771] | [0.55130953 0.65526827 0.71123317] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.18421587347984314 BPR_loss 0.15969082713127136 reg_loss 0.024525048211216927
epoch: 8 s: 256000 batch_loss 0.17995616793632507 BPR_loss 0.15458539128303528 reg_loss 0.025370771065354347
epoch: 8 s: 512000 batch_loss 0.15853270888328552 BPR_loss 0.1323857307434082 reg_loss 0.02614697255194187
epoch: 8 s: 768000 batch_loss 0.16116851568222046 BPR_loss 0.1351892650127411 reg_loss 0.02597925066947937
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 71.10323023796082 | 113.64800429344177 | 68.4071044921875 | [0.16495941 0.23185947 0.27973882] | [0.13815753 0.15921705 0.17351245] | [0.05129111 0.03640817 0.02950577] | [0.5526827  0.65654096 0.71474982] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.1704491376876831 BPR_loss 0.14469414949417114 reg_loss 0.025754986330866814
epoch: 9 s: 256000 batch_loss 0.1696939468383789 BPR_loss 0.14346149563789368 reg_loss 0.02623245120048523
epoch: 9 s: 512000 batch_loss 0.16803325712680817 BPR_loss 0.14137662947177887 reg_loss 0.026656631380319595
epoch: 9 s: 768000 batch_loss 0.14975938200950623 BPR_loss 0.12197501957416534 reg_loss 0.02778436243534088
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 71.4257972240448 | 109.63012099266052 | 64.23019409179688 | [0.16649816 0.23343291 0.28127156] | [0.13940894 0.16047074 0.17477907] | [0.05166789 0.03656725 0.02962746] | [0.55626633 0.65932079 0.71592203] |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.16033679246902466 BPR_loss 0.1327895075082779 reg_loss 0.027547277510166168
epoch: 10 s: 256000 batch_loss 0.1442226767539978 BPR_loss 0.11700980365276337 reg_loss 0.027212880551815033
epoch: 10 s: 512000 batch_loss 0.14998631179332733 BPR_loss 0.12080331146717072 reg_loss 0.029183000326156616
epoch: 10 s: 768000 batch_loss 0.14234568178653717 BPR_loss 0.11441697180271149 reg_loss 0.027928709983825684
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 74.49342370033264 | 76.09649324417114 | 59.78879928588867 | [0.16634301 0.23434257 0.2830926 ] | [0.13926925 0.16071386 0.17530732] | [0.05148536 0.03656809 0.02972682] | [0.55546252 0.6596892  0.71672584] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.1397189497947693 BPR_loss 0.11048698425292969 reg_loss 0.02923196367919445
epoch: 11 s: 256000 batch_loss 0.14967703819274902 BPR_loss 0.11937768757343292 reg_loss 0.030299346894025803
epoch: 11 s: 512000 batch_loss 0.14773237705230713 BPR_loss 0.1180594190955162 reg_loss 0.029672952368855476
epoch: 11 s: 768000 batch_loss 0.1316276341676712 BPR_loss 0.10178495943546295 reg_loss 0.029842674732208252
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 71.66164565086365 | 96.52550196647644 | 56.88550567626953 | [0.16723466 0.23554551 0.28378269] | [0.14025578 0.16184138 0.17622119] | [0.05178177 0.036831   0.02979492] | [0.55810838 0.66122982 0.7185344 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.14760538935661316 BPR_loss 0.11830484867095947 reg_loss 0.029300546273589134
epoch: 12 s: 256000 batch_loss 0.13423378765583038 BPR_loss 0.10386738181114197 reg_loss 0.030366411432623863
epoch: 12 s: 512000 batch_loss 0.13177554309368134 BPR_loss 0.1012120395898819 reg_loss 0.03056349791586399
epoch: 12 s: 768000 batch_loss 0.1414916068315506 BPR_loss 0.10995978862047195 reg_loss 0.031531818211078644
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 71.48516893386841 | 112.23163676261902 | 54.21833038330078 | [0.16801902 0.23635619 0.28531738] | [0.14086423 0.16245895 0.17708081] | [0.05188559 0.03689882 0.02991884] | [0.55938107 0.66236854 0.71987407] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.11781579256057739 BPR_loss 0.0867747962474823 reg_loss 0.031040992587804794
epoch: 13 s: 256000 batch_loss 0.12356270104646683 BPR_loss 0.09194167703390121 reg_loss 0.03162102401256561
epoch: 13 s: 512000 batch_loss 0.1314600706100464 BPR_loss 0.10058241337537766 reg_loss 0.030877653509378433
epoch: 13 s: 768000 batch_loss 0.14711180329322815 BPR_loss 0.11515863984823227 reg_loss 0.03195316344499588
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+---------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |            precision            |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+---------------------------------+------------------------------------+
|   13  | 72.98390674591064 | 97.60545921325684 | 51.72796630859375 | [0.16913484 0.23740613 0.28691465] | [0.14150484 0.16305696 0.17784514] | [0.0521686 0.037006  0.0300249] | [0.56112265 0.66444504 0.72295532] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+---------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.11830081045627594 BPR_loss 0.08748883754014969 reg_loss 0.03081197664141655
epoch: 14 s: 256000 batch_loss 0.12046659737825394 BPR_loss 0.0894366130232811 reg_loss 0.03102998621761799
epoch: 14 s: 512000 batch_loss 0.13151122629642487 BPR_loss 0.10011449456214905 reg_loss 0.03139672800898552
epoch: 14 s: 768000 batch_loss 0.11936615407466888 BPR_loss 0.08685441315174103 reg_loss 0.032511740922927856
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 71.46999144554138 | 78.75654292106628 | 49.63216018676758 | [0.16887934 0.2364204  0.28604744] | [0.14109405 0.16240359 0.17723377] | [0.05205975 0.03681174 0.02991102] | [0.55971599 0.66189966 0.72158216] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.112007275223732 BPR_loss 0.07970284670591354 reg_loss 0.03230442851781845
epoch: 15 s: 256000 batch_loss 0.12714698910713196 BPR_loss 0.09468644112348557 reg_loss 0.032460540533065796
epoch: 15 s: 512000 batch_loss 0.1287732869386673 BPR_loss 0.09524432569742203 reg_loss 0.03352896124124527
epoch: 15 s: 768000 batch_loss 0.11579969525337219 BPR_loss 0.08303063362836838 reg_loss 0.032769061625003815
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 69.41684579849243 | 95.61782908439636 | 47.78769302368164 | [0.16883267 0.23761391 0.2867563 ] | [0.14063288 0.16246736 0.17717431] | [0.05179851 0.0368737  0.02992051] | [0.55991694 0.66451202 0.72339072] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.11209823191165924 BPR_loss 0.078451007604599 reg_loss 0.03364722430706024
epoch: 16 s: 256000 batch_loss 0.13206183910369873 BPR_loss 0.0991763174533844 reg_loss 0.03288552910089493
epoch: 16 s: 512000 batch_loss 0.12621763348579407 BPR_loss 0.0930815264582634 reg_loss 0.03313610702753067
epoch: 16 s: 768000 batch_loss 0.1039828360080719 BPR_loss 0.069249726831913 reg_loss 0.034733109176158905
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 70.2700788974762 | 112.32431435585022 | 46.091495513916016 | [0.17026558 0.23839004 0.28791295] | [0.14190575 0.1634704  0.17826359] | [0.05226907 0.03703279 0.0300422 ] | [0.56299819 0.66498091 0.72459642] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.11759430170059204 BPR_loss 0.08358651399612427 reg_loss 0.03400778770446777
epoch: 17 s: 256000 batch_loss 0.11250977963209152 BPR_loss 0.07876913994550705 reg_loss 0.03374063968658447
epoch: 17 s: 512000 batch_loss 0.12553846836090088 BPR_loss 0.09120123833417892 reg_loss 0.034337226301431656
epoch: 17 s: 768000 batch_loss 0.11821088194847107 BPR_loss 0.08441105484962463 reg_loss 0.03379982337355614
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 71.38120031356812 | 92.98791575431824 | 44.7217903137207 | [0.17081358 0.23882837 0.28851167] | [0.14209426 0.16372919 0.17854142] | [0.0522473  0.037042   0.03003718] | [0.56373501 0.66518186 0.72506531] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.10819250345230103 BPR_loss 0.07416630536317825 reg_loss 0.03402619808912277
epoch: 18 s: 256000 batch_loss 0.10375046730041504 BPR_loss 0.06922918558120728 reg_loss 0.03452128544449806
epoch: 18 s: 512000 batch_loss 0.10565978288650513 BPR_loss 0.07090120017528534 reg_loss 0.03475857898592949
epoch: 18 s: 768000 batch_loss 0.11073760688304901 BPR_loss 0.07498122751712799 reg_loss 0.03575637564063072
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 71.70473861694336 | 84.76741075515747 | 43.01751708984375 | [0.17033312 0.23902264 0.28783938] | [0.14159315 0.16343598 0.17802807] | [0.05205975 0.03699846 0.02993335] | [0.56266327 0.66648804 0.72416103] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.10629530996084213 BPR_loss 0.07129091024398804 reg_loss 0.035004399716854095
epoch: 19 s: 256000 batch_loss 0.09917029738426208 BPR_loss 0.06357981264591217 reg_loss 0.03559048846364021
epoch: 19 s: 512000 batch_loss 0.10218124091625214 BPR_loss 0.0684487596154213 reg_loss 0.03373248130083084
epoch: 19 s: 768000 batch_loss 0.10210412740707397 BPR_loss 0.06738726794719696 reg_loss 0.034716859459877014
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 70.28350687026978 | 99.23757696151733 | 41.82514572143555 | [0.17097848 0.23960131 0.28861195] | [0.14201069 0.16377716 0.17842642] | [0.05224898 0.03703614 0.02999531] | [0.56400295 0.66658852 0.724295  ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.10494470596313477 BPR_loss 0.07024195790290833 reg_loss 0.03470274433493614
epoch: 20 s: 256000 batch_loss 0.10118293017148972 BPR_loss 0.06648898124694824 reg_loss 0.03469394892454147
epoch: 20 s: 512000 batch_loss 0.10989607870578766 BPR_loss 0.07422717660665512 reg_loss 0.03566890209913254
epoch: 20 s: 768000 batch_loss 0.09439525008201599 BPR_loss 0.05892668291926384 reg_loss 0.03546857088804245
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 69.84836292266846 | 98.06378865242004 | 40.6006965637207 | [0.17109139 0.24012288 0.28951254] | [0.14208404 0.16400042 0.1787569 ] | [0.05221214 0.03709726 0.03008183] | [0.56453882 0.66766026 0.72663943] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.09533500671386719 BPR_loss 0.06094345822930336 reg_loss 0.034391552209854126
epoch: 21 s: 256000 batch_loss 0.10770883411169052 BPR_loss 0.07271517068147659 reg_loss 0.03499366343021393
epoch: 21 s: 512000 batch_loss 0.0962580144405365 BPR_loss 0.06106676161289215 reg_loss 0.03519125282764435
epoch: 21 s: 768000 batch_loss 0.09762834012508392 BPR_loss 0.06204666569828987 reg_loss 0.035581670701503754
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 70.04843783378601 | 89.57360863685608 | 39.63139724731445 | [0.17033375 0.24037124 0.28936312] | [0.14097491 0.16329391 0.17796688] | [0.05179684 0.03702274 0.03000815] | [0.56259629 0.66883247 0.72643848] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.09219996631145477 BPR_loss 0.05645544081926346 reg_loss 0.035744525492191315
epoch: 22 s: 256000 batch_loss 0.0967051088809967 BPR_loss 0.061104439198970795 reg_loss 0.03560066595673561
epoch: 22 s: 512000 batch_loss 0.09138745069503784 BPR_loss 0.05574809014797211 reg_loss 0.035639360547065735
epoch: 22 s: 768000 batch_loss 0.10140582174062729 BPR_loss 0.06612302362918854 reg_loss 0.03528279811143875
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 69.78275632858276 | 90.08992624282837 | 38.62310028076172 | [0.17074431 0.23995822 0.28842924] | [0.14105735 0.16308445 0.17762177] | [0.0519375  0.03693985 0.02990935] | [0.56396946 0.66910041 0.72540023] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.09911312162876129 BPR_loss 0.06422136723995209 reg_loss 0.0348917581140995
epoch: 23 s: 256000 batch_loss 0.09371230006217957 BPR_loss 0.058143217116594315 reg_loss 0.03556908667087555
epoch: 23 s: 512000 batch_loss 0.0970492959022522 BPR_loss 0.06051794812083244 reg_loss 0.036531347781419754
epoch: 23 s: 768000 batch_loss 0.09088054299354553 BPR_loss 0.05458648502826691 reg_loss 0.03629405423998833
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 73.58927893638611 | 93.58584356307983 | 37.815494537353516 | [0.1707625  0.24107066 0.28975917] | [0.14134463 0.1636942  0.17825874] | [0.05186885 0.03702274 0.02994786] | [0.56283073 0.67100944 0.72794561] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.09640654921531677 BPR_loss 0.05982126668095589 reg_loss 0.036585286259651184
epoch: 24 s: 256000 batch_loss 0.08943649381399155 BPR_loss 0.05361209064722061 reg_loss 0.035824403166770935
epoch: 24 s: 512000 batch_loss 0.09625187516212463 BPR_loss 0.060296230018138885 reg_loss 0.03595564514398575
epoch: 24 s: 768000 batch_loss 0.0945226401090622 BPR_loss 0.05829956382513046 reg_loss 0.03622308000922203
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 72.4685230255127 | 92.38849973678589 | 36.84888458251953 | [0.17101127 0.2412421  0.28990899] | [0.14147484 0.1637914  0.17832761] | [0.05202123 0.037078   0.02997968] | [0.56393596 0.67044008 0.72600308] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.09371719509363174 BPR_loss 0.057857438921928406 reg_loss 0.03585975617170334
epoch: 25 s: 256000 batch_loss 0.097169429063797 BPR_loss 0.06060709059238434 reg_loss 0.03656233474612236
epoch: 25 s: 512000 batch_loss 0.09144158661365509 BPR_loss 0.05582708120346069 reg_loss 0.0356145054101944
epoch: 25 s: 768000 batch_loss 0.10377635061740875 BPR_loss 0.06679210066795349 reg_loss 0.03698425367474556
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 70.87482023239136 | 91.43654656410217 | 36.13661193847656 | [0.16992489 0.24018227 0.28882389] | [0.14064287 0.16297278 0.17753187] | [0.05169971 0.03686868 0.02984906] | [0.56246232 0.66916739 0.72700784] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.08278681337833405 BPR_loss 0.046596646308898926 reg_loss 0.03619016706943512
epoch: 26 s: 256000 batch_loss 0.0867009162902832 BPR_loss 0.050217341631650925 reg_loss 0.03648357838392258
epoch: 26 s: 512000 batch_loss 0.08697144687175751 BPR_loss 0.05119200795888901 reg_loss 0.0357794389128685
epoch: 26 s: 768000 batch_loss 0.08862463384866714 BPR_loss 0.05201023072004318 reg_loss 0.03661440312862396
+-------+------------------+-------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |      Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 71.0918357372284 | 95.83677363395691 | 35.55322265625 | [0.16999446 0.23977105 0.28860729] | [0.14045504 0.16268828 0.17725818] | [0.0516344  0.03683435 0.02978096] | [0.56259629 0.66923438 0.72623752] |
+-------+------------------+-------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.08960159868001938 BPR_loss 0.053387999534606934 reg_loss 0.036213599145412445
epoch: 27 s: 256000 batch_loss 0.08171145617961884 BPR_loss 0.04618795961141586 reg_loss 0.035523492842912674
epoch: 27 s: 512000 batch_loss 0.08615212142467499 BPR_loss 0.050027843564748764 reg_loss 0.036124274134635925
epoch: 27 s: 768000 batch_loss 0.09129011631011963 BPR_loss 0.055287718772888184 reg_loss 0.036002401262521744
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 69.92554879188538 | 94.42553448677063 | 34.67078399658203 | [0.17026387 0.23966135 0.28874066] | [0.14108272 0.16323358 0.17788525] | [0.05161096 0.03685612 0.02983567] | [0.56246232 0.6691339  0.72694085] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 28 s: 0 batch_loss 0.08631651848554611 BPR_loss 0.050215162336826324 reg_loss 0.03610135614871979
epoch: 28 s: 256000 batch_loss 0.09029130637645721 BPR_loss 0.053786806762218475 reg_loss 0.03650449961423874
epoch: 28 s: 512000 batch_loss 0.08208811283111572 BPR_loss 0.044835414737463 reg_loss 0.03725269436836243
epoch: 28 s: 768000 batch_loss 0.07567267119884491 BPR_loss 0.0387360155582428 reg_loss 0.03693665191531181
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   28  | 72.38874864578247 | 93.35141372680664 | 34.12378692626953 | [0.17021035 0.24001182 0.28893513] | [0.14076579 0.1629845  0.1775848 ] | [0.05161598 0.03683267 0.02980497] | [0.56162503 0.66920088 0.72630451] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 29 s: 0 batch_loss 0.0850471556186676 BPR_loss 0.04867679625749588 reg_loss 0.03637036308646202
epoch: 29 s: 256000 batch_loss 0.0800483226776123 BPR_loss 0.0438227653503418 reg_loss 0.03622555360198021
epoch: 29 s: 512000 batch_loss 0.08720262348651886 BPR_loss 0.05038115754723549 reg_loss 0.03682146593928337
epoch: 29 s: 768000 batch_loss 0.07882043719291687 BPR_loss 0.04218270629644394 reg_loss 0.03663773462176323
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   29  | 71.04878878593445 | 89.61334896087646 | 33.57767105102539 | [0.17062178 0.23951344 0.28861833] | [0.14113984 0.16311923 0.17777703] | [0.05166622 0.03675481 0.02977426] | [0.56293121 0.66910041 0.72667292] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 30 s: 0 batch_loss 0.0857200101017952 BPR_loss 0.048803891986608505 reg_loss 0.03691611811518669
epoch: 30 s: 256000 batch_loss 0.07756076753139496 BPR_loss 0.040510937571525574 reg_loss 0.037049826234579086
epoch: 30 s: 512000 batch_loss 0.08464986085891724 BPR_loss 0.04661254584789276 reg_loss 0.03803731128573418
epoch: 30 s: 768000 batch_loss 0.08552692830562592 BPR_loss 0.04875027760863304 reg_loss 0.036776650696992874
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   30  | 73.10274171829224 | 92.92106056213379 | 32.90841293334961 | [0.17022856 0.24022898 0.28837529] | [0.14092205 0.16323806 0.17766897] | [0.05146527 0.03675899 0.02974468] | [0.56169201 0.67064103 0.7271753 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.17022856191572192
early stopping at 30, recall@20:0.1711
