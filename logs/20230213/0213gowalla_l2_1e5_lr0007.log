Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='gowalla', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=3, l2=1e-05, lr=0.007, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931487321853638 BPR_loss 0.6931487321853638 reg_loss 2.4288397959537633e-09
epoch: 0 s: 256000 batch_loss 0.5678555369377136 BPR_loss 0.5677191615104675 reg_loss 0.0001363760675303638
epoch: 0 s: 512000 batch_loss 0.48997730016708374 BPR_loss 0.48969030380249023 reg_loss 0.0002869971503969282
epoch: 0 s: 768000 batch_loss 0.4473611116409302 BPR_loss 0.44696545600891113 reg_loss 0.0003956541477236897
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 56.78728151321411 | 64.3664813041687 | 212.72134399414062 | [0.13108895 0.18829067 0.22915032] | [0.11004444 0.12797934 0.14014477] | [0.04168899 0.03012677 0.02456963] | [0.48265122 0.58838502 0.64783308] |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.46449416875839233 BPR_loss 0.4640820622444153 reg_loss 0.00041210566996596754
epoch: 1 s: 256000 batch_loss 0.40987348556518555 BPR_loss 0.40933701395988464 reg_loss 0.0005364810931496322
epoch: 1 s: 512000 batch_loss 0.38877150416374207 BPR_loss 0.38812893629074097 reg_loss 0.0006425650790333748
epoch: 1 s: 768000 batch_loss 0.36008593440055847 BPR_loss 0.35931795835494995 reg_loss 0.0007679725531488657
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 58.58636546134949 | 52.92801642417908 | 162.54852294921875 | [0.13940067 0.1990262  0.24134911] | [0.11718347 0.13587508 0.14848852] | [0.04418581 0.03171009 0.02581553] | [0.50137317 0.60697301 0.6658517 ] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.3771153688430786 BPR_loss 0.37635549902915955 reg_loss 0.0007598798256367445
epoch: 2 s: 256000 batch_loss 0.38123148679733276 BPR_loss 0.3804023861885071 reg_loss 0.000829107710160315
epoch: 2 s: 512000 batch_loss 0.3333616852760315 BPR_loss 0.3323986530303955 reg_loss 0.0009630471467971802
epoch: 2 s: 768000 batch_loss 0.31753820180892944 BPR_loss 0.31645649671554565 reg_loss 0.0010817012516781688
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 67.0151994228363 | 87.34221911430359 | 137.71983337402344 | [0.14571158 0.20711286 0.25101214] | [0.12250163 0.14178494 0.15482884] | [0.04605466 0.03298362 0.02679405] | [0.51634403 0.62060419 0.679014  ] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.3162584602832794 BPR_loss 0.31513604521751404 reg_loss 0.001122412970289588
epoch: 3 s: 256000 batch_loss 0.3117170035839081 BPR_loss 0.31053537130355835 reg_loss 0.0011816422920674086
epoch: 3 s: 512000 batch_loss 0.28504860401153564 BPR_loss 0.28374114632606506 reg_loss 0.00130746653303504
epoch: 3 s: 768000 batch_loss 0.2861245572566986 BPR_loss 0.28472650051116943 reg_loss 0.0013980526709929109
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 69.00482845306396 | 85.07273888587952 | 119.23585510253906 | [0.15064816 0.21289246 0.2579002 ] | [0.12655497 0.14603961 0.15944704] | [0.04748644 0.03383934 0.02752696] | [0.52850157 0.62968049 0.68705205] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.2787300646305084 BPR_loss 0.27739015221595764 reg_loss 0.001339917303994298
epoch: 4 s: 256000 batch_loss 0.2601531445980072 BPR_loss 0.2586877942085266 reg_loss 0.0014653584221377969
epoch: 4 s: 512000 batch_loss 0.2695571482181549 BPR_loss 0.26801425218582153 reg_loss 0.0015428924234583974
epoch: 4 s: 768000 batch_loss 0.2553713619709015 BPR_loss 0.2536821961402893 reg_loss 0.001689163618721068
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 67.65527105331421 | 69.98624086380005 | 104.33792114257812 | [0.15416233 0.21773475 0.26333191] | [0.12955034 0.14941896 0.16302986] | [0.04846942 0.0345008  0.02804497] | [0.53623819 0.63741711 0.69532454] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.24500566720962524 BPR_loss 0.24335868656635284 reg_loss 0.0016469783149659634
epoch: 5 s: 256000 batch_loss 0.24399195611476898 BPR_loss 0.24219799041748047 reg_loss 0.0017939598765224218
epoch: 5 s: 512000 batch_loss 0.23808087408542633 BPR_loss 0.23619037866592407 reg_loss 0.001890496932901442
epoch: 5 s: 768000 batch_loss 0.21393418312072754 BPR_loss 0.21191474795341492 reg_loss 0.0020194395910948515
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 67.04094743728638 | 77.20216751098633 | 92.80926513671875 | [0.15581146 0.2205597  0.26686258] | [0.13120521 0.15152636 0.16534524] | [0.04891989 0.03491275 0.02837765] | [0.5378793  0.64039788 0.69987943] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.2170839011669159 BPR_loss 0.21502873301506042 reg_loss 0.0020551695488393307
epoch: 6 s: 256000 batch_loss 0.18594500422477722 BPR_loss 0.18390701711177826 reg_loss 0.002037981292232871
epoch: 6 s: 512000 batch_loss 0.21910953521728516 BPR_loss 0.2168680876493454 reg_loss 0.0022414543200284243
epoch: 6 s: 768000 batch_loss 0.2067592591047287 BPR_loss 0.20445750653743744 reg_loss 0.0023017479106783867
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 66.13021898269653 | 82.57607960700989 | 83.00646209716797 | [0.15932339 0.22362602 0.27086687] | [0.13399205 0.1541723  0.16829567] | [0.04983422 0.03534564 0.02878235] | [0.54497957 0.64619198 0.70597495] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.21809107065200806 BPR_loss 0.2158147096633911 reg_loss 0.0022763616871088743
epoch: 7 s: 256000 batch_loss 0.19169624149799347 BPR_loss 0.1893465220928192 reg_loss 0.0023497159127146006
epoch: 7 s: 512000 batch_loss 0.19233952462673187 BPR_loss 0.18976439535617828 reg_loss 0.0025751253124326468
epoch: 7 s: 768000 batch_loss 0.18696019053459167 BPR_loss 0.18440981209278107 reg_loss 0.002550379605963826
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 66.32368016242981 | 82.33942914009094 | 75.3295669555664 | [0.16072565 0.22597981 0.2730748 ] | [0.13556682 0.15604787 0.17011391] | [0.05025119 0.03561943 0.02890738] | [0.54705607 0.64877085 0.7086543 ] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.18836231529712677 BPR_loss 0.1857912838459015 reg_loss 0.0025710288900882006
epoch: 8 s: 256000 batch_loss 0.18188956379890442 BPR_loss 0.17922312021255493 reg_loss 0.0026664393953979015
epoch: 8 s: 512000 batch_loss 0.15851595997810364 BPR_loss 0.15570104122161865 reg_loss 0.002814922947436571
epoch: 8 s: 768000 batch_loss 0.15756507217884064 BPR_loss 0.1547657698392868 reg_loss 0.0027993060648441315
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 66.11562705039978 | 76.80080819129944 | 68.64542388916016 | [0.16169052 0.22720916 0.2744891 ] | [0.13614681 0.15671567 0.17088478] | [0.05037009 0.03570819 0.02903354] | [0.54662067 0.65057941 0.70872128] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.16999122500419617 BPR_loss 0.16721093654632568 reg_loss 0.002780288690701127
epoch: 9 s: 256000 batch_loss 0.1671452820301056 BPR_loss 0.1643209457397461 reg_loss 0.0028243300039321184
epoch: 9 s: 512000 batch_loss 0.1575029194355011 BPR_loss 0.15456831455230713 reg_loss 0.002934603253379464
epoch: 9 s: 768000 batch_loss 0.1407874971628189 BPR_loss 0.13770678639411926 reg_loss 0.003080714261159301
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 66.38426280021667 | 78.10981965065002 | 63.20354080200195 | [0.16397262 0.22959765 0.27723392] | [0.13793046 0.1585549  0.17278789] | [0.0509294  0.03603473 0.02923002] | [0.55164445 0.6543305  0.71418045] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.16126182675361633 BPR_loss 0.15821294486522675 reg_loss 0.0030488891061395407
epoch: 10 s: 256000 batch_loss 0.13191579282283783 BPR_loss 0.12889014184474945 reg_loss 0.0030256561003625393
epoch: 10 s: 512000 batch_loss 0.14181876182556152 BPR_loss 0.13851898908615112 reg_loss 0.003299775067716837
epoch: 10 s: 768000 batch_loss 0.1365632563829422 BPR_loss 0.13341639935970306 reg_loss 0.0031468505039811134
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 66.3792610168457 | 80.05001878738403 | 57.48374938964844 | [0.16390748 0.230863   0.27880891] | [0.13783074 0.15900497 0.17330985] | [0.05075357 0.0361687  0.02932492] | [0.54996986 0.65650747 0.7152187 ] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.13022130727767944 BPR_loss 0.12684962153434753 reg_loss 0.0033716901671141386
epoch: 11 s: 256000 batch_loss 0.1358577162027359 BPR_loss 0.13226619362831116 reg_loss 0.003591519081965089
epoch: 11 s: 512000 batch_loss 0.1356581449508667 BPR_loss 0.1321692317724228 reg_loss 0.003488918300718069
epoch: 11 s: 768000 batch_loss 0.1271892786026001 BPR_loss 0.12367432564496994 reg_loss 0.0035149562172591686
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 66.74886393547058 | 79.50323247909546 | 53.62366485595703 | [0.1657068  0.23211281 0.28089077] | [0.13904525 0.16005453 0.17459666] | [0.05120571 0.03633532 0.02950075] | [0.55402237 0.65781365 0.71726171] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.1360449492931366 BPR_loss 0.13259398937225342 reg_loss 0.003450962482020259
epoch: 12 s: 256000 batch_loss 0.12487556785345078 BPR_loss 0.12126793712377548 reg_loss 0.003607627470046282
epoch: 12 s: 512000 batch_loss 0.11340433359146118 BPR_loss 0.10971099138259888 reg_loss 0.0036933410447090864
epoch: 12 s: 768000 batch_loss 0.12449302524328232 BPR_loss 0.12066354602575302 reg_loss 0.0038294787518680096
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 66.21103072166443 | 76.27556300163269 | 50.042076110839844 | [0.16567383 0.23311941 0.28189056] | [0.13937752 0.16069899 0.17522907] | [0.05122915 0.03644249 0.02955266] | [0.55328555 0.65915333 0.71799853] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.10556426644325256 BPR_loss 0.10174782574176788 reg_loss 0.003816441632807255
epoch: 13 s: 256000 batch_loss 0.11444270610809326 BPR_loss 0.11061593145132065 reg_loss 0.0038267711643129587
epoch: 13 s: 512000 batch_loss 0.1197759285569191 BPR_loss 0.11587300896644592 reg_loss 0.0039029205217957497
epoch: 13 s: 768000 batch_loss 0.1394300013780594 BPR_loss 0.1353519707918167 reg_loss 0.004078028257936239
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 66.25213170051575 | 81.79446220397949 | 46.5994873046875 | [0.16624462 0.23412311 0.28290413] | [0.14012123 0.1615664  0.17615042] | [0.05137819 0.03651869 0.02966039] | [0.55529506 0.66066046 0.7197401 ] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.1019325852394104 BPR_loss 0.09808037430047989 reg_loss 0.003852207912132144
epoch: 14 s: 256000 batch_loss 0.10446109622716904 BPR_loss 0.10055050253868103 reg_loss 0.003910594619810581
epoch: 14 s: 512000 batch_loss 0.11282981187105179 BPR_loss 0.10893900692462921 reg_loss 0.0038908079732209444
epoch: 14 s: 768000 batch_loss 0.10635625571012497 BPR_loss 0.10216394811868668 reg_loss 0.00419230479747057
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 67.16991353034973 | 73.5662190914154 | 43.67458724975586 | [0.16637222 0.23383215 0.28207783] | [0.13978184 0.16115701 0.17558594] | [0.0513246  0.03645422 0.0295348 ] | [0.55442427 0.65989015 0.71793154] |
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.09565657377243042 BPR_loss 0.0914992243051529 reg_loss 0.004157351795583963
epoch: 15 s: 256000 batch_loss 0.10450633615255356 BPR_loss 0.10026150941848755 reg_loss 0.004244829993695021
epoch: 15 s: 512000 batch_loss 0.10858964920043945 BPR_loss 0.1041976734995842 reg_loss 0.004391974303871393
epoch: 15 s: 768000 batch_loss 0.10145051777362823 BPR_loss 0.09715165197849274 reg_loss 0.004298866260796785
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 66.11961388587952 | 71.87844896316528 | 41.1488037109375 | [0.16653856 0.234526   0.28297673] | [0.13956493 0.16117439 0.17569725] | [0.05103992 0.03635709 0.02951414] | [0.55449126 0.66019157 0.71903677] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.09091272950172424 BPR_loss 0.08646722137928009 reg_loss 0.004445506259799004
epoch: 16 s: 256000 batch_loss 0.11719231307506561 BPR_loss 0.11286316812038422 reg_loss 0.004329142160713673
epoch: 16 s: 512000 batch_loss 0.10544054210186005 BPR_loss 0.10099156945943832 reg_loss 0.004448974039405584
epoch: 16 s: 768000 batch_loss 0.08252736181020737 BPR_loss 0.07787792384624481 reg_loss 0.004649439360946417
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 65.33084273338318 | 78.76432800292969 | 38.741336822509766 | [0.16728369 0.2346435  0.28367589] | [0.14005331 0.16147298 0.17611708] | [0.05133465 0.03647096 0.02960457] | [0.55465872 0.66035903 0.71967312] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.09345197677612305 BPR_loss 0.08881975710391998 reg_loss 0.004632222931832075
epoch: 17 s: 256000 batch_loss 0.10040556639432907 BPR_loss 0.09585952013731003 reg_loss 0.004546049050986767
epoch: 17 s: 512000 batch_loss 0.1070244312286377 BPR_loss 0.10215985029935837 reg_loss 0.004864583723247051
epoch: 17 s: 768000 batch_loss 0.10030490159988403 BPR_loss 0.0955948680639267 reg_loss 0.004710032604634762
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 66.08962988853455 | 80.92292475700378 | 36.84718704223633 | [0.16740622 0.23577647 0.28467924] | [0.14049372 0.1623271  0.17693085] | [0.05119398 0.03651869 0.02960011] | [0.55425682 0.66223458 0.72198406] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.09010617434978485 BPR_loss 0.08537180721759796 reg_loss 0.00473436713218689
epoch: 18 s: 256000 batch_loss 0.08485490083694458 BPR_loss 0.07994776219129562 reg_loss 0.00490714143961668
epoch: 18 s: 512000 batch_loss 0.0808800756931305 BPR_loss 0.07597428560256958 reg_loss 0.004905788227915764
epoch: 18 s: 768000 batch_loss 0.08035944402217865 BPR_loss 0.07515588402748108 reg_loss 0.00520356185734272
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 66.28685307502747 | 75.44533801078796 | 34.75324630737305 | [0.16779626 0.23572085 0.28497559] | [0.14012626 0.16176612 0.17653951] | [0.05122748 0.03638221 0.02959173] | [0.5563668  0.6617322  0.72198406] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.08126501739025116 BPR_loss 0.07629221677780151 reg_loss 0.004972800612449646
epoch: 19 s: 256000 batch_loss 0.07325999438762665 BPR_loss 0.06809112429618835 reg_loss 0.005168868228793144
epoch: 19 s: 512000 batch_loss 0.0787607952952385 BPR_loss 0.073860302567482 reg_loss 0.004900491796433926
epoch: 19 s: 768000 batch_loss 0.078085757791996 BPR_loss 0.07305186986923218 reg_loss 0.005033888388425112
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 66.25983691215515 | 78.49243068695068 | 32.99363327026367 | [0.16846869 0.23585107 0.28559778] | [0.14058823 0.16211558 0.1769892 ] | [0.05134637 0.0364584  0.02964141] | [0.55656775 0.66149776 0.72335722] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.08859556168317795 BPR_loss 0.08355843275785446 reg_loss 0.005037127994000912
epoch: 20 s: 256000 batch_loss 0.08249765634536743 BPR_loss 0.07748888432979584 reg_loss 0.005008772015571594
epoch: 20 s: 512000 batch_loss 0.08319541066884995 BPR_loss 0.07772847265005112 reg_loss 0.005466937553137541
epoch: 20 s: 768000 batch_loss 0.06957658380270004 BPR_loss 0.06427139788866043 reg_loss 0.005305189173668623
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 66.32424902915955 | 74.59678268432617 | 31.332979202270508 | [0.16884333 0.23688442 0.28529775] | [0.1409149  0.16261323 0.17712337] | [0.0514569  0.03654632 0.0295962 ] | [0.55770648 0.66340679 0.72201755] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.07072184234857559 BPR_loss 0.06577946245670319 reg_loss 0.004942379426211119
epoch: 21 s: 256000 batch_loss 0.0876985415816307 BPR_loss 0.08247022330760956 reg_loss 0.00522832153365016
epoch: 21 s: 512000 batch_loss 0.06947989016771317 BPR_loss 0.06427512317895889 reg_loss 0.005204768385738134
epoch: 21 s: 768000 batch_loss 0.06562162935733795 BPR_loss 0.060101643204689026 reg_loss 0.005519986618310213
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 69.00321054458618 | 79.20129036903381 | 29.820693969726562 | [0.16884112 0.23662072 0.28579813] | [0.140323   0.16199611 0.17675088] | [0.05123752 0.03643998 0.02961015] | [0.55703664 0.66347378 0.72228548] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.062082622200250626 BPR_loss 0.05666608363389969 reg_loss 0.00541653810068965
epoch: 22 s: 256000 batch_loss 0.06557358801364899 BPR_loss 0.06007218360900879 reg_loss 0.005501404870301485
epoch: 22 s: 512000 batch_loss 0.06108150631189346 BPR_loss 0.055635079741477966 reg_loss 0.005446425639092922
epoch: 22 s: 768000 batch_loss 0.07325071096420288 BPR_loss 0.06773941218852997 reg_loss 0.005511299706995487
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 67.14356136322021 | 71.02286720275879 | 28.45879364013672 | [0.16861815 0.23636142 0.28530631] | [0.13976683 0.16157252 0.17625872] | [0.05094782 0.03636211 0.02953145] | [0.55753902 0.66447853 0.72241945] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.07837752997875214 BPR_loss 0.07279020547866821 reg_loss 0.005587321240454912
epoch: 23 s: 256000 batch_loss 0.07245077937841415 BPR_loss 0.06684663891792297 reg_loss 0.005604139994829893
epoch: 23 s: 512000 batch_loss 0.0650445893406868 BPR_loss 0.059392061084508896 reg_loss 0.005652529187500477
epoch: 23 s: 768000 batch_loss 0.06448628008365631 BPR_loss 0.05876237899065018 reg_loss 0.005723900627344847
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 66.03969073295593 | 77.94808626174927 | 27.420427322387695 | [0.16940559 0.2371266  0.28614253] | [0.14048656 0.16227706 0.17698392] | [0.05112533 0.03646426 0.02959899] | [0.55867774 0.66591868 0.72442896] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.06562308967113495 BPR_loss 0.059876833111047745 reg_loss 0.0057462588883936405
epoch: 24 s: 256000 batch_loss 0.058663465082645416 BPR_loss 0.05308067426085472 reg_loss 0.005582790356129408
epoch: 24 s: 512000 batch_loss 0.07029329985380173 BPR_loss 0.06442402303218842 reg_loss 0.005869279615581036
epoch: 24 s: 768000 batch_loss 0.06869032979011536 BPR_loss 0.06277937442064285 reg_loss 0.005910955835133791
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 66.46773862838745 | 83.5240581035614 | 26.051055908203125 | [0.16886526 0.23663207 0.28654363] | [0.13993694 0.161767   0.1766943 ] | [0.05091265 0.03630602 0.02951414] | [0.55700315 0.66260299 0.72318976] |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.06343645602464676 BPR_loss 0.057524438947439194 reg_loss 0.005912015214562416
epoch: 25 s: 256000 batch_loss 0.0608711875975132 BPR_loss 0.054905690252780914 reg_loss 0.005965496879070997
epoch: 25 s: 512000 batch_loss 0.06717337667942047 BPR_loss 0.06129393354058266 reg_loss 0.005879443138837814
epoch: 25 s: 768000 batch_loss 0.0752483382821083 BPR_loss 0.06898102164268494 reg_loss 0.00626731663942337
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 66.33292770385742 | 75.81099104881287 | 25.273488998413086 | [0.16831551 0.23606226 0.28560062] | [0.13921241 0.16100948 0.17583082] | [0.05067319 0.03616786 0.02939246] | [0.55646728 0.66283743 0.72275437] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.053155798465013504 BPR_loss 0.04716847091913223 reg_loss 0.005987328477203846
epoch: 26 s: 256000 batch_loss 0.06040926277637482 BPR_loss 0.0543653666973114 reg_loss 0.006043896544724703
epoch: 26 s: 512000 batch_loss 0.05812888965010643 BPR_loss 0.05215173959732056 reg_loss 0.005977150052785873
epoch: 26 s: 768000 batch_loss 0.056331101804971695 BPR_loss 0.05022291839122772 reg_loss 0.006108184810727835
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 67.98548579216003 | 72.83135461807251 | 24.25872802734375 | [0.16808218 0.23637466 0.28553095] | [0.1393164  0.1612825  0.17601191] | [0.05067988 0.03619382 0.02940083] | [0.55506062 0.66427758 0.72251993] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.05380625277757645 BPR_loss 0.04784988611936569 reg_loss 0.005956367123872042
epoch: 27 s: 256000 batch_loss 0.052330534905195236 BPR_loss 0.04624413698911667 reg_loss 0.006086398847401142
epoch: 27 s: 512000 batch_loss 0.06432662904262543 BPR_loss 0.0580022931098938 reg_loss 0.006324336398392916
epoch: 27 s: 768000 batch_loss 0.06379801779985428 BPR_loss 0.057774242013692856 reg_loss 0.006023776717483997
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 62.5098180770874 | 74.06554889678955 | 23.301998138427734 | [0.16839074 0.23668211 0.28615748] | [0.1392793  0.16126067 0.17606013] | [0.05056601 0.03613939 0.02936343] | [0.5551611  0.66300489 0.72365865] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 28 s: 0 batch_loss 0.06439465284347534 BPR_loss 0.05818972736597061 reg_loss 0.0062049273401498795
epoch: 28 s: 256000 batch_loss 0.056768640875816345 BPR_loss 0.050306811928749084 reg_loss 0.006461830344051123
epoch: 28 s: 512000 batch_loss 0.04902004823088646 BPR_loss 0.042616743594408035 reg_loss 0.006403303239494562
epoch: 28 s: 768000 batch_loss 0.048529449850320816 BPR_loss 0.042064763605594635 reg_loss 0.006464685313403606
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   28  | 62.487956285476685 | 60.91705560684204 | 22.497434616088867 | [0.16820352 0.23693293 0.28638913] | [0.13877767 0.16090953 0.17576373] | [0.05038181 0.03604897 0.02935673] | [0.55375444 0.66457901 0.72315627] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 29 s: 0 batch_loss 0.05813115835189819 BPR_loss 0.05163584649562836 reg_loss 0.006495311856269836
epoch: 29 s: 256000 batch_loss 0.05021937936544418 BPR_loss 0.04380408674478531 reg_loss 0.0064152916893363
epoch: 29 s: 512000 batch_loss 0.060019806027412415 BPR_loss 0.05353071540594101 reg_loss 0.006489088758826256
epoch: 29 s: 768000 batch_loss 0.04943803697824478 BPR_loss 0.0429273396730423 reg_loss 0.006510695442557335
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   29  | 60.174673080444336 | 65.89265561103821 | 21.726898193359375 | [0.16867766 0.23672863 0.28586913] | [0.13930133 0.16120336 0.17594057] | [0.05062462 0.03614442 0.0293545 ] | [0.55683569 0.66347378 0.72332373] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 30 s: 0 batch_loss 0.05329363793134689 BPR_loss 0.04672461003065109 reg_loss 0.006569029297679663
epoch: 30 s: 256000 batch_loss 0.048017535358667374 BPR_loss 0.041191089898347855 reg_loss 0.006826446391642094
epoch: 30 s: 512000 batch_loss 0.04877445101737976 BPR_loss 0.04190587252378464 reg_loss 0.006868577096611261
epoch: 30 s: 768000 batch_loss 0.054960768669843674 BPR_loss 0.0484016053378582 reg_loss 0.006559164263308048
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   30  | 57.37913179397583 | 67.98631978034973 | 20.89537239074707 | [0.16816048 0.23614419 0.2853356 ] | [0.13906911 0.16092965 0.17570622] | [0.05042702 0.03596691 0.0292691 ] | [0.55502713 0.66340679 0.7230558 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 31 s: 0 batch_loss 0.046678416430950165 BPR_loss 0.04015783965587616 reg_loss 0.0065205772407352924
epoch: 31 s: 256000 batch_loss 0.04869662597775459 BPR_loss 0.041736021637916565 reg_loss 0.006960605271160603
epoch: 31 s: 512000 batch_loss 0.059308189898729324 BPR_loss 0.052671805024147034 reg_loss 0.006636385340243578
epoch: 31 s: 768000 batch_loss 0.049766551703214645 BPR_loss 0.042934611439704895 reg_loss 0.006831940729171038
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   31  | 58.37295460700989 | 67.71697282791138 | 20.456634521484375 | [0.16768216 0.23563154 0.28454117] | [0.13826416 0.16016813 0.17484361] | [0.05010215 0.03580447 0.02911559] | [0.55274968 0.66159823 0.72211803] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 32 s: 0 batch_loss 0.05052642524242401 BPR_loss 0.04393404722213745 reg_loss 0.006592376623302698
epoch: 32 s: 256000 batch_loss 0.0555354468524456 BPR_loss 0.048627614974975586 reg_loss 0.0069078318774700165
epoch: 32 s: 512000 batch_loss 0.04599510133266449 BPR_loss 0.039236776530742645 reg_loss 0.006758324336260557
epoch: 32 s: 768000 batch_loss 0.05028047785162926 BPR_loss 0.04312323406338692 reg_loss 0.007157242391258478
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   32  | 60.022193908691406 | 56.985010385513306 | 19.628938674926758 | [0.16740843 0.23520165 0.28451269] | [0.13792874 0.15981711 0.17460197] | [0.04995479 0.03572661 0.02908601] | [0.55274968 0.66102887 0.72352468] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 33 s: 0 batch_loss 0.0445488765835762 BPR_loss 0.03814692422747612 reg_loss 0.00640195282176137
epoch: 33 s: 256000 batch_loss 0.037928249686956406 BPR_loss 0.031157512217760086 reg_loss 0.006770738400518894
epoch: 33 s: 512000 batch_loss 0.046601273119449615 BPR_loss 0.03958744555711746 reg_loss 0.007013827562332153
epoch: 33 s: 768000 batch_loss 0.04377687722444534 BPR_loss 0.03705853223800659 reg_loss 0.006718344520777464
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   33  | 58.45453333854675 | 53.45687437057495 | 18.861434936523438 | [0.16780048 0.23601243 0.28443993] | [0.13818609 0.16015584 0.17470526] | [0.05011387 0.03582122 0.02909159] | [0.55335254 0.66333981 0.72302231] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.16780048009997534
early stopping at 33, recall@20:0.1694
