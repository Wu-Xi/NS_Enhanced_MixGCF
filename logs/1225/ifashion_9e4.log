Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ifashion', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.0009, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931484341621399 BPR_loss 0.693148136138916 reg_loss 2.892788586450479e-07
epoch: 0 s: 256000 batch_loss 0.6931460499763489 BPR_loss 0.6931439638137817 reg_loss 2.085298774545663e-06
epoch: 0 s: 512000 batch_loss 0.6931260824203491 BPR_loss 0.6931145191192627 reg_loss 1.1561727660591714e-05
epoch: 0 s: 768000 batch_loss 0.6930497884750366 BPR_loss 0.693004310131073 reg_loss 4.545152478385717e-05
epoch: 0 s: 1024000 batch_loss 0.6927911639213562 BPR_loss 0.6926561594009399 reg_loss 0.00013501862122211605
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 69.0048258304596 | 1067.0226271152496 | 424.81011962890625 | [0.07317213 0.1085965  0.13469358] | [0.03348682 0.0411109  0.04598704] | [0.00459239 0.00343857 0.00285726] | [0.08902833 0.13143535 0.16192853] |
|   0   | 69.0048258304596 | 1176.4937326908112 | 424.81011962890625 | [0.07317213 0.1085965  0.13469358] | [0.03348682 0.0411109  0.04598704] | [0.00459239 0.00343857 0.00285726] | [0.08902833 0.13143535 0.16192853] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6922423243522644 BPR_loss 0.6919577121734619 reg_loss 0.00028461363399401307
epoch: 1 s: 256000 batch_loss 0.6914085745811462 BPR_loss 0.6908593773841858 reg_loss 0.0005491794436238706
epoch: 1 s: 512000 batch_loss 0.6901748776435852 BPR_loss 0.689204752445221 reg_loss 0.0009701024391688406
epoch: 1 s: 768000 batch_loss 0.6885910034179688 BPR_loss 0.6871315836906433 reg_loss 0.0014594255480915308
epoch: 1 s: 1024000 batch_loss 0.6867635846138 BPR_loss 0.6847187280654907 reg_loss 0.0020448830910027027
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 84.21261096000671 | 1782.2208487987518 | 422.4311828613281 | [0.07935274 0.11691759 0.14470241] | [0.03664258 0.04472757 0.04992073] | [0.00497067 0.0036956  0.00306562] | [0.09631128 0.14111744 0.17351505] |
|   1   | 84.21261096000671 | 1977.789361000061  | 422.4311828613281 | [0.07935274 0.11691759 0.14470241] | [0.03664258 0.04472757 0.04992073] | [0.00497067 0.0036956  0.00306562] | [0.09631128 0.14111744 0.17351505] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6840754747390747 BPR_loss 0.6813513040542603 reg_loss 0.002724196296185255
epoch: 2 s: 256000 batch_loss 0.6810826063156128 BPR_loss 0.6776008605957031 reg_loss 0.0034817249979823828
epoch: 2 s: 512000 batch_loss 0.6778157353401184 BPR_loss 0.6732770204544067 reg_loss 0.0045387097634375095
epoch: 2 s: 768000 batch_loss 0.6744812726974487 BPR_loss 0.6690732836723328 reg_loss 0.005407992284744978
epoch: 2 s: 1024000 batch_loss 0.6707135438919067 BPR_loss 0.6641948223114014 reg_loss 0.006518704351037741
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 105.1810851097107 | 2122.723379611969  | 414.53839111328125 | [0.08157198 0.11986828 0.14787023] | [0.03775044 0.0459942  0.0512269 ] | [0.00510141 0.00379035 0.00313164] | [0.09883317 0.14455434 0.1770189 ] |
|   2   | 105.1810851097107 | 2052.7438294887543 | 414.53839111328125 | [0.08157198 0.11986828 0.14787023] | [0.03775044 0.0459942  0.0512269 ] | [0.00510141 0.00379035 0.00313164] | [0.09883317 0.14455434 0.1770189 ] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.665797233581543 BPR_loss 0.6583983898162842 reg_loss 0.007398832589387894
epoch: 3 s: 256000 batch_loss 0.6632488965988159 BPR_loss 0.6545183658599854 reg_loss 0.008730540983378887
epoch: 3 s: 512000 batch_loss 0.658528745174408 BPR_loss 0.6486846208572388 reg_loss 0.009844138287007809
epoch: 3 s: 768000 batch_loss 0.6542326211929321 BPR_loss 0.6431624293327332 reg_loss 0.01107021514326334
epoch: 3 s: 1024000 batch_loss 0.6492975354194641 BPR_loss 0.6370120048522949 reg_loss 0.012285505421459675
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 105.55459904670715 | 2078.6549682617188 | 402.4549865722656 | [0.08305178 0.12147769 0.14979732] | [0.03849954 0.04677673 0.05206515] | [0.00520315 0.00384224 0.00317237] | [0.10075991 0.14644389 0.1793548 ] |
|   3   | 105.55459904670715 | 1958.8795883655548 | 402.4549865722656 | [0.08305178 0.12147769 0.14979732] | [0.03849954 0.04677673 0.05206515] | [0.00520315 0.00384224 0.00317237] | [0.10075991 0.14644389 0.1793548 ] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.6446743011474609 BPR_loss 0.6313486099243164 reg_loss 0.01332566887140274
epoch: 4 s: 256000 batch_loss 0.6400443911552429 BPR_loss 0.6250479221343994 reg_loss 0.014996484853327274
epoch: 4 s: 512000 batch_loss 0.6351693868637085 BPR_loss 0.6187286376953125 reg_loss 0.01644074358046055
epoch: 4 s: 768000 batch_loss 0.6296236515045166 BPR_loss 0.6123009920120239 reg_loss 0.01732267253100872
epoch: 4 s: 1024000 batch_loss 0.6261261105537415 BPR_loss 0.6071839332580566 reg_loss 0.018942205235362053
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 106.35987305641174 | 2056.9677708148956 | 388.2134094238281 | [0.08412256 0.12275622 0.1510051 ] | [0.03898386 0.04730935 0.05258661] | [0.00527159 0.00388455 0.00319971] | [0.10208409 0.14800612 0.18084635] |
|   4   | 106.35987305641174 | 2028.1030359268188 | 388.2134094238281 | [0.08412256 0.12275622 0.1510051 ] | [0.03898386 0.04730935 0.05258661] | [0.00527159 0.00388455 0.00319971] | [0.10208409 0.14800612 0.18084635] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.619579017162323 BPR_loss 0.5998737812042236 reg_loss 0.01970524527132511
epoch: 5 s: 256000 batch_loss 0.6149526834487915 BPR_loss 0.593502402305603 reg_loss 0.021450266242027283
epoch: 5 s: 512000 batch_loss 0.6120249032974243 BPR_loss 0.5891556739807129 reg_loss 0.02286924608051777
epoch: 5 s: 768000 batch_loss 0.607947587966919 BPR_loss 0.5838065147399902 reg_loss 0.0241410955786705
epoch: 5 s: 1024000 batch_loss 0.5973897576332092 BPR_loss 0.5714815855026245 reg_loss 0.025908157229423523
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 100.79296445846558 | 2111.960129737854  | 373.4369201660156 | [0.08523435 0.12393824 0.15243763] | [0.03958393 0.04791734 0.05324136] | [0.00534189 0.00392072 0.00323195] | [0.10336734 0.14928937 0.1824495 ] |
|   5   | 100.79296445846558 | 1997.1384966373444 | 373.4369201660156 | [0.08523435 0.12393824 0.15243763] | [0.03958393 0.04791734 0.05324136] | [0.00534189 0.00392072 0.00323195] | [0.10336734 0.14928937 0.1824495 ] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.5971267819404602 BPR_loss 0.5702430009841919 reg_loss 0.026883792132139206
epoch: 6 s: 256000 batch_loss 0.588723361492157 BPR_loss 0.5605739951133728 reg_loss 0.02814936824142933
epoch: 6 s: 512000 batch_loss 0.5857229828834534 BPR_loss 0.5566467642784119 reg_loss 0.029076246544718742
epoch: 6 s: 768000 batch_loss 0.5852257013320923 BPR_loss 0.5539956092834473 reg_loss 0.03123006969690323
epoch: 6 s: 1024000 batch_loss 0.5793181657791138 BPR_loss 0.5474322438240051 reg_loss 0.03188590705394745
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 101.89979028701782 |  2066.93328499794  | 358.748779296875 | [0.08579744 0.12490237 0.1531543 ] | [0.03997561 0.04840248 0.05368767] | [0.0053789  0.00395308 0.00324894] | [0.10403687 0.15048336 0.18329384] |
|   6   | 101.89979028701782 | 2037.2707028388977 | 358.748779296875 | [0.08579744 0.12490237 0.1531543 ] | [0.03997561 0.04840248 0.05368767] | [0.0053789  0.00395308 0.00324894] | [0.10403687 0.15048336 0.18329384] |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.5702222585678101 BPR_loss 0.5370600819587708 reg_loss 0.033162184059619904
epoch: 7 s: 256000 batch_loss 0.5700304508209229 BPR_loss 0.5351063013076782 reg_loss 0.03492412716150284
epoch: 7 s: 512000 batch_loss 0.5620140433311462 BPR_loss 0.5253273844718933 reg_loss 0.036686643958091736
epoch: 7 s: 768000 batch_loss 0.5566443800926208 BPR_loss 0.5184906721115112 reg_loss 0.03815368190407753
epoch: 7 s: 1024000 batch_loss 0.5545514822006226 BPR_loss 0.5160459280014038 reg_loss 0.038505543023347855
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 127.30003237724304 | 2293.0551342964172 | 344.5978698730469 | [0.08653922 0.12550353 0.15352414] | [0.04030181 0.04869494 0.05394212] | [0.00542539 0.0039714  0.00325805] | [0.10488865 0.15104502 0.18369556] |
|   7   | 127.30003237724304 |  2408.4928586483   | 344.5978698730469 | [0.08653922 0.12550353 0.15352414] | [0.04030181 0.04869494 0.05394212] | [0.00542539 0.0039714  0.00325805] | [0.10488865 0.15104502 0.18369556] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.5500683188438416 BPR_loss 0.5101104378700256 reg_loss 0.03995787352323532
epoch: 8 s: 256000 batch_loss 0.5409404635429382 BPR_loss 0.49951010942459106 reg_loss 0.04143036529421806
epoch: 8 s: 512000 batch_loss 0.5368340015411377 BPR_loss 0.4935153126716614 reg_loss 0.04331868141889572
epoch: 8 s: 768000 batch_loss 0.5369971990585327 BPR_loss 0.4929018020629883 reg_loss 0.04409541189670563
epoch: 8 s: 1024000 batch_loss 0.5297780632972717 BPR_loss 0.4838065505027771 reg_loss 0.04597148671746254
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 168.69462847709656 | 2305.8399686813354 | 331.26239013671875 | [0.08658281 0.12566901 0.15375942] | [0.04038839 0.04880801 0.05406969] | [0.00543413 0.0039767  0.00326499] | [0.10500768 0.15139466 0.18392245] |
|   8   | 168.69462847709656 | 2371.201420068741  | 331.26239013671875 | [0.08658281 0.12566901 0.15375942] | [0.04038839 0.04880801 0.05406969] | [0.00543413 0.0039767  0.00326499] | [0.10500768 0.15139466 0.18392245] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.5296372175216675 BPR_loss 0.48202478885650635 reg_loss 0.047612447291612625
epoch: 9 s: 256000 batch_loss 0.5194006562232971 BPR_loss 0.4718850255012512 reg_loss 0.04751560837030411
epoch: 9 s: 512000 batch_loss 0.5222286581993103 BPR_loss 0.4741176664829254 reg_loss 0.0481109693646431
epoch: 9 s: 768000 batch_loss 0.5177872180938721 BPR_loss 0.4684061110019684 reg_loss 0.04938112944364548
epoch: 9 s: 1024000 batch_loss 0.5096501111984253 BPR_loss 0.4574713706970215 reg_loss 0.052178755402565
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 165.71142983436584 | 2338.937605381012  | 319.0926818847656 | [0.0869796  0.12614003 0.15382689] | [0.04055001 0.04898324 0.05416398] | [0.00546203 0.00399679 0.00326791] | [0.10547635 0.15196748 0.18411959] |
|   9   | 165.71142983436584 | 2350.2160573005676 | 319.0926818847656 | [0.0869796  0.12614003 0.15382689] | [0.04055001 0.04898324 0.05416398] | [0.00546203 0.00399679 0.00326791] | [0.10547635 0.15196748 0.18411959] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.5122388005256653 BPR_loss 0.46107518672943115 reg_loss 0.051163602620363235
epoch: 10 s: 256000 batch_loss 0.5123616456985474 BPR_loss 0.4596361815929413 reg_loss 0.05272545665502548
epoch: 10 s: 512000 batch_loss 0.5016034245491028 BPR_loss 0.44681626558303833 reg_loss 0.054787132889032364
epoch: 10 s: 768000 batch_loss 0.5033466815948486 BPR_loss 0.4481419026851654 reg_loss 0.05520479381084442
epoch: 10 s: 1024000 batch_loss 0.4988381266593933 BPR_loss 0.4416232109069824 reg_loss 0.057214900851249695
+-------+--------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 172.19953632354736 | 2345.7218687534332 | 307.67822265625 | [0.08731233 0.12613545 0.15397386] | [0.0407261  0.04909461 0.05430745] | [0.00547951 0.00399921 0.00327367] | [0.10584831 0.15202327 0.18430929] |
|   10  | 172.19953632354736 | 2363.4181015491486 | 307.67822265625 | [0.08731233 0.12613545 0.15397386] | [0.0407261  0.04909461 0.05430745] | [0.00547951 0.00399921 0.00327367] | [0.10584831 0.15202327 0.18430929] |
+-------+--------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.49553561210632324 BPR_loss 0.4379006028175354 reg_loss 0.05763500928878784
epoch: 11 s: 256000 batch_loss 0.49354052543640137 BPR_loss 0.43527886271476746 reg_loss 0.05826166272163391
epoch: 11 s: 512000 batch_loss 0.4873400330543518 BPR_loss 0.42663079500198364 reg_loss 0.06070925295352936
epoch: 11 s: 768000 batch_loss 0.48425111174583435 BPR_loss 0.424135684967041 reg_loss 0.060115423053503036
epoch: 11 s: 1024000 batch_loss 0.47643497586250305 BPR_loss 0.4152511656284332 reg_loss 0.06118381395936012
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 182.68158984184265 | 2349.846735715866 | 297.6010437011719 | [0.0873963  0.12612709 0.15380131] | [0.04083428 0.04917823 0.05436494] | [0.00548342 0.00399791 0.00327287] | [0.10591526 0.15205303 0.18412331] |
|   11  | 182.68158984184265 | 2408.316190958023 | 297.6010437011719 | [0.0873963  0.12612709 0.15380131] | [0.04083428 0.04917823 0.05436494] | [0.00548342 0.00399791 0.00327287] | [0.10591526 0.15205303 0.18412331] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.48050323128700256 BPR_loss 0.4168488681316376 reg_loss 0.0636543557047844
epoch: 12 s: 256000 batch_loss 0.4766559600830078 BPR_loss 0.4122421145439148 reg_loss 0.06441385298967361
epoch: 12 s: 512000 batch_loss 0.4776424467563629 BPR_loss 0.413063645362854 reg_loss 0.06457880139350891
epoch: 12 s: 768000 batch_loss 0.4671115577220917 BPR_loss 0.40068915486335754 reg_loss 0.06642240285873413
epoch: 12 s: 1024000 batch_loss 0.4710041880607605 BPR_loss 0.4048638939857483 reg_loss 0.06614027917385101
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 172.17658162117004 | 2373.701619386673  | 287.9501037597656 | [0.08716904 0.1256814  0.15358591] | [0.04081112 0.04911422 0.05433733] | [0.00547691 0.0039874  0.00326729] | [0.10575532 0.151536   0.1838741 ] |
|   12  | 172.17658162117004 | 2365.5600695610046 | 287.9501037597656 | [0.08716904 0.1256814  0.15358591] | [0.04081112 0.04911422 0.05433733] | [0.00547691 0.0039874  0.00326729] | [0.10575532 0.151536   0.1838741 ] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.457976758480072 BPR_loss 0.389748752117157 reg_loss 0.06822799146175385
epoch: 13 s: 256000 batch_loss 0.4557598829269409 BPR_loss 0.38553789258003235 reg_loss 0.07022197544574738
epoch: 13 s: 512000 batch_loss 0.4634086489677429 BPR_loss 0.39463549852371216 reg_loss 0.06877315044403076
epoch: 13 s: 768000 batch_loss 0.45460057258605957 BPR_loss 0.38314369320869446 reg_loss 0.07145686447620392
epoch: 13 s: 1024000 batch_loss 0.45137250423431396 BPR_loss 0.3797605335712433 reg_loss 0.07161197066307068
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 166.96557021141052 | 2298.343633413315 | 279.49713134765625 | [0.08706521 0.12544847 0.15327344] | [0.04084932 0.04912448 0.05433937] | [0.00547319 0.00398042 0.00326276] | [0.10563629 0.15123472 0.18353562] |
|   13  | 166.96557021141052 |  2372.76673913002 | 279.49713134765625 | [0.08706521 0.12544847 0.15327344] | [0.04084932 0.04912448 0.05433937] | [0.00547319 0.00398042 0.00326276] | [0.10563629 0.15123472 0.18353562] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.4476955235004425 BPR_loss 0.3751174807548523 reg_loss 0.07257803529500961
epoch: 14 s: 256000 batch_loss 0.45104604959487915 BPR_loss 0.37703755497932434 reg_loss 0.07400848716497421
epoch: 14 s: 512000 batch_loss 0.45013415813446045 BPR_loss 0.37795305252075195 reg_loss 0.07218112051486969
epoch: 14 s: 768000 batch_loss 0.4390726685523987 BPR_loss 0.3639140725135803 reg_loss 0.07515858113765717
epoch: 14 s: 1024000 batch_loss 0.440121591091156 BPR_loss 0.3640883266925812 reg_loss 0.07603326439857483
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 167.84812808036804 | 2294.472172021866  | 271.6644592285156 | [0.08692333 0.12535826 0.15292815] | [0.04072918 0.04901432 0.05418463] | [0.00546352 0.00397875 0.00325848] | [0.10546891 0.15111197 0.18320457] |
|   14  | 167.84812808036804 | 2310.9182436466217 | 271.6644592285156 | [0.08692333 0.12535826 0.15292815] | [0.04072918 0.04901432 0.05418463] | [0.00546352 0.00397875 0.00325848] | [0.10546891 0.15111197 0.18320457] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.4371057152748108 BPR_loss 0.36133983731269836 reg_loss 0.07576588541269302
epoch: 15 s: 256000 batch_loss 0.43630850315093994 BPR_loss 0.35808348655700684 reg_loss 0.07822500169277191
epoch: 15 s: 512000 batch_loss 0.429965615272522 BPR_loss 0.35210680961608887 reg_loss 0.0778588205575943
epoch: 15 s: 768000 batch_loss 0.431951642036438 BPR_loss 0.35308414697647095 reg_loss 0.07886750251054764
epoch: 15 s: 1024000 batch_loss 0.4317939281463623 BPR_loss 0.3520617187023163 reg_loss 0.07973221689462662
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 162.81395840644836 | 2341.5650250911713 | 264.5896301269531 | [0.08710008 0.12513921 0.15259014] | [0.04075884 0.048957   0.0541013 ] | [0.00547282 0.0039728  0.00325036] | [0.10558794 0.15084788 0.18279542] |
|   15  | 162.81395840644836 | 2350.359865427017  | 264.5896301269531 | [0.08710008 0.12513921 0.15259014] | [0.04075884 0.048957   0.0541013 ] | [0.00547282 0.0039728  0.00325036] | [0.10558794 0.15084788 0.18279542] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.422848105430603 BPR_loss 0.3426209092140198 reg_loss 0.08022721111774445
epoch: 16 s: 256000 batch_loss 0.4231444299221039 BPR_loss 0.3421347141265869 reg_loss 0.08100972324609756
epoch: 16 s: 512000 batch_loss 0.4274681508541107 BPR_loss 0.34670647978782654 reg_loss 0.08076167851686478
epoch: 16 s: 768000 batch_loss 0.41947704553604126 BPR_loss 0.3366268277168274 reg_loss 0.08285021036863327
epoch: 16 s: 1024000 batch_loss 0.41757357120513916 BPR_loss 0.3334711194038391 reg_loss 0.08410246670246124
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 168.3503429889679 | 2301.151675462723  | 258.10540771484375 | [0.08644676 0.12457145 0.15223996] | [0.04061609 0.04884347 0.05402663] | [0.00544306 0.00395904 0.00324453] | [0.10502256 0.15029738 0.18245694] |
|   16  | 168.3503429889679 | 2381.5010738372803 | 258.10540771484375 | [0.08644676 0.12457145 0.15223996] | [0.04061609 0.04884347 0.05402663] | [0.00544306 0.00395904 0.00324453] | [0.10502256 0.15029738 0.18245694] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.4214121699333191 BPR_loss 0.33726561069488525 reg_loss 0.08414655178785324
epoch: 17 s: 256000 batch_loss 0.4152616560459137 BPR_loss 0.3311934471130371 reg_loss 0.08406820893287659
epoch: 17 s: 512000 batch_loss 0.4152924716472626 BPR_loss 0.3298242688179016 reg_loss 0.08546819537878036
epoch: 17 s: 768000 batch_loss 0.4063724875450134 BPR_loss 0.3200204074382782 reg_loss 0.08635207265615463
epoch: 17 s: 1024000 batch_loss 0.41300320625305176 BPR_loss 0.32571786642074585 reg_loss 0.0872853547334671
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 162.56156373023987 |  2300.34907579422  | 251.97035217285156 | [0.08648859 0.12429342 0.15196538] | [0.04054928 0.04870222 0.05388795] | [0.00544008 0.00395011 0.00324063] | [0.10499652 0.14997378 0.18218541] |
|   17  | 162.56156373023987 | 2334.5815019607544 | 251.97035217285156 | [0.08648859 0.12429342 0.15196538] | [0.04054928 0.04870222 0.05388795] | [0.00544008 0.00395011 0.00324063] | [0.10499652 0.14997378 0.18218541] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.4012307822704315 BPR_loss 0.3134620189666748 reg_loss 0.08776875585317612
epoch: 18 s: 256000 batch_loss 0.40411001443862915 BPR_loss 0.3167704939842224 reg_loss 0.08733951300382614
epoch: 18 s: 512000 batch_loss 0.40640512108802795 BPR_loss 0.31738781929016113 reg_loss 0.08901730924844742
epoch: 18 s: 768000 batch_loss 0.4017511308193207 BPR_loss 0.31170469522476196 reg_loss 0.09004643559455872
epoch: 18 s: 1024000 batch_loss 0.3935469090938568 BPR_loss 0.3037545084953308 reg_loss 0.089792400598526
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 176.13656854629517 | 2322.1083765029907 | 246.62966918945312 | [0.08611885 0.1238408  0.1513833 ] | [0.04041507 0.04855077 0.05371386] | [0.00542353 0.0039383  0.00323009] | [0.10460597 0.14951255 0.18154564] |
|   18  | 176.13656854629517 | 2320.512614965439  | 246.62966918945312 | [0.08611885 0.1238408  0.1513833 ] | [0.04041507 0.04855077 0.05371386] | [0.00542353 0.0039383  0.00323009] | [0.10460597 0.14951255 0.18154564] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.4047066271305084 BPR_loss 0.3146994113922119 reg_loss 0.09000720828771591
epoch: 19 s: 256000 batch_loss 0.40295353531837463 BPR_loss 0.31083226203918457 reg_loss 0.09212126582860947
epoch: 19 s: 512000 batch_loss 0.4064340591430664 BPR_loss 0.31479141116142273 reg_loss 0.09164264798164368
epoch: 19 s: 768000 batch_loss 0.3935704827308655 BPR_loss 0.30058401823043823 reg_loss 0.09298644959926605
epoch: 19 s: 1024000 batch_loss 0.3862021267414093 BPR_loss 0.29438459873199463 reg_loss 0.09181752055883408
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 99.30898356437683 | 2065.3324480056763 | 241.8845977783203 | [0.08582388 0.1233899  0.15077467] | [0.04023636 0.04834589 0.05348421] | [0.00540549 0.00392556 0.00321999] | [0.10428608 0.14906248 0.18090587] |
|   19  | 99.30898356437683 | 2046.012766122818  | 241.8845977783203 | [0.08582388 0.1233899  0.15077467] | [0.04023636 0.04834589 0.05348421] | [0.00540549 0.00392556 0.00321999] | [0.10428608 0.14906248 0.18090587] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.39232948422431946 BPR_loss 0.2975788116455078 reg_loss 0.09475068002939224
epoch: 20 s: 256000 batch_loss 0.391426682472229 BPR_loss 0.296766996383667 reg_loss 0.09465967863798141
epoch: 20 s: 512000 batch_loss 0.39550483226776123 BPR_loss 0.30121028423309326 reg_loss 0.09429454803466797
epoch: 20 s: 768000 batch_loss 0.38543039560317993 BPR_loss 0.29087018966674805 reg_loss 0.09456020593643188
epoch: 20 s: 1024000 batch_loss 0.39165198802948 BPR_loss 0.2951582372188568 reg_loss 0.09649375826120377
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 96.7788438796997 | 2042.0408296585083 | 237.2965850830078 | [0.08569254 0.12308785 0.15022614] | [0.04015639 0.04822124 0.0533161 ] | [0.00539675 0.00391496 0.00320814] | [0.10417077 0.14866076 0.18024378] |
|   20  | 96.7788438796997 | 2025.8608691692352 | 237.2965850830078 | [0.08569254 0.12308785 0.15022614] | [0.04015639 0.04822124 0.0533161 ] | [0.00539675 0.00391496 0.00320814] | [0.10417077 0.14866076 0.18024378] |
+-------+------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.3831372857093811 BPR_loss 0.2868404984474182 reg_loss 0.0962967798113823
epoch: 21 s: 256000 batch_loss 0.38101381063461304 BPR_loss 0.28331881761550903 reg_loss 0.09769498556852341
epoch: 21 s: 512000 batch_loss 0.3783394694328308 BPR_loss 0.28129681944847107 reg_loss 0.09704264998435974
epoch: 21 s: 768000 batch_loss 0.37934964895248413 BPR_loss 0.2803940176963806 reg_loss 0.09895562380552292
epoch: 21 s: 1024000 batch_loss 0.3717294931411743 BPR_loss 0.27289509773254395 reg_loss 0.09883439540863037
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 96.33397245407104 | 2065.084974527359 | 233.30918884277344 | [0.08517346 0.12237725 0.14971944] | [0.03997098 0.04800195 0.05313786] | [0.00536718 0.00389376 0.00319996] | [0.10356076 0.14780154 0.17970816] |
|   21  | 96.33397245407104 | 1992.562088251114 | 233.30918884277344 | [0.08517346 0.12237725 0.14971944] | [0.03997098 0.04800195 0.05313786] | [0.00536718 0.00389376 0.00319996] | [0.10356076 0.14780154 0.17970816] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.08517346197268712
early stopping at 21, recall@20:0.0874
