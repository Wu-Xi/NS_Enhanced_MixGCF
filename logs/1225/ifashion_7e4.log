Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ifashion', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.0007, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931483745574951 BPR_loss 0.693148136138916 reg_loss 2.2499466467706952e-07
epoch: 0 s: 256000 batch_loss 0.6931450963020325 BPR_loss 0.6931432485580444 reg_loss 1.8532722378949984e-06
epoch: 0 s: 512000 batch_loss 0.6931189298629761 BPR_loss 0.6931076049804688 reg_loss 1.1310592526569963e-05
epoch: 0 s: 768000 batch_loss 0.6930149793624878 BPR_loss 0.6929681301116943 reg_loss 4.687875116360374e-05
epoch: 0 s: 1024000 batch_loss 0.6926810145378113 BPR_loss 0.6925387978553772 reg_loss 0.0001421969209332019
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 68.10675549507141 | 1059.211139678955  | 424.7796936035156 | [0.07459578 0.11012507 0.13641254] | [0.03425233 0.04189525 0.04681313] | [0.00467292 0.00347874 0.00289043] | [0.09068727 0.13324307 0.16395571] |
|   0   | 68.10675549507141 | 1195.6959285736084 | 424.7796936035156 | [0.07459578 0.11012507 0.13641254] | [0.03425233 0.04189525 0.04681313] | [0.00467292 0.00347874 0.00289043] | [0.09068727 0.13324307 0.16395571] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6919411420822144 BPR_loss 0.6916393637657166 reg_loss 0.0003017642884515226
epoch: 1 s: 256000 batch_loss 0.690911591053009 BPR_loss 0.6903356313705444 reg_loss 0.0005759786581620574
epoch: 1 s: 512000 batch_loss 0.689325749874115 BPR_loss 0.6883127689361572 reg_loss 0.0010129528818652034
epoch: 1 s: 768000 batch_loss 0.6875259280204773 BPR_loss 0.686013400554657 reg_loss 0.001512513030320406
epoch: 1 s: 1024000 batch_loss 0.6851553916931152 BPR_loss 0.6830374002456665 reg_loss 0.00211798632517457
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 85.16487002372742 | 1780.9998698234558 | 421.78985595703125 | [0.08029036 0.11811337 0.14645392] | [0.03712108 0.04524979 0.05054316] | [0.00502479 0.00372749 0.00309662] | [0.09749411 0.14244533 0.17543435] |
|   1   | 85.16487002372742 | 2019.0443720817566 | 421.78985595703125 | [0.08029036 0.11811337 0.14645392] | [0.03712108 0.04524979 0.05054316] | [0.00502479 0.00372749 0.00309662] | [0.09749411 0.14244533 0.17543435] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.681969404220581 BPR_loss 0.679169774055481 reg_loss 0.002799635985866189
epoch: 2 s: 256000 batch_loss 0.678490161895752 BPR_loss 0.6749404668807983 reg_loss 0.0035497096832841635
epoch: 2 s: 512000 batch_loss 0.6744645833969116 BPR_loss 0.669844388961792 reg_loss 0.004620182327926159
epoch: 2 s: 768000 batch_loss 0.6708481907844543 BPR_loss 0.6654012203216553 reg_loss 0.005446989554911852
epoch: 2 s: 1024000 batch_loss 0.6659513115882874 BPR_loss 0.6594071388244629 reg_loss 0.006544193718582392
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 103.63728666305542 | 2028.9160871505737 | 412.376708984375 | [0.0824194  0.12129552 0.14921814] | [0.03826307 0.04661557 0.05183697] | [0.00516037 0.0038282  0.00315843] | [0.10000112 0.14610169 0.17863692] |
|   2   | 103.63728666305542 | 1983.5127160549164 | 412.376708984375 | [0.0824194  0.12129552 0.14921814] | [0.03826307 0.04661557 0.05183697] | [0.00516037 0.0038282  0.00315843] | [0.10000112 0.14610169 0.17863692] |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6611708402633667 BPR_loss 0.6537603139877319 reg_loss 0.007410525344312191
epoch: 3 s: 256000 batch_loss 0.6577760577201843 BPR_loss 0.6490349173545837 reg_loss 0.008741161786019802
epoch: 3 s: 512000 batch_loss 0.6528080105781555 BPR_loss 0.6430728435516357 reg_loss 0.009735161438584328
epoch: 3 s: 768000 batch_loss 0.6479405760765076 BPR_loss 0.6369863748550415 reg_loss 0.0109541742131114
epoch: 3 s: 1024000 batch_loss 0.6430510878562927 BPR_loss 0.6309208869934082 reg_loss 0.012130210176110268
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 96.38825488090515 | 2028.423018693924  | 398.5028991699219 | [0.08375746 0.12315455 0.15149558] | [0.03903141 0.04750886 0.05280741] | [0.00524629 0.00389171 0.00320641] | [0.10158566 0.14832972 0.18123691] |
|   3   | 96.38825488090515 | 2026.6042411327362 | 398.5028991699219 | [0.08375746 0.12315455 0.15149558] | [0.03903141 0.04750886 0.05280741] | [0.00524629 0.00389171 0.00320641] | [0.10158566 0.14832972 0.18123691] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.6358872652053833 BPR_loss 0.6227869391441345 reg_loss 0.013100331649184227
epoch: 4 s: 256000 batch_loss 0.6318225264549255 BPR_loss 0.6171684861183167 reg_loss 0.014654035679996014
epoch: 4 s: 512000 batch_loss 0.625300407409668 BPR_loss 0.609188437461853 reg_loss 0.016111982986330986
epoch: 4 s: 768000 batch_loss 0.6197202801704407 BPR_loss 0.6028292179107666 reg_loss 0.016891058534383774
epoch: 4 s: 1024000 batch_loss 0.6154299974441528 BPR_loss 0.5970659255981445 reg_loss 0.018364068120718002
+-------+-------------------+--------------------+-------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |     Loss    |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 95.70038414001465 | 2004.581375360489  | 382.5078125 | [0.08503558 0.12503027 0.15309708] | [0.03961244 0.04821875 0.0534675 ] | [0.00532422 0.00395011 0.00324162] | [0.10313301 0.15047592 0.1831339 ] |
|   4   | 95.70038414001465 | 2047.5408985614777 | 382.5078125 | [0.08503558 0.12503027 0.15309708] | [0.03961244 0.04821875 0.0534675 ] | [0.00532422 0.00395011 0.00324162] | [0.10313301 0.15047592 0.1831339 ] |
+-------+-------------------+--------------------+-------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.60893315076828 BPR_loss 0.5898966789245605 reg_loss 0.019036443904042244
epoch: 5 s: 256000 batch_loss 0.6043878793716431 BPR_loss 0.583624005317688 reg_loss 0.020763861015439034
epoch: 5 s: 512000 batch_loss 0.6003767251968384 BPR_loss 0.578370213508606 reg_loss 0.022006500512361526
epoch: 5 s: 768000 batch_loss 0.5965102910995483 BPR_loss 0.5732176303863525 reg_loss 0.023292671889066696
epoch: 5 s: 1024000 batch_loss 0.5828930139541626 BPR_loss 0.5580919981002808 reg_loss 0.02480103075504303
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 95.05450654029846 |  2007.45360994339 | 366.1646423339844 | [0.08652219 0.12607345 0.15426972] | [0.04032224 0.04883002 0.05410121] | [0.00542241 0.00398535 0.00326679] | [0.10490353 0.15174802 0.18443576] |
|   5   | 95.05450654029846 | 2047.339664697647 | 366.1646423339844 | [0.08652219 0.12607345 0.15426972] | [0.04032224 0.04883002 0.05410121] | [0.00542241 0.00398535 0.00326679] | [0.10490353 0.15174802 0.18443576] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.5851656198501587 BPR_loss 0.5593628883361816 reg_loss 0.025802742689847946
epoch: 6 s: 256000 batch_loss 0.5769688487052917 BPR_loss 0.5500203371047974 reg_loss 0.02694852277636528
epoch: 6 s: 512000 batch_loss 0.573815643787384 BPR_loss 0.5460418462753296 reg_loss 0.027773790061473846
epoch: 6 s: 768000 batch_loss 0.5726587176322937 BPR_loss 0.5428136587142944 reg_loss 0.029845060780644417
epoch: 6 s: 1024000 batch_loss 0.5640236139297485 BPR_loss 0.5337247848510742 reg_loss 0.03029884397983551
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 96.46370768547058 | 1995.5241413116455 | 350.1593017578125 | [0.08700623 0.12679375 0.15550208] | [0.04068792 0.04925326 0.0546133 ] | [0.00545682 0.00401065 0.00329171] | [0.10559538 0.15260353 0.18575621] |
|   6   | 96.46370768547058 | 2071.546830892563  | 350.1593017578125 | [0.08700623 0.12679375 0.15550208] | [0.04068792 0.04925326 0.0546133 ] | [0.00545682 0.00401065 0.00329171] | [0.10559538 0.15260353 0.18575621] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.5543402433395386 BPR_loss 0.5228188037872314 reg_loss 0.03152146562933922
epoch: 7 s: 256000 batch_loss 0.5550488233566284 BPR_loss 0.521908700466156 reg_loss 0.0331401526927948
epoch: 7 s: 512000 batch_loss 0.5469337701797485 BPR_loss 0.5122026801109314 reg_loss 0.03473107889294624
epoch: 7 s: 768000 batch_loss 0.5403265953063965 BPR_loss 0.5041385889053345 reg_loss 0.036187995225191116
epoch: 7 s: 1024000 batch_loss 0.5379415154457092 BPR_loss 0.5015578269958496 reg_loss 0.03638366609811783
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 95.64574790000916 | 2221.8294117450714 | 334.8805847167969 | [0.08747087 0.12743713 0.15588657] | [0.04093794 0.04954133 0.05486154] | [0.00548937 0.00403324 0.00330467] | [0.10616819 0.15346647 0.18634763] |
|   7   | 95.64574790000916 | 2426.6275339126587 | 334.8805847167969 | [0.08747087 0.12743713 0.15588657] | [0.04093794 0.04954133 0.05486154] | [0.00548937 0.00403324 0.00330467] | [0.10616819 0.15346647 0.18634763] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.5333583950996399 BPR_loss 0.4956887364387512 reg_loss 0.03766964003443718
epoch: 8 s: 256000 batch_loss 0.5234812498092651 BPR_loss 0.48437023162841797 reg_loss 0.03911101818084717
epoch: 8 s: 512000 batch_loss 0.5173431634902954 BPR_loss 0.4765135645866394 reg_loss 0.0408296212553978
epoch: 8 s: 768000 batch_loss 0.521361768245697 BPR_loss 0.4800833463668823 reg_loss 0.041278425604104996
epoch: 8 s: 1024000 batch_loss 0.5099826455116272 BPR_loss 0.46670636534690857 reg_loss 0.04327629879117012
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 163.2924563884735 | 2238.897571325302 | 320.5589599609375 | [0.08804501 0.12760266 0.15631306] | [0.04121051 0.04972507 0.05509559] | [0.00552396 0.00403938 0.00331589] | [0.10681912 0.15366733 0.18687953] |
|   8   | 163.2924563884735 | 2418.266121149063 | 320.5589599609375 | [0.08804501 0.12760266 0.15631306] | [0.04121051 0.04972507 0.05509559] | [0.00552396 0.00403938 0.00331589] | [0.10681912 0.15366733 0.18687953] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.5113896131515503 BPR_loss 0.46673697233200073 reg_loss 0.04465263709425926
epoch: 9 s: 256000 batch_loss 0.5010578036308289 BPR_loss 0.4564701318740845 reg_loss 0.04458769038319588
epoch: 9 s: 512000 batch_loss 0.5007539987564087 BPR_loss 0.4558364152908325 reg_loss 0.044917576014995575
epoch: 9 s: 768000 batch_loss 0.5009498000144958 BPR_loss 0.4548109173774719 reg_loss 0.046138864010572433
epoch: 9 s: 1024000 batch_loss 0.4872865080833435 BPR_loss 0.4385891854763031 reg_loss 0.0486973375082016
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 160.4834427833557 | 2220.5444815158844 | 307.5374450683594 | [0.0880891  0.12771488 0.15650734] | [0.04120419 0.04973703 0.05511754] | [0.005534   0.00404682 0.00332066] | [0.10692699 0.15384215 0.18709898] |
|   9   | 160.4834427833557 | 2405.501665353775  | 307.5374450683594 | [0.0880891  0.12771488 0.15650734] | [0.04120419 0.04973703 0.05511754] | [0.005534   0.00404682 0.00332066] | [0.10692699 0.15384215 0.18709898] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.4948113262653351 BPR_loss 0.4471237063407898 reg_loss 0.04768760874867439
epoch: 10 s: 256000 batch_loss 0.4962216019630432 BPR_loss 0.44701820611953735 reg_loss 0.04920339956879616
epoch: 10 s: 512000 batch_loss 0.4837568998336792 BPR_loss 0.43276965618133545 reg_loss 0.050987232476472855
epoch: 10 s: 768000 batch_loss 0.47981035709381104 BPR_loss 0.42844682931900024 reg_loss 0.051363538950681686
epoch: 10 s: 1024000 batch_loss 0.4784368872642517 BPR_loss 0.42531245946884155 reg_loss 0.05312443897128105
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 163.47269535064697 | 2275.686327457428  | 295.482666015625 | [0.08825824 0.12782043 0.15665599] | [0.04129494 0.04981198 0.05520983] | [0.00554684 0.00404877 0.00332692] | [0.10713529 0.15390538 0.18742631] |
|   10  | 163.47269535064697 | 2457.3023171424866 | 295.482666015625 | [0.08825824 0.12782043 0.15665599] | [0.04129494 0.04981198 0.05520983] | [0.00554684 0.00404877 0.00332692] | [0.10713529 0.15390538 0.18742631] |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.4749751687049866 BPR_loss 0.42138737440109253 reg_loss 0.05358780547976494
epoch: 11 s: 256000 batch_loss 0.475250780582428 BPR_loss 0.42107951641082764 reg_loss 0.05417127162218094
epoch: 11 s: 512000 batch_loss 0.4658486247062683 BPR_loss 0.40949371457099915 reg_loss 0.05635491758584976
epoch: 11 s: 768000 batch_loss 0.4638352394104004 BPR_loss 0.40832269191741943 reg_loss 0.05551254376769066
epoch: 11 s: 1024000 batch_loss 0.45604926347732544 BPR_loss 0.399260938167572 reg_loss 0.05678833648562431
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 159.2783658504486 | 2279.808937549591 | 284.75689697265625 | [0.0884337  0.12780565 0.1562273 ] | [0.0415516  0.05003906 0.05536009] | [0.00555595 0.00405361 0.00332122] | [0.10734358 0.15397977 0.18698739] |
|   11  | 159.2783658504486 | 2437.462478160858 | 284.75689697265625 | [0.0884337  0.12780565 0.1562273 ] | [0.0415516  0.05003906 0.05536009] | [0.00555595 0.00405361 0.00332122] | [0.10734358 0.15397977 0.18698739] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.4627774953842163 BPR_loss 0.4038674235343933 reg_loss 0.0589100681245327
epoch: 12 s: 256000 batch_loss 0.45550820231437683 BPR_loss 0.39592742919921875 reg_loss 0.059580784291028976
epoch: 12 s: 512000 batch_loss 0.4549257457256317 BPR_loss 0.39545494318008423 reg_loss 0.059470806270837784
epoch: 12 s: 768000 batch_loss 0.4474254548549652 BPR_loss 0.38611066341400146 reg_loss 0.06131479889154434
epoch: 12 s: 1024000 batch_loss 0.44826555252075195 BPR_loss 0.38721194863319397 reg_loss 0.06105358898639679
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 164.8604655265808 | 2246.2666931152344 | 274.5730895996094 | [0.08840402 0.12772026 0.15620476] | [0.04147675 0.04994943 0.05527943] | [0.00555595 0.00405212 0.0033211 ] | [0.10734358 0.15390538 0.18690184] |
|   12  | 164.8604655265808 | 2444.2651329040527 | 274.5730895996094 | [0.08840402 0.12772026 0.15620476] | [0.04147675 0.04994943 0.05527943] | [0.00555595 0.00405212 0.0033211 ] | [0.10734358 0.15390538 0.18690184] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.4388713240623474 BPR_loss 0.3761930465698242 reg_loss 0.06267829239368439
epoch: 13 s: 256000 batch_loss 0.43392184376716614 BPR_loss 0.36916205286979675 reg_loss 0.06475978344678879
epoch: 13 s: 512000 batch_loss 0.4454817771911621 BPR_loss 0.38202160596847534 reg_loss 0.06346017122268677
epoch: 13 s: 768000 batch_loss 0.4284695088863373 BPR_loss 0.36266523599624634 reg_loss 0.06580426543951035
epoch: 13 s: 1024000 batch_loss 0.4278733432292938 BPR_loss 0.3623162806034088 reg_loss 0.06555706262588501
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 155.58316564559937 | 2229.233904361725  | 265.7713317871094 | [0.08842802 0.12735777 0.15576401] | [0.04150068 0.04989495 0.05521368] | [0.0055593  0.00404235 0.00331459] | [0.10738078 0.15354086 0.18650757] |
|   13  | 155.58316564559937 | 2404.0723354816437 | 265.7713317871094 | [0.08842802 0.12735777 0.15576401] | [0.04150068 0.04989495 0.05521368] | [0.0055593  0.00404235 0.00331459] | [0.10738078 0.15354086 0.18650757] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.42276832461357117 BPR_loss 0.3560406267642975 reg_loss 0.06672769784927368
epoch: 14 s: 256000 batch_loss 0.4270476698875427 BPR_loss 0.35906580090522766 reg_loss 0.06798186153173447
epoch: 14 s: 512000 batch_loss 0.4277190864086151 BPR_loss 0.3614678978919983 reg_loss 0.06625118851661682
epoch: 14 s: 768000 batch_loss 0.420637309551239 BPR_loss 0.35152703523635864 reg_loss 0.06911028921604156
epoch: 14 s: 1024000 batch_loss 0.41895413398742676 BPR_loss 0.3491370975971222 reg_loss 0.06981704384088516
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 155.11047840118408 | 2244.549541950226 | 257.5339660644531 | [0.08826157 0.12722885 0.15540868] | [0.04140753 0.04980593 0.05508721] | [0.0055513  0.00403789 0.00330715] | [0.1071762  0.15335488 0.1860575 ] |
|   14  | 155.11047840118408 | 2384.471274614334 | 257.5339660644531 | [0.08826157 0.12722885 0.15540868] | [0.04140753 0.04980593 0.05508721] | [0.0055513  0.00403789 0.00330715] | [0.1071762  0.15335488 0.1860575 ] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.41492047905921936 BPR_loss 0.3453305959701538 reg_loss 0.06958987563848495
epoch: 15 s: 256000 batch_loss 0.4108644723892212 BPR_loss 0.33922719955444336 reg_loss 0.07163728773593903
epoch: 15 s: 512000 batch_loss 0.40865495800971985 BPR_loss 0.3372759222984314 reg_loss 0.07137902826070786
epoch: 15 s: 768000 batch_loss 0.4106867015361786 BPR_loss 0.33840736746788025 reg_loss 0.07227934151887894
epoch: 15 s: 1024000 batch_loss 0.40916216373443604 BPR_loss 0.33619463443756104 reg_loss 0.072967529296875
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 158.7672667503357 | 2274.314553260803  | 250.0723419189453 | [0.08826844 0.12712407 0.15509882] | [0.04140172 0.04976853 0.05501549] | [0.00555967 0.00403315 0.00330182] | [0.10725431 0.15314287 0.18575621] |
|   15  | 158.7672667503357 | 2496.5073421001434 | 250.0723419189453 | [0.08826844 0.12712407 0.15509882] | [0.04140172 0.04976853 0.05501549] | [0.00555967 0.00403315 0.00330182] | [0.10725431 0.15314287 0.18575621] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.39373525977134705 BPR_loss 0.3204415440559387 reg_loss 0.07329372316598892
epoch: 16 s: 256000 batch_loss 0.4019923210144043 BPR_loss 0.32802441716194153 reg_loss 0.07396790385246277
epoch: 16 s: 512000 batch_loss 0.40344807505607605 BPR_loss 0.3298017978668213 reg_loss 0.07364628463983536
epoch: 16 s: 768000 batch_loss 0.39321014285087585 BPR_loss 0.3174898624420166 reg_loss 0.07572028040885925
epoch: 16 s: 1024000 batch_loss 0.3974544405937195 BPR_loss 0.3206198811531067 reg_loss 0.07683455944061279
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 159.96051573753357 | 2232.4275982379913 | 243.27183532714844 | [0.08789446 0.12667091 0.15472355] | [0.04122091 0.04957905 0.05483654] | [0.00553121 0.00402227 0.00329524] | [0.10675961 0.15268908 0.18538053] |
|   16  | 159.96051573753357 | 2430.615740299225  | 243.27183532714844 | [0.08789446 0.12667091 0.15472355] | [0.04122091 0.04957905 0.05483654] | [0.00553121 0.00402227 0.00329524] | [0.10675961 0.15268908 0.18538053] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.393513560295105 BPR_loss 0.31658339500427246 reg_loss 0.07693016529083252
epoch: 17 s: 256000 batch_loss 0.3852897584438324 BPR_loss 0.3087148368358612 reg_loss 0.07657492160797119
epoch: 17 s: 512000 batch_loss 0.39896535873413086 BPR_loss 0.32093632221221924 reg_loss 0.07802902162075043
epoch: 17 s: 768000 batch_loss 0.3802145719528198 BPR_loss 0.30141621828079224 reg_loss 0.0787983387708664
epoch: 17 s: 1024000 batch_loss 0.38974303007125854 BPR_loss 0.310124933719635 reg_loss 0.07961811125278473
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 160.15834856033325 | 2297.988038778305 | 236.8463592529297 | [0.08790082 0.12648736 0.15431733] | [0.04127301 0.04958844 0.05480788] | [0.00553251 0.00401836 0.00328991] | [0.10677077 0.1525031  0.18498626] |
|   17  | 160.15834856033325 | 2406.169015645981 | 236.8463592529297 | [0.08790082 0.12648736 0.15431733] | [0.04127301 0.04958844 0.05480788] | [0.00553251 0.00401836 0.00328991] | [0.10677077 0.1525031  0.18498626] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.3761954605579376 BPR_loss 0.29642200469970703 reg_loss 0.07977346330881119
epoch: 18 s: 256000 batch_loss 0.3778296411037445 BPR_loss 0.2982773184776306 reg_loss 0.0795523151755333
epoch: 18 s: 512000 batch_loss 0.3800005316734314 BPR_loss 0.2988380789756775 reg_loss 0.08116244524717331
epoch: 18 s: 768000 batch_loss 0.377341628074646 BPR_loss 0.2953495383262634 reg_loss 0.08199208229780197
epoch: 18 s: 1024000 batch_loss 0.3731662929058075 BPR_loss 0.29145270586013794 reg_loss 0.08171358704566956
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 168.03463673591614 | 2272.0554299354553 | 231.3153839111328 | [0.08779422 0.12594402 0.15373408] | [0.04115261 0.04937359 0.05458467] | [0.00553028 0.00400209 0.00327727] | [0.10667034 0.15184101 0.18435393] |
|   18  | 168.03463673591614 | 2363.511797428131  | 231.3153839111328 | [0.08779422 0.12594402 0.15373408] | [0.04115261 0.04937359 0.05458467] | [0.00553028 0.00400209 0.00327727] | [0.10667034 0.15184101 0.18435393] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.38007208704948425 BPR_loss 0.29824912548065186 reg_loss 0.0818229615688324
epoch: 19 s: 256000 batch_loss 0.37597987055778503 BPR_loss 0.2923036217689514 reg_loss 0.08367624878883362
epoch: 19 s: 512000 batch_loss 0.3798239827156067 BPR_loss 0.2963380515575409 reg_loss 0.08348594605922699
epoch: 19 s: 768000 batch_loss 0.36642712354660034 BPR_loss 0.2820066809654236 reg_loss 0.08442044258117676
epoch: 19 s: 1024000 batch_loss 0.3556770384311676 BPR_loss 0.2724566161632538 reg_loss 0.08322042971849442
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 173.1503074169159 | 2048.3322587013245 | 226.2828369140625 | [0.08734842 0.12559229 0.15341978] | [0.04098096 0.04922146 0.0544414 ] | [0.00551001 0.00399279 0.00327194] | [0.10632442 0.15151369 0.18391501] |
|   19  | 173.1503074169159 |  2111.55006814003  | 226.2828369140625 | [0.08734842 0.12559229 0.15341978] | [0.04098096 0.04922146 0.0544414 ] | [0.00551001 0.00399279 0.00327194] | [0.10632442 0.15151369 0.18391501] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.3673095107078552 BPR_loss 0.28108134865760803 reg_loss 0.0862281545996666
epoch: 20 s: 256000 batch_loss 0.36515718698501587 BPR_loss 0.27911829948425293 reg_loss 0.08603890240192413
epoch: 20 s: 512000 batch_loss 0.378298282623291 BPR_loss 0.2928202450275421 reg_loss 0.0854780524969101
epoch: 20 s: 768000 batch_loss 0.3607179522514343 BPR_loss 0.2748015522956848 reg_loss 0.08591639250516891
epoch: 20 s: 1024000 batch_loss 0.36019617319107056 BPR_loss 0.27254724502563477 reg_loss 0.08764893561601639
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 95.46258091926575 | 1993.9853961467743 | 221.49082946777344 | [0.08714042 0.12508999 0.15294074] | [0.04091608 0.04910065 0.05432143] | [0.00549123 0.00398061 0.00326338] | [0.10595246 0.15107477 0.18344635] |
|   20  | 95.46258091926575 |  2104.18679189682  | 221.49082946777344 | [0.08714042 0.12508999 0.15294074] | [0.04091608 0.04910065 0.05432143] | [0.00549123 0.00398061 0.00326338] | [0.10595246 0.15107477 0.18344635] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.3553846478462219 BPR_loss 0.2680589556694031 reg_loss 0.08732567727565765
epoch: 21 s: 256000 batch_loss 0.3549470007419586 BPR_loss 0.2662293612957001 reg_loss 0.08871763199567795
epoch: 21 s: 512000 batch_loss 0.35193192958831787 BPR_loss 0.26410382986068726 reg_loss 0.08782810717821121
epoch: 21 s: 768000 batch_loss 0.3537279963493347 BPR_loss 0.2642648220062256 reg_loss 0.08946317434310913
epoch: 21 s: 1024000 batch_loss 0.34199467301368713 BPR_loss 0.25239264965057373 reg_loss 0.0896020233631134
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 97.45559573173523 |  1983.12269115448 | 217.3677978515625 | [0.08684055 0.12463645 0.15245008] | [0.04081037 0.04895982 0.0541711 ] | [0.00547207 0.00396601 0.00325216] | [0.10560653 0.1505094  0.18282146] |
|   21  | 97.45559573173523 | 2130.406201839447 | 217.3677978515625 | [0.08684055 0.12463645 0.15245008] | [0.04081037 0.04895982 0.0541711 ] | [0.00547207 0.00396601 0.00325216] | [0.10560653 0.1505094  0.18282146] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.08684055427518077
early stopping at 21, recall@20:0.0884
