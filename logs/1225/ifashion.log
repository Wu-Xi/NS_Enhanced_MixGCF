Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ifashion', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.0001, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931481957435608 BPR_loss 0.693148136138916 reg_loss 3.21420934312755e-08
epoch: 0 s: 256000 batch_loss 0.6931418180465698 BPR_loss 0.6931413412094116 reg_loss 4.782984888151987e-07
epoch: 0 s: 512000 batch_loss 0.6930731534957886 BPR_loss 0.6930687427520752 reg_loss 4.423250629770337e-06
epoch: 0 s: 768000 batch_loss 0.6927791237831116 BPR_loss 0.6927558779716492 reg_loss 2.3227252313517965e-05
epoch: 0 s: 1024000 batch_loss 0.6918110251426697 BPR_loss 0.6917290687561035 reg_loss 8.192915993276983e-05
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 70.85266160964966 |  695.695686340332  | 424.54852294921875 | [0.07665284 0.11490511 0.14298587] | [0.03537579 0.04360083 0.04884095] | [0.00478395 0.00361479 0.0030133 ] | [0.09299341 0.13845793 0.17122006] |
|   0   | 70.85266160964966 | 1191.5664901733398 | 424.54852294921875 | [0.07665284 0.11490511 0.14298587] | [0.03537579 0.04360083 0.04884095] | [0.00478395 0.00361479 0.0030133 ] | [0.09299341 0.13845793 0.17122006] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6898337006568909 BPR_loss 0.6896461844444275 reg_loss 0.0001875036396086216
epoch: 1 s: 256000 batch_loss 0.6872423887252808 BPR_loss 0.6868883967399597 reg_loss 0.0003539956815075129
epoch: 1 s: 512000 batch_loss 0.6830167174339294 BPR_loss 0.6823878884315491 reg_loss 0.0006288285949267447
epoch: 1 s: 768000 batch_loss 0.6788504719734192 BPR_loss 0.6779202222824097 reg_loss 0.000930227804929018
epoch: 1 s: 1024000 batch_loss 0.6737169027328491 BPR_loss 0.6724123954772949 reg_loss 0.001304522273130715
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 85.98816442489624 | 1180.0341620445251 | 417.0451354980469 | [0.08327537 0.12313437 0.15229287] | [0.03847745 0.04704033 0.05248533] | [0.0051892  0.00386874 0.00320864] | [0.10075619 0.14788709 0.18193247] |
|   1   | 85.98816442489624 | 1237.4717230796814 | 417.0451354980469 | [0.08327537 0.12313437 0.15229287] | [0.03847745 0.04704033 0.05248533] | [0.0051892  0.00386874 0.00320864] | [0.10075619 0.14788709 0.18193247] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6672608256340027 BPR_loss 0.665587306022644 reg_loss 0.0016735030803829432
epoch: 2 s: 256000 batch_loss 0.6600549817085266 BPR_loss 0.6579986810684204 reg_loss 0.002056283876299858
epoch: 2 s: 512000 batch_loss 0.6522906422615051 BPR_loss 0.6495328545570374 reg_loss 0.002757786773145199
epoch: 2 s: 768000 batch_loss 0.6452178359031677 BPR_loss 0.6421197056770325 reg_loss 0.0030981486197561026
epoch: 2 s: 1024000 batch_loss 0.6360403895378113 BPR_loss 0.6323157548904419 reg_loss 0.0037246192805469036
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 88.09647297859192 | 1188.947955608368  | 397.71246337890625 | [0.08626445 0.12740907 0.15696492] | [0.04002211 0.04886322 0.05439767] | [0.00538038 0.00400349 0.00331335] | [0.10436791 0.15283042 0.18744118] |
|   2   | 88.09647297859192 | 1239.8633494377136 | 397.71246337890625 | [0.08626445 0.12740907 0.15696492] | [0.04002211 0.04886322 0.05439767] | [0.00538038 0.00400349 0.00331335] | [0.10436791 0.15283042 0.18744118] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6279149055480957 BPR_loss 0.6237958669662476 reg_loss 0.004119031596928835
epoch: 3 s: 256000 batch_loss 0.623152494430542 BPR_loss 0.6183298826217651 reg_loss 0.004822585266083479
epoch: 3 s: 512000 batch_loss 0.6142598390579224 BPR_loss 0.6090073585510254 reg_loss 0.005252459552139044
epoch: 3 s: 768000 batch_loss 0.6052989363670349 BPR_loss 0.5994550585746765 reg_loss 0.0058438885025680065
epoch: 3 s: 1024000 batch_loss 0.596979558467865 BPR_loss 0.5906257033348083 reg_loss 0.00635384488850832
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 86.39386940002441 | 1186.590410709381  | 373.7074890136719 | [0.0886235  0.13003625 0.16035771] | [0.04127866 0.05018704 0.05585913] | [0.00553028 0.00409052 0.00338371] | [0.10715388 0.15600695 0.19125376] |
|   3   | 86.39386940002441 | 1235.1547179222107 | 373.7074890136719 | [0.0886235  0.13003625 0.16035771] | [0.04127866 0.05018704 0.05585913] | [0.00553028 0.00409052 0.00338371] | [0.10715388 0.15600695 0.19125376] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.587665319442749 BPR_loss 0.5809593200683594 reg_loss 0.00670600263401866
epoch: 4 s: 256000 batch_loss 0.5815706253051758 BPR_loss 0.5740796327590942 reg_loss 0.007490998599678278
epoch: 4 s: 512000 batch_loss 0.571761965751648 BPR_loss 0.5634808540344238 reg_loss 0.008281111717224121
epoch: 4 s: 768000 batch_loss 0.5622627139091492 BPR_loss 0.5538132786750793 reg_loss 0.008449463173747063
epoch: 4 s: 1024000 batch_loss 0.554137110710144 BPR_loss 0.5451741218566895 reg_loss 0.008962979540228844
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 87.49427366256714 | 1196.7171211242676 | 349.27630615234375 | [0.09044734 0.13250334 0.16288888] | [0.04218046 0.0512308  0.0569113 ] | [0.00564931 0.00416956 0.0034382 ] | [0.10936704 0.15887103 0.1941662 ] |
|   4   | 87.49427366256714 | 1256.1286296844482 | 349.27630615234375 | [0.09044734 0.13250334 0.16288888] | [0.04218046 0.0512308  0.0569113 ] | [0.00564931 0.00416956 0.0034382 ] | [0.10936704 0.15887103 0.1941662 ] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.5485389232635498 BPR_loss 0.5393099188804626 reg_loss 0.009229001589119434
epoch: 5 s: 256000 batch_loss 0.5450950264930725 BPR_loss 0.5350947380065918 reg_loss 0.010000268928706646
epoch: 5 s: 512000 batch_loss 0.5369680523872375 BPR_loss 0.5265184044837952 reg_loss 0.010449659079313278
epoch: 5 s: 768000 batch_loss 0.5319641828536987 BPR_loss 0.5208516120910645 reg_loss 0.01111258938908577
epoch: 5 s: 1024000 batch_loss 0.513618528842926 BPR_loss 0.5020032525062561 reg_loss 0.011615264229476452
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 85.20484280586243 | 1199.4948525428772 | 326.5880126953125 | [0.09208604 0.13431691 0.16498566] | [0.04305037 0.05214418 0.05787414] | [0.00574806 0.00422945 0.00348414] | [0.11128263 0.16098376 0.19654302] |
|   5   | 85.20484280586243 | 1242.8399016857147 | 326.5880126953125 | [0.09208604 0.13431691 0.16498566] | [0.04305037 0.05214418 0.05787414] | [0.00574806 0.00422945 0.00348414] | [0.11128263 0.16098376 0.19654302] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.514506995677948 BPR_loss 0.5024415254592896 reg_loss 0.012065493501722813
epoch: 6 s: 256000 batch_loss 0.5043029189109802 BPR_loss 0.4919249713420868 reg_loss 0.012377973645925522
epoch: 6 s: 512000 batch_loss 0.5032826066017151 BPR_loss 0.4905334711074829 reg_loss 0.012749123387038708
epoch: 6 s: 768000 batch_loss 0.497708261013031 BPR_loss 0.4840918183326721 reg_loss 0.013616439886391163
epoch: 6 s: 1024000 batch_loss 0.490840882062912 BPR_loss 0.47717350721359253 reg_loss 0.013667386956512928
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 86.31913113594055 | 1197.8715884685516 | 305.9785461425781 | [0.09342542 0.13573347 0.16671619] | [0.04368111 0.05279573 0.05858702] | [0.00582897 0.0042766  0.00352313] | [0.11282625 0.16271336 0.1985144 ] |
|   6   | 86.31913113594055 | 1255.0548176765442 | 305.9785461425781 | [0.09342542 0.13573347 0.16671619] | [0.04368111 0.05279573 0.05858702] | [0.00582897 0.0042766  0.00352313] | [0.11282625 0.16271336 0.1985144 ] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.4835880994796753 BPR_loss 0.4695170521736145 reg_loss 0.014071039855480194
epoch: 7 s: 256000 batch_loss 0.4786892235279083 BPR_loss 0.46389782428741455 reg_loss 0.014791400171816349
epoch: 7 s: 512000 batch_loss 0.46442505717277527 BPR_loss 0.44898027181625366 reg_loss 0.015444784425199032
epoch: 7 s: 768000 batch_loss 0.45537269115448 BPR_loss 0.4391767978668213 reg_loss 0.016195885837078094
epoch: 7 s: 1024000 batch_loss 0.45883873105049133 BPR_loss 0.44317328929901123 reg_loss 0.015665434300899506
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 84.82642698287964 | 1168.7899823188782 | 286.89569091796875 | [0.09444083 0.13666951 0.16752959] | [0.0442093  0.05331404 0.05908889] | [0.00589238 0.00430914 0.00354328] | [0.1139942  0.16379205 0.19955588] |
|   7   | 84.82642698287964 | 1264.4284899234772 | 286.89569091796875 | [0.09444083 0.13666951 0.16752959] | [0.0442093  0.05331404 0.05908889] | [0.00589238 0.00430914 0.00354328] | [0.1139942  0.16379205 0.19955588] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.45513421297073364 BPR_loss 0.43841463327407837 reg_loss 0.016719579696655273
epoch: 8 s: 256000 batch_loss 0.4379781484603882 BPR_loss 0.4210805296897888 reg_loss 0.01689763180911541
epoch: 8 s: 512000 batch_loss 0.42976999282836914 BPR_loss 0.4119088649749756 reg_loss 0.01786111481487751
epoch: 8 s: 768000 batch_loss 0.4424726665019989 BPR_loss 0.42487409710884094 reg_loss 0.017598574981093407
epoch: 8 s: 1024000 batch_loss 0.42337700724601746 BPR_loss 0.4048897624015808 reg_loss 0.018487241119146347
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 85.46117901802063 | 1195.1407735347748 | 269.5653076171875 | [0.09498862 0.13731794 0.16854215] | [0.04446939 0.05359808 0.05943114] | [0.00593032 0.00433285 0.00356287] | [0.11470093 0.16459176 0.20055645] |
|   8   | 85.46117901802063 | 1258.3390119075775 | 269.5653076171875 | [0.09498862 0.13731794 0.16854215] | [0.04446939 0.05359808 0.05943114] | [0.00593032 0.00433285 0.00356287] | [0.11470093 0.16459176 0.20055645] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.42706722021102905 BPR_loss 0.4079669117927551 reg_loss 0.01910031959414482
epoch: 9 s: 256000 batch_loss 0.4117416441440582 BPR_loss 0.39272862672805786 reg_loss 0.01901300624012947
epoch: 9 s: 512000 batch_loss 0.4110364317893982 BPR_loss 0.39231497049331665 reg_loss 0.01872146502137184
epoch: 9 s: 768000 batch_loss 0.41372397541999817 BPR_loss 0.39439162611961365 reg_loss 0.019332358613610268
epoch: 9 s: 1024000 batch_loss 0.39531078934669495 BPR_loss 0.37478500604629517 reg_loss 0.02052578143775463
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 86.93188452720642 | 1204.5722086429596 | 254.4324493408203 | [0.09586478 0.138126   0.16922376] | [0.04490647 0.05402509 0.05983005] | [0.005985   0.00436429 0.00357806] | [0.11569034 0.16561464 0.20141196] |
|   9   | 86.93188452720642 | 1238.4370784759521 | 254.4324493408203 | [0.09586478 0.138126   0.16922376] | [0.04490647 0.05402509 0.05983005] | [0.005985   0.00436429 0.00357806] | [0.11569034 0.16561464 0.20141196] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.40924739837646484 BPR_loss 0.38962507247924805 reg_loss 0.019622324034571648
epoch: 10 s: 256000 batch_loss 0.41091057658195496 BPR_loss 0.3904936909675598 reg_loss 0.020416878163814545
epoch: 10 s: 512000 batch_loss 0.39025554060935974 BPR_loss 0.36916932463645935 reg_loss 0.021086229011416435
epoch: 10 s: 768000 batch_loss 0.39319032430648804 BPR_loss 0.372040331363678 reg_loss 0.02114999108016491
epoch: 10 s: 1024000 batch_loss 0.3847822844982147 BPR_loss 0.3627813458442688 reg_loss 0.022000951692461967
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 87.89372229576111 | 1195.0846433639526 | 240.3470916748047 | [0.09638981 0.13866681 0.16926255] | [0.0451733  0.05429246 0.06001385] | [0.00602071 0.00438065 0.00358283] | [0.11636358 0.16620978 0.20150123] |
|   10  | 87.89372229576111 | 1241.2782876491547 | 240.3470916748047 | [0.09638981 0.13866681 0.16926255] | [0.0451733  0.05429246 0.06001385] | [0.00602071 0.00438065 0.00358283] | [0.11636358 0.16620978 0.20150123] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.39068663120269775 BPR_loss 0.3685535490512848 reg_loss 0.022133085876703262
epoch: 11 s: 256000 batch_loss 0.3788082003593445 BPR_loss 0.35692861676216125 reg_loss 0.021879585459828377
epoch: 11 s: 512000 batch_loss 0.3655981421470642 BPR_loss 0.3422459065914154 reg_loss 0.02335222065448761
epoch: 11 s: 768000 batch_loss 0.36971718072891235 BPR_loss 0.3474704325199127 reg_loss 0.02224673330783844
epoch: 11 s: 1024000 batch_loss 0.3649609088897705 BPR_loss 0.3421090841293335 reg_loss 0.02285182662308216
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 87.97410249710083 | 1178.4645850658417 | 228.12945556640625 | [0.09704342 0.13883611 0.16958567] | [0.04552304 0.05453477 0.06028378] | [0.00606256 0.00438846 0.00359095] | [0.11715957 0.16650734 0.20180251] |
|   11  | 87.97410249710083 | 1246.3336968421936 | 228.12945556640625 | [0.09704342 0.13883611 0.16958567] | [0.04552304 0.05453477 0.06028378] | [0.00606256 0.00438846 0.00359095] | [0.11715957 0.16650734 0.20180251] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.36589768528938293 BPR_loss 0.34191393852233887 reg_loss 0.023983748629689217
epoch: 12 s: 256000 batch_loss 0.36168602108955383 BPR_loss 0.3376840353012085 reg_loss 0.024001983925700188
epoch: 12 s: 512000 batch_loss 0.35508808493614197 BPR_loss 0.3314446806907654 reg_loss 0.02364340052008629
epoch: 12 s: 768000 batch_loss 0.3515278100967407 BPR_loss 0.32695358991622925 reg_loss 0.02457423135638237
epoch: 12 s: 1024000 batch_loss 0.3509829640388489 BPR_loss 0.3264605700969696 reg_loss 0.02452240325510502
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 87.81172633171082 | 1201.641054391861  | 216.5510711669922 | [0.09702341 0.13920401 0.16974773] | [0.04563931 0.05473943 0.06045193] | [0.00606497 0.00440148 0.0035969 ] | [0.11718561 0.16694626 0.20209264] |
|   12  | 87.81172633171082 | 1244.0005667209625 | 216.5510711669922 | [0.09702341 0.13920401 0.16974773] | [0.04563931 0.05473943 0.06045193] | [0.00606497 0.00440148 0.0035969 ] | [0.11718561 0.16694626 0.20209264] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.34143880009651184 BPR_loss 0.31621307134628296 reg_loss 0.025225719437003136
epoch: 13 s: 256000 batch_loss 0.3370934724807739 BPR_loss 0.3107808232307434 reg_loss 0.02631264552474022
epoch: 13 s: 512000 batch_loss 0.3462139964103699 BPR_loss 0.32095932960510254 reg_loss 0.025254663079977036
epoch: 13 s: 768000 batch_loss 0.3319541811943054 BPR_loss 0.305403470993042 reg_loss 0.02655070088803768
epoch: 13 s: 1024000 batch_loss 0.3299034535884857 BPR_loss 0.3037411570549011 reg_loss 0.026162290945649147
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 87.48121809959412 | 1204.9470946788788 | 206.53244018554688 | [0.09715726 0.13918532 0.16967726] | [0.04574329 0.05480739 0.06051613] | [0.00607706 0.0044013  0.00359796] | [0.11733811 0.16688674 0.20207776] |
|   13  | 87.48121809959412 | 1265.0466475486755 | 206.53244018554688 | [0.09715726 0.13918532 0.16967726] | [0.04574329 0.05480739 0.06051613] | [0.00607706 0.0044013  0.00359796] | [0.11733811 0.16688674 0.20207776] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.32139939069747925 BPR_loss 0.29508596658706665 reg_loss 0.026313433423638344
epoch: 14 s: 256000 batch_loss 0.32652583718299866 BPR_loss 0.2998763918876648 reg_loss 0.026649434119462967
epoch: 14 s: 512000 batch_loss 0.3325307369232178 BPR_loss 0.30629727244377136 reg_loss 0.026233455166220665
epoch: 14 s: 768000 batch_loss 0.31609734892845154 BPR_loss 0.2888064980506897 reg_loss 0.02729085646569729
epoch: 14 s: 1024000 batch_loss 0.3100859224796295 BPR_loss 0.28283852338790894 reg_loss 0.02724740467965603
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 87.09109163284302 | 1198.9334857463837 | 197.02749633789062 | [0.09708809 0.13925625 0.1694718 ] | [0.0457959  0.05489372 0.06054818] | [0.00607892 0.00440725 0.00359511] | [0.11733439 0.16698345 0.20185831] |
|   14  | 87.09109163284302 | 1240.516753435135  | 197.02749633789062 | [0.09708809 0.13925625 0.1694718 ] | [0.0457959  0.05489372 0.06054818] | [0.00607892 0.00440725 0.00359511] | [0.11733439 0.16698345 0.20185831] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.3149098753929138 BPR_loss 0.2874072194099426 reg_loss 0.027502648532390594
epoch: 15 s: 256000 batch_loss 0.3081114888191223 BPR_loss 0.27987417578697205 reg_loss 0.028237303718924522
epoch: 15 s: 512000 batch_loss 0.3115967810153961 BPR_loss 0.2833501398563385 reg_loss 0.028246652334928513
epoch: 15 s: 768000 batch_loss 0.30980628728866577 BPR_loss 0.28153926134109497 reg_loss 0.028267012909054756
epoch: 15 s: 1024000 batch_loss 0.3169209063053131 BPR_loss 0.2881929278373718 reg_loss 0.028727984055876732
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 87.24184513092041 | 1221.1948506832123 | 188.66143798828125 | [0.09734593 0.1394503  0.16944414] | [0.04595581 0.05503818 0.06065856] | [0.00609343 0.00441273 0.00359752] | [0.11755757 0.16716199 0.20188434] |
|   15  | 87.24184513092041 | 1238.593920469284  | 188.66143798828125 | [0.09734593 0.1394503  0.16944414] | [0.04595581 0.05503818 0.06065856] | [0.00609343 0.00441273 0.00359752] | [0.11755757 0.16716199 0.20188434] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.2959538996219635 BPR_loss 0.26724380254745483 reg_loss 0.028710106387734413
epoch: 16 s: 256000 batch_loss 0.3058682084083557 BPR_loss 0.2773789167404175 reg_loss 0.028489278629422188
epoch: 16 s: 512000 batch_loss 0.30362480878829956 BPR_loss 0.27507781982421875 reg_loss 0.028547002002596855
epoch: 16 s: 768000 batch_loss 0.2967367172241211 BPR_loss 0.26742443442344666 reg_loss 0.029312273487448692
epoch: 16 s: 1024000 batch_loss 0.287610799074173 BPR_loss 0.25724393129348755 reg_loss 0.030366865918040276
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 77.30030393600464 | 1190.4671649932861 | 180.78805541992188 | [0.09710629 0.13917945 0.1691051 ] | [0.04587458 0.05495082 0.06056236] | [0.00608339 0.00440576 0.00359238] | [0.11737531 0.1669351  0.20154958] |
|   16  | 77.30030393600464 |  1210.72376537323  | 180.78805541992188 | [0.09710629 0.13917945 0.1691051 ] | [0.04587458 0.05495082 0.06056236] | [0.00608339 0.00440576 0.00359238] | [0.11737531 0.1669351  0.20154958] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.2904767394065857 BPR_loss 0.26045870780944824 reg_loss 0.030018026009202003
epoch: 17 s: 256000 batch_loss 0.2909054458141327 BPR_loss 0.2611141800880432 reg_loss 0.029791252687573433
epoch: 17 s: 512000 batch_loss 0.29274481534957886 BPR_loss 0.2621043920516968 reg_loss 0.030640432611107826
epoch: 17 s: 768000 batch_loss 0.2702568769454956 BPR_loss 0.23979437351226807 reg_loss 0.030462490394711494
epoch: 17 s: 1024000 batch_loss 0.2846234440803528 BPR_loss 0.25360411405563354 reg_loss 0.031019335612654686
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 77.49877595901489 | 1188.7945532798767 | 173.31179809570312 | [0.09709856 0.138995   0.16893953] | [0.04596834 0.05500888 0.06061774] | [0.00608673 0.00440278 0.00358822] | [0.11741251 0.16673052 0.20130037] |
|   17  | 77.49877595901489 | 1226.398279428482  | 173.31179809570312 | [0.09709856 0.138995   0.16893953] | [0.04596834 0.05500888 0.06061774] | [0.00608673 0.00440278 0.00358822] | [0.11741251 0.16673052 0.20130037] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.2653190791606903 BPR_loss 0.23414820432662964 reg_loss 0.03117087297141552
epoch: 18 s: 256000 batch_loss 0.2766185700893402 BPR_loss 0.24613654613494873 reg_loss 0.030482018366456032
epoch: 18 s: 512000 batch_loss 0.28174299001693726 BPR_loss 0.25038832426071167 reg_loss 0.03135466203093529
epoch: 18 s: 768000 batch_loss 0.2640339136123657 BPR_loss 0.23212352395057678 reg_loss 0.03191039338707924
epoch: 18 s: 1024000 batch_loss 0.2654174566268921 BPR_loss 0.23382675647735596 reg_loss 0.03159070387482643
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 77.45051693916321 | 1183.2672007083893 | 166.7355194091797 | [0.09720434 0.13892307 0.16865286] | [0.04595578 0.05495479 0.06052176] | [0.0060912  0.00440288 0.00358215] | [0.11747574 0.16660777 0.20099908] |
|   18  | 77.45051693916321 | 1239.214122056961  | 166.7355194091797 | [0.09720434 0.13892307 0.16865286] | [0.04595578 0.05495479 0.06052176] | [0.0060912  0.00440288 0.00358215] | [0.11747574 0.16660777 0.20099908] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.2793181240558624 BPR_loss 0.2478562295436859 reg_loss 0.03146190568804741
epoch: 19 s: 256000 batch_loss 0.2661340832710266 BPR_loss 0.23399022221565247 reg_loss 0.03214387595653534
epoch: 19 s: 512000 batch_loss 0.2886803448200226 BPR_loss 0.2565178871154785 reg_loss 0.03216245770454407
epoch: 19 s: 768000 batch_loss 0.25651881098747253 BPR_loss 0.22374215722084045 reg_loss 0.03277665376663208
epoch: 19 s: 1024000 batch_loss 0.2526771128177643 BPR_loss 0.22105780243873596 reg_loss 0.03161931410431862
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 78.21870541572571 | 1190.7820439338684 | 160.73765563964844 | [0.0970623  0.13868349 0.16818472] | [0.04594106 0.05491445 0.06044265] | [0.00608562 0.00439413 0.0035744 ] | [0.11728976 0.16635112 0.2004523 ] |
|   19  | 78.21870541572571 | 1236.3166377544403 | 160.73765563964844 | [0.0970623  0.13868349 0.16818472] | [0.04594106 0.05491445 0.06044265] | [0.00608562 0.00439413 0.0035744 ] | [0.11728976 0.16635112 0.2004523 ] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.2628821134567261 BPR_loss 0.22950740158557892 reg_loss 0.03337471932172775
epoch: 20 s: 256000 batch_loss 0.25547415018081665 BPR_loss 0.22218020260334015 reg_loss 0.033293940126895905
epoch: 20 s: 512000 batch_loss 0.2609978914260864 BPR_loss 0.228359192609787 reg_loss 0.03263868764042854
epoch: 20 s: 768000 batch_loss 0.26120635867118835 BPR_loss 0.22828397154808044 reg_loss 0.032922398298978806
epoch: 20 s: 1024000 batch_loss 0.2566233277320862 BPR_loss 0.2230527698993683 reg_loss 0.03357057273387909
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 77.71397066116333 | 1100.5450854301453 | 155.3043212890625 | [0.0968701  0.13814307 0.16786624] | [0.04590593 0.05480275 0.06037364] | [0.00607502 0.00437628 0.00356677] | [0.11709262 0.16571135 0.20010266] |
|   20  | 77.71397066116333 | 1011.2752611637115 | 155.3043212890625 | [0.0968701  0.13814307 0.16786624] | [0.04590593 0.05480275 0.06037364] | [0.00607502 0.00437628 0.00356677] | [0.11709262 0.16571135 0.20010266] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.2512001097202301 BPR_loss 0.21768388152122498 reg_loss 0.03351623937487602
epoch: 21 s: 256000 batch_loss 0.2480091005563736 BPR_loss 0.2138892412185669 reg_loss 0.0341198556125164
epoch: 21 s: 512000 batch_loss 0.24413427710533142 BPR_loss 0.21052122116088867 reg_loss 0.03361305221915245
epoch: 21 s: 768000 batch_loss 0.24395306408405304 BPR_loss 0.20929405093193054 reg_loss 0.0346590131521225
epoch: 21 s: 1024000 batch_loss 0.23294970393180847 BPR_loss 0.1985122114419937 reg_loss 0.03443749621510506
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 71.95126032829285 | 965.4125571250916 | 150.26072692871094 | [0.09654885 0.13790525 0.16768113] | [0.04578852 0.05470396 0.06027919] | [0.00605958 0.00437117 0.00356256] | [0.11676902 0.1654733  0.19981997] |
|   21  | 71.95126032829285 | 991.8734586238861 | 150.26072692871094 | [0.09654885 0.13790525 0.16768113] | [0.04578852 0.05470396 0.06027919] | [0.00605958 0.00437117 0.00356256] | [0.11676902 0.1654733  0.19981997] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.2564998269081116 BPR_loss 0.22200967371463776 reg_loss 0.03449016809463501
epoch: 22 s: 256000 batch_loss 0.2382826805114746 BPR_loss 0.20454280078411102 reg_loss 0.03373988717794418
epoch: 22 s: 512000 batch_loss 0.23461297154426575 BPR_loss 0.19944347441196442 reg_loss 0.03516950085759163
epoch: 22 s: 768000 batch_loss 0.2357819527387619 BPR_loss 0.20079267024993896 reg_loss 0.034989286214113235
epoch: 22 s: 1024000 batch_loss 0.24050810933113098 BPR_loss 0.20456865429878235 reg_loss 0.03593945503234863
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 71.91072535514832 | 945.8829605579376 | 145.33021545410156 | [0.09641609 0.13760452 0.16703272] | [0.04574199 0.05461778 0.06013269] | [0.00605177 0.00436187 0.00355196] | [0.11666115 0.16510506 0.1991616 ] |
|   22  | 71.91072535514832 | 863.1190929412842 | 145.33021545410156 | [0.09641609 0.13760452 0.16703272] | [0.04574199 0.05461778 0.06013269] | [0.00605177 0.00436187 0.00355196] | [0.11666115 0.16510506 0.1991616 ] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.2351219207048416 BPR_loss 0.2002052366733551 reg_loss 0.03491668775677681
epoch: 23 s: 256000 batch_loss 0.22766166925430298 BPR_loss 0.19151151180267334 reg_loss 0.03615015000104904
epoch: 23 s: 512000 batch_loss 0.2323157787322998 BPR_loss 0.19733387231826782 reg_loss 0.03498190641403198
epoch: 23 s: 768000 batch_loss 0.22015005350112915 BPR_loss 0.18448156118392944 reg_loss 0.035668496042490005
epoch: 23 s: 1024000 batch_loss 0.21305793523788452 BPR_loss 0.17774704098701477 reg_loss 0.03531089052557945
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 69.93616962432861 | 828.9243876934052 | 141.13607788085938 | [0.09628357 0.13726693 0.16661386] | [0.04568231 0.05451977 0.06001849] | [0.00603875 0.00435368 0.00354433] | [0.11641566 0.16472566 0.19864458] |
|   23  | 69.93616962432861 | 839.3775098323822 | 141.13607788085938 | [0.09628357 0.13726693 0.16661386] | [0.04568231 0.05451977 0.06001849] | [0.00603875 0.00435368 0.00354433] | [0.11641566 0.16472566 0.19864458] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.22811511158943176 BPR_loss 0.1918051689863205 reg_loss 0.036309946328401566
epoch: 24 s: 256000 batch_loss 0.229951411485672 BPR_loss 0.19428938627243042 reg_loss 0.035662032663822174
epoch: 24 s: 512000 batch_loss 0.23450517654418945 BPR_loss 0.1977802813053131 reg_loss 0.03672490268945694
epoch: 24 s: 768000 batch_loss 0.22671040892601013 BPR_loss 0.18930383026599884 reg_loss 0.037406571209430695
epoch: 24 s: 1024000 batch_loss 0.21969689428806305 BPR_loss 0.1838541179895401 reg_loss 0.03584278002381325
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 69.95534753799438 | 832.2288053035736 | 137.11224365234375 | [0.09610298 0.13675723 0.16617447] | [0.04562336 0.05438983 0.05989841] | [0.0060315  0.00433862 0.0035341 ] | [0.1162334  0.16420492 0.19808292] |
|   24  | 69.95534753799438 | 731.8237326145172 | 137.11224365234375 | [0.09610298 0.13675723 0.16617447] | [0.04562336 0.05438983 0.05989841] | [0.0060315  0.00433862 0.0035341 ] | [0.1162334  0.16420492 0.19808292] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.22764140367507935 BPR_loss 0.192092627286911 reg_loss 0.03554878011345863
epoch: 25 s: 256000 batch_loss 0.21219299733638763 BPR_loss 0.17593246698379517 reg_loss 0.03626053407788277
epoch: 25 s: 512000 batch_loss 0.21133765578269958 BPR_loss 0.17479602992534637 reg_loss 0.03654162958264351
epoch: 25 s: 768000 batch_loss 0.21651671826839447 BPR_loss 0.17964103817939758 reg_loss 0.03687567636370659
epoch: 25 s: 1024000 batch_loss 0.20974323153495789 BPR_loss 0.17305833101272583 reg_loss 0.03668490797281265
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 69.86148405075073 | 739.8420894145966 | 133.57879638671875 | [0.0959473  0.13643456 0.1660197 ] | [0.0455051  0.05423542 0.05977262] | [0.00602294 0.0043296  0.00353076] | [0.11610321 0.1638218  0.19793042] |
|   25  | 69.86148405075073 | 740.9710767269135 | 133.57879638671875 | [0.0959473  0.13643456 0.1660197 ] | [0.0455051  0.05423542 0.05977262] | [0.00602294 0.0043296  0.00353076] | [0.11610321 0.1638218  0.19793042] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.09594730471521301
early stopping at 25, recall@20:0.0973
