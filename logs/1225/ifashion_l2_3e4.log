Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ifashion', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.0003, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931482553482056 BPR_loss 0.693148136138916 reg_loss 9.642629095196753e-08
epoch: 0 s: 256000 batch_loss 0.6931433081626892 BPR_loss 0.6931421756744385 reg_loss 1.125389303524571e-06
epoch: 0 s: 512000 batch_loss 0.6930956840515137 BPR_loss 0.6930869817733765 reg_loss 8.683323358127382e-06
epoch: 0 s: 768000 batch_loss 0.6928978562355042 BPR_loss 0.6928572654724121 reg_loss 4.0578015614300966e-05
epoch: 0 s: 1024000 batch_loss 0.692290186882019 BPR_loss 0.6921584606170654 reg_loss 0.00013170520833227783
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 82.64917516708374 | 1192.3188800811768 | 424.67193603515625 | [0.07630636 0.11308003 0.14096522] | [0.03525885 0.04317172 0.04837287] | [0.00476535 0.00356402 0.00297344] | [0.09258054 0.13649399 0.16888044] |
|   0   | 82.64917516708374 | 1187.7512176036835 | 424.67193603515625 | [0.07630636 0.11308003 0.14096522] | [0.03525885 0.04317172 0.04837287] | [0.00476535 0.00356402 0.00297344] | [0.09258054 0.13649399 0.16888044] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6909963488578796 BPR_loss 0.6907120943069458 reg_loss 0.00028425949858501554
epoch: 1 s: 256000 batch_loss 0.689215898513794 BPR_loss 0.6886848211288452 reg_loss 0.000531053519807756
epoch: 1 s: 512000 batch_loss 0.6864677667617798 BPR_loss 0.6855348348617554 reg_loss 0.0009329437743872404
epoch: 1 s: 768000 batch_loss 0.6836923360824585 BPR_loss 0.6823151707649231 reg_loss 0.0013771862722933292
epoch: 1 s: 1024000 batch_loss 0.6800218224525452 BPR_loss 0.6781067848205566 reg_loss 0.0019150270381942391
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 86.78233122825623 | 1268.5645875930786 | 419.658447265625 | [0.08270591 0.12125104 0.14988695] | [0.03816513 0.04645763 0.05180615] | [0.00514512 0.00381555 0.00316171] | [0.09990069 0.14587479 0.17929157] |
|   1   | 86.78233122825623 | 1199.4757497310638 | 419.658447265625 | [0.08270591 0.12125104 0.14988695] | [0.03816513 0.04645763 0.05180615] | [0.00514512 0.00381555 0.00316171] | [0.09990069 0.14587479 0.17929157] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6754894256591797 BPR_loss 0.6729816794395447 reg_loss 0.002507749479264021
epoch: 2 s: 256000 batch_loss 0.6699879169464111 BPR_loss 0.666877269744873 reg_loss 0.003110642312094569
epoch: 2 s: 512000 batch_loss 0.6639887690544128 BPR_loss 0.6598930358886719 reg_loss 0.004095739219337702
epoch: 2 s: 768000 batch_loss 0.6583767533302307 BPR_loss 0.6536529660224915 reg_loss 0.004723782651126385
epoch: 2 s: 1024000 batch_loss 0.651636004447937 BPR_loss 0.6459774374961853 reg_loss 0.005658556707203388
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 83.14522886276245 | 1250.3077478408813 | 405.6144714355469 | [0.08514003 0.12475168 0.15427962] | [0.03943442 0.04795495 0.05346454] | [0.00530971 0.00392807 0.00325377] | [0.10296935 0.15004073 0.18410843] |
|   2   | 83.14522886276245 | 1181.638370513916  | 405.6144714355469 | [0.08514003 0.12475168 0.15427962] | [0.03943442 0.04795495 0.05346454] | [0.00530971 0.00392807 0.00325377] | [0.10296935 0.15004073 0.18410843] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6463297605514526 BPR_loss 0.6400073766708374 reg_loss 0.006322384811937809
epoch: 3 s: 256000 batch_loss 0.6416956186294556 BPR_loss 0.6342694759368896 reg_loss 0.007426133379340172
epoch: 3 s: 512000 batch_loss 0.6344141364097595 BPR_loss 0.6262406706809998 reg_loss 0.008173471316695213
epoch: 3 s: 768000 batch_loss 0.628985583782196 BPR_loss 0.6198551654815674 reg_loss 0.009130432270467281
epoch: 3 s: 1024000 batch_loss 0.6217983365058899 BPR_loss 0.6117807626724243 reg_loss 0.01001759897917509
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 82.3433678150177 |   1235.603515625   | 386.59283447265625 | [0.08700451 0.12723659 0.15671515] | [0.040519   0.04917734 0.05468511] | [0.00543209 0.00400953 0.00330752] | [0.10524201 0.15295317 0.18712502] |
|   3   | 82.3433678150177 | 1211.7247307300568 | 386.59283447265625 | [0.08700451 0.12723659 0.15671515] | [0.040519   0.04917734 0.05468511] | [0.00543209 0.00400953 0.00330752] | [0.10524201 0.15295317 0.18712502] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.6125825643539429 BPR_loss 0.6018946170806885 reg_loss 0.010687942616641521
epoch: 4 s: 256000 batch_loss 0.6057513356208801 BPR_loss 0.5938289165496826 reg_loss 0.011922402307391167
epoch: 4 s: 512000 batch_loss 0.5981224179267883 BPR_loss 0.5849689841270447 reg_loss 0.013153434731066227
epoch: 4 s: 768000 batch_loss 0.5900818109512329 BPR_loss 0.5765472650527954 reg_loss 0.013534534722566605
epoch: 4 s: 1024000 batch_loss 0.5852627158164978 BPR_loss 0.5706473588943481 reg_loss 0.014615362510085106
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 84.89486694335938 | 1261.5614080429077 | 365.9438781738281 | [0.08887262 0.12932889 0.15881748] | [0.04131632 0.05002519 0.05553342] | [0.00555111 0.00407806 0.0033555 ] | [0.10754072 0.15542297 0.18955019] |
|   4   | 84.89486694335938 | 1198.6629164218903 | 365.9438781738281 | [0.08887262 0.12932889 0.15881748] | [0.04131632 0.05002519 0.05553342] | [0.00555111 0.00407806 0.0033555 ] | [0.10754072 0.15542297 0.18955019] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.5777463912963867 BPR_loss 0.562604546546936 reg_loss 0.01514186430722475
epoch: 5 s: 256000 batch_loss 0.5726953744888306 BPR_loss 0.556355357170105 reg_loss 0.016340011730790138
epoch: 5 s: 512000 batch_loss 0.569394588470459 BPR_loss 0.5521169900894165 reg_loss 0.017277587205171585
epoch: 5 s: 768000 batch_loss 0.5601640939712524 BPR_loss 0.5419552326202393 reg_loss 0.01820884831249714
epoch: 5 s: 1024000 batch_loss 0.5483365654945374 BPR_loss 0.5290808081626892 reg_loss 0.019255777820944786
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 84.39944577217102 | 1236.5890378952026 | 345.8998107910156 | [0.09018551 0.13075061 0.16031246] | [0.04201367 0.05074833 0.05627317] | [0.00563573 0.00412465 0.00338904] | [0.10914386 0.15715258 0.19130584] |
|   5   | 84.39944577217102 | 1200.2861886024475 | 345.8998107910156 | [0.09018551 0.13075061 0.16031246] | [0.04201367 0.05074833 0.05627317] | [0.00563573 0.00412465 0.00338904] | [0.10914386 0.15715258 0.19130584] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.5493876934051514 BPR_loss 0.529438853263855 reg_loss 0.019948838278651237
epoch: 6 s: 256000 batch_loss 0.5387160181999207 BPR_loss 0.5180290937423706 reg_loss 0.020686915144324303
epoch: 6 s: 512000 batch_loss 0.5375304222106934 BPR_loss 0.5163111686706543 reg_loss 0.02121923305094242
epoch: 6 s: 768000 batch_loss 0.5346919894218445 BPR_loss 0.5118981599807739 reg_loss 0.02279381826519966
epoch: 6 s: 1024000 batch_loss 0.5237873792648315 BPR_loss 0.5007311105728149 reg_loss 0.0230562724173069
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 83.36622166633606 | 1255.9689319133759 | 326.9254150390625 | [0.09121704 0.1320612  0.16159045] | [0.04262228 0.05141528 0.05693829] | [0.00569636 0.0041651  0.00341719] | [0.11030065 0.15852883 0.19277135] |
|   6   | 83.36622166633606 | 1151.613900899887  | 326.9254150390625 | [0.09121704 0.1320612  0.16159045] | [0.04262228 0.05141528 0.05693829] | [0.00569636 0.0041651  0.00341719] | [0.11030065 0.15852883 0.19277135] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.5194860696792603 BPR_loss 0.49575087428092957 reg_loss 0.02373518981039524
epoch: 7 s: 256000 batch_loss 0.5133253931999207 BPR_loss 0.4881976544857025 reg_loss 0.025127742439508438
epoch: 7 s: 512000 batch_loss 0.5074678659439087 BPR_loss 0.481270432472229 reg_loss 0.026197412982583046
epoch: 7 s: 768000 batch_loss 0.4984223544597626 BPR_loss 0.47121864557266235 reg_loss 0.02720371074974537
epoch: 7 s: 1024000 batch_loss 0.4947473704814911 BPR_loss 0.4677623510360718 reg_loss 0.02698501944541931
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 84.11989092826843 | 1276.1636292934418 | 309.20245361328125 | [0.09200143 0.13292209 0.16222312] | [0.04299282 0.05181438 0.05729784] | [0.00574342 0.00419328 0.00343231] | [0.11118592 0.15961495 0.19348551] |
|   7   | 84.11989092826843 | 1193.307856798172  | 309.20245361328125 | [0.09200143 0.13292209 0.16222312] | [0.04299282 0.05181438 0.05729784] | [0.00574342 0.00419328 0.00343231] | [0.11118592 0.15961495 0.19348551] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.4931473433971405 BPR_loss 0.4649767279624939 reg_loss 0.028170619159936905
epoch: 8 s: 256000 batch_loss 0.47784388065338135 BPR_loss 0.4489334225654602 reg_loss 0.028910469263792038
epoch: 8 s: 512000 batch_loss 0.4703839421272278 BPR_loss 0.4398428201675415 reg_loss 0.030541110783815384
epoch: 8 s: 768000 batch_loss 0.47458603978157043 BPR_loss 0.44423413276672363 reg_loss 0.030351907014846802
epoch: 8 s: 1024000 batch_loss 0.4590636193752289 BPR_loss 0.42728662490844727 reg_loss 0.031776994466781616
+-------+-------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |      Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 87.89474487304688 | 1267.7891681194305 | 292.8115234375 | [0.09239927 0.13334443 0.16260181] | [0.04326539 0.05210122 0.05757729] | [0.00576815 0.00421095 0.00344347] | [0.11166574 0.16014313 0.19392071] |
|   8   | 87.89474487304688 | 1201.7488102912903 | 292.8115234375 | [0.09239927 0.13334443 0.16260181] | [0.04326539 0.05210122 0.05757729] | [0.00576815 0.00421095 0.00344347] | [0.11166574 0.16014313 0.19392071] |
+-------+-------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.46445250511169434 BPR_loss 0.43173155188560486 reg_loss 0.03272095322608948
epoch: 9 s: 256000 batch_loss 0.4543556272983551 BPR_loss 0.42170000076293945 reg_loss 0.032655615359544754
epoch: 9 s: 512000 batch_loss 0.45205390453338623 BPR_loss 0.41952377557754517 reg_loss 0.03253013640642166
epoch: 9 s: 768000 batch_loss 0.45227235555648804 BPR_loss 0.4186268448829651 reg_loss 0.033645518124103546
epoch: 9 s: 1024000 batch_loss 0.4377215802669525 BPR_loss 0.4022615849971771 reg_loss 0.03545999526977539
+-------+------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 87.9870035648346 | 1259.732340812683 | 278.29638671875 | [0.09272215 0.13401832 0.16326129] | [0.04342535 0.05232247 0.0577978 ] | [0.00579865 0.0042314  0.00345866] | [0.11214185 0.16095772 0.19473902] |
|   9   | 87.9870035648346 | 1183.716642856598 | 278.29638671875 | [0.09272215 0.13401832 0.16326129] | [0.04342535 0.05232247 0.0577978 ] | [0.00579865 0.0042314  0.00345866] | [0.11214185 0.16095772 0.19473902] |
+-------+------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.4479448199272156 BPR_loss 0.41366317868232727 reg_loss 0.0342816524207592
epoch: 10 s: 256000 batch_loss 0.44958317279815674 BPR_loss 0.4140016734600067 reg_loss 0.03558151051402092
epoch: 10 s: 512000 batch_loss 0.43038496375083923 BPR_loss 0.3937506675720215 reg_loss 0.03663429617881775
epoch: 10 s: 768000 batch_loss 0.4326828718185425 BPR_loss 0.3958107829093933 reg_loss 0.03687208145856857
epoch: 10 s: 1024000 batch_loss 0.42223334312438965 BPR_loss 0.3840184211730957 reg_loss 0.03821493685245514
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 87.3827292919159 | 1250.057639837265  | 264.93707275390625 | [0.09325136 0.13432981 0.16313517] | [0.04365734 0.05250574 0.05790671] | [0.0058312  0.00424312 0.00345934] | [0.11276674 0.16131852 0.19475389] |
|   10  | 87.3827292919159 | 1195.3971560001373 | 264.93707275390625 | [0.09325136 0.13432981 0.16313517] | [0.04365734 0.05250574 0.05790671] | [0.0058312  0.00424312 0.00345934] | [0.11276674 0.16131852 0.19475389] |
+-------+------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.4297218322753906 BPR_loss 0.3913128674030304 reg_loss 0.03840895742177963
epoch: 11 s: 256000 batch_loss 0.4214717745780945 BPR_loss 0.3829752802848816 reg_loss 0.03849649429321289
epoch: 11 s: 512000 batch_loss 0.4134727120399475 BPR_loss 0.3731616735458374 reg_loss 0.04031103104352951
epoch: 11 s: 768000 batch_loss 0.413974791765213 BPR_loss 0.37468409538269043 reg_loss 0.03929070755839348
epoch: 11 s: 1024000 batch_loss 0.4058495759963989 BPR_loss 0.365709125995636 reg_loss 0.04014044627547264
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 88.07078099250793 | 1244.5300970077515 | 253.26991271972656 | [0.09341923 0.13426054 0.16327012] | [0.04380401 0.05260745 0.05803967] | [0.00584701 0.00424479 0.00346244] | [0.11300107 0.16122925 0.19476877] |
|   11  | 88.07078099250793 | 1205.053739309311  | 253.26991271972656 | [0.09341923 0.13426054 0.16327012] | [0.04380401 0.05260745 0.05803967] | [0.00584701 0.00424479 0.00346244] | [0.11300107 0.16122925 0.19476877] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.40679189562797546 BPR_loss 0.36489930748939514 reg_loss 0.04189259186387062
epoch: 12 s: 256000 batch_loss 0.4008326530456543 BPR_loss 0.3585742115974426 reg_loss 0.04225843772292137
epoch: 12 s: 512000 batch_loss 0.39618968963623047 BPR_loss 0.3542875349521637 reg_loss 0.041902150958776474
epoch: 12 s: 768000 batch_loss 0.39027050137519836 BPR_loss 0.3470771908760071 reg_loss 0.04319332167506218
epoch: 12 s: 1024000 batch_loss 0.39567041397094727 BPR_loss 0.3525373637676239 reg_loss 0.04313305765390396
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 89.50300025939941 | 1249.9807486534119 | 242.00099182128906 | [0.09353489 0.13430335 0.16330622] | [0.04388422 0.05267459 0.05810117] | [0.00585556 0.00424842 0.00346287] | [0.11309778 0.16131108 0.19477249] |
|   12  | 89.50300025939941 | 1203.0366225242615 | 242.00099182128906 | [0.09353489 0.13430335 0.16330622] | [0.04388422 0.05267459 0.05810117] | [0.00585556 0.00424842 0.00346287] | [0.11309778 0.16131108 0.19477249] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.3791252374649048 BPR_loss 0.3348945677280426 reg_loss 0.044230684638023376
epoch: 13 s: 256000 batch_loss 0.3807056248188019 BPR_loss 0.3348274230957031 reg_loss 0.045878197997808456
epoch: 13 s: 512000 batch_loss 0.39584383368492126 BPR_loss 0.35142797231674194 reg_loss 0.04441585764288902
epoch: 13 s: 768000 batch_loss 0.3731648325920105 BPR_loss 0.3268948793411255 reg_loss 0.04626995697617531
epoch: 13 s: 1024000 batch_loss 0.3708774745464325 BPR_loss 0.32475560903549194 reg_loss 0.046121854335069656
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 89.1823570728302 | 1258.612050294876 | 232.28170776367188 | [0.09371509 0.13420521 0.16307059] | [0.04397603 0.05270132 0.05810983] | [0.00587193 0.00424563 0.00346101] | [0.11339907 0.16122925 0.19456791] |
|   13  | 89.1823570728302 | 1203.573616027832 | 232.28170776367188 | [0.09371509 0.13420521 0.16307059] | [0.04397603 0.05270132 0.05810983] | [0.00587193 0.00424563 0.00346101] | [0.11339907 0.16122925 0.19456791] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.3692062795162201 BPR_loss 0.3225730359554291 reg_loss 0.04663325101137161
epoch: 14 s: 256000 batch_loss 0.37166377902030945 BPR_loss 0.32441389560699463 reg_loss 0.04724988713860512
epoch: 14 s: 512000 batch_loss 0.3744043707847595 BPR_loss 0.3281203508377075 reg_loss 0.046284016221761703
epoch: 14 s: 768000 batch_loss 0.3615776002407074 BPR_loss 0.3134353756904602 reg_loss 0.048142220824956894
epoch: 14 s: 1024000 batch_loss 0.3630564212799072 BPR_loss 0.3146941065788269 reg_loss 0.04836231470108032
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 88.28180432319641 | 1250.0877754688263 | 223.1969451904297 | [0.09353076 0.13408772 0.16293326] | [0.04393218 0.05267879 0.05808256] | [0.00586542 0.00424517 0.00346064] | [0.11327632 0.16112138 0.19451212] |
|   14  | 88.28180432319641 | 1204.2550883293152 | 223.1969451904297 | [0.09353076 0.13408772 0.16293326] | [0.04393218 0.05267879 0.05808256] | [0.00586542 0.00424517 0.00346064] | [0.11327632 0.16112138 0.19451212] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.35988637804985046 BPR_loss 0.31150442361831665 reg_loss 0.048381950706243515
epoch: 15 s: 256000 batch_loss 0.35019224882125854 BPR_loss 0.3003314733505249 reg_loss 0.04986076056957245
epoch: 15 s: 512000 batch_loss 0.35108548402786255 BPR_loss 0.301288366317749 reg_loss 0.04979711025953293
epoch: 15 s: 768000 batch_loss 0.35326820611953735 BPR_loss 0.3033066689968109 reg_loss 0.04996153712272644
epoch: 15 s: 1024000 batch_loss 0.3533676564693451 BPR_loss 0.30272215604782104 reg_loss 0.05064550042152405
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 80.10295963287354 | 1224.1867196559906 | 215.2798309326172 | [0.09340696 0.13393228 0.16278722] | [0.04391668 0.05265194 0.0580597 ] | [0.00585519 0.0042394  0.00345804] | [0.11307175 0.16090193 0.19429266] |
|   15  | 80.10295963287354 | 1193.0554022789001 | 215.2798309326172 | [0.09340696 0.13393228 0.16278722] | [0.04391668 0.05265194 0.0580597 ] | [0.00585519 0.0042394  0.00345804] | [0.11307175 0.16090193 0.19429266] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.3414071798324585 BPR_loss 0.29075443744659424 reg_loss 0.05065273493528366
epoch: 16 s: 256000 batch_loss 0.3493236005306244 BPR_loss 0.2985246181488037 reg_loss 0.05079898610711098
epoch: 16 s: 512000 batch_loss 0.34548285603523254 BPR_loss 0.2948578894138336 reg_loss 0.05062495544552803
epoch: 16 s: 768000 batch_loss 0.33696866035461426 BPR_loss 0.2850687503814697 reg_loss 0.051899924874305725
epoch: 16 s: 1024000 batch_loss 0.3337043523788452 BPR_loss 0.2805108428001404 reg_loss 0.05319352075457573
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 79.43029141426086 | 1203.1137504577637 | 207.73687744140625 | [0.09322752 0.13363239 0.16233823] | [0.04389531 0.05259789 0.05798331] | [0.00584998 0.00422945 0.00345072] | [0.11292296 0.16045558 0.19380168] |
|   16  | 79.43029141426086 | 1174.8122465610504 | 207.73687744140625 | [0.09322752 0.13363239 0.16233823] | [0.04389531 0.05259789 0.05798331] | [0.00584998 0.00422945 0.00345072] | [0.11292296 0.16045558 0.19380168] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.32678723335266113 BPR_loss 0.273942232131958 reg_loss 0.052845001220703125
epoch: 17 s: 256000 batch_loss 0.3301627039909363 BPR_loss 0.2775389850139618 reg_loss 0.052623722702264786
epoch: 17 s: 512000 batch_loss 0.33366844058036804 BPR_loss 0.2799587845802307 reg_loss 0.05370965600013733
epoch: 17 s: 768000 batch_loss 0.32079052925109863 BPR_loss 0.2669009566307068 reg_loss 0.05388955771923065
epoch: 17 s: 1024000 batch_loss 0.31971368193626404 BPR_loss 0.26497411727905273 reg_loss 0.054739560931921005
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 78.50965166091919 | 1230.1269841194153 | 200.7069091796875 | [0.09300977 0.1333545  0.16212212] | [0.04379788 0.05249617 0.05788711] | [0.00583733 0.00422601 0.00344781] | [0.11268119 0.16031423 0.19367893] |
|   17  | 78.50965166091919 | 1180.1422533988953 | 200.7069091796875 | [0.09300977 0.1333545  0.16212212] | [0.04379788 0.05249617 0.05788711] | [0.00583733 0.00422601 0.00344781] | [0.11268119 0.16031423 0.19367893] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.31427696347236633 BPR_loss 0.259424090385437 reg_loss 0.05485287308692932
epoch: 18 s: 256000 batch_loss 0.3177371025085449 BPR_loss 0.26361319422721863 reg_loss 0.0541238933801651
epoch: 18 s: 512000 batch_loss 0.3235686123371124 BPR_loss 0.26814794540405273 reg_loss 0.05542067065834999
epoch: 18 s: 768000 batch_loss 0.3133057951927185 BPR_loss 0.257091224193573 reg_loss 0.05621457099914551
epoch: 18 s: 1024000 batch_loss 0.309506893157959 BPR_loss 0.2536255121231079 reg_loss 0.05588137358427048
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 78.69229245185852 | 1230.255970954895 | 194.53147888183594 | [0.09277756 0.13302233 0.1616837 ] | [0.04363469 0.05231082 0.05768721] | [0.00582413 0.00421494 0.00343969] | [0.1124171  0.15989764 0.19319539] |
|   18  | 78.69229245185852 | 1176.852558851242 | 194.53147888183594 | [0.09277756 0.13302233 0.1616837 ] | [0.04363469 0.05231082 0.05768721] | [0.00582413 0.00421494 0.00343969] | [0.1124171  0.15989764 0.19319539] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.3218199610710144 BPR_loss 0.2659341096878052 reg_loss 0.05588585138320923
epoch: 19 s: 256000 batch_loss 0.31183144450187683 BPR_loss 0.25487303733825684 reg_loss 0.05695841461420059
epoch: 19 s: 512000 batch_loss 0.3234182894229889 BPR_loss 0.2666187882423401 reg_loss 0.056799501180648804
epoch: 19 s: 768000 batch_loss 0.3023652136325836 BPR_loss 0.2445862591266632 reg_loss 0.05777895078063011
epoch: 19 s: 1024000 batch_loss 0.2946503460407257 BPR_loss 0.23831328749656677 reg_loss 0.05633706599473953
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 80.14549970626831 | 1220.3859074115753 | 188.95518493652344 | [0.09271709 0.13277368 0.16135906] | [0.04363828 0.05227394 0.05763159] | [0.00582264 0.0042075  0.00343237] | [0.1124357  0.15967074 0.19276391] |
|   19  | 80.14549970626831 | 1103.8892607688904 | 188.95518493652344 | [0.09271709 0.13277368 0.16135906] | [0.04363828 0.05227394 0.05763159] | [0.00582264 0.0042075  0.00343237] | [0.1124357  0.15967074 0.19276391] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.3018326759338379 BPR_loss 0.24299094080924988 reg_loss 0.05884175002574921
epoch: 20 s: 256000 batch_loss 0.3056645095348358 BPR_loss 0.24706000089645386 reg_loss 0.05860449746251106
epoch: 20 s: 512000 batch_loss 0.31081485748291016 BPR_loss 0.25274622440338135 reg_loss 0.05806863307952881
epoch: 20 s: 768000 batch_loss 0.2977263629436493 BPR_loss 0.23954768478870392 reg_loss 0.05817867070436478
epoch: 20 s: 1024000 batch_loss 0.301540732383728 BPR_loss 0.2422531545162201 reg_loss 0.05928756296634674
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 73.09908628463745 | 998.3557047843933 | 183.7390594482422 | [0.09236829 0.13241386 0.16103039] | [0.04356841 0.05220051 0.05756304] | [0.00580237 0.00419635 0.00342425] | [0.11203026 0.15922439 0.19237708] |
|   20  | 73.09908628463745 | 968.9433794021606 | 183.7390594482422 | [0.09236829 0.13241386 0.16103039] | [0.04356841 0.05220051 0.05756304] | [0.00580237 0.00419635 0.00342425] | [0.11203026 0.15922439 0.19237708] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.29606255888938904 BPR_loss 0.23688626289367676 reg_loss 0.059176284819841385
epoch: 21 s: 256000 batch_loss 0.2949925661087036 BPR_loss 0.23473891615867615 reg_loss 0.06025365740060806
epoch: 21 s: 512000 batch_loss 0.292910635471344 BPR_loss 0.23345264792442322 reg_loss 0.05945797264575958
epoch: 21 s: 768000 batch_loss 0.28621482849121094 BPR_loss 0.225449338555336 reg_loss 0.060765475034713745
epoch: 21 s: 1024000 batch_loss 0.2742922604084015 BPR_loss 0.21358168125152588 reg_loss 0.06071057915687561
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 73.49963068962097 | 996.7282180786133 | 179.01278686523438 | [0.09199823 0.13215893 0.16043192] | [0.04341858 0.05207641 0.05737748] | [0.00578154 0.00419216 0.00341557] | [0.1116583  0.15900122 0.19174475] |
|   21  | 73.49963068962097 | 958.7963943481445 | 179.01278686523438 | [0.09199823 0.13215893 0.16043192] | [0.04341858 0.05207641 0.05737748] | [0.00578154 0.00419216 0.00341557] | [0.1116583  0.15900122 0.19174475] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.30033448338508606 BPR_loss 0.23929134011268616 reg_loss 0.061043135821819305
epoch: 22 s: 256000 batch_loss 0.28490570187568665 BPR_loss 0.22490449249744415 reg_loss 0.060001201927661896
epoch: 22 s: 512000 batch_loss 0.28347092866897583 BPR_loss 0.22167769074440002 reg_loss 0.061793237924575806
epoch: 22 s: 768000 batch_loss 0.28326892852783203 BPR_loss 0.22161100804805756 reg_loss 0.06165790930390358
epoch: 22 s: 1024000 batch_loss 0.28365641832351685 BPR_loss 0.22083589434623718 reg_loss 0.06282052397727966
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 68.99981021881104 | 864.7432909011841 | 174.5115966796875 | [0.09186045 0.13162361 0.16006571] | [0.04335711 0.0519328  0.05726267] | [0.00577057 0.00417691 0.00340702] | [0.11147604 0.1584098  0.19132443] |
|   22  | 68.99981021881104 | 831.0785119533539 | 174.5115966796875 | [0.09186045 0.13162361 0.16006571] | [0.04335711 0.0519328  0.05726267] | [0.00577057 0.00417691 0.00340702] | [0.11147604 0.1584098  0.19132443] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.2814421057701111 BPR_loss 0.2197045385837555 reg_loss 0.061737582087516785
epoch: 23 s: 256000 batch_loss 0.28296270966529846 BPR_loss 0.21942511200904846 reg_loss 0.0635375902056694
epoch: 23 s: 512000 batch_loss 0.2718886733055115 BPR_loss 0.2101472020149231 reg_loss 0.061741460114717484
epoch: 23 s: 768000 batch_loss 0.26943540573120117 BPR_loss 0.2067466527223587 reg_loss 0.06268875300884247
epoch: 23 s: 1024000 batch_loss 0.2654612362384796 BPR_loss 0.20292532444000244 reg_loss 0.06253590434789658
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 68.81347632408142 |  838.631991147995 | 170.60845947265625 | [0.09159674 0.13131611 0.15958818] | [0.04323501 0.05181062 0.05710449] | [0.00575476 0.00417049 0.00339722] | [0.11108549 0.15808248 0.19078509] |
|   23  | 68.81347632408142 | 824.1556210517883 | 170.60845947265625 | [0.09159674 0.13131611 0.15958818] | [0.04323501 0.05181062 0.05710449] | [0.00575476 0.00417049 0.00339722] | [0.11108549 0.15808248 0.19078509] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.09159674024454639
early stopping at 23, recall@20:0.0937
