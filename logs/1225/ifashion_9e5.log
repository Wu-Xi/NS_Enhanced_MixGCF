Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='ifashion', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=9e-05, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.693148136138916 BPR_loss 0.693148136138916 reg_loss 2.8927885864504788e-08
epoch: 0 s: 256000 batch_loss 0.6931413412094116 BPR_loss 0.6931409239768982 reg_loss 4.374234094939311e-07
epoch: 0 s: 512000 batch_loss 0.6930713057518005 BPR_loss 0.693067193031311 reg_loss 4.096634256711695e-06
epoch: 0 s: 768000 batch_loss 0.6927639842033386 BPR_loss 0.6927419304847717 reg_loss 2.202921677962877e-05
epoch: 0 s: 1024000 batch_loss 0.6917542219161987 BPR_loss 0.6916758418083191 reg_loss 7.840574835427105e-05
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 108.47847986221313 | 1998.784081697464  | 424.5353088378906 | [0.07716645 0.11472594 0.14297596] | [0.03548367 0.04355334 0.04882603] | [0.00481798 0.00361256 0.00301566] | [0.09363318 0.13829055 0.17129445] |
|   0   | 108.47847986221313 | 1948.5511660575867 | 424.5353088378906 | [0.07716645 0.11472594 0.14297596] | [0.03548367 0.04355334 0.04882603] | [0.00481798 0.00361256 0.00301566] | [0.09363318 0.13829055 0.17129445] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6897581219673157 BPR_loss 0.6895772218704224 reg_loss 0.00018088619981426746
epoch: 1 s: 256000 batch_loss 0.686948299407959 BPR_loss 0.6866077184677124 reg_loss 0.0003405599854886532
epoch: 1 s: 512000 batch_loss 0.6826568841934204 BPR_loss 0.682051420211792 reg_loss 0.000605440407525748
epoch: 1 s: 768000 batch_loss 0.6783792972564697 BPR_loss 0.6774797439575195 reg_loss 0.0008995816460810602
epoch: 1 s: 1024000 batch_loss 0.6732842326164246 BPR_loss 0.6720259189605713 reg_loss 0.0012582966592162848
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 117.17176246643066 | 2157.5939371585846 | 416.7594909667969 | [0.08346672 0.12340125 0.15264865] | [0.03850386 0.04707899 0.05254148] | [0.00520724 0.00387916 0.00321695] | [0.10115047 0.148326   0.18231559] |
|   1   | 117.17176246643066 | 1925.522484779358  | 416.7594909667969 | [0.08346672 0.12340125 0.15264865] | [0.03850386 0.04707899 0.05254148] | [0.00520724 0.00387916 0.00321695] | [0.10115047 0.148326   0.18231559] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6664257049560547 BPR_loss 0.6648096442222595 reg_loss 0.001616065506823361
epoch: 2 s: 256000 batch_loss 0.659065842628479 BPR_loss 0.6570762991905212 reg_loss 0.0019895259756594896
epoch: 2 s: 512000 batch_loss 0.6504107713699341 BPR_loss 0.6477416753768921 reg_loss 0.0026690710801631212
epoch: 2 s: 768000 batch_loss 0.6440466642379761 BPR_loss 0.6410382986068726 reg_loss 0.0030083798337727785
epoch: 2 s: 1024000 batch_loss 0.6336324214935303 BPR_loss 0.6300426721572876 reg_loss 0.003589724423363805
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 105.92693018913269 | 2190.0003457069397 | 396.8056945800781 | [0.08657756 0.12743028 0.15790721] | [0.04005188 0.04883164 0.054529  ] | [0.00539973 0.00400609 0.00333027] | [0.10477707 0.15293457 0.18824833] |
|   2   | 105.92693018913269 | 1902.4533953666687 | 396.8056945800781 | [0.08657756 0.12743028 0.15790721] | [0.04005188 0.04883164 0.054529  ] | [0.00539973 0.00400609 0.00333027] | [0.10477707 0.15293457 0.18824833] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6279305219650269 BPR_loss 0.6239397525787354 reg_loss 0.003990768454968929
epoch: 3 s: 256000 batch_loss 0.6209830641746521 BPR_loss 0.6163126230239868 reg_loss 0.004670417867600918
epoch: 3 s: 512000 batch_loss 0.6119055151939392 BPR_loss 0.6068074703216553 reg_loss 0.0050980630330741405
epoch: 3 s: 768000 batch_loss 0.603975236415863 BPR_loss 0.5983525514602661 reg_loss 0.005622666794806719
epoch: 3 s: 1024000 batch_loss 0.5956264138221741 BPR_loss 0.5894944667816162 reg_loss 0.0061319503001868725
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 99.82863593101501 | 2176.585957765579 | 372.29144287109375 | [0.08889971 0.13064124 0.16121904] | [0.04137099 0.05034001 0.05605256] | [0.00555074 0.00410968 0.00340051] | [0.10760395 0.15672855 0.19212786] |
|   3   | 99.82863593101501 | 1951.932951450348 | 372.29144287109375 | [0.08889971 0.13064124 0.16121904] | [0.04137099 0.05034001 0.05605256] | [0.00555074 0.00410968 0.00340051] | [0.10760395 0.15672855 0.19212786] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.5867156982421875 BPR_loss 0.5802409052848816 reg_loss 0.006474809721112251
epoch: 4 s: 256000 batch_loss 0.5793202519416809 BPR_loss 0.5721191167831421 reg_loss 0.007201106287539005
epoch: 4 s: 512000 batch_loss 0.5688999891281128 BPR_loss 0.5609467029571533 reg_loss 0.007953261025249958
epoch: 4 s: 768000 batch_loss 0.5607738494873047 BPR_loss 0.5526740550994873 reg_loss 0.00809978973120451
epoch: 4 s: 1024000 batch_loss 0.5494518876075745 BPR_loss 0.5408381223678589 reg_loss 0.008613760583102703
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 97.98638582229614 | 2196.867258787155  | 347.5185241699219 | [0.09089396 0.13262939 0.16367716] | [0.0422683  0.05125186 0.05705393] | [0.00567758 0.00417487 0.00345382] | [0.11004028 0.15904957 0.19498823] |
|   4   | 97.98638582229614 | 1937.7490932941437 | 347.5185241699219 | [0.09089396 0.13262939 0.16367716] | [0.0422683  0.05125186 0.05705393] | [0.00567758 0.00417487 0.00345382] | [0.11004028 0.15904957 0.19498823] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.5458295345306396 BPR_loss 0.5369560718536377 reg_loss 0.0088734682649374
epoch: 5 s: 256000 batch_loss 0.5407232046127319 BPR_loss 0.5311070680618286 reg_loss 0.009616130031645298
epoch: 5 s: 512000 batch_loss 0.5335988402366638 BPR_loss 0.5235841274261475 reg_loss 0.010014692321419716
epoch: 5 s: 768000 batch_loss 0.5269443392753601 BPR_loss 0.5163106918334961 reg_loss 0.010633660480380058
epoch: 5 s: 1024000 batch_loss 0.5116283297538757 BPR_loss 0.5005163550376892 reg_loss 0.011111950501799583
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 96.67514872550964 | 2184.120125770569  | 324.6376647949219 | [0.092551   0.13473009 0.16549824] | [0.04314282 0.05221913 0.05796974] | [0.00578396 0.00424517 0.00349629] | [0.11193727 0.16150078 0.19716791] |
|   5   | 96.67514872550964 | 1987.4170186519623 | 324.6376647949219 | [0.092551   0.13473009 0.16549824] | [0.04314282 0.05221913 0.05796974] | [0.00578396 0.00424517 0.00349629] | [0.11193727 0.16150078 0.19716791] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.5145143270492554 BPR_loss 0.5029114484786987 reg_loss 0.011602872982621193
epoch: 6 s: 256000 batch_loss 0.5010337233543396 BPR_loss 0.48917728662490845 reg_loss 0.011856434866786003
epoch: 6 s: 512000 batch_loss 0.4986327886581421 BPR_loss 0.4863685965538025 reg_loss 0.01226419024169445
epoch: 6 s: 768000 batch_loss 0.49654391407966614 BPR_loss 0.4835481643676758 reg_loss 0.012995735742151737
epoch: 6 s: 1024000 batch_loss 0.4827444851398468 BPR_loss 0.4696345031261444 reg_loss 0.013109978288412094
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 144.7851881980896 | 2408.3859343528748 | 303.8879699707031 | [0.09396679 0.13626425 0.16701196] | [0.04381244 0.05291026 0.05866262] | [0.00587137 0.00429333 0.00353181] | [0.11361109 0.16326386 0.19896819] |
|   6   | 144.7851881980896 | 2301.2232859134674 | 303.8879699707031 | [0.09396679 0.13626425 0.16701196] | [0.04381244 0.05291026 0.05866262] | [0.00587137 0.00429333 0.00353181] | [0.11361109 0.16326386 0.19896819] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.4803321659564972 BPR_loss 0.46685755252838135 reg_loss 0.01347460225224495
epoch: 7 s: 256000 batch_loss 0.47263991832733154 BPR_loss 0.4584755301475525 reg_loss 0.014164387248456478
epoch: 7 s: 512000 batch_loss 0.4597165286540985 BPR_loss 0.44486817717552185 reg_loss 0.014848344027996063
epoch: 7 s: 768000 batch_loss 0.45062610507011414 BPR_loss 0.4351422190666199 reg_loss 0.015483886934816837
epoch: 7 s: 1024000 batch_loss 0.4550514221191406 BPR_loss 0.4400968849658966 reg_loss 0.014954552054405212
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 149.0400788784027 | 2451.1995751857758 | 284.8135070800781 | [0.09488408 0.13726439 0.16821508] | [0.04431174 0.0534349  0.05922621] | [0.00592679 0.0043283  0.0035589 ] | [0.11458934 0.16448389 0.20032956] |
|   7   | 149.0400788784027 | 2315.4512333869934 | 284.8135070800781 | [0.09488408 0.13726439 0.16821508] | [0.04431174 0.0534349  0.05922621] | [0.00592679 0.0043283  0.0035589 ] | [0.11458934 0.16448389 0.20032956] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.4524939954280853 BPR_loss 0.4365163743495941 reg_loss 0.015977617353200912
epoch: 8 s: 256000 batch_loss 0.43737906217575073 BPR_loss 0.42126327753067017 reg_loss 0.01611579768359661
epoch: 8 s: 512000 batch_loss 0.4264467656612396 BPR_loss 0.40932533144950867 reg_loss 0.01712142303586006
epoch: 8 s: 768000 batch_loss 0.4368501305580139 BPR_loss 0.420024573802948 reg_loss 0.016825569793581963
epoch: 8 s: 1024000 batch_loss 0.41741833090782166 BPR_loss 0.3997468948364258 reg_loss 0.017671439796686172
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 153.88555908203125 | 2412.9744567871094 | 267.36102294921875 | [0.0951781  0.13813782 0.16898332] | [0.04455366 0.05379698 0.0595742 ] | [0.0059506  0.00435341 0.00357632] | [0.11506545 0.16546958 0.20120366] |
|   8   | 153.88555908203125 | 2375.4523696899414 | 267.36102294921875 | [0.0951781  0.13813782 0.16898332] | [0.04455366 0.05379698 0.0595742 ] | [0.0059506  0.00435341 0.00357632] | [0.11506545 0.16546958 0.20120366] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.42259860038757324 BPR_loss 0.4043503403663635 reg_loss 0.018248263746500015
epoch: 9 s: 256000 batch_loss 0.4098694920539856 BPR_loss 0.3917098343372345 reg_loss 0.018159659579396248
epoch: 9 s: 512000 batch_loss 0.4075317680835724 BPR_loss 0.38962966203689575 reg_loss 0.01790209487080574
epoch: 9 s: 768000 batch_loss 0.41047292947769165 BPR_loss 0.3920832574367523 reg_loss 0.01838967204093933
epoch: 9 s: 1024000 batch_loss 0.3960387110710144 BPR_loss 0.37647727131843567 reg_loss 0.01956142485141754
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 151.92363667488098 | 2431.1230652332306 | 252.29568481445312 | [0.09598453 0.13902152 0.16940265] | [0.04494422 0.05420407 0.05989493] | [0.00600416 0.00438521 0.00358779] | [0.11595443 0.1665371  0.20172068] |
|   9   | 151.92363667488098 | 2289.3307909965515 | 252.29568481445312 | [0.09598453 0.13902152 0.16940265] | [0.04494422 0.05420407 0.05989493] | [0.00600416 0.00438521 0.00358779] | [0.11595443 0.1665371  0.20172068] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.4085337221622467 BPR_loss 0.389819860458374 reg_loss 0.018713854253292084
epoch: 10 s: 256000 batch_loss 0.41021645069122314 BPR_loss 0.39078736305236816 reg_loss 0.019429074600338936
epoch: 10 s: 512000 batch_loss 0.38542577624320984 BPR_loss 0.3652917146682739 reg_loss 0.020134055987000465
epoch: 10 s: 768000 batch_loss 0.39558932185173035 BPR_loss 0.3753955364227295 reg_loss 0.020193785429000854
epoch: 10 s: 1024000 batch_loss 0.38289955258369446 BPR_loss 0.3619210720062256 reg_loss 0.02097848430275917
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 146.88791179656982 | 2401.1759753227234 | 238.31219482421875 | [0.09670279 0.13941066 0.16991332] | [0.0452408  0.05442935 0.06013919] | [0.00605196 0.00440195 0.00359951] | [0.11686573 0.1670504  0.20240137] |
|   10  | 146.88791179656982 | 2282.9356033802032 | 238.31219482421875 | [0.09670279 0.13941066 0.16991332] | [0.0452408  0.05442935 0.06013919] | [0.00605196 0.00440195 0.00359951] | [0.11686573 0.1670504  0.20240137] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.3845694065093994 BPR_loss 0.3634611666202545 reg_loss 0.021108252927660942
epoch: 11 s: 256000 batch_loss 0.3791202902793884 BPR_loss 0.3582894206047058 reg_loss 0.02083086408674717
epoch: 11 s: 512000 batch_loss 0.36239302158355713 BPR_loss 0.34009069204330444 reg_loss 0.022302331402897835
epoch: 11 s: 768000 batch_loss 0.36846455931663513 BPR_loss 0.34724849462509155 reg_loss 0.021216074004769325
epoch: 11 s: 1024000 batch_loss 0.3629548251628876 BPR_loss 0.3411451280117035 reg_loss 0.021809691563248634
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 159.60570883750916 | 2496.540856361389  | 226.15155029296875 | [0.09708086 0.13945139 0.17011887] | [0.04547937 0.05460436 0.06034266] | [0.00607855 0.0044079  0.00360484] | [0.11736415 0.16720291 0.20254271] |
|   11  | 159.60570883750916 | 2319.2330145835876 | 226.15155029296875 | [0.09708086 0.13945139 0.17011887] | [0.04547937 0.05460436 0.06034266] | [0.00607855 0.0044079  0.00360484] | [0.11736415 0.16720291 0.20254271] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.3599874973297119 BPR_loss 0.33716729283332825 reg_loss 0.02282019704580307
epoch: 12 s: 256000 batch_loss 0.35954517126083374 BPR_loss 0.33658820390701294 reg_loss 0.022956978529691696
epoch: 12 s: 512000 batch_loss 0.35239872336387634 BPR_loss 0.3299208879470825 reg_loss 0.022477826103568077
epoch: 12 s: 768000 batch_loss 0.3451452851295471 BPR_loss 0.32164305448532104 reg_loss 0.023502234369516373
epoch: 12 s: 1024000 batch_loss 0.34866106510162354 BPR_loss 0.32527491450309753 reg_loss 0.0233861543238163
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 153.57773160934448 | 2506.7636551856995 | 214.47596740722656 | [0.09732523 0.13972193 0.17031872] | [0.04567984 0.05481072 0.06054144] | [0.00609826 0.00441701 0.00361265] | [0.11766172 0.1674856  0.20286631] |
|   12  | 153.57773160934448 | 2309.7924902439117 | 214.47596740722656 | [0.09732523 0.13972193 0.17031872] | [0.04567984 0.05481072 0.06054144] | [0.00609826 0.00441701 0.00361265] | [0.11766172 0.1674856  0.20286631] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.33747774362564087 BPR_loss 0.31342458724975586 reg_loss 0.024053145200014114
epoch: 13 s: 256000 batch_loss 0.33462396264076233 BPR_loss 0.3095230460166931 reg_loss 0.02510092779994011
epoch: 13 s: 512000 batch_loss 0.3438175916671753 BPR_loss 0.31981563568115234 reg_loss 0.0240019541233778
epoch: 13 s: 768000 batch_loss 0.32370758056640625 BPR_loss 0.2983244061470032 reg_loss 0.025383180007338524
epoch: 13 s: 1024000 batch_loss 0.3272770941257477 BPR_loss 0.3022931218147278 reg_loss 0.024983976036310196
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 143.03960418701172 | 2442.8587419986725 | 204.44627380371094 | [0.09766764 0.13973314 0.17029558] | [0.04590254 0.05496545 0.06069049] | [0.00612337 0.00441943 0.00361364] | [0.11811923 0.16757487 0.20283284] |
|   13  | 143.03960418701172 | 2308.920672893524  | 204.44627380371094 | [0.09766764 0.13973314 0.17029558] | [0.04590254 0.05496545 0.06069049] | [0.00612337 0.00441943 0.00361364] | [0.11811923 0.16757487 0.20283284] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.3215298354625702 BPR_loss 0.29649704694747925 reg_loss 0.025032777339220047
epoch: 14 s: 256000 batch_loss 0.32330286502838135 BPR_loss 0.29790329933166504 reg_loss 0.025399550795555115
epoch: 14 s: 512000 batch_loss 0.32793471217155457 BPR_loss 0.3029651641845703 reg_loss 0.024969546124339104
epoch: 14 s: 768000 batch_loss 0.31723570823669434 BPR_loss 0.29116931557655334 reg_loss 0.026066387072205544
epoch: 14 s: 1024000 batch_loss 0.30875465273857117 BPR_loss 0.2828120291233063 reg_loss 0.025942621752619743
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 143.59191846847534 | 2518.8135561943054 | 194.9432830810547 | [0.09784468 0.13997793 0.17028554] | [0.04597328 0.05505033 0.06072587] | [0.00613769 0.00443049 0.00361513] | [0.1183424  0.16787615 0.20284028] |
|   14  | 143.59191846847534 | 2267.6395378112793 | 194.9432830810547 | [0.09784468 0.13997793 0.17028554] | [0.04597328 0.05505033 0.06072587] | [0.00613769 0.00443049 0.00361513] | [0.1183424  0.16787615 0.20284028] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.31793707609176636 BPR_loss 0.2917541265487671 reg_loss 0.02618294395506382
epoch: 15 s: 256000 batch_loss 0.3035091459751129 BPR_loss 0.27651235461235046 reg_loss 0.026996787637472153
epoch: 15 s: 512000 batch_loss 0.30256903171539307 BPR_loss 0.27572014927864075 reg_loss 0.026848873123526573
epoch: 15 s: 768000 batch_loss 0.305569052696228 BPR_loss 0.2786639928817749 reg_loss 0.02690504491329193
epoch: 15 s: 1024000 batch_loss 0.30024945735931396 BPR_loss 0.2729385197162628 reg_loss 0.027310935780405998
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 162.02651071548462 | 2397.9176948070526 | 186.52365112304688 | [0.09801275 0.13985218 0.1701203 ] | [0.04605894 0.05508662 0.06075538] | [0.00614848 0.00443189 0.00361302] | [0.11852094 0.16780176 0.20271753] |
|   15  | 162.02651071548462 | 2242.1503891944885 | 186.52365112304688 | [0.09801275 0.13985218 0.1701203 ] | [0.04605894 0.05508662 0.06075538] | [0.00614848 0.00443189 0.00361302] | [0.11852094 0.16780176 0.20271753] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.2913414239883423 BPR_loss 0.26394349336624146 reg_loss 0.027397917583584785
epoch: 16 s: 256000 batch_loss 0.30363529920578003 BPR_loss 0.27648013830184937 reg_loss 0.02715514600276947
epoch: 16 s: 512000 batch_loss 0.2965889573097229 BPR_loss 0.26934152841567993 reg_loss 0.027247434481978416
epoch: 16 s: 768000 batch_loss 0.2914663255214691 BPR_loss 0.2636321187019348 reg_loss 0.0278342142701149
epoch: 16 s: 1024000 batch_loss 0.29018211364746094 BPR_loss 0.2611508369445801 reg_loss 0.029031265527009964
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 161.2401511669159 | 2431.5375459194183 | 178.79336547851562 | [0.09793306 0.13985089 0.16979944] | [0.04606839 0.05510938 0.06072496] | [0.00614476 0.00443226 0.00361042] | [0.11839076 0.1677906  0.20246088] |
|   16  | 161.2401511669159 | 2309.5399832725525 | 178.79336547851562 | [0.09793306 0.13985089 0.16979944] | [0.04606839 0.05510938 0.06072496] | [0.00614476 0.00443226 0.00361042] | [0.11839076 0.1677906  0.20246088] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.28556203842163086 BPR_loss 0.2569853365421295 reg_loss 0.028576688840985298
epoch: 17 s: 256000 batch_loss 0.2813684642314911 BPR_loss 0.2530640959739685 reg_loss 0.028304357081651688
epoch: 17 s: 512000 batch_loss 0.28633782267570496 BPR_loss 0.2571467161178589 reg_loss 0.02919110842049122
epoch: 17 s: 768000 batch_loss 0.27107325196266174 BPR_loss 0.24201473593711853 reg_loss 0.02905852533876896
epoch: 17 s: 1024000 batch_loss 0.2836564779281616 BPR_loss 0.2541278302669525 reg_loss 0.0295286625623703
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 154.96818208694458 | 2491.6076724529266 | 171.1241455078125 | [0.09790282 0.13980409 0.16948964] | [0.04614304 0.05517209 0.0607392 ] | [0.00614718 0.00443087 0.00360552] | [0.11848375 0.16772365 0.2021038 ] |
|   17  | 154.96818208694458 | 2168.1730284690857 | 171.1241455078125 | [0.09790282 0.13980409 0.16948964] | [0.04614304 0.05517209 0.0607392 ] | [0.00614718 0.00443087 0.00360552] | [0.11848375 0.16772365 0.2021038 ] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.2665553689002991 BPR_loss 0.23688890039920807 reg_loss 0.029666461050510406
epoch: 18 s: 256000 batch_loss 0.2679853141307831 BPR_loss 0.23899434506893158 reg_loss 0.0289909727871418
epoch: 18 s: 512000 batch_loss 0.2766643762588501 BPR_loss 0.24675823748111725 reg_loss 0.029906125739216805
epoch: 18 s: 768000 batch_loss 0.2630075216293335 BPR_loss 0.2326677143573761 reg_loss 0.030339820310473442
epoch: 18 s: 1024000 batch_loss 0.26552891731262207 BPR_loss 0.23550556600093842 reg_loss 0.0300233606249094
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 104.60553359985352 | 2192.268781900406  | 164.47276306152344 | [0.09777961 0.13947055 0.16932047] | [0.04611728 0.05510422 0.06070267] | [0.00614123 0.00441924 0.0036013 ] | [0.11830893 0.16731821 0.20185087] |
|   18  | 104.60553359985352 | 1948.2666442394257 | 164.47276306152344 | [0.09777961 0.13947055 0.16932047] | [0.04611728 0.05510422 0.06070267] | [0.00614123 0.00441924 0.0036013 ] | [0.11830893 0.16731821 0.20185087] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.27111390233039856 BPR_loss 0.24106630682945251 reg_loss 0.030047602951526642
epoch: 19 s: 256000 batch_loss 0.2631736695766449 BPR_loss 0.2325817048549652 reg_loss 0.030591966584324837
epoch: 19 s: 512000 batch_loss 0.27711057662963867 BPR_loss 0.24648521840572357 reg_loss 0.03062535636126995
epoch: 19 s: 768000 batch_loss 0.25618764758110046 BPR_loss 0.2249734252691269 reg_loss 0.03121422976255417
epoch: 19 s: 1024000 batch_loss 0.2449093461036682 BPR_loss 0.21489357948303223 reg_loss 0.030015774071216583
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 103.0708417892456 | 2141.890962123871  | 158.61325073242188 | [0.09741662 0.13936099 0.16916295] | [0.04599443 0.05503973 0.0606223 ] | [0.00612133 0.00441906 0.00359765] | [0.11787373 0.16721779 0.20172812] |
|   19  | 103.0708417892456 | 1930.9996252059937 | 158.61325073242188 | [0.09741662 0.13936099 0.16916295] | [0.04599443 0.05503973 0.0606223 ] | [0.00612133 0.00441906 0.00359765] | [0.11787373 0.16721779 0.20172812] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.2627311050891876 BPR_loss 0.23097120225429535 reg_loss 0.03175991028547287
epoch: 20 s: 256000 batch_loss 0.25304386019706726 BPR_loss 0.22119581699371338 reg_loss 0.03184803947806358
epoch: 20 s: 512000 batch_loss 0.2589602470397949 BPR_loss 0.22783873975276947 reg_loss 0.0311215128749609
epoch: 20 s: 768000 batch_loss 0.25670328736305237 BPR_loss 0.22529779374599457 reg_loss 0.0314055010676384
epoch: 20 s: 1024000 batch_loss 0.25586092472076416 BPR_loss 0.22392931580543518 reg_loss 0.031931597739458084
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 104.14399075508118 | 2166.140040397644 | 153.2210235595703 | [0.09748759 0.13903692 0.16870156] | [0.04602127 0.05498404 0.0605389 ] | [0.00612486 0.0044119  0.00358853] | [0.11799276 0.16695741 0.2012111 ] |
|   20  | 104.14399075508118 | 1606.277184009552 | 153.2210235595703 | [0.09748759 0.13903692 0.16870156] | [0.04602127 0.05498404 0.0605389 ] | [0.00612486 0.0044119  0.00358853] | [0.11799276 0.16695741 0.2012111 ] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.24556398391723633 BPR_loss 0.213597372174263 reg_loss 0.03196660801768303
epoch: 21 s: 256000 batch_loss 0.24141612648963928 BPR_loss 0.20880308747291565 reg_loss 0.03261303901672363
epoch: 21 s: 512000 batch_loss 0.2459656298160553 BPR_loss 0.21380895376205444 reg_loss 0.032156672328710556
epoch: 21 s: 768000 batch_loss 0.2429276704788208 BPR_loss 0.20998194813728333 reg_loss 0.032945726066827774
epoch: 21 s: 1024000 batch_loss 0.22579516470432281 BPR_loss 0.19301065802574158 reg_loss 0.03278450667858124
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 81.84751439094543 | 1504.1490573883057 | 148.0238037109375 | [0.09720028 0.13889088 0.16835427] | [0.04595784 0.05495489 0.06047424] | [0.00609994 0.00440725 0.00358308] | [0.11749806 0.16673052 0.2008131 ] |
|   21  | 81.84751439094543 | 1408.9392895698547 | 148.0238037109375 | [0.09720028 0.13889088 0.16835427] | [0.04595784 0.05495489 0.06047424] | [0.00609994 0.00440725 0.00358308] | [0.11749806 0.16673052 0.2008131 ] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.2517896294593811 BPR_loss 0.21878881752490997 reg_loss 0.03300080820918083
epoch: 22 s: 256000 batch_loss 0.2369575798511505 BPR_loss 0.2047305852174759 reg_loss 0.03222699835896492
epoch: 22 s: 512000 batch_loss 0.23653285205364227 BPR_loss 0.20297756791114807 reg_loss 0.0335552804172039
epoch: 22 s: 768000 batch_loss 0.2304813116788864 BPR_loss 0.1971222460269928 reg_loss 0.03335906192660332
epoch: 22 s: 1024000 batch_loss 0.22906199097633362 BPR_loss 0.1948128342628479 reg_loss 0.03424915671348572
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 82.98199510574341 | 1507.868965625763 | 143.09140014648438 | [0.09705524 0.13840341 0.16772213] | [0.04587132 0.05479073 0.06028413] | [0.0061005  0.00439516 0.00357093] | [0.11748318 0.16630649 0.20012498] |
|   22  | 82.98199510574341 | 1419.198971271515 | 143.09140014648438 | [0.09705524 0.13840341 0.16772213] | [0.04587132 0.05479073 0.06028413] | [0.0061005  0.00439516 0.00357093] | [0.11748318 0.16630649 0.20012498] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.23079073429107666 BPR_loss 0.1974753439426422 reg_loss 0.03331539407372475
epoch: 23 s: 256000 batch_loss 0.22456246614456177 BPR_loss 0.19007360935211182 reg_loss 0.034488849341869354
epoch: 23 s: 512000 batch_loss 0.23647469282150269 BPR_loss 0.2030649036169052 reg_loss 0.03340979665517807
epoch: 23 s: 768000 batch_loss 0.2213757485151291 BPR_loss 0.18740813434123993 reg_loss 0.03396761044859886
epoch: 23 s: 1024000 batch_loss 0.20921331644058228 BPR_loss 0.17560125887393951 reg_loss 0.033612050116062164
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 83.37822723388672 | 1486.9621527194977 | 139.1023406982422 | [0.09683209 0.13827552 0.1674547 ] | [0.04582005 0.05476184 0.06022642] | [0.00608264 0.00438958 0.00356349] | [0.11712238 0.16606099 0.19975302] |
|   23  | 83.37822723388672 | 1427.6961665153503 | 139.1023406982422 | [0.09683209 0.13827552 0.1674547 ] | [0.04582005 0.05476184 0.06022642] | [0.00608264 0.00438958 0.00356349] | [0.11712238 0.16606099 0.19975302] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.231735497713089 BPR_loss 0.19709961116313934 reg_loss 0.034635890275239944
epoch: 24 s: 256000 batch_loss 0.2188202142715454 BPR_loss 0.18481066823005676 reg_loss 0.03400954231619835
epoch: 24 s: 512000 batch_loss 0.2291726917028427 BPR_loss 0.19408783316612244 reg_loss 0.03508485481142998
epoch: 24 s: 768000 batch_loss 0.22185984253883362 BPR_loss 0.18611633777618408 reg_loss 0.03574351221323013
epoch: 24 s: 1024000 batch_loss 0.22052638232707977 BPR_loss 0.18632772564888 reg_loss 0.03419865295290947
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 86.73682498931885 | 1513.6236906051636 | 134.98777770996094 | [0.09669828 0.13771256 0.16699844] | [0.04572414 0.05457466 0.06006683] | [0.00607613 0.00437219 0.00355741] | [0.11699963 0.16539147 0.19935874] |
|   24  | 86.73682498931885 | 1457.3646070957184 | 134.98777770996094 | [0.09669828 0.13771256 0.16699844] | [0.04572414 0.05457466 0.06006683] | [0.00607613 0.00437219 0.00355741] | [0.11699963 0.16539147 0.19935874] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.22373169660568237 BPR_loss 0.1898302137851715 reg_loss 0.03390147536993027
epoch: 25 s: 256000 batch_loss 0.20172101259231567 BPR_loss 0.16716095805168152 reg_loss 0.034560054540634155
epoch: 25 s: 512000 batch_loss 0.20415204763412476 BPR_loss 0.16929203271865845 reg_loss 0.03486001119017601
epoch: 25 s: 768000 batch_loss 0.2107176035642624 BPR_loss 0.17551565170288086 reg_loss 0.03520194813609123
epoch: 25 s: 1024000 batch_loss 0.21123050153255463 BPR_loss 0.17615388333797455 reg_loss 0.03507661819458008
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 86.72050452232361 | 1550.2899761199951 | 131.42315673828125 | [0.09636049 0.13732573 0.16663521] | [0.04561293 0.05445974 0.05995362] | [0.00605567 0.00436224 0.00354997] | [0.11660536 0.16505299 0.1989905 ] |
|   25  | 86.72050452232361 | 1440.3449149131775 | 131.42315673828125 | [0.09636049 0.13732573 0.16663521] | [0.04561293 0.05445974 0.05995362] | [0.00605567 0.00436224 0.00354997] | [0.11660536 0.16505299 0.1989905 ] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.09636049245118426
early stopping at 25, recall@20:0.0980
