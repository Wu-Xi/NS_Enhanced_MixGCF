Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='gowalla', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=3, l2=0.0001, lr=0.01, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931487321853638 BPR_loss 0.6931487321853638 reg_loss 2.7992433260237704e-08
epoch: 0 s: 256000 batch_loss 0.5443617701530457 BPR_loss 0.5398566126823425 reg_loss 0.0045051369816064835
epoch: 0 s: 512000 batch_loss 0.46804100275039673 BPR_loss 0.4595544934272766 reg_loss 0.008486509323120117
epoch: 0 s: 768000 batch_loss 0.4284640848636627 BPR_loss 0.4171241521835327 reg_loss 0.01133991964161396
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 41.174261808395386 | 37.22164607048035 | 204.48898315429688 | [0.13514277 0.1935107  0.23545818] | [0.11374468 0.13202481 0.14453769] | [0.04303034 0.03092806 0.0252417 ] | [0.49122513 0.59846607 0.65704334] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.44451674818992615 BPR_loss 0.43271008133888245 reg_loss 0.011806653812527657
epoch: 1 s: 256000 batch_loss 0.3847697079181671 BPR_loss 0.36965054273605347 reg_loss 0.015119160525500774
epoch: 1 s: 512000 batch_loss 0.3726980686187744 BPR_loss 0.35501188039779663 reg_loss 0.017686182633042336
epoch: 1 s: 768000 batch_loss 0.34621867537498474 BPR_loss 0.325425922870636 reg_loss 0.02079274319112301
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 45.614723920822144 | 44.377997159957886 | 155.31471252441406 | [0.14426925 0.20540096 0.24881553] | [0.1210305  0.14020708 0.15316766] | [0.04552046 0.03262861 0.02657356] | [0.51215755 0.61651819 0.67362181] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.3537655174732208 BPR_loss 0.3333020806312561 reg_loss 0.02046344429254532
epoch: 2 s: 256000 batch_loss 0.36484575271606445 BPR_loss 0.3428412079811096 reg_loss 0.02200453355908394
epoch: 2 s: 512000 batch_loss 0.3233044743537903 BPR_loss 0.2981312870979309 reg_loss 0.02517317794263363
epoch: 2 s: 768000 batch_loss 0.3110789656639099 BPR_loss 0.28343310952186584 reg_loss 0.02764585241675377
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 48.03484296798706 | 45.91858172416687 | 132.6201934814453 | [0.15066265 0.21357907 0.25938038] | [0.12659582 0.14633307 0.15998707] | [0.04739768 0.03388958 0.02761962] | [0.52625762 0.63008239 0.68926251] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.3063720166683197 BPR_loss 0.2777816653251648 reg_loss 0.02859034389257431
epoch: 3 s: 256000 batch_loss 0.30488741397857666 BPR_loss 0.2752058804035187 reg_loss 0.02968154288828373
epoch: 3 s: 512000 batch_loss 0.2811768352985382 BPR_loss 0.24894046783447266 reg_loss 0.03223636373877525
epoch: 3 s: 768000 batch_loss 0.2863658368587494 BPR_loss 0.25257641077041626 reg_loss 0.03378942608833313
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 42.615070104599  | 44.26666617393494 | 117.56660461425781 | [0.1552164  0.21993939 0.26629913] | [0.13043067 0.15073434 0.16457288] | [0.04871224 0.03483907 0.028333  ] | [0.53576931 0.63979503 0.69880769] |
+-------+------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.2757894694805145 BPR_loss 0.24317559599876404 reg_loss 0.032613884657621384
epoch: 4 s: 256000 batch_loss 0.2628900706768036 BPR_loss 0.22803020477294922 reg_loss 0.03485987335443497
epoch: 4 s: 512000 batch_loss 0.27067363262176514 BPR_loss 0.23458796739578247 reg_loss 0.03608566150069237
epoch: 4 s: 768000 batch_loss 0.2665538787841797 BPR_loss 0.22807005047798157 reg_loss 0.03848382458090782
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 45.45480513572693 | 46.43387246131897 | 106.29051208496094 | [0.15844756 0.22340846 0.27032709] | [0.13344584 0.15383922 0.16784443] | [0.04963996 0.03536071 0.02873546] | [0.54223324 0.64635943 0.7040994 ] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.2558693587779999 BPR_loss 0.21823427081108093 reg_loss 0.03763507679104805
epoch: 5 s: 256000 batch_loss 0.26163285970687866 BPR_loss 0.22161194682121277 reg_loss 0.04002092033624649
epoch: 5 s: 512000 batch_loss 0.25076714158058167 BPR_loss 0.2091478407382965 reg_loss 0.04161929339170456
epoch: 5 s: 768000 batch_loss 0.233907088637352 BPR_loss 0.19016027450561523 reg_loss 0.04374681040644646
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 46.758289098739624 | 45.70138502120972 | 98.21363067626953 | [0.15967049 0.22565282 0.27308362] | [0.13424299 0.15501872 0.16917537] | [0.04989618 0.03561357 0.02892413] | [0.54276911 0.64793355 0.70848684] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.2329881191253662 BPR_loss 0.18878714740276337 reg_loss 0.04420096427202225
epoch: 6 s: 256000 batch_loss 0.21212196350097656 BPR_loss 0.1686353087425232 reg_loss 0.04348664730787277
epoch: 6 s: 512000 batch_loss 0.24433906376361847 BPR_loss 0.1977274864912033 reg_loss 0.04661158099770546
epoch: 6 s: 768000 batch_loss 0.23721632361412048 BPR_loss 0.19013801217079163 reg_loss 0.047078315168619156
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 42.71176743507385 | 44.430830240249634 | 91.43505096435547 | [0.16278942 0.229911   0.2771686 ] | [0.13703507 0.15811168 0.17228975] | [0.05075189 0.03615949 0.02938074] | [0.55161096 0.65453145 0.71341014] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.24177736043930054 BPR_loss 0.1951470971107483 reg_loss 0.04663025587797165
epoch: 7 s: 256000 batch_loss 0.22219818830490112 BPR_loss 0.17490723729133606 reg_loss 0.047290947288274765
epoch: 7 s: 512000 batch_loss 0.22244539856910706 BPR_loss 0.1720564067363739 reg_loss 0.050388988107442856
epoch: 7 s: 768000 batch_loss 0.21777737140655518 BPR_loss 0.16871140897274017 reg_loss 0.049065958708524704
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 45.23071575164795 | 46.056355237960815 | 86.44757080078125 | [0.16448954 0.23163728 0.27939743] | [0.13832257 0.15941407 0.17368447] | [0.05125427 0.03637132 0.02948233] | [0.5547257  0.65711032 0.71468283] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.21649160981178284 BPR_loss 0.16703924536705017 reg_loss 0.049452368170022964
epoch: 8 s: 256000 batch_loss 0.21266299486160278 BPR_loss 0.16199803352355957 reg_loss 0.050664957612752914
epoch: 8 s: 512000 batch_loss 0.19658654928207397 BPR_loss 0.14435309171676636 reg_loss 0.05223345756530762
epoch: 8 s: 768000 batch_loss 0.19574053585529327 BPR_loss 0.1439313292503357 reg_loss 0.05180920287966728
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 48.29200196266174 | 47.57533073425293 | 82.23117065429688 | [0.16499417 0.23280471 0.28112491] | [0.13845835 0.15984875 0.17428022] | [0.05127604 0.03652957 0.02962634] | [0.55459173 0.65818206 0.7164579 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.20262393355369568 BPR_loss 0.15177008509635925 reg_loss 0.050853848457336426
epoch: 9 s: 256000 batch_loss 0.20441457629203796 BPR_loss 0.15315312147140503 reg_loss 0.05126144737005234
epoch: 9 s: 512000 batch_loss 0.19915686547756195 BPR_loss 0.1470261514186859 reg_loss 0.05213071033358574
epoch: 9 s: 768000 batch_loss 0.18704114854335785 BPR_loss 0.13235193490982056 reg_loss 0.05468921363353729
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 46.582204818725586 | 49.497289419174194 | 78.87496948242188 | [0.1667225  0.2341979  0.28328616] | [0.13975991 0.16106905 0.1757388 ] | [0.0516411  0.03668447 0.02980217] | [0.55747203 0.66045951 0.7205774 ] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.19545623660087585 BPR_loss 0.14188577234745026 reg_loss 0.053570456802845
epoch: 10 s: 256000 batch_loss 0.18203938007354736 BPR_loss 0.12938804924488068 reg_loss 0.05265133082866669
epoch: 10 s: 512000 batch_loss 0.18472322821617126 BPR_loss 0.12800677120685577 reg_loss 0.05671645328402519
epoch: 10 s: 768000 batch_loss 0.17985263466835022 BPR_loss 0.12631219625473022 reg_loss 0.05354044586420059
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 46.397263050079346 | 50.50097346305847 | 74.96987915039062 | [0.16740478 0.23529507 0.28469616] | [0.14007281 0.16155053 0.17631122] | [0.05170641 0.03675481 0.02986972] | [0.55827584 0.66216759 0.72128073] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.17791524529457092 BPR_loss 0.12193156778812408 reg_loss 0.05598367005586624
epoch: 11 s: 256000 batch_loss 0.19229353964328766 BPR_loss 0.1341525763273239 reg_loss 0.05814095959067345
epoch: 11 s: 512000 batch_loss 0.18535038828849792 BPR_loss 0.1290062665939331 reg_loss 0.05634411424398422
epoch: 11 s: 768000 batch_loss 0.1773402988910675 BPR_loss 0.1210775077342987 reg_loss 0.0562627837061882
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 50.03204798698425 | 42.68667531013489 | 72.58826446533203 | [0.1689221  0.237175   0.28572587] | [0.1412424  0.16283186 0.17740208] | [0.05210999 0.03701437 0.03000592] | [0.56179248 0.66575122 0.72238596] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.18184679746627808 BPR_loss 0.1262483298778534 reg_loss 0.05559846758842468
epoch: 12 s: 256000 batch_loss 0.17757548391819 BPR_loss 0.12014356255531311 reg_loss 0.05743192136287689
epoch: 12 s: 512000 batch_loss 0.16892413794994354 BPR_loss 0.11172020435333252 reg_loss 0.057203929871320724
epoch: 12 s: 768000 batch_loss 0.18173518776893616 BPR_loss 0.12254396826028824 reg_loss 0.05919122323393822
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 44.150954484939575 | 46.461660623550415 | 70.25946044921875 | [0.16913179 0.23839067 0.28740151] | [0.14176225 0.16366407 0.17835419] | [0.05219372 0.03717764 0.03016277] | [0.56329962 0.66745931 0.72499833] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.16473323106765747 BPR_loss 0.10623496025800705 reg_loss 0.05849827826023102
epoch: 13 s: 256000 batch_loss 0.16701817512512207 BPR_loss 0.10856704413890839 reg_loss 0.05845113471150398
epoch: 13 s: 512000 batch_loss 0.172429621219635 BPR_loss 0.11459701508283615 reg_loss 0.05783260241150856
epoch: 13 s: 768000 batch_loss 0.18950998783111572 BPR_loss 0.1299673467874527 reg_loss 0.05954264476895332
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 47.332435607910156 | 59.099963426589966 | 68.17549133300781 | [0.17005252 0.23889607 0.28822514] | [0.14214214 0.16393923 0.17870762] | [0.05236118 0.03720946 0.03019124] | [0.56366803 0.66755978 0.72596959] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.1575617641210556 BPR_loss 0.10104044526815414 reg_loss 0.05652132257819176
epoch: 14 s: 256000 batch_loss 0.16265489161014557 BPR_loss 0.10530750453472137 reg_loss 0.057347387075424194
epoch: 14 s: 512000 batch_loss 0.1692524254322052 BPR_loss 0.11223061382770538 reg_loss 0.05702181160449982
epoch: 14 s: 768000 batch_loss 0.165492981672287 BPR_loss 0.10552938282489777 reg_loss 0.05996359884738922
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 53.92840123176575 | 45.62350296974182 | 66.25250244140625 | [0.169925   0.23917146 0.28837728] | [0.14189332 0.16385296 0.17859989] | [0.05225568 0.03719104 0.03017226] | [0.56286422 0.66782772 0.72540023] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.155981183052063 BPR_loss 0.09682328999042511 reg_loss 0.05915789678692818
epoch: 15 s: 256000 batch_loss 0.16880223155021667 BPR_loss 0.10972313582897186 reg_loss 0.05907909944653511
epoch: 15 s: 512000 batch_loss 0.1713995337486267 BPR_loss 0.1101069524884224 reg_loss 0.06129258871078491
epoch: 15 s: 768000 batch_loss 0.16053912043571472 BPR_loss 0.10133884847164154 reg_loss 0.05920027196407318
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 43.05005168914795 | 46.277435541152954 | 64.58658599853516 | [0.17043492 0.23935843 0.28874235] | [0.14184458 0.16374573 0.17853275] | [0.0521552  0.03709307 0.0300729 ] | [0.56366803 0.66809565 0.72620403] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.15594664216041565 BPR_loss 0.09520750492811203 reg_loss 0.06073914095759392
epoch: 16 s: 256000 batch_loss 0.17616808414459229 BPR_loss 0.11657756567001343 reg_loss 0.05959051847457886
epoch: 16 s: 512000 batch_loss 0.16822737455368042 BPR_loss 0.1091281920671463 reg_loss 0.05909918248653412
epoch: 16 s: 768000 batch_loss 0.14946019649505615 BPR_loss 0.08675047010183334 reg_loss 0.0627097338438034
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 52.989471435546875 | 48.21666502952576 | 63.06773376464844 | [0.17120766 0.24016098 0.28937542] | [0.14262618 0.1645012  0.17919766] | [0.05244826 0.03727393 0.03017114] | [0.56437136 0.66920088 0.72774466] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.16701635718345642 BPR_loss 0.1054796576499939 reg_loss 0.06153669208288193
epoch: 17 s: 256000 batch_loss 0.1571347564458847 BPR_loss 0.09690815210342407 reg_loss 0.06022660806775093
epoch: 17 s: 512000 batch_loss 0.16369250416755676 BPR_loss 0.1017812192440033 reg_loss 0.061911288648843765
epoch: 17 s: 768000 batch_loss 0.16151578724384308 BPR_loss 0.10080692172050476 reg_loss 0.06070886179804802
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 60.61481022834778 | 56.66366362571716 | 61.884315490722656 | [0.1724348  0.24083961 0.29024461] | [0.14335802 0.16514757 0.17992854] | [0.05250184 0.03725886 0.03018733] | [0.56735213 0.67107643 0.72985465] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.1547098159790039 BPR_loss 0.09383516758680344 reg_loss 0.06087464466691017
epoch: 18 s: 256000 batch_loss 0.14813360571861267 BPR_loss 0.0863625556230545 reg_loss 0.061771053820848465
epoch: 18 s: 512000 batch_loss 0.15175160765647888 BPR_loss 0.09016096591949463 reg_loss 0.06159064173698425
epoch: 18 s: 768000 batch_loss 0.15655644237995148 BPR_loss 0.09298519790172577 reg_loss 0.06357124447822571
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 47.09434390068054 | 52.01340627670288 | 60.45087814331055 | [0.17256475 0.24122776 0.29055413] | [0.14312114 0.16498823 0.17979642] | [0.05243318 0.03723039 0.03019626] | [0.56705071 0.67003818 0.72928528] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.1502782702445984 BPR_loss 0.08810260891914368 reg_loss 0.06217565760016441
epoch: 19 s: 256000 batch_loss 0.14910686016082764 BPR_loss 0.08613866567611694 reg_loss 0.0629681870341301
epoch: 19 s: 512000 batch_loss 0.14535799622535706 BPR_loss 0.08550667762756348 reg_loss 0.05985131859779358
epoch: 19 s: 768000 batch_loss 0.14498449862003326 BPR_loss 0.08393999934196472 reg_loss 0.06104449927806854
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 49.16451573371887 | 51.660988092422485 | 59.18696975708008 | [0.1723972  0.24212833 0.29169069] | [0.14371717 0.16591652 0.1807854 ] | [0.05246165 0.03732333 0.03028781] | [0.56671579 0.67258356 0.73116083] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.15037214756011963 BPR_loss 0.0893637165427208 reg_loss 0.061008427292108536
epoch: 20 s: 256000 batch_loss 0.15068599581718445 BPR_loss 0.09022113680839539 reg_loss 0.06046486645936966
epoch: 20 s: 512000 batch_loss 0.15466776490211487 BPR_loss 0.09092201292514801 reg_loss 0.06374574452638626
epoch: 20 s: 768000 batch_loss 0.1437714695930481 BPR_loss 0.08167991787195206 reg_loss 0.06209154427051544
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 50.989644289016724 | 51.213106870651245 | 58.090274810791016 | [0.17251994 0.24234694 0.29133405] | [0.14362796 0.16591459 0.18059674] | [0.05236453 0.03737273 0.0302398 ] | [0.5670842  0.67261705 0.73149575] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.14027680456638336 BPR_loss 0.08091621100902557 reg_loss 0.05936058983206749
epoch: 21 s: 256000 batch_loss 0.15018004179000854 BPR_loss 0.08930887281894684 reg_loss 0.0608711764216423
epoch: 21 s: 512000 batch_loss 0.1437908113002777 BPR_loss 0.08320436626672745 reg_loss 0.06058644875884056
epoch: 21 s: 768000 batch_loss 0.14339202642440796 BPR_loss 0.08075833320617676 reg_loss 0.0626336932182312
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 48.90526795387268 | 60.41213774681091 | 57.03187561035156 | [0.17143927 0.24175174 0.29085487] | [0.14261393 0.165078   0.17980035] | [0.05200951 0.03719522 0.0301036 ] | [0.56561056 0.67194722 0.73049099] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.134278804063797 BPR_loss 0.0718412846326828 reg_loss 0.062437523156404495
epoch: 22 s: 256000 batch_loss 0.1408447027206421 BPR_loss 0.07886897027492523 reg_loss 0.06197573244571686
epoch: 22 s: 512000 batch_loss 0.13758274912834167 BPR_loss 0.07589337229728699 reg_loss 0.06168937683105469
epoch: 22 s: 768000 batch_loss 0.14180324971675873 BPR_loss 0.08022969961166382 reg_loss 0.06157354637980461
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 46.20263719558716 | 67.80963206291199 | 56.23569869995117 | [0.17154698 0.24213196 0.29161689] | [0.14246636 0.16505106 0.17991617] | [0.05201956 0.03725216 0.03020743] | [0.56597897 0.67358832 0.73233304] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.14212365448474884 BPR_loss 0.08074416220188141 reg_loss 0.06137949228286743
epoch: 23 s: 256000 batch_loss 0.13409554958343506 BPR_loss 0.07235585153102875 reg_loss 0.06173969432711601
epoch: 23 s: 512000 batch_loss 0.13784059882164001 BPR_loss 0.07537218928337097 reg_loss 0.06246841326355934
epoch: 23 s: 768000 batch_loss 0.1333666294813156 BPR_loss 0.0712992250919342 reg_loss 0.06206740066409111
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 48.45941472053528 | 43.82760810852051 | 55.35469436645508 | [0.17234188 0.24277177 0.29233748] | [0.14321288 0.16568045 0.18056802] | [0.05219037 0.037253   0.03022026] | [0.56718467 0.67452609 0.7325005 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.1419711410999298 BPR_loss 0.07990606129169464 reg_loss 0.06206507235765457
epoch: 24 s: 256000 batch_loss 0.13043971359729767 BPR_loss 0.06935380399227142 reg_loss 0.061085913330316544
epoch: 24 s: 512000 batch_loss 0.1437523365020752 BPR_loss 0.08060053735971451 reg_loss 0.06315179169178009
epoch: 24 s: 768000 batch_loss 0.13459479808807373 BPR_loss 0.0715930163860321 reg_loss 0.06300178915262222
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 49.88725256919861 | 78.66825461387634 | 54.49949645996094 | [0.17180375 0.24221402 0.29190406] | [0.14222459 0.16474894 0.17962903] | [0.05196095 0.03710731 0.03010472] | [0.56490723 0.67231563 0.73283542] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.13451695442199707 BPR_loss 0.07191802561283112 reg_loss 0.06259892135858536
epoch: 25 s: 256000 batch_loss 0.14057669043540955 BPR_loss 0.07749241590499878 reg_loss 0.06308426707983017
epoch: 25 s: 512000 batch_loss 0.13458780944347382 BPR_loss 0.0737210065126419 reg_loss 0.06086680665612221
epoch: 25 s: 768000 batch_loss 0.14725261926651 BPR_loss 0.08284386247396469 reg_loss 0.06440874934196472
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 50.35311460494995 | 72.21722221374512 | 53.90576934814453 | [0.17112606 0.24116829 0.2909811 ] | [0.14183798 0.16433051 0.17925731] | [0.05167124 0.03696915 0.03002099] | [0.56333311 0.6720142  0.73189765] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.12493358552455902 BPR_loss 0.06268634647130966 reg_loss 0.06224723905324936
epoch: 26 s: 256000 batch_loss 0.1299181878566742 BPR_loss 0.06694088876247406 reg_loss 0.06297730654478073
epoch: 26 s: 512000 batch_loss 0.12992547452449799 BPR_loss 0.06879282742738724 reg_loss 0.06113265082240105
epoch: 26 s: 768000 batch_loss 0.1289496123790741 BPR_loss 0.06698716431856155 reg_loss 0.06196244806051254
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 45.21458148956299 | 43.757381200790405 | 53.1861572265625 | [0.17065847 0.24090269 0.29045145] | [0.14121146 0.16374657 0.17865155] | [0.05153393 0.03690468 0.02999643] | [0.56169201 0.67127738 0.73072543] |
+-------+-------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.13301891088485718 BPR_loss 0.07168372720479965 reg_loss 0.061335183680057526
epoch: 27 s: 256000 batch_loss 0.12153968960046768 BPR_loss 0.06049923598766327 reg_loss 0.06104045361280441
epoch: 27 s: 512000 batch_loss 0.137800395488739 BPR_loss 0.07535798847675323 reg_loss 0.06244239956140518
epoch: 27 s: 768000 batch_loss 0.13922876119613647 BPR_loss 0.0784149020910263 reg_loss 0.060813866555690765
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 48.18200731277466 | 77.37729954719543 | 52.520259857177734 | [0.17136252 0.24080061 0.28981619] | [0.14205258 0.16428273 0.17902388] | [0.05169636 0.03685026 0.02989372] | [0.56340009 0.67244959 0.73018956] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 28 s: 0 batch_loss 0.1355319768190384 BPR_loss 0.07377627491950989 reg_loss 0.0617557056248188
epoch: 28 s: 256000 batch_loss 0.1324995905160904 BPR_loss 0.06950125098228455 reg_loss 0.06299833953380585
epoch: 28 s: 512000 batch_loss 0.12568533420562744 BPR_loss 0.06273921579122543 reg_loss 0.0629461258649826
epoch: 28 s: 768000 batch_loss 0.12107967585325241 BPR_loss 0.05775843560695648 reg_loss 0.06332124024629593
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   28  | 56.2161979675293 | 63.71833801269531 | 51.90433120727539 | [0.17189011 0.24142412 0.29039003] | [0.14247242 0.16471107 0.17942567] | [0.0518454  0.03693734 0.02996182] | [0.56487374 0.67258356 0.73142876] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.17189010897622936
early stopping at 28, recall@20:0.1726
