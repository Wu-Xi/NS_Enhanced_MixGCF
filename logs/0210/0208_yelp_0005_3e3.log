Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='yelp2018', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.001, lr=0.005, mess_dropout=False, mess_dropout_rate=0.1, n_negs=64, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.693148672580719 BPR_loss 0.6931484937667847 reg_loss 1.7170005151001533e-07
epoch: 0 s: 256000 batch_loss 0.693161129951477 BPR_loss 0.6931394338607788 reg_loss 2.1688631022698246e-05
epoch: 0 s: 512000 batch_loss 0.6927250027656555 BPR_loss 0.6920518279075623 reg_loss 0.0006731836474500597
epoch: 0 s: 768000 batch_loss 0.6911570429801941 BPR_loss 0.6886777877807617 reg_loss 0.0024792358744889498
epoch: 0 s: 1024000 batch_loss 0.6874528527259827 BPR_loss 0.6818912029266357 reg_loss 0.005561632104218006
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 201.91060328483582 | 35.32011818885803 | 417.2879638671875 | [0.06103607 0.10126813 0.13400978] | [0.05016483 0.06536161 0.0768072 ] | [0.02779304 0.02330902 0.02065492] | [0.37649994 0.52295693 0.61086902] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6838628053665161 BPR_loss 0.6756043434143066 reg_loss 0.008258466608822346
epoch: 1 s: 256000 batch_loss 0.6789410710334778 BPR_loss 0.6664001941680908 reg_loss 0.012540857307612896
epoch: 1 s: 512000 batch_loss 0.676809549331665 BPR_loss 0.6606581211090088 reg_loss 0.01615140028297901
epoch: 1 s: 768000 batch_loss 0.6701240539550781 BPR_loss 0.6494897603988647 reg_loss 0.020634319633245468
epoch: 1 s: 1024000 batch_loss 0.670042872428894 BPR_loss 0.6452496647834778 reg_loss 0.02479320392012596
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 206.33138036727905 | 38.04892611503601 | 408.326416015625 | [0.06313534 0.10418649 0.13810276] | [0.05192441 0.06741167 0.07924119] | [0.02877195 0.02398557 0.021257  ] | [0.38815208 0.53404067 0.62094228] |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6635414361953735 BPR_loss 0.6354212164878845 reg_loss 0.028120199218392372
epoch: 2 s: 256000 batch_loss 0.6640610694885254 BPR_loss 0.6329324245452881 reg_loss 0.03112863004207611
epoch: 2 s: 512000 batch_loss 0.6614928245544434 BPR_loss 0.6260346174240112 reg_loss 0.03545822203159332
epoch: 2 s: 768000 batch_loss 0.6596608757972717 BPR_loss 0.6203435063362122 reg_loss 0.03931739181280136
epoch: 2 s: 1024000 batch_loss 0.6483855843544006 BPR_loss 0.6054266691207886 reg_loss 0.042958926409482956
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 203.9696168899536 | 35.588056564331055 | 398.70751953125 | [0.06437878 0.10619479 0.14006264] | [0.05267813 0.06844031 0.0802899 ] | [0.02924877 0.02437318 0.02154593] | [0.3944676  0.53871416 0.62586838] |
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6491938233375549 BPR_loss 0.6028785705566406 reg_loss 0.046315230429172516
epoch: 3 s: 256000 batch_loss 0.6555767059326172 BPR_loss 0.6056727170944214 reg_loss 0.04990397393703461
epoch: 3 s: 512000 batch_loss 0.645103394985199 BPR_loss 0.5938586592674255 reg_loss 0.051244743168354034
epoch: 3 s: 768000 batch_loss 0.6456058025360107 BPR_loss 0.5889785885810852 reg_loss 0.05662719905376434
epoch: 3 s: 1024000 batch_loss 0.6479041576385498 BPR_loss 0.5909268856048584 reg_loss 0.05697726830840111
+-------+--------------------+-------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |      Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 204.94639372825623 | 38.25262665748596 | 391.1806640625 | [0.0653347  0.10783238 0.14239367] | [0.05347461 0.06949826 0.08157982] | [0.02964033 0.02472212 0.02187171] | [0.3977201  0.54285083 0.62959454] |
+-------+--------------------+-------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.6410409808158875 BPR_loss 0.5793538689613342 reg_loss 0.06168711185455322
epoch: 4 s: 256000 batch_loss 0.6342114806175232 BPR_loss 0.5699175596237183 reg_loss 0.06429393589496613
epoch: 4 s: 512000 batch_loss 0.6378880143165588 BPR_loss 0.5731309056282043 reg_loss 0.06475711613893509
epoch: 4 s: 768000 batch_loss 0.632904052734375 BPR_loss 0.563004732131958 reg_loss 0.0698993131518364
epoch: 4 s: 1024000 batch_loss 0.6411834955215454 BPR_loss 0.5717747807502747 reg_loss 0.06940872222185135
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 202.38334894180298 | 35.93454694747925 | 385.2386779785156 | [0.06638029 0.10858468 0.14372458] | [0.05429126 0.0701882  0.08248257] | [0.03008242 0.02485948 0.0220596 ] | [0.4019515  0.54594543 0.63256284] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.6346463561058044 BPR_loss 0.5632467269897461 reg_loss 0.07139961421489716
epoch: 5 s: 256000 batch_loss 0.6237785220146179 BPR_loss 0.5477986335754395 reg_loss 0.07597989588975906
epoch: 5 s: 512000 batch_loss 0.633812665939331 BPR_loss 0.5567499995231628 reg_loss 0.07706266641616821
epoch: 5 s: 768000 batch_loss 0.6276469826698303 BPR_loss 0.549992561340332 reg_loss 0.07765442132949829
epoch: 5 s: 1024000 batch_loss 0.6252676248550415 BPR_loss 0.5443551540374756 reg_loss 0.08091249316930771
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 206.9971387386322 | 46.080217123031616 | 380.3584899902344 | [0.06629939 0.10926122 0.14443991] | [0.0543636  0.07052786 0.08283884] | [0.03017715 0.0250371  0.02219591] | [0.40173045 0.5469875  0.63382594] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.6205269694328308 BPR_loss 0.5378181338310242 reg_loss 0.08270884305238724
epoch: 6 s: 256000 batch_loss 0.6238391995429993 BPR_loss 0.5407754778862 reg_loss 0.08306374400854111
epoch: 6 s: 512000 batch_loss 0.6180689930915833 BPR_loss 0.5305348634719849 reg_loss 0.08753413707017899
epoch: 6 s: 768000 batch_loss 0.6211336851119995 BPR_loss 0.535017192363739 reg_loss 0.0861164927482605
epoch: 6 s: 1024000 batch_loss 0.6247888207435608 BPR_loss 0.5364629030227661 reg_loss 0.08832590281963348
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 221.53640174865723 | 42.46043348312378 | 376.3757019042969 | [0.06689556 0.1095043  0.14471048] | [0.05470497 0.07074691 0.08303415] | [0.03035399 0.02511763 0.02219854] | [0.40334091 0.54664014 0.63347859] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.6157587766647339 BPR_loss 0.5250476598739624 reg_loss 0.0907110944390297
epoch: 7 s: 256000 batch_loss 0.6144453883171082 BPR_loss 0.5199076533317566 reg_loss 0.09453771263360977
epoch: 7 s: 512000 batch_loss 0.6116670370101929 BPR_loss 0.5157957077026367 reg_loss 0.09587132185697556
epoch: 7 s: 768000 batch_loss 0.6158280968666077 BPR_loss 0.521547794342041 reg_loss 0.09428031742572784
epoch: 7 s: 1024000 batch_loss 0.6195498108863831 BPR_loss 0.5237282514572144 reg_loss 0.0958215668797493
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 224.23997831344604 | 44.91021466255188 | 373.17144775390625 | [0.0668894  0.11003034 0.14554217] | [0.05480813 0.0710252  0.08342785] | [0.03039661 0.02519499 0.02231643] | [0.40444613 0.54967159 0.63714159] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.6165810227394104 BPR_loss 0.5201684236526489 reg_loss 0.09641258418560028
epoch: 8 s: 256000 batch_loss 0.6121312379837036 BPR_loss 0.5139731168746948 reg_loss 0.09815812855958939
epoch: 8 s: 512000 batch_loss 0.6068928241729736 BPR_loss 0.5044198036193848 reg_loss 0.10247302055358887
epoch: 8 s: 768000 batch_loss 0.6006903648376465 BPR_loss 0.5000826716423035 reg_loss 0.10060771554708481
epoch: 8 s: 1024000 batch_loss 0.6076342463493347 BPR_loss 0.503792405128479 reg_loss 0.10384184867143631
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 233.56963849067688 | 45.72160196304321 | 370.2577819824219 | [0.06713398 0.11050853 0.14584047] | [0.05511468 0.0714682  0.0838064 ] | [0.03048661 0.02535841 0.02239643] | [0.40570923 0.55096628 0.6384047 ] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.6064184308052063 BPR_loss 0.49929293990135193 reg_loss 0.10712547600269318
epoch: 9 s: 256000 batch_loss 0.6173739433288574 BPR_loss 0.5122513771057129 reg_loss 0.10512256622314453
epoch: 9 s: 512000 batch_loss 0.6040956974029541 BPR_loss 0.4975827932357788 reg_loss 0.1065128743648529
epoch: 9 s: 768000 batch_loss 0.6052751541137695 BPR_loss 0.4987848103046417 reg_loss 0.10649031400680542
epoch: 9 s: 1024000 batch_loss 0.6031902432441711 BPR_loss 0.4941895604133606 reg_loss 0.10900066792964935
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 228.7976038455963 | 45.12347221374512 | 367.5253601074219 | [0.06732044 0.11063725 0.1461978 ] | [0.0552908  0.07159306 0.08402549] | [0.03057661 0.02534972 0.02243432] | [0.4064671  0.55156625 0.6386889 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.6114959716796875 BPR_loss 0.5000283718109131 reg_loss 0.1114676222205162
epoch: 10 s: 256000 batch_loss 0.6019412875175476 BPR_loss 0.4905291795730591 reg_loss 0.11141211539506912
epoch: 10 s: 512000 batch_loss 0.6083147525787354 BPR_loss 0.4981917142868042 reg_loss 0.11012305319309235
epoch: 10 s: 768000 batch_loss 0.6072531342506409 BPR_loss 0.49652665853500366 reg_loss 0.11072647571563721
epoch: 10 s: 1024000 batch_loss 0.6058509349822998 BPR_loss 0.49515455961227417 reg_loss 0.11069636791944504
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 239.3545207977295 | 62.64849019050598 | 365.1427001953125 | [0.06755568 0.11072585 0.14629102] | [0.05548375 0.07173399 0.08414951] | [0.03068555 0.0253813  0.02243906] | [0.40713023 0.55346091 0.63894152] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.6076077222824097 BPR_loss 0.49298182129859924 reg_loss 0.11462589353322983
epoch: 11 s: 256000 batch_loss 0.600180447101593 BPR_loss 0.4862329363822937 reg_loss 0.11394749581813812
epoch: 11 s: 512000 batch_loss 0.6013588309288025 BPR_loss 0.48722174763679504 reg_loss 0.11413707584142685
epoch: 11 s: 768000 batch_loss 0.6026783585548401 BPR_loss 0.4888906478881836 reg_loss 0.1137877032160759
epoch: 11 s: 1024000 batch_loss 0.6039731502532959 BPR_loss 0.48655998706817627 reg_loss 0.11741313338279724
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 250.22595524787903 | 55.55709719657898 | 363.098388671875 | [0.06763068 0.11067171 0.14621634] | [0.05545998 0.0716614  0.08406935] | [0.03067923 0.02534341 0.02239906] | [0.40741442 0.552482   0.63837312] |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.5995513200759888 BPR_loss 0.48111197352409363 reg_loss 0.11843937635421753
epoch: 12 s: 256000 batch_loss 0.5924788117408752 BPR_loss 0.4743390679359436 reg_loss 0.11813975870609283
epoch: 12 s: 512000 batch_loss 0.5964909195899963 BPR_loss 0.4766148328781128 reg_loss 0.11987606436014175
epoch: 12 s: 768000 batch_loss 0.599220335483551 BPR_loss 0.4822258949279785 reg_loss 0.1169944629073143
epoch: 12 s: 1024000 batch_loss 0.5865992903709412 BPR_loss 0.4648668169975281 reg_loss 0.1217324510216713
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 244.92411637306213 | 48.00998115539551 | 361.28948974609375 | [0.06776027 0.11080183 0.14614116] | [0.05560119 0.0718169  0.08414943] | [0.03076292 0.02539551 0.02241906] | [0.40687761 0.55203991 0.63739421] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.5942651033401489 BPR_loss 0.47028741240501404 reg_loss 0.1239776611328125
epoch: 13 s: 256000 batch_loss 0.5988622903823853 BPR_loss 0.478840708732605 reg_loss 0.12002155929803848
epoch: 13 s: 512000 batch_loss 0.6027776598930359 BPR_loss 0.47912153601646423 reg_loss 0.12365613132715225
epoch: 13 s: 768000 batch_loss 0.5908908843994141 BPR_loss 0.4671475887298584 reg_loss 0.12374332547187805
epoch: 13 s: 1024000 batch_loss 0.6024777293205261 BPR_loss 0.4816196858882904 reg_loss 0.12085802108049393
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 246.6400179862976 | 77.28034377098083 | 359.4822082519531 | [0.06746291 0.11081345 0.14645342] | [0.05554365 0.07183953 0.08429284] | [0.03064292 0.02534025 0.02243221] | [0.40558292 0.55317671 0.63884679] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.5890805721282959 BPR_loss 0.4638967514038086 reg_loss 0.1251838505268097
epoch: 14 s: 256000 batch_loss 0.5866022706031799 BPR_loss 0.4631972312927246 reg_loss 0.12340504676103592
epoch: 14 s: 512000 batch_loss 0.5927771329879761 BPR_loss 0.46758323907852173 reg_loss 0.12519387900829315
epoch: 14 s: 768000 batch_loss 0.5924627184867859 BPR_loss 0.46811723709106445 reg_loss 0.12434550374746323
epoch: 14 s: 1024000 batch_loss 0.5901185274124146 BPR_loss 0.46312445402145386 reg_loss 0.1269940435886383
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 240.55554485321045 | 80.73020219802856 | 357.645751953125 | [0.06791688 0.11099834 0.14644593] | [0.05578311 0.07199556 0.08437482] | [0.03085765 0.02546419 0.02249116] | [0.40864595 0.55472401 0.63976254] |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.5930955410003662 BPR_loss 0.463590145111084 reg_loss 0.12950542569160461
epoch: 15 s: 256000 batch_loss 0.5902153849601746 BPR_loss 0.46267154812812805 reg_loss 0.1275438517332077
epoch: 15 s: 512000 batch_loss 0.5915765762329102 BPR_loss 0.4626573324203491 reg_loss 0.12891924381256104
epoch: 15 s: 768000 batch_loss 0.5873487591743469 BPR_loss 0.45982471108436584 reg_loss 0.12752403318881989
epoch: 15 s: 1024000 batch_loss 0.5883166790008545 BPR_loss 0.45950907468795776 reg_loss 0.12880758941173553
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 241.2180700302124 | 50.263904094696045 | 356.2577819824219 | [0.06811113 0.11170173 0.14669076] | [0.05601856 0.07245792 0.08470502] | [0.03088133 0.02559761 0.02255589] | [0.40959328 0.5557345  0.6389731 ] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.5838494896888733 BPR_loss 0.45419996976852417 reg_loss 0.12964950501918793
epoch: 16 s: 256000 batch_loss 0.5816554427146912 BPR_loss 0.4507237374782562 reg_loss 0.13093169033527374
epoch: 16 s: 512000 batch_loss 0.5880364179611206 BPR_loss 0.4547193646430969 reg_loss 0.13331708312034607
epoch: 16 s: 768000 batch_loss 0.588185727596283 BPR_loss 0.4576634466648102 reg_loss 0.13052229583263397
epoch: 16 s: 1024000 batch_loss 0.5880277156829834 BPR_loss 0.45180588960647583 reg_loss 0.13622179627418518
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 238.9266881942749 | 47.762535095214844 | 354.7017822265625 | [0.06799595 0.1112324  0.14647261] | [0.05595401 0.07221849 0.08453981] | [0.03093343 0.0255084  0.0225101 ] | [0.40934066 0.55428192 0.63925729] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.5860990881919861 BPR_loss 0.456942081451416 reg_loss 0.12915699183940887
epoch: 17 s: 256000 batch_loss 0.5883416533470154 BPR_loss 0.45430612564086914 reg_loss 0.13403554260730743
epoch: 17 s: 512000 batch_loss 0.5820534825325012 BPR_loss 0.44856151938438416 reg_loss 0.13349194824695587
epoch: 17 s: 768000 batch_loss 0.5941500067710876 BPR_loss 0.45996952056884766 reg_loss 0.13418048620224
epoch: 17 s: 1024000 batch_loss 0.585882842540741 BPR_loss 0.45096656680107117 reg_loss 0.1349162608385086
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 236.1435148715973 | 42.68302035331726 | 353.4971008300781 | [0.06799268 0.11122291 0.14649382] | [0.05591402 0.07217926 0.08452483] | [0.03088765 0.02547524 0.0225101 ] | [0.40971959 0.55443981 0.63872047] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.5814465880393982 BPR_loss 0.44558942317962646 reg_loss 0.13585717976093292
epoch: 18 s: 256000 batch_loss 0.5849741697311401 BPR_loss 0.4475880563259125 reg_loss 0.13738612830638885
epoch: 18 s: 512000 batch_loss 0.5830701589584351 BPR_loss 0.44759178161621094 reg_loss 0.13547834753990173
epoch: 18 s: 768000 batch_loss 0.5855659246444702 BPR_loss 0.4520547688007355 reg_loss 0.13351114094257355
epoch: 18 s: 1024000 batch_loss 0.5866263508796692 BPR_loss 0.4493905007839203 reg_loss 0.1372358500957489
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 241.27027678489685 | 42.58798265457153 | 352.14019775390625 | [0.0679748  0.11091604 0.14614741] | [0.05593558 0.07210447 0.08441545] | [0.03084028 0.02543498 0.02243432] | [0.40946697 0.55289251 0.63846785] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.5801764726638794 BPR_loss 0.4450991749763489 reg_loss 0.13507728278636932
epoch: 19 s: 256000 batch_loss 0.5818254947662354 BPR_loss 0.4437386989593506 reg_loss 0.13808682560920715
epoch: 19 s: 512000 batch_loss 0.5764330625534058 BPR_loss 0.44003698229789734 reg_loss 0.13639606535434723
epoch: 19 s: 768000 batch_loss 0.5829442143440247 BPR_loss 0.446491539478302 reg_loss 0.13645267486572266
epoch: 19 s: 1024000 batch_loss 0.5761532187461853 BPR_loss 0.43561315536499023 reg_loss 0.14054007828235626
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 234.4993417263031 | 53.34820199012756 | 350.7886962890625 | [0.06815506 0.11086749 0.14630952] | [0.05593645 0.07201619 0.08440791] | [0.0308908  0.02542077 0.02246853] | [0.41088796 0.55232411 0.6384047 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.5811710357666016 BPR_loss 0.4429686963558197 reg_loss 0.13820230960845947
epoch: 20 s: 256000 batch_loss 0.5770554542541504 BPR_loss 0.434848427772522 reg_loss 0.1422070562839508
epoch: 20 s: 512000 batch_loss 0.5749661922454834 BPR_loss 0.43681877851486206 reg_loss 0.13814744353294373
epoch: 20 s: 768000 batch_loss 0.5734301805496216 BPR_loss 0.4337405860424042 reg_loss 0.1396896094083786
epoch: 20 s: 1024000 batch_loss 0.5806257724761963 BPR_loss 0.4375421106815338 reg_loss 0.14308366179466248
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 227.03240275382996 | 58.68600130081177 | 349.63092041015625 | [0.0677479  0.11083298 0.14638237] | [0.05587642 0.07210337 0.08452418] | [0.03076607 0.02542788 0.02247747] | [0.40785651 0.55339775 0.63862574] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.574856162071228 BPR_loss 0.4308462142944336 reg_loss 0.14400991797447205
epoch: 21 s: 256000 batch_loss 0.5851632952690125 BPR_loss 0.4403612017631531 reg_loss 0.14480209350585938
epoch: 21 s: 512000 batch_loss 0.5748662352561951 BPR_loss 0.4320629835128784 reg_loss 0.14280325174331665
epoch: 21 s: 768000 batch_loss 0.5698531270027161 BPR_loss 0.4302884340286255 reg_loss 0.13956470787525177
epoch: 21 s: 1024000 batch_loss 0.5754024386405945 BPR_loss 0.43308329582214355 reg_loss 0.14231914281845093
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 230.46544885635376 | 55.59005570411682 | 348.5719299316406 | [0.06760934 0.11098271 0.14633948] | [0.05583306 0.07218034 0.08456557] | [0.03063029 0.02541051 0.02248116] | [0.40640394 0.55222938 0.63849943] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.5756909847259521 BPR_loss 0.43454867601394653 reg_loss 0.14114227890968323
epoch: 22 s: 256000 batch_loss 0.5744385719299316 BPR_loss 0.43036454916000366 reg_loss 0.14407403767108917
epoch: 22 s: 512000 batch_loss 0.5749462246894836 BPR_loss 0.431535005569458 reg_loss 0.14341121912002563
epoch: 22 s: 768000 batch_loss 0.5878209471702576 BPR_loss 0.4424061179161072 reg_loss 0.1454148143529892
epoch: 22 s: 1024000 batch_loss 0.580556333065033 BPR_loss 0.4408891797065735 reg_loss 0.13966715335845947
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 230.78413772583008 | 55.18062424659729 | 347.55975341796875 | [0.06793949 0.11103019 0.14624811] | [0.05588839 0.07208963 0.08442128] | [0.03081502 0.02542314 0.02245221] | [0.40883542 0.55260831 0.63903625] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.567416787147522 BPR_loss 0.4244069457054138 reg_loss 0.14300982654094696
epoch: 23 s: 256000 batch_loss 0.5766059160232544 BPR_loss 0.43459275364875793 reg_loss 0.14201316237449646
epoch: 23 s: 512000 batch_loss 0.5709531903266907 BPR_loss 0.42508766055107117 reg_loss 0.1458655297756195
epoch: 23 s: 768000 batch_loss 0.578768789768219 BPR_loss 0.4369881749153137 reg_loss 0.14178061485290527
epoch: 23 s: 1024000 batch_loss 0.5662318468093872 BPR_loss 0.4178463816642761 reg_loss 0.1483854353427887
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |  tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 223.70893025398254 | 47.7141387462616 | 346.4450988769531 | [0.06787194 0.1107481  0.14603439] | [0.05579573 0.07189699 0.0842318 ] | [0.03087502 0.02537498 0.022408  ] | [0.40747758 0.55279778 0.63837312] |
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.5679445266723633 BPR_loss 0.4239271283149719 reg_loss 0.14401742815971375
epoch: 24 s: 256000 batch_loss 0.5731970071792603 BPR_loss 0.4292171597480774 reg_loss 0.14397983253002167
epoch: 24 s: 512000 batch_loss 0.5677552223205566 BPR_loss 0.422235906124115 reg_loss 0.14551934599876404
epoch: 24 s: 768000 batch_loss 0.5743627548217773 BPR_loss 0.4300875663757324 reg_loss 0.14427515864372253
epoch: 24 s: 1024000 batch_loss 0.5752326250076294 BPR_loss 0.42906439304351807 reg_loss 0.14616820216178894
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 223.7164707183838 | 47.837305307388306 | 345.5575866699219 | [0.06782004 0.11059392 0.14601297] | [0.05572852 0.0718166  0.08418767] | [0.03080555 0.02535288 0.02239695] | [0.40836175 0.55166098 0.63846785] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.572512149810791 BPR_loss 0.4222733974456787 reg_loss 0.1502387374639511
epoch: 25 s: 256000 batch_loss 0.5726065635681152 BPR_loss 0.42345356941223145 reg_loss 0.14915302395820618
epoch: 25 s: 512000 batch_loss 0.570545494556427 BPR_loss 0.42321091890335083 reg_loss 0.14733456075191498
epoch: 25 s: 768000 batch_loss 0.5622947216033936 BPR_loss 0.41264230012893677 reg_loss 0.1496524065732956
epoch: 25 s: 1024000 batch_loss 0.5740106701850891 BPR_loss 0.4237615466117859 reg_loss 0.15024912357330322
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 225.16217589378357 | 50.24374341964722 | 344.501708984375 | [0.06762629 0.11090426 0.14629281] | [0.05578334 0.0720544  0.08441646] | [0.03076134 0.02542235 0.02244116] | [0.40728811 0.5533346  0.63799419] |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.5740155577659607 BPR_loss 0.42531102895736694 reg_loss 0.14870451390743256
epoch: 26 s: 256000 batch_loss 0.5686730146408081 BPR_loss 0.4186675548553467 reg_loss 0.1500054895877838
epoch: 26 s: 512000 batch_loss 0.5652267336845398 BPR_loss 0.41370725631713867 reg_loss 0.15151946246623993
epoch: 26 s: 768000 batch_loss 0.5742269158363342 BPR_loss 0.4265851378440857 reg_loss 0.14764179289340973
epoch: 26 s: 1024000 batch_loss 0.5712789297103882 BPR_loss 0.421869695186615 reg_loss 0.14940926432609558
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 222.50340461730957 | 62.24324178695679 | 343.7112731933594 | [0.0675721  0.11062945 0.14567286] | [0.05560102 0.07181406 0.08405043] | [0.03072818 0.02539788 0.02237064] | [0.40615132 0.55241885 0.6372679 ] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.5616373419761658 BPR_loss 0.41003525257110596 reg_loss 0.15160208940505981
epoch: 27 s: 256000 batch_loss 0.56703782081604 BPR_loss 0.42009609937667847 reg_loss 0.14694175124168396
epoch: 27 s: 512000 batch_loss 0.567721962928772 BPR_loss 0.41792047023773193 reg_loss 0.14980149269104004
epoch: 27 s: 768000 batch_loss 0.5666581392288208 BPR_loss 0.4179263114929199 reg_loss 0.14873184263706207
epoch: 27 s: 1024000 batch_loss 0.5705428123474121 BPR_loss 0.4217284321784973 reg_loss 0.148814395070076
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 217.7561264038086 | 66.44185280799866 | 342.7977600097656 | [0.06771264 0.11080829 0.14555224] | [0.05572666 0.07191549 0.08406243] | [0.03079291 0.02537341 0.02233695] | [0.40791967 0.55371353 0.63673109] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 28 s: 0 batch_loss 0.5686357617378235 BPR_loss 0.41912198066711426 reg_loss 0.14951379597187042
epoch: 28 s: 256000 batch_loss 0.5759331583976746 BPR_loss 0.4236941933631897 reg_loss 0.15223897993564606
epoch: 28 s: 512000 batch_loss 0.5629081726074219 BPR_loss 0.41322094202041626 reg_loss 0.149687260389328
epoch: 28 s: 768000 batch_loss 0.5645908117294312 BPR_loss 0.41496118903160095 reg_loss 0.1496296525001526
epoch: 28 s: 1024000 batch_loss 0.5616090893745422 BPR_loss 0.40873396396636963 reg_loss 0.1528751254081726
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   28  | 220.3425760269165 | 49.929840326309204 | 342.05230712890625 | [0.06747864 0.11067011 0.1452586 ] | [0.05555279 0.07180031 0.08390284] | [0.03064292 0.02534104 0.02231222] | [0.40722496 0.55185045 0.63707844] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 29 s: 0 batch_loss 0.5665044188499451 BPR_loss 0.41620224714279175 reg_loss 0.15030218660831451
epoch: 29 s: 256000 batch_loss 0.5573086738586426 BPR_loss 0.4062976837158203 reg_loss 0.15101100504398346
epoch: 29 s: 512000 batch_loss 0.5647801756858826 BPR_loss 0.415039986371994 reg_loss 0.14974017441272736
epoch: 29 s: 768000 batch_loss 0.569018542766571 BPR_loss 0.41570669412612915 reg_loss 0.1533118635416031
epoch: 29 s: 1024000 batch_loss 0.566116988658905 BPR_loss 0.4133979082107544 reg_loss 0.15271909534931183
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   29  | 226.7534680366516 | 57.1931574344635 | 341.1830139160156 | [0.0674112  0.11034092 0.14536505] | [0.0556372  0.07178272 0.08404406] | [0.03064608 0.02530236 0.0223438 ] | [0.40567766 0.55068208 0.6368574 ] |
+-------+-------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.06741120419379938
early stopping at 29, recall@20:0.0682
