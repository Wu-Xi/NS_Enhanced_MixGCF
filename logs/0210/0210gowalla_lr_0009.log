Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='gowalla', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=3, l2=0.0001, lr=0.009, mess_dropout=False, mess_dropout_rate=0.1, n_negs=16, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.6931487321853638 BPR_loss 0.6931487321853638 reg_loss 2.7992433260237704e-08
epoch: 0 s: 256000 batch_loss 0.5551324486732483 BPR_loss 0.5511646270751953 reg_loss 0.0039678229950368404
epoch: 0 s: 512000 batch_loss 0.4795284569263458 BPR_loss 0.47184962034225464 reg_loss 0.007678838912397623
epoch: 0 s: 768000 batch_loss 0.4404529631137848 BPR_loss 0.43009278178215027 reg_loss 0.010360185988247395
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+---------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s)  |        Loss        |               recall               |                ndcg                |            precision            |             hit_ratio              |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+---------------------------------+------------------------------------+
|   0   | 50.67923617362976 | 48.7563796043396 | 208.35389709472656 | [0.13320508 0.19100425 0.23282109] | [0.11226796 0.13036916 0.14279595] | [0.0424007 0.0305496 0.0249252] | [0.48660326 0.59307388 0.65345971] |
+-------+-------------------+------------------+--------------------+------------------------------------+------------------------------------+---------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.4563000202178955 BPR_loss 0.445486843585968 reg_loss 0.010813167318701744
epoch: 1 s: 256000 batch_loss 0.397271990776062 BPR_loss 0.38333725929260254 reg_loss 0.013934719376266003
epoch: 1 s: 512000 batch_loss 0.38473808765411377 BPR_loss 0.36835384368896484 reg_loss 0.016384249553084373
epoch: 1 s: 768000 batch_loss 0.3545626699924469 BPR_loss 0.3352864980697632 reg_loss 0.01927616074681282
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 55.99945020675659 | 47.873053789138794 | 159.75518798828125 | [0.14206488 0.20224032 0.24601461] | [0.11947155 0.13831792 0.15131827] | [0.04502478 0.03224931 0.02628106] | [0.50696631 0.6123317  0.67141135] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.3719738721847534 BPR_loss 0.35299599170684814 reg_loss 0.01897789165377617
epoch: 2 s: 256000 batch_loss 0.3753637969493866 BPR_loss 0.35486459732055664 reg_loss 0.02049919217824936
epoch: 2 s: 512000 batch_loss 0.3316444158554077 BPR_loss 0.3082095682621002 reg_loss 0.02343486249446869
epoch: 2 s: 768000 batch_loss 0.32100164890289307 BPR_loss 0.2951391041278839 reg_loss 0.02586255967617035
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 63.74431538581848 | 44.520211696624756 | 137.18209838867188 | [0.14927864 0.2115614  0.25649037] | [0.12519085 0.14467572 0.15805549] | [0.04708118 0.03358313 0.02732545] | [0.52314288 0.62837431 0.68480809] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.3168014883995056 BPR_loss 0.2900424599647522 reg_loss 0.026759013533592224
epoch: 3 s: 256000 batch_loss 0.3200474977493286 BPR_loss 0.29223984479904175 reg_loss 0.027807647362351418
epoch: 3 s: 512000 batch_loss 0.2932634651660919 BPR_loss 0.2630121111869812 reg_loss 0.030251342803239822
epoch: 3 s: 768000 batch_loss 0.29443132877349854 BPR_loss 0.26266682147979736 reg_loss 0.03176451101899147
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 62.70915079116821 | 54.545899629592896 | 121.90275573730469 | [0.15373708 0.21769718 0.26358531] | [0.12938381 0.14939918 0.16307315] | [0.04838737 0.03455355 0.02809465] | [0.53362583 0.63678076 0.69515708] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.2851025462150574 BPR_loss 0.2545429468154907 reg_loss 0.030559612438082695
epoch: 4 s: 256000 batch_loss 0.2765114903450012 BPR_loss 0.24368751049041748 reg_loss 0.032823964953422546
epoch: 4 s: 512000 batch_loss 0.2800025939941406 BPR_loss 0.24591971933841705 reg_loss 0.034082889556884766
epoch: 4 s: 768000 batch_loss 0.27655521035194397 BPR_loss 0.23997379839420319 reg_loss 0.03658141940832138
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 61.95689797401428 | 66.55361342430115 | 110.30014038085938 | [0.15695718 0.22219956 0.26855278] | [0.13224557 0.15271628 0.16655486] | [0.04923639 0.0351832  0.02859033] | [0.54142943 0.64411548 0.70198942] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.26009318232536316 BPR_loss 0.2244631052017212 reg_loss 0.03563007712364197
epoch: 5 s: 256000 batch_loss 0.2666323781013489 BPR_loss 0.22881831228733063 reg_loss 0.037814054638147354
epoch: 5 s: 512000 batch_loss 0.25860410928726196 BPR_loss 0.21914459764957428 reg_loss 0.03945952653884888
epoch: 5 s: 768000 batch_loss 0.2458139955997467 BPR_loss 0.20434914529323578 reg_loss 0.041464850306510925
+-------+-------------------+-----------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |  tesing time(s) |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-----------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 66.87282419204712 | 89.912668466568 | 101.89261627197266 | [0.15927216 0.22457789 0.27198132] | [0.13375882 0.15427297 0.16838601] | [0.04986771 0.03553821 0.02887501] | [0.5436064  0.64666086 0.70550606] |
+-------+-------------------+-----------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.24113211035728455 BPR_loss 0.19915226101875305 reg_loss 0.04197985678911209
epoch: 6 s: 256000 batch_loss 0.2167986035346985 BPR_loss 0.17544743418693542 reg_loss 0.04135117679834366
epoch: 6 s: 512000 batch_loss 0.24812981486320496 BPR_loss 0.20370741188526154 reg_loss 0.04442241042852402
epoch: 6 s: 768000 batch_loss 0.24113905429840088 BPR_loss 0.1961188018321991 reg_loss 0.045020245015621185
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 64.88988900184631 | 49.474153995513916 | 94.95447540283203 | [0.16192392 0.22854262 0.27570524] | [0.13640285 0.15732369 0.17142058] | [0.05068826 0.03609502 0.029273  ] | [0.55017081 0.65319177 0.71046286] |
+-------+-------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.2537786066532135 BPR_loss 0.20936711132526398 reg_loss 0.04441150277853012
epoch: 7 s: 256000 batch_loss 0.23054078221321106 BPR_loss 0.18557500839233398 reg_loss 0.04496578127145767
epoch: 7 s: 512000 batch_loss 0.22912569344043732 BPR_loss 0.18092474341392517 reg_loss 0.04820094630122185
epoch: 7 s: 768000 batch_loss 0.2269170582294464 BPR_loss 0.1799437254667282 reg_loss 0.0469733402132988
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 64.01358938217163 | 69.65572667121887 | 89.74600982666016 | [0.16364634 0.23064456 0.27839612] | [0.13778894 0.15883963 0.17310916] | [0.05108011 0.03629513 0.02944995] | [0.55204635 0.65550271 0.71196999] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.22841857373714447 BPR_loss 0.18100862205028534 reg_loss 0.04740995541214943
epoch: 8 s: 256000 batch_loss 0.2226720154285431 BPR_loss 0.1742197573184967 reg_loss 0.04845225438475609
epoch: 8 s: 512000 batch_loss 0.20223897695541382 BPR_loss 0.15214717388153076 reg_loss 0.05009180307388306
epoch: 8 s: 768000 batch_loss 0.20456808805465698 BPR_loss 0.1546556055545807 reg_loss 0.04991248622536659
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 64.05927538871765 | 66.13459348678589 | 85.34892272949219 | [0.16490133 0.23214474 0.28013569] | [0.13864408 0.15982556 0.17415879] | [0.05138154 0.03655051 0.029647  ] | [0.55415634 0.65757921 0.71314221] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.21149879693984985 BPR_loss 0.1625482439994812 reg_loss 0.048950549215078354
epoch: 9 s: 256000 batch_loss 0.21063080430030823 BPR_loss 0.16117891669273376 reg_loss 0.04945188760757446
epoch: 9 s: 512000 batch_loss 0.20931805670261383 BPR_loss 0.15903742611408234 reg_loss 0.050280630588531494
epoch: 9 s: 768000 batch_loss 0.19065169990062714 BPR_loss 0.13784021139144897 reg_loss 0.05281148478388786
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 63.726436614990234 | 66.07156491279602 | 81.74395751953125 | [0.16650726 0.23392869 0.28273303] | [0.13984184 0.16110907 0.17564925] | [0.05177339 0.0367749  0.02983008] | [0.55747203 0.65891888 0.71880233] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.20666208863258362 BPR_loss 0.1549014449119568 reg_loss 0.05176065117120743
epoch: 10 s: 256000 batch_loss 0.18264038860797882 BPR_loss 0.13175615668296814 reg_loss 0.05088422819972038
epoch: 10 s: 512000 batch_loss 0.19057539105415344 BPR_loss 0.13580967485904694 reg_loss 0.054765719920396805
epoch: 10 s: 768000 batch_loss 0.19073379039764404 BPR_loss 0.139042928814888 reg_loss 0.05169086903333664
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch | training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 64.0030882358551 | 46.53274893760681 | 77.70272064208984 | [0.16659222 0.23525629 0.28409872] | [0.13974928 0.16150514 0.17604934] | [0.05157579 0.03684105 0.02986079] | [0.55750553 0.66206712 0.71997455] |
+-------+------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.18278959393501282 BPR_loss 0.12835393846035004 reg_loss 0.05443565547466278
epoch: 11 s: 256000 batch_loss 0.19602584838867188 BPR_loss 0.1395142674446106 reg_loss 0.05651158466935158
epoch: 11 s: 512000 batch_loss 0.18962301313877106 BPR_loss 0.13474616408348083 reg_loss 0.05487684905529022
epoch: 11 s: 768000 batch_loss 0.1812686026096344 BPR_loss 0.12647029757499695 reg_loss 0.05479831248521805
+-------+-------------------+----------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) | tesing time(s) |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+----------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 67.66881346702576 | 64.21337890625 | 75.10521697998047 | [0.16782906 0.23677683 0.28560927] | [0.14098071 0.16281249 0.17738137] | [0.05198439 0.03708135 0.03003048] | [0.56005091 0.66464599 0.72094581] |
+-------+-------------------+----------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.19275441765785217 BPR_loss 0.13866496086120605 reg_loss 0.05408945307135582
epoch: 12 s: 256000 batch_loss 0.17946887016296387 BPR_loss 0.12349587678909302 reg_loss 0.05597299709916115
epoch: 12 s: 512000 batch_loss 0.1783783733844757 BPR_loss 0.12262261658906937 reg_loss 0.055755749344825745
epoch: 12 s: 768000 batch_loss 0.19155524671077728 BPR_loss 0.13400313258171082 reg_loss 0.05755211040377617
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 67.32579731941223 | 87.18514800071716 | 72.67412567138672 | [0.16891224 0.23799003 0.28732363] | [0.14178033 0.16364565 0.17835655] | [0.05220376 0.03721867 0.03017393] | [0.56199344 0.6658517  0.72231898] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.16541510820388794 BPR_loss 0.10839216411113739 reg_loss 0.05702294781804085
epoch: 13 s: 256000 batch_loss 0.1736067831516266 BPR_loss 0.11663336306810379 reg_loss 0.0569734126329422
epoch: 13 s: 512000 batch_loss 0.17669065296649933 BPR_loss 0.1202281191945076 reg_loss 0.05646253004670143
epoch: 13 s: 768000 batch_loss 0.19401632249355316 BPR_loss 0.13594825565814972 reg_loss 0.058068063110113144
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 65.11979103088379 | 55.74329376220703 | 70.41534423828125 | [0.16988081 0.23919701 0.28803997] | [0.14227694 0.16417557 0.17880778] | [0.05239802 0.03728984 0.03021189] | [0.56494072 0.66849756 0.72396008] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.16275815665721893 BPR_loss 0.10751035809516907 reg_loss 0.055247802287340164
epoch: 14 s: 256000 batch_loss 0.16706180572509766 BPR_loss 0.11097338795661926 reg_loss 0.05608842521905899
epoch: 14 s: 512000 batch_loss 0.17526191473007202 BPR_loss 0.11950914561748505 reg_loss 0.05575277656316757
epoch: 14 s: 768000 batch_loss 0.16925238072872162 BPR_loss 0.110598124563694 reg_loss 0.05865425243973732
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 62.013015031814575 | 57.843912839889526 | 68.3968276977539 | [0.17022491 0.23933171 0.28808895] | [0.14240044 0.16424915 0.17880053] | [0.05246333 0.03733589 0.03019124] | [0.56390247 0.66729185 0.72295532] |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.15582752227783203 BPR_loss 0.0979895368218422 reg_loss 0.05783798173069954
epoch: 15 s: 256000 batch_loss 0.1713668256998062 BPR_loss 0.11343324184417725 reg_loss 0.057933587580919266
epoch: 15 s: 512000 batch_loss 0.17479443550109863 BPR_loss 0.1147310808300972 reg_loss 0.06006334722042084
epoch: 15 s: 768000 batch_loss 0.16549552977085114 BPR_loss 0.10753770172595978 reg_loss 0.05795782431960106
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 60.26054310798645 | 56.95382118225098 | 66.70372772216797 | [0.17024959 0.23934187 0.28892457] | [0.14209529 0.16406885 0.17889325] | [0.05224061 0.03722453 0.03019626] | [0.56400295 0.66702391 0.72560118] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.16331546008586884 BPR_loss 0.10367852449417114 reg_loss 0.05963693559169769
epoch: 16 s: 256000 batch_loss 0.18072375655174255 BPR_loss 0.12226016819477081 reg_loss 0.05846359580755234
epoch: 16 s: 512000 batch_loss 0.1735326647758484 BPR_loss 0.11543263494968414 reg_loss 0.05810002237558365
epoch: 16 s: 768000 batch_loss 0.15141916275024414 BPR_loss 0.0898084044456482 reg_loss 0.06161075457930565
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |  tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 63.350104570388794 | 92.7863142490387 | 65.14752960205078 | [0.17116095 0.2400415  0.28998313] | [0.14311076 0.16491292 0.17982415] | [0.05268605 0.03737189 0.03033023] | [0.56554357 0.66769375 0.72620403] |
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.16567835211753845 BPR_loss 0.10518962144851685 reg_loss 0.060488730669021606
epoch: 17 s: 256000 batch_loss 0.1615290343761444 BPR_loss 0.10242712497711182 reg_loss 0.059101901948451996
epoch: 17 s: 512000 batch_loss 0.17029069364070892 BPR_loss 0.1094137653708458 reg_loss 0.06087692826986313
epoch: 17 s: 768000 batch_loss 0.16894593834877014 BPR_loss 0.10928808152675629 reg_loss 0.05965784937143326
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 66.26036143302917 | 51.70763850212097 | 63.76816940307617 | [0.17220895 0.24154163 0.29026965] | [0.14390409 0.16591498 0.18051087] | [0.05280327 0.03750921 0.03034698] | [0.56684976 0.67174627 0.72670641] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.1607247143983841 BPR_loss 0.10094308853149414 reg_loss 0.059781625866889954
epoch: 18 s: 256000 batch_loss 0.1551482379436493 BPR_loss 0.09431155025959015 reg_loss 0.06083669140934944
epoch: 18 s: 512000 batch_loss 0.14924736320972443 BPR_loss 0.08847319334745407 reg_loss 0.060774169862270355
epoch: 18 s: 768000 batch_loss 0.15986427664756775 BPR_loss 0.09712868928909302 reg_loss 0.06273557990789413
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 65.35211110115051 | 53.95407485961914 | 62.25605010986328 | [0.17241784 0.24096165 0.291173  ] | [0.14348379 0.16526028 0.18025146] | [0.05272121 0.0373652  0.03034698] | [0.56842387 0.67131087 0.72828053] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.15632089972496033 BPR_loss 0.09500375390052795 reg_loss 0.06131714954972267
epoch: 19 s: 256000 batch_loss 0.15186212956905365 BPR_loss 0.08967249095439911 reg_loss 0.06218963488936424
epoch: 19 s: 512000 batch_loss 0.15096987783908844 BPR_loss 0.09192266315221786 reg_loss 0.059047214686870575
epoch: 19 s: 768000 batch_loss 0.15414871275424957 BPR_loss 0.09387615323066711 reg_loss 0.06027255579829216
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |  tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 62.381938219070435 | 60.5581488609314 | 60.96742248535156 | [0.17329735 0.24146681 0.29149543] | [0.14408918 0.16571879 0.18065185] | [0.05293556 0.03745562 0.03037154] | [0.57029942 0.67100944 0.72965369] |
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.15535223484039307 BPR_loss 0.09523672610521317 reg_loss 0.060115501284599304
epoch: 20 s: 256000 batch_loss 0.14971387386322021 BPR_loss 0.09000054001808167 reg_loss 0.05971334129571915
epoch: 20 s: 512000 batch_loss 0.15932945907115936 BPR_loss 0.09644085168838501 reg_loss 0.06288860738277435
epoch: 20 s: 768000 batch_loss 0.14753921329975128 BPR_loss 0.08606916666030884 reg_loss 0.061470046639442444
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 63.82559132575989 | 69.83565664291382 | 59.768096923828125 | [0.17306399 0.24238768 0.29237328] | [0.1440629  0.16604187 0.18093957] | [0.0529925  0.03758875 0.03045136] | [0.57153862 0.67315292 0.73055797] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.14570356905460358 BPR_loss 0.0869620069861412 reg_loss 0.05874156206846237
epoch: 21 s: 256000 batch_loss 0.15492722392082214 BPR_loss 0.09458426386117935 reg_loss 0.06034296005964279
epoch: 21 s: 512000 batch_loss 0.14183712005615234 BPR_loss 0.08195066452026367 reg_loss 0.059886448085308075
epoch: 21 s: 768000 batch_loss 0.14397841691970825 BPR_loss 0.08196641504764557 reg_loss 0.06201200932264328
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 63.25128388404846 | 49.697290658950806 | 58.863155364990234 | [0.17200881 0.24200343 0.29094051] | [0.1432439  0.16551133 0.18013799] | [0.05254203 0.03745144 0.03029004] | [0.56768705 0.67171277 0.72858195] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.13807880878448486 BPR_loss 0.07611650973558426 reg_loss 0.06196229159832001
epoch: 22 s: 256000 batch_loss 0.1436050683259964 BPR_loss 0.08228403329849243 reg_loss 0.061321038752794266
epoch: 22 s: 512000 batch_loss 0.13952019810676575 BPR_loss 0.07841911166906357 reg_loss 0.06110108643770218
epoch: 22 s: 768000 batch_loss 0.14722298085689545 BPR_loss 0.08635839074850082 reg_loss 0.06086459010839462
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 69.52140188217163 | 68.58691120147705 | 57.837242126464844 | [0.17196294 0.24154396 0.29114156] | [0.14312785 0.16530618 0.18012245] | [0.05241811 0.03733924 0.03025097] | [0.56721817 0.67301896 0.72972068] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.14766059815883636 BPR_loss 0.08688896149396896 reg_loss 0.0607716403901577
epoch: 23 s: 256000 batch_loss 0.14089427888393402 BPR_loss 0.07971914857625961 reg_loss 0.061175134032964706
epoch: 23 s: 512000 batch_loss 0.14247605204582214 BPR_loss 0.08053818345069885 reg_loss 0.06193787604570389
epoch: 23 s: 768000 batch_loss 0.14219564199447632 BPR_loss 0.0806218609213829 reg_loss 0.06157378479838371
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 65.53113102912903 | 73.18319487571716 | 56.976470947265625 | [0.17277535 0.24188552 0.29151384] | [0.14398336 0.16595991 0.18080061] | [0.05261571 0.03734594 0.03024762] | [0.56909371 0.67435863 0.7304575 ] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.14238737523555756 BPR_loss 0.08074947446584702 reg_loss 0.06163790076971054
epoch: 24 s: 256000 batch_loss 0.13069869577884674 BPR_loss 0.07002879679203033 reg_loss 0.060669902712106705
epoch: 24 s: 512000 batch_loss 0.1488596498966217 BPR_loss 0.08620297908782959 reg_loss 0.06265667825937271
epoch: 24 s: 768000 batch_loss 0.14286503195762634 BPR_loss 0.08034126460552216 reg_loss 0.06252377480268478
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 63.838332176208496 | 57.342029333114624 | 56.01471710205078 | [0.17227611 0.24177555 0.29224021] | [0.14307333 0.16516934 0.1802396 ] | [0.052465   0.03726221 0.03028111] | [0.56906022 0.6732534  0.72968719] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.14478029310703278 BPR_loss 0.08269504457712173 reg_loss 0.06208525225520134
epoch: 25 s: 256000 batch_loss 0.14652112126350403 BPR_loss 0.08394741266965866 reg_loss 0.06257370859384537
epoch: 25 s: 512000 batch_loss 0.14081119000911713 BPR_loss 0.0802534818649292 reg_loss 0.060557711869478226
epoch: 25 s: 768000 batch_loss 0.15393796563148499 BPR_loss 0.08992446959018707 reg_loss 0.06401348859071732
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 62.557671308517456 | 51.34956884384155 | 55.334678649902344 | [0.1720712  0.24109232 0.29110786] | [0.1428804  0.16487711 0.1798489 ] | [0.05227912 0.03715922 0.03017896] | [0.56932815 0.67368879 0.72928528] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.1287965178489685 BPR_loss 0.06694822013378143 reg_loss 0.061848293989896774
epoch: 26 s: 256000 batch_loss 0.1347116082906723 BPR_loss 0.07225829362869263 reg_loss 0.06245331093668938
epoch: 26 s: 512000 batch_loss 0.1327684223651886 BPR_loss 0.07201720029115677 reg_loss 0.06075121834874153
epoch: 26 s: 768000 batch_loss 0.13424456119537354 BPR_loss 0.07262756675481796 reg_loss 0.06161699816584587
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 64.20190954208374 | 59.55966281890869 | 54.746639251708984 | [0.17282973 0.24124504 0.29095358] | [0.14363159 0.1654157  0.18029522] | [0.05250017 0.03721532 0.03019347] | [0.57096925 0.67298546 0.73035702] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.13263481855392456 BPR_loss 0.07169868797063828 reg_loss 0.060936130583286285
epoch: 27 s: 256000 batch_loss 0.13040006160736084 BPR_loss 0.06961634755134583 reg_loss 0.060783714056015015
epoch: 27 s: 512000 batch_loss 0.13953056931495667 BPR_loss 0.07746687531471252 reg_loss 0.06206369400024414
epoch: 27 s: 768000 batch_loss 0.13995596766471863 BPR_loss 0.0793549045920372 reg_loss 0.06060105934739113
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 65.80057144165039 | 94.99204659461975 | 53.93670654296875 | [0.17231417 0.241341   0.29058332] | [0.14321949 0.16520163 0.17997847] | [0.0522808  0.03716759 0.03014491] | [0.56875879 0.67261705 0.73075893] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 28 s: 0 batch_loss 0.13957738876342773 BPR_loss 0.07810236513614655 reg_loss 0.06147502362728119
epoch: 28 s: 256000 batch_loss 0.14112186431884766 BPR_loss 0.0784093588590622 reg_loss 0.06271251291036606
epoch: 28 s: 512000 batch_loss 0.12702743709087372 BPR_loss 0.06426769495010376 reg_loss 0.06275974214076996
epoch: 28 s: 768000 batch_loss 0.12474314868450165 BPR_loss 0.061614423990249634 reg_loss 0.06312872469425201
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   28  | 63.79613161087036 | 52.37136220932007 | 53.36589050292969 | [0.17270906 0.24186219 0.29038335] | [0.14341062 0.16540078 0.17996996] | [0.05231764 0.03712991 0.03005336] | [0.56875879 0.67368879 0.72861545] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 29 s: 0 batch_loss 0.1340203881263733 BPR_loss 0.07133711129426956 reg_loss 0.06268327683210373
epoch: 29 s: 256000 batch_loss 0.12941081821918488 BPR_loss 0.06733934581279755 reg_loss 0.06207147240638733
epoch: 29 s: 512000 batch_loss 0.13856224715709686 BPR_loss 0.07565078139305115 reg_loss 0.06291146576404572
epoch: 29 s: 768000 batch_loss 0.12550729513168335 BPR_loss 0.06325656175613403 reg_loss 0.06225072965025902
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   29  | 61.89270329475403 | 59.73028516769409 | 52.83815383911133 | [0.17254451 0.24153598 0.29131063] | [0.14318679 0.16515103 0.18011056] | [0.05225903 0.03710061 0.03016724] | [0.5695626  0.67275102 0.73059147] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.1725445057034327
early stopping at 29, recall@20:0.1733
