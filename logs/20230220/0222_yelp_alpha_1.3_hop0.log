Namespace(K=1, Ks='[20, 40, 60]', alpha=1.3, batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='yelp2018', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, gnn='lightgcn', gpu_id=3, l2=0.001, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, n_negs=64, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上进行softmax自适应权重,引入alpha超参数来控制模型倾向......
start training ...
epoch: 0 s: 0 batch_loss 0.6931486129760742 BPR_loss 0.6931484937667847 reg_loss 1.4336978892970365e-07
epoch: 0 s: 256000 batch_loss 0.6931031346321106 BPR_loss 0.6931003332138062 reg_loss 2.8007962100673467e-06
epoch: 0 s: 512000 batch_loss 0.6928206086158752 BPR_loss 0.6927946209907532 reg_loss 2.6002595404861495e-05
epoch: 0 s: 768000 batch_loss 0.6922555565834045 BPR_loss 0.6922152638435364 reg_loss 4.031219214084558e-05
epoch: 0 s: 1024000 batch_loss 0.6919800639152527 BPR_loss 0.6919191479682922 reg_loss 6.090704118832946e-05
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 229.81199979782104 | 45.483537673950195 | 418.2906188964844 | [0.05007099 0.08394203 0.11127   ] | [0.04104955 0.0538432  0.0634814 ] | [0.02360269 0.01986469 0.01767294] | [0.32329165 0.45332828 0.5341354 ] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6925936937332153 BPR_loss 0.692523717880249 reg_loss 6.995879084570333e-05
epoch: 1 s: 256000 batch_loss 0.6909624338150024 BPR_loss 0.6908751726150513 reg_loss 8.724416693439707e-05
epoch: 1 s: 512000 batch_loss 0.6924024820327759 BPR_loss 0.6922948360443115 reg_loss 0.00010762913734652102
epoch: 1 s: 768000 batch_loss 0.6913868188858032 BPR_loss 0.6912499666213989 reg_loss 0.00013685280282516032
epoch: 1 s: 1024000 batch_loss 0.6902593374252319 BPR_loss 0.6900467872619629 reg_loss 0.00021256088803056628
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 242.8993685245514 | 48.50809121131897 | 417.7721862792969 | [0.05131742 0.08628567 0.11511726] | [0.04212477 0.05536405 0.06550062] | [0.0241853  0.02048677 0.01830449] | [0.32812303 0.46365416 0.54490337] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6910473704338074 BPR_loss 0.6908111572265625 reg_loss 0.00023623285233043134
epoch: 2 s: 256000 batch_loss 0.6911874413490295 BPR_loss 0.69091796875 reg_loss 0.00026946785510517657
epoch: 2 s: 512000 batch_loss 0.6933711171150208 BPR_loss 0.6930743455886841 reg_loss 0.00029675671248696744
epoch: 2 s: 768000 batch_loss 0.6918464303016663 BPR_loss 0.6914747357368469 reg_loss 0.0003716946521308273
epoch: 2 s: 1024000 batch_loss 0.6871598958969116 BPR_loss 0.6867234706878662 reg_loss 0.0004364462220109999
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 247.82010793685913 | 50.44512414932251 | 417.0809020996094 | [0.05345872 0.08947141 0.11930265] | [0.04374352 0.05740288 0.06785493] | [0.02500632 0.02117279 0.01888131] | [0.33819629 0.47508526 0.56069218] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6891302466392517 BPR_loss 0.6886428594589233 reg_loss 0.00048739011981524527
epoch: 3 s: 256000 batch_loss 0.6896885633468628 BPR_loss 0.6891903877258301 reg_loss 0.0004981958772987127
epoch: 3 s: 512000 batch_loss 0.6878864765167236 BPR_loss 0.6872981786727905 reg_loss 0.0005883006961084902
epoch: 3 s: 768000 batch_loss 0.6887715458869934 BPR_loss 0.6881786584854126 reg_loss 0.0005928935715928674
epoch: 3 s: 1024000 batch_loss 0.6892571449279785 BPR_loss 0.6885902881622314 reg_loss 0.0006668451242148876
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 259.73699474334717 | 45.219850301742554 | 416.3951721191406 | [0.05481738 0.09174117 0.12192588] | [0.04472445 0.05868005 0.06931473] | [0.0255984  0.02161962 0.01929971] | [0.34394341 0.48345333 0.56662877] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.6870390176773071 BPR_loss 0.6863363981246948 reg_loss 0.0007026050589047372
epoch: 4 s: 256000 batch_loss 0.686241626739502 BPR_loss 0.6854357719421387 reg_loss 0.0008058606181293726
epoch: 4 s: 512000 batch_loss 0.6883956789970398 BPR_loss 0.6876579523086548 reg_loss 0.0007377322181127965
epoch: 4 s: 768000 batch_loss 0.6875265836715698 BPR_loss 0.6867107152938843 reg_loss 0.0008158527780324221
epoch: 4 s: 1024000 batch_loss 0.6893240809440613 BPR_loss 0.6885124444961548 reg_loss 0.0008116467506624758
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 258.63513922691345 | 43.73718309402466 | 415.84088134765625 | [0.05477915 0.09243604 0.12254801] | [0.04482048 0.05907929 0.06969229] | [0.02546893 0.02168356 0.01931656] | [0.34334344 0.48424277 0.56909183] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.6875848174095154 BPR_loss 0.6866298913955688 reg_loss 0.000954899936914444
epoch: 5 s: 256000 batch_loss 0.6871259212493896 BPR_loss 0.6861897110939026 reg_loss 0.0009361888514831662
epoch: 5 s: 512000 batch_loss 0.6878134608268738 BPR_loss 0.6869580745697021 reg_loss 0.0008554054656997323
epoch: 5 s: 768000 batch_loss 0.6888540387153625 BPR_loss 0.6880025863647461 reg_loss 0.0008514659130014479
epoch: 5 s: 1024000 batch_loss 0.6878628730773926 BPR_loss 0.6869611740112305 reg_loss 0.0009017008705995977
+-------+--------------------+-------------------+---------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |      Loss     |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+---------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 249.33643674850464 | 74.43459105491638 | 415.337890625 | [0.0554376  0.09300511 0.12366592] | [0.04537382 0.05961794 0.07039608] | [0.0257847  0.02191487 0.01951023] | [0.34634331 0.48711633 0.5715233 ] |
+-------+--------------------+-------------------+---------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.6868472695350647 BPR_loss 0.6858024597167969 reg_loss 0.0010447957320138812
epoch: 6 s: 256000 batch_loss 0.6886075735092163 BPR_loss 0.6876384019851685 reg_loss 0.0009691664017736912
epoch: 6 s: 512000 batch_loss 0.684615969657898 BPR_loss 0.6835546493530273 reg_loss 0.0010613205377012491
epoch: 6 s: 768000 batch_loss 0.6863288879394531 BPR_loss 0.6853345632553101 reg_loss 0.0009943284094333649
epoch: 6 s: 1024000 batch_loss 0.6895661354064941 BPR_loss 0.6886246204376221 reg_loss 0.0009415021631866693
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 221.08823680877686 | 105.19532752037048 | 414.927978515625 | [0.05584052 0.09346396 0.12419557] | [0.04571024 0.05998687 0.07079294] | [0.02594575 0.02201749 0.01961707] | [0.34716433 0.48954781 0.57256537] |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.6858090162277222 BPR_loss 0.6846793293952942 reg_loss 0.0011296787997707725
epoch: 7 s: 256000 batch_loss 0.6856926679611206 BPR_loss 0.6845253705978394 reg_loss 0.0011673100525513291
epoch: 7 s: 512000 batch_loss 0.6850650906562805 BPR_loss 0.6838564872741699 reg_loss 0.001208580331876874
epoch: 7 s: 768000 batch_loss 0.6846840977668762 BPR_loss 0.6835024356842041 reg_loss 0.00118166278116405
epoch: 7 s: 1024000 batch_loss 0.688029408454895 BPR_loss 0.6869217157363892 reg_loss 0.0011076763039454818
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 220.8825147151947 | 67.27879905700684 | 414.6249084472656 | [0.05553925 0.09309622 0.1237418 ] | [0.04542333 0.05966901 0.07046017] | [0.02575786 0.02185171 0.01949181] | [0.34552229 0.48569534 0.56994442] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.6868307590484619 BPR_loss 0.6856572031974792 reg_loss 0.0011735785519704223
epoch: 8 s: 256000 batch_loss 0.6870587468147278 BPR_loss 0.6858001947402954 reg_loss 0.0012585545191541314
epoch: 8 s: 512000 batch_loss 0.683110237121582 BPR_loss 0.6816620826721191 reg_loss 0.0014481768012046814
epoch: 8 s: 768000 batch_loss 0.6801451444625854 BPR_loss 0.6787872314453125 reg_loss 0.0013578890357166529
epoch: 8 s: 1024000 batch_loss 0.6873820424079895 BPR_loss 0.6861099600791931 reg_loss 0.0012720640515908599
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 220.65483570098877 | 55.33314228057861 | 414.37017822265625 | [0.05640128 0.09407949 0.12488087] | [0.04621519 0.06045672 0.07132777] | [0.02622837 0.0221146  0.0197218 ] | [0.3515852  0.49115827 0.57521789] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.6843046545982361 BPR_loss 0.6828243732452393 reg_loss 0.0014803021913394332
epoch: 9 s: 256000 batch_loss 0.6870954632759094 BPR_loss 0.6857864260673523 reg_loss 0.001309025101363659
epoch: 9 s: 512000 batch_loss 0.6841142773628235 BPR_loss 0.682741641998291 reg_loss 0.0013726644683629274
epoch: 9 s: 768000 batch_loss 0.6843310594558716 BPR_loss 0.6830089092254639 reg_loss 0.00132213463075459
epoch: 9 s: 1024000 batch_loss 0.6833446621894836 BPR_loss 0.6818490028381348 reg_loss 0.0014956558588892221
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 230.60174584388733 | 39.71266531944275 | 414.0809020996094 | [0.05661116 0.09434949 0.12551573] | [0.04653474 0.06077827 0.07176277] | [0.02641152 0.0222338  0.01986337] | [0.35142731 0.49128458 0.57657572] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.688560426235199 BPR_loss 0.6871289610862732 reg_loss 0.0014314812142401934
epoch: 10 s: 256000 batch_loss 0.6850979924201965 BPR_loss 0.6837353110313416 reg_loss 0.0013627067673951387
epoch: 10 s: 512000 batch_loss 0.6846207976341248 BPR_loss 0.6831691265106201 reg_loss 0.001451662858016789
epoch: 10 s: 768000 batch_loss 0.6839671730995178 BPR_loss 0.6825377941131592 reg_loss 0.001429379335604608
epoch: 10 s: 1024000 batch_loss 0.6867964267730713 BPR_loss 0.6853463053703308 reg_loss 0.0014501491095870733
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 225.90577912330627 | 46.295307636260986 | 413.8681335449219 | [0.05653645 0.09397737 0.12488176] | [0.04630654 0.06048225 0.07141297] | [0.02624732 0.02208302 0.01974654] | [0.3504484  0.48926361 0.57433371] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.6887524127960205 BPR_loss 0.6873154640197754 reg_loss 0.0014369753189384937
epoch: 11 s: 256000 batch_loss 0.6841956377029419 BPR_loss 0.6826165318489075 reg_loss 0.001579113188199699
epoch: 11 s: 512000 batch_loss 0.6837154626846313 BPR_loss 0.6822193264961243 reg_loss 0.0014961586566641927
epoch: 11 s: 768000 batch_loss 0.6854843497276306 BPR_loss 0.6840190887451172 reg_loss 0.0014652510872110724
epoch: 11 s: 1024000 batch_loss 0.6859496831893921 BPR_loss 0.684441089630127 reg_loss 0.0015085723716765642
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 228.82302856445312 | 51.204832553863525 | 413.6960144042969 | [0.05624555 0.09374559 0.12460506] | [0.04611392 0.06032951 0.07121112] | [0.0260768  0.02197723 0.01961549] | [0.34849059 0.48850575 0.57221801] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.6836680769920349 BPR_loss 0.6821638345718384 reg_loss 0.0015042545273900032
epoch: 12 s: 256000 batch_loss 0.6813141107559204 BPR_loss 0.679814338684082 reg_loss 0.0014997960533946753
epoch: 12 s: 512000 batch_loss 0.6828497052192688 BPR_loss 0.6812658309936523 reg_loss 0.0015838472172617912
epoch: 12 s: 768000 batch_loss 0.6840410232543945 BPR_loss 0.6825577020645142 reg_loss 0.0014833470340818167
epoch: 12 s: 1024000 batch_loss 0.6795229911804199 BPR_loss 0.6777568459510803 reg_loss 0.0017661532619968057
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 228.68977451324463 | 60.809062004089355 | 413.48333740234375 | [0.05654214 0.09409096 0.12518423] | [0.04643764 0.06062987 0.07160165] | [0.02630416 0.02211065 0.01977338] | [0.35114311 0.48935834 0.57446002] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.6826601028442383 BPR_loss 0.6808995008468628 reg_loss 0.0017605992034077644
epoch: 13 s: 256000 batch_loss 0.6864359378814697 BPR_loss 0.6849703788757324 reg_loss 0.0014655616832897067
epoch: 13 s: 512000 batch_loss 0.6850669980049133 BPR_loss 0.683547854423523 reg_loss 0.001519154291599989
epoch: 13 s: 768000 batch_loss 0.6843932271003723 BPR_loss 0.6825999021530151 reg_loss 0.0017933150520548224
epoch: 13 s: 1024000 batch_loss 0.6885178685188293 BPR_loss 0.6868619918823242 reg_loss 0.0016558710485696793
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 233.78226232528687 | 59.43133234977722 | 413.2729187011719 | [0.05637986 0.09377084 0.12460784] | [0.04627881 0.06041461 0.07129681] | [0.02619679 0.02199776 0.01963759] | [0.34871163 0.48667425 0.57221801] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.6826119422912598 BPR_loss 0.6808986663818359 reg_loss 0.001713275327347219
epoch: 14 s: 256000 batch_loss 0.6832463145256042 BPR_loss 0.6815483570098877 reg_loss 0.0016979505307972431
epoch: 14 s: 512000 batch_loss 0.6849598288536072 BPR_loss 0.6832060217857361 reg_loss 0.0017538312822580338
epoch: 14 s: 768000 batch_loss 0.6845402717590332 BPR_loss 0.6828321814537048 reg_loss 0.0017080610850825906
epoch: 14 s: 1024000 batch_loss 0.6839933395385742 BPR_loss 0.6822956800460815 reg_loss 0.0016976520419120789
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 223.34904289245605 | 58.907079458236694 | 413.1265869140625 | [0.05659183 0.09404309 0.12491573] | [0.04652005 0.06067265 0.0715595 ] | [0.02629468 0.02204828 0.01967443] | [0.35066945 0.48853732 0.57247063] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.6845324039459229 BPR_loss 0.6827765703201294 reg_loss 0.0017558123217895627
epoch: 15 s: 256000 batch_loss 0.6872603893280029 BPR_loss 0.6854943037033081 reg_loss 0.00176608853507787
epoch: 15 s: 512000 batch_loss 0.686119794845581 BPR_loss 0.6843245029449463 reg_loss 0.0017953140195459127
epoch: 15 s: 768000 batch_loss 0.6833255887031555 BPR_loss 0.6816806197166443 reg_loss 0.0016449595568701625
epoch: 15 s: 1024000 batch_loss 0.6852680444717407 BPR_loss 0.6835922598838806 reg_loss 0.0016757664270699024
+-------+--------------------+-------------------+---------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |      Loss     |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+---------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 217.02895379066467 | 60.46545624732971 | 413.021484375 | [0.05657172 0.09427211 0.12500824] | [0.04664827 0.06088323 0.07172047] | [0.02632784 0.02213512 0.01971917] | [0.34991158 0.48894783 0.5720917 ] |
+-------+--------------------+-------------------+---------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.6851500868797302 BPR_loss 0.6833832859992981 reg_loss 0.001766822300851345
epoch: 16 s: 256000 batch_loss 0.6810038685798645 BPR_loss 0.67913818359375 reg_loss 0.0018656858010217547
epoch: 16 s: 512000 batch_loss 0.682567834854126 BPR_loss 0.6806154251098633 reg_loss 0.0019524252275004983
epoch: 16 s: 768000 batch_loss 0.6824953556060791 BPR_loss 0.6806716918945312 reg_loss 0.001823642523959279
epoch: 16 s: 1024000 batch_loss 0.6837568879127502 BPR_loss 0.6819219589233398 reg_loss 0.0018349429592490196
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 212.3338143825531 | 63.57297730445862 | 412.94219970703125 | [0.0564053  0.09370353 0.12456643] | [0.04632699 0.06045311 0.07134803] | [0.02612416 0.02194171 0.01959654] | [0.34814324 0.48544272 0.57108122] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.68159019947052 BPR_loss 0.6796978116035461 reg_loss 0.0018924159230664372
epoch: 17 s: 256000 batch_loss 0.6845993399620056 BPR_loss 0.6827850937843323 reg_loss 0.0018142538610845804
epoch: 17 s: 512000 batch_loss 0.6824893951416016 BPR_loss 0.680726170539856 reg_loss 0.0017632108647376299
epoch: 17 s: 768000 batch_loss 0.6870428323745728 BPR_loss 0.6851043701171875 reg_loss 0.0019384654005989432
epoch: 17 s: 1024000 batch_loss 0.6847687363624573 BPR_loss 0.6828051805496216 reg_loss 0.0019635825883597136
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 215.57570910453796 | 69.38767337799072 | 412.8287658691406 | [0.05633876 0.09381215 0.12494546] | [0.04640956 0.0606247  0.0715976 ] | [0.02609574 0.02197881 0.0196397 ] | [0.34684855 0.4851901  0.57070229] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.6854299306869507 BPR_loss 0.6835243701934814 reg_loss 0.0019055433804169297
epoch: 18 s: 256000 batch_loss 0.6864321827888489 BPR_loss 0.684525191783905 reg_loss 0.0019070074195042253
epoch: 18 s: 512000 batch_loss 0.6806687712669373 BPR_loss 0.6787163019180298 reg_loss 0.0019524708623066545
epoch: 18 s: 768000 batch_loss 0.6846450567245483 BPR_loss 0.6828152537345886 reg_loss 0.0018298114882782102
epoch: 18 s: 1024000 batch_loss 0.6828444004058838 BPR_loss 0.6809604167938232 reg_loss 0.0018839765107259154
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 211.52775835990906 | 70.02592134475708 | 412.71270751953125 | [0.05695246 0.09404034 0.12453135] | [0.04688696 0.06091358 0.0716742 ] | [0.026361   0.02203328 0.01961075] | [0.34988001 0.48550587 0.56956549] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.6826145052909851 BPR_loss 0.6807669401168823 reg_loss 0.0018475502729415894
epoch: 19 s: 256000 batch_loss 0.6832602024078369 BPR_loss 0.6813535690307617 reg_loss 0.0019066446693614125
epoch: 19 s: 512000 batch_loss 0.6828799843788147 BPR_loss 0.6811040639877319 reg_loss 0.0017759389011189342
epoch: 19 s: 768000 batch_loss 0.6832308769226074 BPR_loss 0.6813743114471436 reg_loss 0.0018565469654276967
epoch: 19 s: 1024000 batch_loss 0.6814406514167786 BPR_loss 0.6793702244758606 reg_loss 0.0020704385824501514
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 216.6994445323944 | 71.55389285087585 | 412.5527648925781 | [0.05671639 0.09372601 0.12427091] | [0.04663686 0.06066301 0.07141203] | [0.02621732 0.02194408 0.01951444] | [0.34842743 0.48455854 0.56754452] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.683820366859436 BPR_loss 0.6819979548454285 reg_loss 0.0018224413506686687
epoch: 20 s: 256000 batch_loss 0.6837638020515442 BPR_loss 0.6818620562553406 reg_loss 0.0019017682643607259
epoch: 20 s: 512000 batch_loss 0.6791256070137024 BPR_loss 0.677008867263794 reg_loss 0.0021167632658034563
epoch: 20 s: 768000 batch_loss 0.6813576221466064 BPR_loss 0.6791601777076721 reg_loss 0.0021974581759423018
epoch: 20 s: 1024000 batch_loss 0.6813623309135437 BPR_loss 0.679307222366333 reg_loss 0.0020551031921058893
+-------+--------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |  tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 215.67614793777466 | 66.7796061038971 | 412.45501708984375 | [0.05667314 0.09389931 0.12460168] | [0.04667742 0.06077578 0.0715942 ] | [0.02619206 0.0219725  0.0195776 ] | [0.34864848 0.48572692 0.56918656] |
+-------+--------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.6798679828643799 BPR_loss 0.6777889728546143 reg_loss 0.002078997902572155
epoch: 21 s: 256000 batch_loss 0.683667778968811 BPR_loss 0.6816480755805969 reg_loss 0.0020196863915771246
epoch: 21 s: 512000 batch_loss 0.6815478205680847 BPR_loss 0.6793380975723267 reg_loss 0.0022097446490079165
epoch: 21 s: 768000 batch_loss 0.678657054901123 BPR_loss 0.6765545606613159 reg_loss 0.002102483296766877
epoch: 21 s: 1024000 batch_loss 0.6798502802848816 BPR_loss 0.6776614189147949 reg_loss 0.0021888839546591043
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 217.39105248451233 | 59.62670135498047 | 412.3018493652344 | [0.05644561 0.09360209 0.12403561] | [0.04653959 0.06060845 0.07133176] | [0.02609416 0.02186513 0.01944918] | [0.34732222 0.48260073 0.56628142] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.6875881552696228 BPR_loss 0.6855629682540894 reg_loss 0.0020251607056707144
epoch: 22 s: 256000 batch_loss 0.6819751858711243 BPR_loss 0.679960310459137 reg_loss 0.0020148977637290955
epoch: 22 s: 512000 batch_loss 0.6821313500404358 BPR_loss 0.6801192760467529 reg_loss 0.0020120914559811354
epoch: 22 s: 768000 batch_loss 0.6851469874382019 BPR_loss 0.6829607486724854 reg_loss 0.002186248544603586
epoch: 22 s: 1024000 batch_loss 0.6868947744369507 BPR_loss 0.6849384903907776 reg_loss 0.0019563031382858753
+-------+--------------------+--------------------+---------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |      Loss     |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+---------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 223.93328070640564 | 44.816930294036865 | 412.326171875 | [0.0564825  0.0935802  0.12404158] | [0.04641595 0.06046855 0.07123671] | [0.02599943 0.02177514 0.01941655] | [0.3465012  0.48117974 0.56498674] |
+-------+--------------------+--------------------+---------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.6798920035362244 BPR_loss 0.6776728630065918 reg_loss 0.002219138666987419
epoch: 23 s: 256000 batch_loss 0.6837369799613953 BPR_loss 0.6816038489341736 reg_loss 0.0021331270691007376
epoch: 23 s: 512000 batch_loss 0.6812798380851746 BPR_loss 0.6790701746940613 reg_loss 0.0022096747998148203
epoch: 23 s: 768000 batch_loss 0.6856585144996643 BPR_loss 0.683607280254364 reg_loss 0.00205124425701797
epoch: 23 s: 1024000 batch_loss 0.6754969954490662 BPR_loss 0.6733691096305847 reg_loss 0.0021278716158121824
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 221.06061935424805 | 43.90563130378723 | 412.1807861328125 | [0.05652081 0.09391171 0.12426069] | [0.04648559 0.06060646 0.07129886] | [0.02611469 0.02187461 0.01943234] | [0.34836428 0.48357964 0.56637615] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.6846526861190796 BPR_loss 0.682401716709137 reg_loss 0.0022509675472974777
epoch: 24 s: 256000 batch_loss 0.683557391166687 BPR_loss 0.6814396977424622 reg_loss 0.002117680385708809
epoch: 24 s: 512000 batch_loss 0.6840871572494507 BPR_loss 0.6820451021194458 reg_loss 0.0020420525688678026
epoch: 24 s: 768000 batch_loss 0.6818452477455139 BPR_loss 0.6796985864639282 reg_loss 0.0021466370671987534
epoch: 24 s: 1024000 batch_loss 0.6808074712753296 BPR_loss 0.6787335872650146 reg_loss 0.002073857234790921
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 226.83261847496033 | 41.67636966705322 | 412.0977478027344 | [0.05660448 0.09365298 0.12401709] | [0.04646345 0.06052145 0.07121472] | [0.02605627 0.02183592 0.01940392] | [0.34725906 0.48304282 0.56533409] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.6813501715660095 BPR_loss 0.6791219711303711 reg_loss 0.002228200202807784
epoch: 25 s: 256000 batch_loss 0.6858741044998169 BPR_loss 0.6835986375808716 reg_loss 0.0022754373494535685
epoch: 25 s: 512000 batch_loss 0.682307779788971 BPR_loss 0.6800966262817383 reg_loss 0.0022111765574663877
epoch: 25 s: 768000 batch_loss 0.6827617883682251 BPR_loss 0.6805827617645264 reg_loss 0.00217904313467443
epoch: 25 s: 1024000 batch_loss 0.6804118752479553 BPR_loss 0.6781576871871948 reg_loss 0.002254198770970106
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 224.3564875125885 | 39.86028790473938 | 411.9583435058594 | [0.05643663 0.09361239 0.12379187] | [0.04656136 0.06063958 0.07128842] | [0.02603575 0.02185645 0.01943023] | [0.34605911 0.48162183 0.56337628] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.6828668117523193 BPR_loss 0.6807368993759155 reg_loss 0.002129933563992381
epoch: 26 s: 256000 batch_loss 0.6806387901306152 BPR_loss 0.6783159971237183 reg_loss 0.002322810934856534
epoch: 26 s: 512000 batch_loss 0.6774638891220093 BPR_loss 0.6751484870910645 reg_loss 0.002315401565283537
epoch: 26 s: 768000 batch_loss 0.6822457909584045 BPR_loss 0.6800292730331421 reg_loss 0.002216495107859373
epoch: 26 s: 1024000 batch_loss 0.6768894195556641 BPR_loss 0.6746548414230347 reg_loss 0.002234562300145626
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 228.32055139541626 | 39.05265402793884 | 411.93145751953125 | [0.05623464 0.09346335 0.12364322] | [0.04620318 0.06033828 0.07097812] | [0.02582891 0.0217033  0.01928498] | [0.34542756 0.48130605 0.56321839] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.6829529404640198 BPR_loss 0.680700421333313 reg_loss 0.0022525021340698004
epoch: 27 s: 256000 batch_loss 0.6844863891601562 BPR_loss 0.6823387145996094 reg_loss 0.0021476789843291044
epoch: 27 s: 512000 batch_loss 0.683080792427063 BPR_loss 0.6808246374130249 reg_loss 0.002256159670650959
epoch: 27 s: 768000 batch_loss 0.6844398379325867 BPR_loss 0.6821110248565674 reg_loss 0.0023288042284548283
epoch: 27 s: 1024000 batch_loss 0.6787863373756409 BPR_loss 0.6766321659088135 reg_loss 0.002154169837012887
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 223.33372592926025 | 38.98452568054199 | 411.8560791015625 | [0.05641103 0.09355759 0.123781  ] | [0.04639254 0.0604769  0.07112874] | [0.02598206 0.02178382 0.01933919] | [0.34580649 0.48174814 0.5630605 ] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 28 s: 0 batch_loss 0.6810805201530457 BPR_loss 0.6787459254264832 reg_loss 0.002334600081667304
epoch: 28 s: 256000 batch_loss 0.6793756484985352 BPR_loss 0.6770490407943726 reg_loss 0.0023265948984771967
epoch: 28 s: 512000 batch_loss 0.6798999309539795 BPR_loss 0.6774661540985107 reg_loss 0.0024337819777429104
epoch: 28 s: 768000 batch_loss 0.6842331886291504 BPR_loss 0.6819968223571777 reg_loss 0.0022363420575857162
epoch: 28 s: 1024000 batch_loss 0.6785059571266174 BPR_loss 0.6762475967407227 reg_loss 0.0022583683021366596
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   28  | 224.72314858436584 | 38.02397179603577 | 411.7407531738281 | [0.05626892 0.09344817 0.12360279] | [0.04636205 0.06043278 0.07108619] | [0.0259047  0.02169856 0.01930603] | [0.34517494 0.48045345 0.56249211] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.05626892235826501
early stopping at 28, recall@20:0.0570
