Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='yelp2018', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.001, lr=0.003, mess_dropout=False, mess_dropout_rate=0.1, n_negs=64, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.693148672580719 BPR_loss 0.6931484937667847 reg_loss 1.7170005151001533e-07
epoch: 0 s: 256000 batch_loss 0.693148136138916 BPR_loss 0.6931478977203369 reg_loss 2.65040341673739e-07
epoch: 0 s: 512000 batch_loss 0.6931374669075012 BPR_loss 0.6931198239326477 reg_loss 1.7666665371507406e-05
epoch: 0 s: 768000 batch_loss 0.6929605007171631 BPR_loss 0.6926960945129395 reg_loss 0.0002644060004968196
epoch: 0 s: 1024000 batch_loss 0.6919095516204834 BPR_loss 0.6907676458358765 reg_loss 0.001141894143074751
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 208.25423097610474 | 35.76469111442566 | 418.38153076171875 | [0.0592228  0.09876217 0.13010733] | [0.04863478 0.0635198  0.07449934] | [0.02711254 0.02271694 0.02009757] | [0.36873184 0.51626247 0.60079576] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6904281377792358 BPR_loss 0.688194990158081 reg_loss 0.0022331452928483486
epoch: 1 s: 256000 batch_loss 0.6874298453330994 BPR_loss 0.6831976771354675 reg_loss 0.004232182167470455
epoch: 1 s: 512000 batch_loss 0.6862752437591553 BPR_loss 0.6802819967269897 reg_loss 0.005993275437504053
epoch: 1 s: 768000 batch_loss 0.6814156770706177 BPR_loss 0.6730232238769531 reg_loss 0.008392435498535633
epoch: 1 s: 1024000 batch_loss 0.6811628341674805 BPR_loss 0.6704958081245422 reg_loss 0.010667032562196255
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 211.1019217967987 | 35.05158019065857 | 413.96807861328125 | [0.06185612 0.10164987 0.13504929] | [0.05059368 0.06557223 0.07725668] | [0.02818618 0.02341875 0.02084702] | [0.38095238 0.52655678 0.61323734] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6774601340293884 BPR_loss 0.664703369140625 reg_loss 0.012756790965795517
epoch: 2 s: 256000 batch_loss 0.6778690814971924 BPR_loss 0.6632087230682373 reg_loss 0.014660343527793884
epoch: 2 s: 512000 batch_loss 0.6775394082069397 BPR_loss 0.6602336764335632 reg_loss 0.01730571873486042
epoch: 2 s: 768000 batch_loss 0.674485445022583 BPR_loss 0.6547390222549438 reg_loss 0.019746406003832817
epoch: 2 s: 1024000 batch_loss 0.6645394563674927 BPR_loss 0.6421562433242798 reg_loss 0.022383183240890503
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 207.57669830322266 | 35.23359990119934 | 407.3643798828125 | [0.06292228 0.10358342 0.13741528] | [0.05141471 0.06675209 0.07858089] | [0.02860301 0.02383084 0.02117963] | [0.38663635 0.53078818 0.61971075] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6675460338592529 BPR_loss 0.6428676843643188 reg_loss 0.024678345769643784
epoch: 3 s: 256000 batch_loss 0.6707779169082642 BPR_loss 0.643819272518158 reg_loss 0.02695867046713829
epoch: 3 s: 512000 batch_loss 0.6618868708610535 BPR_loss 0.6334532499313354 reg_loss 0.028433633968234062
epoch: 3 s: 768000 batch_loss 0.6632106900215149 BPR_loss 0.6310950517654419 reg_loss 0.032115623354911804
epoch: 3 s: 1024000 batch_loss 0.6634442210197449 BPR_loss 0.6305376291275024 reg_loss 0.03290660306811333
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 206.47914338111877 | 35.43757462501526 | 401.391357421875 | [0.06378685 0.10496896 0.13890214] | [0.05210942 0.06758609 0.07947866] | [0.02906088 0.02408583 0.02139331] | [0.39127826 0.53505116 0.62220538] |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.658250629901886 BPR_loss 0.6219766736030579 reg_loss 0.036273933947086334
epoch: 4 s: 256000 batch_loss 0.6540133953094482 BPR_loss 0.61543869972229 reg_loss 0.0385746955871582
epoch: 4 s: 512000 batch_loss 0.6551306247711182 BPR_loss 0.6159874796867371 reg_loss 0.03914312273263931
epoch: 4 s: 768000 batch_loss 0.6529619097709656 BPR_loss 0.6100223064422607 reg_loss 0.04293959215283394
epoch: 4 s: 1024000 batch_loss 0.6584579944610596 BPR_loss 0.6152032613754272 reg_loss 0.04325472563505173
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 212.14271235466003 | 34.65925669670105 | 396.2243957519531 | [0.06449135 0.10564529 0.14030697] | [0.05262702 0.06810396 0.0802265 ] | [0.02935613 0.02427529 0.02159278] | [0.39383605 0.53716686 0.62533156] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.6547603607177734 BPR_loss 0.6098823547363281 reg_loss 0.04487799108028412
epoch: 5 s: 256000 batch_loss 0.6436423063278198 BPR_loss 0.5950886011123657 reg_loss 0.048553697764873505
epoch: 5 s: 512000 batch_loss 0.6511671543121338 BPR_loss 0.6015400886535645 reg_loss 0.04962706193327904
epoch: 5 s: 768000 batch_loss 0.6479223966598511 BPR_loss 0.5975930690765381 reg_loss 0.05032934993505478
epoch: 5 s: 1024000 batch_loss 0.6441017389297485 BPR_loss 0.5911826491355896 reg_loss 0.052919089794158936
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 211.2836434841156 | 36.00099992752075 | 391.744873046875 | [0.06473576 0.10678514 0.14081156] | [0.05301195 0.06886849 0.08077881] | [0.02946192 0.02453739 0.02169382] | [0.39487811 0.54111406 0.62561576] |
+-------+-------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.6402571797370911 BPR_loss 0.5853039622306824 reg_loss 0.05495321750640869
epoch: 6 s: 256000 batch_loss 0.6444350481033325 BPR_loss 0.5889471769332886 reg_loss 0.055487848818302155
epoch: 6 s: 512000 batch_loss 0.6364812254905701 BPR_loss 0.5774497985839844 reg_loss 0.05903143435716629
epoch: 6 s: 768000 batch_loss 0.6392573118209839 BPR_loss 0.5805872082710266 reg_loss 0.05867008492350578
epoch: 6 s: 1024000 batch_loss 0.6457127928733826 BPR_loss 0.5854421854019165 reg_loss 0.060270603746175766
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 209.75021815299988 | 36.313313484191895 | 387.970458984375 | [0.06516604 0.10714333 0.14170127] | [0.05325714 0.06909707 0.08119418] | [0.0295977  0.02460607 0.02182013] | [0.3968675  0.54196665 0.62845775] |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.6368457674980164 BPR_loss 0.5742076635360718 reg_loss 0.06263809651136398
epoch: 7 s: 256000 batch_loss 0.6332842111587524 BPR_loss 0.5675410628318787 reg_loss 0.06574314832687378
epoch: 7 s: 512000 batch_loss 0.6300296783447266 BPR_loss 0.5629180669784546 reg_loss 0.06711160391569138
epoch: 7 s: 768000 batch_loss 0.6348784565925598 BPR_loss 0.5681876540184021 reg_loss 0.06669079512357712
epoch: 7 s: 1024000 batch_loss 0.6404191851615906 BPR_loss 0.5727148652076721 reg_loss 0.06770433485507965
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 215.24017238616943 | 41.95750856399536 | 384.8320007324219 | [0.06538361 0.10770733 0.14247765] | [0.05348219 0.06943155 0.08161825] | [0.02972243 0.02470317 0.02194539] | [0.3977201  0.5443034  0.62956297] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.6366047263145447 BPR_loss 0.5679422616958618 reg_loss 0.06866248697042465
epoch: 8 s: 256000 batch_loss 0.6313600540161133 BPR_loss 0.5608632564544678 reg_loss 0.07049679756164551
epoch: 8 s: 512000 batch_loss 0.6261879801750183 BPR_loss 0.5521925091743469 reg_loss 0.07399545609951019
epoch: 8 s: 768000 batch_loss 0.6221157312393188 BPR_loss 0.5492660999298096 reg_loss 0.07284961640834808
epoch: 8 s: 1024000 batch_loss 0.6273853778839111 BPR_loss 0.5516290664672852 reg_loss 0.07575628906488419
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 213.15658926963806 | 40.80829358100891 | 381.9678649902344 | [0.06567765 0.10814887 0.14300797] | [0.05379475 0.06981064 0.08199664] | [0.02982506 0.02481685 0.0219996 ] | [0.39873058 0.54474548 0.63016294] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.6257319450378418 BPR_loss 0.5468822717666626 reg_loss 0.078849658370018
epoch: 9 s: 256000 batch_loss 0.6356732845306396 BPR_loss 0.5580850839614868 reg_loss 0.07758820056915283
epoch: 9 s: 512000 batch_loss 0.6266252994537354 BPR_loss 0.5479304790496826 reg_loss 0.07869482040405273
epoch: 9 s: 768000 batch_loss 0.6249856948852539 BPR_loss 0.5457217693328857 reg_loss 0.07926391810178757
epoch: 9 s: 1024000 batch_loss 0.6206612586975098 BPR_loss 0.5391247272491455 reg_loss 0.08153654634952545
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 207.80749130249023 | 45.48449659347534 | 379.3692626953125 | [0.0661823  0.10849974 0.14379029] | [0.05406048 0.06999916 0.08236369] | [0.03002084 0.02486501 0.02212275] | [0.40113048 0.54597701 0.63224706] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.6287358403205872 BPR_loss 0.545151948928833 reg_loss 0.08358389139175415
epoch: 10 s: 256000 batch_loss 0.6240552663803101 BPR_loss 0.540556013584137 reg_loss 0.0834992453455925
epoch: 10 s: 512000 batch_loss 0.6266031265258789 BPR_loss 0.5436893105506897 reg_loss 0.0829138457775116
epoch: 10 s: 768000 batch_loss 0.6248171925544739 BPR_loss 0.5407148599624634 reg_loss 0.08410235494375229
epoch: 10 s: 1024000 batch_loss 0.6246548891067505 BPR_loss 0.5408291220664978 reg_loss 0.08382578939199448
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |  tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 208.29382586479187 | 39.8808536529541 | 377.0362243652344 | [0.06634042 0.10884389 0.14359197] | [0.05430958 0.07032702 0.08251036] | [0.03009031 0.02495027 0.02211591] | [0.40214096 0.54676645 0.63256284] |
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.6282538175582886 BPR_loss 0.5410188436508179 reg_loss 0.0872349739074707
epoch: 11 s: 256000 batch_loss 0.6197587251663208 BPR_loss 0.5327273607254028 reg_loss 0.08703137934207916
epoch: 11 s: 512000 batch_loss 0.6210538744926453 BPR_loss 0.5332819223403931 reg_loss 0.08777197450399399
epoch: 11 s: 768000 batch_loss 0.620112419128418 BPR_loss 0.5324400663375854 reg_loss 0.08767237514257431
epoch: 11 s: 1024000 batch_loss 0.6219247579574585 BPR_loss 0.5311390161514282 reg_loss 0.09078573435544968
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 206.01907539367676 | 39.77604150772095 | 374.9591369628906 | [0.06637489 0.10893301 0.14383682] | [0.05433945 0.07038497 0.0826305 ] | [0.03006505 0.02492263 0.0221338 ] | [0.4013831  0.54695592 0.63231022] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.6212562322616577 BPR_loss 0.529558002948761 reg_loss 0.09169819951057434
epoch: 12 s: 256000 batch_loss 0.6121023893356323 BPR_loss 0.5200868844985962 reg_loss 0.09201548993587494
epoch: 12 s: 512000 batch_loss 0.6144499778747559 BPR_loss 0.5210342407226562 reg_loss 0.0934157520532608
epoch: 12 s: 768000 batch_loss 0.6191842555999756 BPR_loss 0.5279524326324463 reg_loss 0.0912318006157875
epoch: 12 s: 1024000 batch_loss 0.6082054972648621 BPR_loss 0.5127513408660889 reg_loss 0.09545417875051498
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 210.0422809123993 | 38.085625648498535 | 373.10498046875 | [0.06659973 0.10898835 0.1443936 ] | [0.0545174  0.0705121  0.08292511] | [0.03014399 0.02495342 0.02219591] | [0.40217254 0.54749274 0.63414172] |
+-------+-------------------+--------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.6143653392791748 BPR_loss 0.5167930722236633 reg_loss 0.09757223725318909
epoch: 13 s: 256000 batch_loss 0.6158610582351685 BPR_loss 0.5216124057769775 reg_loss 0.09424867480993271
epoch: 13 s: 512000 batch_loss 0.6211209893226624 BPR_loss 0.5234721899032593 reg_loss 0.09764880686998367
epoch: 13 s: 768000 batch_loss 0.6115878820419312 BPR_loss 0.5135023593902588 reg_loss 0.09808550029993057
epoch: 13 s: 1024000 batch_loss 0.6229326725006104 BPR_loss 0.5269811749458313 reg_loss 0.09595152735710144
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 208.1390233039856 | 39.06598377227783 | 371.34344482421875 | [0.06658033 0.10937449 0.14417889] | [0.05466401 0.07077837 0.08299097] | [0.03018189 0.02502763 0.0221738 ] | [0.40201465 0.54802956 0.63423645] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.6083756685256958 BPR_loss 0.508842945098877 reg_loss 0.09953273832798004
epoch: 14 s: 256000 batch_loss 0.6074996590614319 BPR_loss 0.509372353553772 reg_loss 0.0981273204088211
epoch: 14 s: 512000 batch_loss 0.6129615306854248 BPR_loss 0.5128957033157349 reg_loss 0.10006584972143173
epoch: 14 s: 768000 batch_loss 0.6139926314353943 BPR_loss 0.5142554640769958 reg_loss 0.09973718225955963
epoch: 14 s: 1024000 batch_loss 0.6114323139190674 BPR_loss 0.5096746683120728 reg_loss 0.10175766795873642
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 207.96333384513855 | 38.282795667648315 | 369.6177978515625 | [0.06685131 0.10933253 0.14468735] | [0.05482203 0.07083469 0.08322875] | [0.03030662 0.02505368 0.02225696] | [0.40419351 0.54799798 0.63455223] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.6165614128112793 BPR_loss 0.5124384164810181 reg_loss 0.10412301123142242
epoch: 15 s: 256000 batch_loss 0.611780047416687 BPR_loss 0.5091292262077332 reg_loss 0.10265079885721207
epoch: 15 s: 512000 batch_loss 0.6104682683944702 BPR_loss 0.5065608620643616 reg_loss 0.10390740633010864
epoch: 15 s: 768000 batch_loss 0.6081439256668091 BPR_loss 0.5051714777946472 reg_loss 0.10297246277332306
epoch: 15 s: 1024000 batch_loss 0.6081222295761108 BPR_loss 0.5041041374206543 reg_loss 0.10401806235313416
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 207.26026701927185 | 39.10688877105713 | 368.1607360839844 | [0.06735522 0.11006043 0.14521522] | [0.05518913 0.07127782 0.08359968] | [0.03049608 0.02520999 0.02234116] | [0.40454086 0.54998737 0.63477327] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.6029864549636841 BPR_loss 0.49806320667266846 reg_loss 0.10492324829101562
epoch: 16 s: 256000 batch_loss 0.5992981791496277 BPR_loss 0.4927879869937897 reg_loss 0.1065102070569992
epoch: 16 s: 512000 batch_loss 0.6108511686325073 BPR_loss 0.5022640228271484 reg_loss 0.10858717560768127
epoch: 16 s: 768000 batch_loss 0.6070645451545715 BPR_loss 0.5005874633789062 reg_loss 0.10647705942392349
epoch: 16 s: 1024000 batch_loss 0.6086407899856567 BPR_loss 0.4971676170825958 reg_loss 0.1114731952548027
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 206.82751870155334 | 40.01691651344299 | 366.6016540527344 | [0.06717693 0.11008701 0.1450347 ] | [0.05514629 0.07132578 0.08355946] | [0.0304503  0.02523131 0.02230801] | [0.40482506 0.55011368 0.63518378] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.6048425436019897 BPR_loss 0.4989674687385559 reg_loss 0.10587505251169205
epoch: 17 s: 256000 batch_loss 0.6121690273284912 BPR_loss 0.5020876526832581 reg_loss 0.11008139699697495
epoch: 17 s: 512000 batch_loss 0.6035915613174438 BPR_loss 0.49414217472076416 reg_loss 0.1094493716955185
epoch: 17 s: 768000 batch_loss 0.6128128170967102 BPR_loss 0.5024135112762451 reg_loss 0.11039932072162628
epoch: 17 s: 1024000 batch_loss 0.604535698890686 BPR_loss 0.49346280097961426 reg_loss 0.11107288300991058
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 205.71015119552612 | 43.552505016326904 | 365.4454040527344 | [0.06735052 0.11005703 0.14499771] | [0.05536262 0.07143958 0.08367801] | [0.03050872 0.02521078 0.02228643] | [0.40545661 0.54878742 0.63499432] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.6030927300453186 BPR_loss 0.4908772110939026 reg_loss 0.11221553385257721
epoch: 18 s: 256000 batch_loss 0.6057121157646179 BPR_loss 0.4921048879623413 reg_loss 0.11360721290111542
epoch: 18 s: 512000 batch_loss 0.6022902727127075 BPR_loss 0.49008989334106445 reg_loss 0.11220034956932068
epoch: 18 s: 768000 batch_loss 0.6066232323646545 BPR_loss 0.49626293778419495 reg_loss 0.11036031693220139
epoch: 18 s: 1024000 batch_loss 0.6049286723136902 BPR_loss 0.49092811346054077 reg_loss 0.11400055140256882
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 206.9830183982849 | 41.29305076599121 | 364.1454772949219 | [0.06757095 0.11017698 0.14516188] | [0.05546744 0.07150884 0.08378344] | [0.03057819 0.02523604 0.02233695] | [0.40580397 0.54932424 0.63505747] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.6019938588142395 BPR_loss 0.48991137742996216 reg_loss 0.11208249628543854
epoch: 19 s: 256000 batch_loss 0.6026134490966797 BPR_loss 0.48787662386894226 reg_loss 0.11473684757947922
epoch: 19 s: 512000 batch_loss 0.59371417760849 BPR_loss 0.4800715446472168 reg_loss 0.1136426106095314
epoch: 19 s: 768000 batch_loss 0.6016393899917603 BPR_loss 0.48788708448410034 reg_loss 0.11375231295824051
epoch: 19 s: 1024000 batch_loss 0.5952534675598145 BPR_loss 0.4775301218032837 reg_loss 0.11772337555885315
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 207.90862917900085 | 40.49431395530701 | 362.7948913574219 | [0.0672505  0.11030372 0.14504463] | [0.05528431 0.07147635 0.0836538 ] | [0.03051977 0.02524709 0.02229801] | [0.40447771 0.54992421 0.63496274] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.6024415493011475 BPR_loss 0.4871624708175659 reg_loss 0.11527910083532333
epoch: 20 s: 256000 batch_loss 0.5971494913101196 BPR_loss 0.47789421677589417 reg_loss 0.11925526708364487
epoch: 20 s: 512000 batch_loss 0.5920583009719849 BPR_loss 0.4761098027229309 reg_loss 0.11594848334789276
epoch: 20 s: 768000 batch_loss 0.5954776406288147 BPR_loss 0.4780328869819641 reg_loss 0.11744476854801178
epoch: 20 s: 1024000 batch_loss 0.6004068851470947 BPR_loss 0.4796901047229767 reg_loss 0.12071678042411804
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 206.8817527294159 | 36.69116187095642 | 361.59063720703125 | [0.06730173 0.11015276 0.14541649] | [0.05540421 0.07154762 0.0838866 ] | [0.03052608 0.02526052 0.02236222] | [0.40551977 0.55001895 0.63578376] |
+-------+-------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.5945210456848145 BPR_loss 0.4729821979999542 reg_loss 0.12153884023427963
epoch: 21 s: 256000 batch_loss 0.6012710928916931 BPR_loss 0.479041188955307 reg_loss 0.1222299113869667
epoch: 21 s: 512000 batch_loss 0.5959224700927734 BPR_loss 0.4752993881702423 reg_loss 0.12062305957078934
epoch: 21 s: 768000 batch_loss 0.5891151428222656 BPR_loss 0.4711211919784546 reg_loss 0.11799392849206924
epoch: 21 s: 1024000 batch_loss 0.5953651070594788 BPR_loss 0.47467041015625 reg_loss 0.12069467455148697
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 207.4793426990509 | 36.20721745491028 | 360.5892028808594 | [0.06718932 0.11039254 0.14542184] | [0.05527297 0.07152803 0.08380864] | [0.03046451 0.02524867 0.02234169] | [0.40419351 0.55115574 0.63546798] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.5968709588050842 BPR_loss 0.4774515628814697 reg_loss 0.11941938102245331
epoch: 22 s: 256000 batch_loss 0.5957841277122498 BPR_loss 0.4735299050807953 reg_loss 0.12225423008203506
epoch: 22 s: 512000 batch_loss 0.5952004790306091 BPR_loss 0.4735319912433624 reg_loss 0.1216685026884079
epoch: 22 s: 768000 batch_loss 0.6048187017440796 BPR_loss 0.48082274198532104 reg_loss 0.12399597465991974
epoch: 22 s: 1024000 batch_loss 0.6007287502288818 BPR_loss 0.4821324944496155 reg_loss 0.11859628558158875
+-------+--------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 207.51338744163513 | 34.81910753250122 | 359.54052734375 | [0.06724992 0.11042171 0.14557386] | [0.05547168 0.07171611 0.08403908] | [0.03053398 0.02527867 0.02236643] | [0.40466717 0.55046103 0.63660477] |
+-------+--------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.5916672348976135 BPR_loss 0.4695665240287781 reg_loss 0.12210072576999664
epoch: 23 s: 256000 batch_loss 0.5973562002182007 BPR_loss 0.47607606649398804 reg_loss 0.12128015607595444
epoch: 23 s: 512000 batch_loss 0.5934571623802185 BPR_loss 0.46903765201568604 reg_loss 0.12441952526569366
epoch: 23 s: 768000 batch_loss 0.5931612849235535 BPR_loss 0.4723530411720276 reg_loss 0.12080826610326767
epoch: 23 s: 1024000 batch_loss 0.5853492021560669 BPR_loss 0.4581851363182068 reg_loss 0.12716403603553772
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 207.93687391281128 | 35.305625200271606 | 358.4717712402344 | [0.06719522 0.11052986 0.14542574] | [0.05531529 0.0716342  0.08385334] | [0.03048661 0.02529367 0.02233801] | [0.403783   0.55150309 0.63534167] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.5914598703384399 BPR_loss 0.4683429002761841 reg_loss 0.12311694771051407
epoch: 24 s: 256000 batch_loss 0.5945490598678589 BPR_loss 0.47088244557380676 reg_loss 0.12366662919521332
epoch: 24 s: 512000 batch_loss 0.5878161787986755 BPR_loss 0.46341055631637573 reg_loss 0.1244056448340416
epoch: 24 s: 768000 batch_loss 0.5970189571380615 BPR_loss 0.47330915927886963 reg_loss 0.1237097755074501
epoch: 24 s: 1024000 batch_loss 0.5925922989845276 BPR_loss 0.46712660789489746 reg_loss 0.12546569108963013
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 208.20507073402405 | 35.20024228096008 | 357.5077209472656 | [0.0675267  0.11056135 0.14578762] | [0.05548606 0.07172113 0.08404507] | [0.03056556 0.02533788 0.02240485] | [0.40485664 0.5506505  0.63679424] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.5918431878089905 BPR_loss 0.46245184540748596 reg_loss 0.1293913573026657
epoch: 25 s: 256000 batch_loss 0.5971300005912781 BPR_loss 0.46848243474960327 reg_loss 0.1286475658416748
epoch: 25 s: 512000 batch_loss 0.5889332294464111 BPR_loss 0.46187716722488403 reg_loss 0.1270560771226883
epoch: 25 s: 768000 batch_loss 0.5833352208137512 BPR_loss 0.45399975776672363 reg_loss 0.1293354481458664
epoch: 25 s: 1024000 batch_loss 0.5944994688034058 BPR_loss 0.4649662673473358 reg_loss 0.12953320145606995
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 207.09958148002625 | 35.132521629333496 | 356.44549560546875 | [0.06740518 0.1104933  0.14584478] | [0.05554128 0.07177162 0.08415533] | [0.03058608 0.0253292  0.02242748] | [0.40539346 0.55102943 0.63843628] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.5943011045455933 BPR_loss 0.4658898115158081 reg_loss 0.12841132283210754
epoch: 26 s: 256000 batch_loss 0.5896271467208862 BPR_loss 0.4596535861492157 reg_loss 0.12997359037399292
epoch: 26 s: 512000 batch_loss 0.5841520428657532 BPR_loss 0.45275259017944336 reg_loss 0.13139945268630981
epoch: 26 s: 768000 batch_loss 0.5945563912391663 BPR_loss 0.4668199419975281 reg_loss 0.12773646414279938
epoch: 26 s: 1024000 batch_loss 0.5864663124084473 BPR_loss 0.45666536688804626 reg_loss 0.1298009753227234
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 206.86393928527832 | 35.53536772727966 | 355.59527587890625 | [0.06717431 0.11049423 0.14539738] | [0.05531147 0.07164692 0.08387037] | [0.03047398 0.02531578 0.02234695] | [0.40327776 0.55080839 0.63546798] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 27 s: 0 batch_loss 0.5850762128829956 BPR_loss 0.45352938771247864 reg_loss 0.13154684007167816
epoch: 27 s: 256000 batch_loss 0.5870490670204163 BPR_loss 0.4596933126449585 reg_loss 0.12735573947429657
epoch: 27 s: 512000 batch_loss 0.5906307101249695 BPR_loss 0.4604957103729248 reg_loss 0.13013498485088348
epoch: 27 s: 768000 batch_loss 0.5879626274108887 BPR_loss 0.45877957344055176 reg_loss 0.1291830837726593
epoch: 27 s: 1024000 batch_loss 0.5928773283958435 BPR_loss 0.4638245701789856 reg_loss 0.1290527582168579
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   27  | 204.6507089138031 | 35.19321608543396 | 354.7860412597656 | [0.06733254 0.11062907 0.14547969] | [0.05545343 0.07176703 0.08398189] | [0.03056082 0.0253513  0.02237853] | [0.40387773 0.5509347  0.63581533] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 28 s: 0 batch_loss 0.587104856967926 BPR_loss 0.4572440981864929 reg_loss 0.1298607736825943
epoch: 28 s: 256000 batch_loss 0.593298077583313 BPR_loss 0.4606385827064514 reg_loss 0.13265950977802277
epoch: 28 s: 512000 batch_loss 0.5827813148498535 BPR_loss 0.4520127475261688 reg_loss 0.1307685375213623
epoch: 28 s: 768000 batch_loss 0.5842541456222534 BPR_loss 0.4539422392845154 reg_loss 0.13031189143657684
epoch: 28 s: 1024000 batch_loss 0.5808115601539612 BPR_loss 0.4470937252044678 reg_loss 0.1337178498506546
+-------+--------------------+-------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |      Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   28  | 205.80187225341797 | 36.23623514175415 | 353.9736328125 | [0.06733042 0.11042349 0.14556157] | [0.05548439 0.07174237 0.08405908] | [0.03049293 0.02530946 0.02238853] | [0.40428824 0.55058734 0.6375521 ] |
+-------+--------------------+-------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.0673304241090526
early stopping at 28, recall@20:0.0676
