Namespace(K=1, Ks='[20, 40, 60]', batch_size=2048, batch_test_flag=True, context_hops=3, cuda=True, data_path='data/', dataset='yelp2018', dim=64, edge_dropout=False, edge_dropout_rate=0.1, epoch=1000, eps=0.01, gnn='lightgcn', gpu_id=1, l2=0.001, lr=0.007, mess_dropout=False, mess_dropout_rate=0.1, n_negs=64, ns='mixgcf', out_dir='./weights/yelp2018/', pool='mean', save=False, test_batch_size=2048, test_flag='part')
reading train and test user-item set ...
building the adj mat ...
loading over ...
卷积器不需要第0层embedding
拿这个最难的neg_item去和pos_item在每一个维度上自适应权重......
start training ...
epoch: 0 s: 0 batch_loss 0.693148672580719 BPR_loss 0.6931484937667847 reg_loss 1.7170005151001533e-07
epoch: 0 s: 256000 batch_loss 0.6931182742118835 BPR_loss 0.6928554773330688 reg_loss 0.0002627880603540689
epoch: 0 s: 512000 batch_loss 0.6916489601135254 BPR_loss 0.6893582940101624 reg_loss 0.0022906395606696606
epoch: 0 s: 768000 batch_loss 0.6886104941368103 BPR_loss 0.6827828884124756 reg_loss 0.005827617831528187
epoch: 0 s: 1024000 batch_loss 0.6826598644256592 BPR_loss 0.6714454293251038 reg_loss 0.011214419268071651
+-------+--------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   0   | 202.58490681648254 | 36.51820707321167 | 415.95947265625 | [0.06144848 0.10158456 0.13453206] | [0.05038005 0.06550255 0.07704044] | [0.02803461 0.02336191 0.02074965] | [0.38006821 0.5249779  0.6115953 ] |
+-------+--------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 1 s: 0 batch_loss 0.6778307557106018 BPR_loss 0.6623489856719971 reg_loss 0.015481791459023952
epoch: 1 s: 256000 batch_loss 0.6714533567428589 BPR_loss 0.6495358943939209 reg_loss 0.021917488425970078
epoch: 1 s: 512000 batch_loss 0.6667593121528625 BPR_loss 0.6391676664352417 reg_loss 0.027591628953814507
epoch: 1 s: 768000 batch_loss 0.6604259014129639 BPR_loss 0.62675940990448 reg_loss 0.033666495233774185
epoch: 1 s: 1024000 batch_loss 0.660481333732605 BPR_loss 0.6210365295410156 reg_loss 0.03944480046629906
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   1   | 204.57453989982605 | 35.743257999420166 | 403.08319091796875 | [0.06362437 0.10533482 0.13907524] | [0.05207563 0.06778282 0.07958932] | [0.02894247 0.02415609 0.02140278] | [0.39042567 0.53792472 0.62258431] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 2 s: 0 batch_loss 0.6507871150970459 BPR_loss 0.6073499321937561 reg_loss 0.043437205255031586
epoch: 2 s: 256000 batch_loss 0.6516447067260742 BPR_loss 0.6041462421417236 reg_loss 0.047498490661382675
epoch: 2 s: 512000 batch_loss 0.6475468873977661 BPR_loss 0.5945570468902588 reg_loss 0.05298985540866852
epoch: 2 s: 768000 batch_loss 0.6485177278518677 BPR_loss 0.5909208059310913 reg_loss 0.05759692192077637
epoch: 2 s: 1024000 batch_loss 0.6364307403564453 BPR_loss 0.575038731098175 reg_loss 0.06139202415943146
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   2   | 203.03227281570435 | 35.03188490867615 | 391.2754821777344 | [0.06489644 0.10748483 0.1416194 ] | [0.05301711 0.06910315 0.08106024] | [0.02940192 0.02459423 0.02176593] | [0.39620437 0.54379816 0.62858406] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 3 s: 0 batch_loss 0.6361614465713501 BPR_loss 0.5704984068870544 reg_loss 0.06566306948661804
epoch: 3 s: 256000 batch_loss 0.6421129107475281 BPR_loss 0.5722501873970032 reg_loss 0.06986270844936371
epoch: 3 s: 512000 batch_loss 0.6295933127403259 BPR_loss 0.558923602104187 reg_loss 0.07066972553730011
epoch: 3 s: 768000 batch_loss 0.6332710385322571 BPR_loss 0.5562587380409241 reg_loss 0.07701230049133301
epoch: 3 s: 1024000 batch_loss 0.6359583735466003 BPR_loss 0.5590907335281372 reg_loss 0.07686764001846313
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   3   | 200.10603713989258 | 36.082467555999756 | 382.8565368652344 | [0.06558729 0.1088387  0.1431062 ] | [0.05374119 0.07004428 0.08204254] | [0.02976348 0.02486658 0.02195276] | [0.39876216 0.54695592 0.62921561] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 4 s: 0 batch_loss 0.6260062456130981 BPR_loss 0.543670117855072 reg_loss 0.08233614265918732
epoch: 4 s: 256000 batch_loss 0.6180756688117981 BPR_loss 0.533130407333374 reg_loss 0.08494525402784348
epoch: 4 s: 512000 batch_loss 0.6244308948516846 BPR_loss 0.539433479309082 reg_loss 0.08499744534492493
epoch: 4 s: 768000 batch_loss 0.6189689636230469 BPR_loss 0.5280948877334595 reg_loss 0.09087405353784561
epoch: 4 s: 1024000 batch_loss 0.626392662525177 BPR_loss 0.536693811416626 reg_loss 0.08969884365797043
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   4   | 206.10127878189087 | 36.145374059677124 | 376.5650634765625 | [0.06611982 0.10968999 0.14377846] | [0.05410701 0.07054101 0.08249149] | [0.02994032 0.02502921 0.0220596 ] | [0.39993053 0.54919793 0.63174182] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 5 s: 0 batch_loss 0.6183367967605591 BPR_loss 0.5266876220703125 reg_loss 0.09164919704198837
epoch: 5 s: 256000 batch_loss 0.6069701910018921 BPR_loss 0.5099893808364868 reg_loss 0.09698079526424408
epoch: 5 s: 512000 batch_loss 0.6180374622344971 BPR_loss 0.5204126834869385 reg_loss 0.0976247638463974
epoch: 5 s: 768000 batch_loss 0.610519528388977 BPR_loss 0.5125065445899963 reg_loss 0.09801295399665833
epoch: 5 s: 1024000 batch_loss 0.6104719638824463 BPR_loss 0.5090819597244263 reg_loss 0.10138998180627823
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |  tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   5   | 205.98486733436584 | 36.1160933971405 | 371.5032043457031 | [0.06643753 0.1098721  0.14454365] | [0.0543941  0.07077465 0.08292741] | [0.03009821 0.02509631 0.02217275] | [0.40242516 0.54885057 0.63369963] |
+-------+--------------------+------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 6 s: 0 batch_loss 0.6059237122535706 BPR_loss 0.5029897689819336 reg_loss 0.10293396562337875
epoch: 6 s: 256000 batch_loss 0.6080509424209595 BPR_loss 0.5050333142280579 reg_loss 0.1030176430940628
epoch: 6 s: 512000 batch_loss 0.6031827330589294 BPR_loss 0.4955006241798401 reg_loss 0.10768208652734756
epoch: 6 s: 768000 batch_loss 0.6064919829368591 BPR_loss 0.5002947449684143 reg_loss 0.10619723796844482
epoch: 6 s: 1024000 batch_loss 0.6079729795455933 BPR_loss 0.5000573396682739 reg_loss 0.10791566222906113
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   6   | 204.4953055381775 | 39.66161823272705 | 367.4012756347656 | [0.06669795 0.11045754 0.14482364] | [0.05467813 0.07114951 0.08321199] | [0.03026557 0.02520683 0.02221801] | [0.40226727 0.5503663  0.6341733 ] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 7 s: 0 batch_loss 0.6030364036560059 BPR_loss 0.4928057789802551 reg_loss 0.11023061722517014
epoch: 7 s: 256000 batch_loss 0.5969911813735962 BPR_loss 0.48235857486724854 reg_loss 0.11463263630867004
epoch: 7 s: 512000 batch_loss 0.59837806224823 BPR_loss 0.4831382632255554 reg_loss 0.11523981392383575
epoch: 7 s: 768000 batch_loss 0.6010929942131042 BPR_loss 0.487504780292511 reg_loss 0.11358819901943207
epoch: 7 s: 1024000 batch_loss 0.6050969958305359 BPR_loss 0.4900978207588196 reg_loss 0.1149991974234581
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   7   | 207.72062397003174 | 41.914238691329956 | 364.0444641113281 | [0.06679303 0.11012181 0.14489431] | [0.05471835 0.07100048 0.08322731] | [0.03027662 0.0251121  0.02224327] | [0.40236201 0.54986106 0.63407857] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 8 s: 0 batch_loss 0.5986588001251221 BPR_loss 0.4832528829574585 reg_loss 0.11540591716766357
epoch: 8 s: 256000 batch_loss 0.5985590219497681 BPR_loss 0.4816564917564392 reg_loss 0.11690252274274826
epoch: 8 s: 512000 batch_loss 0.5965118408203125 BPR_loss 0.47554224729537964 reg_loss 0.12096957862377167
epoch: 8 s: 768000 batch_loss 0.5832533240318298 BPR_loss 0.46405214071273804 reg_loss 0.1192011907696724
epoch: 8 s: 1024000 batch_loss 0.5944055318832397 BPR_loss 0.4720076322555542 reg_loss 0.12239789962768555
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   8   | 203.9656846523285 | 40.141467332839966 | 361.28424072265625 | [0.06688169 0.11072543 0.14548114] | [0.05480061 0.07129006 0.08349418] | [0.03038714 0.0252842  0.02235011] | [0.4043514  0.55134521 0.63692055] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 9 s: 0 batch_loss 0.5931571125984192 BPR_loss 0.4672403335571289 reg_loss 0.12591677904129028
epoch: 9 s: 256000 batch_loss 0.6023398637771606 BPR_loss 0.4788385033607483 reg_loss 0.12350133806467056
epoch: 9 s: 512000 batch_loss 0.5869801640510559 BPR_loss 0.4624007046222687 reg_loss 0.12457945942878723
epoch: 9 s: 768000 batch_loss 0.5888868570327759 BPR_loss 0.46421658992767334 reg_loss 0.12467028945684433
epoch: 9 s: 1024000 batch_loss 0.5868009328842163 BPR_loss 0.4600362777709961 reg_loss 0.12676465511322021
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   9   | 201.59223818778992 | 45.73936438560486 | 358.4858703613281 | [0.06690767 0.11114473 0.14527871] | [0.05478229 0.07147623 0.08348031] | [0.03032241 0.02537814 0.02233222] | [0.40536188 0.55298724 0.63591007] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 10 s: 0 batch_loss 0.5947228074073792 BPR_loss 0.4651901125907898 reg_loss 0.12953267991542816
epoch: 10 s: 256000 batch_loss 0.5886402726173401 BPR_loss 0.4593321979045868 reg_loss 0.1293080747127533
epoch: 10 s: 512000 batch_loss 0.5941875576972961 BPR_loss 0.4670219123363495 reg_loss 0.12716566026210785
epoch: 10 s: 768000 batch_loss 0.587943434715271 BPR_loss 0.4598296880722046 reg_loss 0.1281137615442276
epoch: 10 s: 1024000 batch_loss 0.5923054218292236 BPR_loss 0.46412086486816406 reg_loss 0.12818458676338196
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   10  | 202.98459243774414 | 39.04085946083069 | 356.1391906738281 | [0.06695942 0.11061516 0.14554338] | [0.05499522 0.0714253  0.08368662] | [0.03043451 0.02527551 0.02234801] | [0.40463559 0.55131363 0.63695213] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 11 s: 0 batch_loss 0.5895645618438721 BPR_loss 0.4582706093788147 reg_loss 0.13129393756389618
epoch: 11 s: 256000 batch_loss 0.5893879532814026 BPR_loss 0.45853090286254883 reg_loss 0.13085705041885376
epoch: 11 s: 512000 batch_loss 0.5832284688949585 BPR_loss 0.45236167311668396 reg_loss 0.13086676597595215
epoch: 11 s: 768000 batch_loss 0.5839925408363342 BPR_loss 0.4537283778190613 reg_loss 0.13026414811611176
epoch: 11 s: 1024000 batch_loss 0.5910497307777405 BPR_loss 0.45719146728515625 reg_loss 0.13385827839374542
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   11  | 201.2495720386505 | 40.78061008453369 | 354.0437927246094 | [0.06701115 0.11083859 0.14505715] | [0.05476883 0.07131178 0.08331875] | [0.03033346 0.02530078 0.02226906] | [0.40387773 0.55134521 0.63565745] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 12 s: 0 batch_loss 0.5857900381088257 BPR_loss 0.4508019983768463 reg_loss 0.13498806953430176
epoch: 12 s: 256000 batch_loss 0.5759267807006836 BPR_loss 0.4416406750679016 reg_loss 0.13428613543510437
epoch: 12 s: 512000 batch_loss 0.5819070935249329 BPR_loss 0.4458860158920288 reg_loss 0.13602107763290405
epoch: 12 s: 768000 batch_loss 0.5841579437255859 BPR_loss 0.4517054557800293 reg_loss 0.13245251774787903
epoch: 12 s: 1024000 batch_loss 0.5729272365570068 BPR_loss 0.43543627858161926 reg_loss 0.13749097287654877
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   12  | 202.44236373901367 | 36.869369983673096 | 352.2347412109375 | [0.06731165 0.11066269 0.14512306] | [0.05509595 0.07141927 0.08354623] | [0.0305024  0.02527236 0.02231169] | [0.40548819 0.55102943 0.63562587] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 13 s: 0 batch_loss 0.580724835395813 BPR_loss 0.44109657406806946 reg_loss 0.13962824642658234
epoch: 13 s: 256000 batch_loss 0.5839704275131226 BPR_loss 0.4487101435661316 reg_loss 0.13526028394699097
epoch: 13 s: 512000 batch_loss 0.5874249935150146 BPR_loss 0.44839906692504883 reg_loss 0.13902594149112701
epoch: 13 s: 768000 batch_loss 0.5786441564559937 BPR_loss 0.43954750895500183 reg_loss 0.13909663259983063
epoch: 13 s: 1024000 batch_loss 0.5862393975257874 BPR_loss 0.4505229592323303 reg_loss 0.13571645319461823
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   13  | 201.49699640274048 | 36.53410840034485 | 350.3429870605469 | [0.06691613 0.11021856 0.1443288 ] | [0.05478046 0.07106574 0.08304087] | [0.0303903  0.02518078 0.02216749] | [0.40311987 0.55200834 0.63294177] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 14 s: 0 batch_loss 0.5719037055969238 BPR_loss 0.4320697486400604 reg_loss 0.1398339569568634
epoch: 14 s: 256000 batch_loss 0.570553183555603 BPR_loss 0.43259191513061523 reg_loss 0.1379612535238266
epoch: 14 s: 512000 batch_loss 0.5766641497612 BPR_loss 0.4371177554130554 reg_loss 0.13954639434814453
epoch: 14 s: 768000 batch_loss 0.5810983777046204 BPR_loss 0.442190557718277 reg_loss 0.1389078050851822
epoch: 14 s: 1024000 batch_loss 0.5783329010009766 BPR_loss 0.4370748698711395 reg_loss 0.14125800132751465
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   14  | 201.47841477394104 | 34.973169803619385 | 348.543701171875 | [0.06690943 0.11004489 0.14493013] | [0.05490072 0.07113745 0.08339711] | [0.03043135 0.02515236 0.02227696] | [0.40390931 0.55071365 0.63512063] |
+-------+--------------------+--------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 15 s: 0 batch_loss 0.5799645781517029 BPR_loss 0.43650513887405396 reg_loss 0.14345942437648773
epoch: 15 s: 256000 batch_loss 0.5750617980957031 BPR_loss 0.4338926076889038 reg_loss 0.14116919040679932
epoch: 15 s: 512000 batch_loss 0.5748860239982605 BPR_loss 0.43237608671188354 reg_loss 0.14250992238521576
epoch: 15 s: 768000 batch_loss 0.5721462965011597 BPR_loss 0.4312913417816162 reg_loss 0.14085495471954346
epoch: 15 s: 1024000 batch_loss 0.5731318593025208 BPR_loss 0.43072307109832764 reg_loss 0.1424088031053543
+-------+--------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |       Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   15  | 201.59680080413818 | 34.30907225608826 | 347.11669921875 | [0.06727741 0.1104267  0.14518928] | [0.0551415  0.0714062  0.08359707] | [0.03056398 0.02525894 0.0223038 ] | [0.40488822 0.55207149 0.63635215] |
+-------+--------------------+-------------------+-----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 16 s: 0 batch_loss 0.564396858215332 BPR_loss 0.421034038066864 reg_loss 0.1433628350496292
epoch: 16 s: 256000 batch_loss 0.5633761286735535 BPR_loss 0.4189996123313904 reg_loss 0.14437653124332428
epoch: 16 s: 512000 batch_loss 0.5722869634628296 BPR_loss 0.42554089426994324 reg_loss 0.14674603939056396
epoch: 16 s: 768000 batch_loss 0.5715137720108032 BPR_loss 0.4279886484146118 reg_loss 0.1435251384973526
epoch: 16 s: 1024000 batch_loss 0.5758883357048035 BPR_loss 0.42645370960235596 reg_loss 0.1494346410036087
+-------+--------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |      Loss      |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   16  | 203.29225611686707 | 35.343939542770386 | 345.6181640625 | [0.06748365 0.11026559 0.14471391] | [0.0552543  0.07139124 0.08344509] | [0.03059871 0.02527473 0.02224222] | [0.40665656 0.55106101 0.6341733 ] |
+-------+--------------------+--------------------+----------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 17 s: 0 batch_loss 0.570241391658783 BPR_loss 0.42819690704345703 reg_loss 0.14204449951648712
epoch: 17 s: 256000 batch_loss 0.5751600861549377 BPR_loss 0.4280828535556793 reg_loss 0.14707721769809723
epoch: 17 s: 512000 batch_loss 0.5693207383155823 BPR_loss 0.42258816957473755 reg_loss 0.14673256874084473
epoch: 17 s: 768000 batch_loss 0.579558253288269 BPR_loss 0.4328641891479492 reg_loss 0.14669404923915863
epoch: 17 s: 1024000 batch_loss 0.570985734462738 BPR_loss 0.4235677719116211 reg_loss 0.14741797745227814
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   17  | 204.0548961162567 | 35.576878786087036 | 344.43890380859375 | [0.06717386 0.1102902  0.14474632] | [0.05518568 0.07140867 0.08350871] | [0.03053556 0.02523604 0.02227327] | [0.40593028 0.55055577 0.63407857] |
+-------+-------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 18 s: 0 batch_loss 0.5659942626953125 BPR_loss 0.41756218671798706 reg_loss 0.14843206107616425
epoch: 18 s: 256000 batch_loss 0.5717698335647583 BPR_loss 0.421568363904953 reg_loss 0.1502014696598053
epoch: 18 s: 512000 batch_loss 0.5664255619049072 BPR_loss 0.41868263483047485 reg_loss 0.14774292707443237
epoch: 18 s: 768000 batch_loss 0.5690784454345703 BPR_loss 0.4235278069972992 reg_loss 0.1455506533384323
epoch: 18 s: 1024000 batch_loss 0.5700948238372803 BPR_loss 0.4207702577114105 reg_loss 0.14932453632354736
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   18  | 203.9792981147766 | 35.32073640823364 | 343.1802062988281 | [0.06706111 0.1100743  0.14445755] | [0.05511442 0.07129904 0.08335558] | [0.03044872 0.02516026 0.02218749] | [0.40460402 0.54986106 0.63287862] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 19 s: 0 batch_loss 0.5656875371932983 BPR_loss 0.41894975304603577 reg_loss 0.14673779904842377
epoch: 19 s: 256000 batch_loss 0.5645889043807983 BPR_loss 0.4145256578922272 reg_loss 0.15006324648857117
epoch: 19 s: 512000 batch_loss 0.5614792704582214 BPR_loss 0.4127048850059509 reg_loss 0.1487743854522705
epoch: 19 s: 768000 batch_loss 0.5684376955032349 BPR_loss 0.4199998080730438 reg_loss 0.14843788743019104
epoch: 19 s: 1024000 batch_loss 0.5658732056617737 BPR_loss 0.41345763206481934 reg_loss 0.15241558849811554
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s) |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   19  | 203.2819368839264 | 34.80267572402954 | 341.7130126953125 | [0.06702311 0.10951833 0.14426763] | [0.055022   0.07102115 0.08320101] | [0.03043135 0.02506868 0.02215854] | [0.40454086 0.54844007 0.63278388] |
+-------+-------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 20 s: 0 batch_loss 0.5668678283691406 BPR_loss 0.4170650243759155 reg_loss 0.1498028188943863
epoch: 20 s: 256000 batch_loss 0.5629475116729736 BPR_loss 0.4090164303779602 reg_loss 0.15393106639385223
epoch: 20 s: 512000 batch_loss 0.5577360987663269 BPR_loss 0.40839868783950806 reg_loss 0.14933742582798004
epoch: 20 s: 768000 batch_loss 0.5569323301315308 BPR_loss 0.405788391828537 reg_loss 0.15114393830299377
epoch: 20 s: 1024000 batch_loss 0.5659300684928894 BPR_loss 0.4117337167263031 reg_loss 0.1541963666677475
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   20  | 203.15156841278076 | 34.563576221466064 | 340.4398193359375 | [0.0668793  0.11004105 0.14431336] | [0.05498039 0.07123676 0.08327716] | [0.03037135 0.02517762 0.02220328] | [0.40381458 0.54916635 0.63249968] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 21 s: 0 batch_loss 0.5595411658287048 BPR_loss 0.40445512533187866 reg_loss 0.15508605539798737
epoch: 21 s: 256000 batch_loss 0.5720455646514893 BPR_loss 0.41629308462142944 reg_loss 0.15575245022773743
epoch: 21 s: 512000 batch_loss 0.5606743693351746 BPR_loss 0.40683189034461975 reg_loss 0.15384246408939362
epoch: 21 s: 768000 batch_loss 0.5563684701919556 BPR_loss 0.405207097530365 reg_loss 0.15116138756275177
epoch: 21 s: 1024000 batch_loss 0.5660364031791687 BPR_loss 0.413079172372818 reg_loss 0.1529572308063507
+-------+--------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |  tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   21  | 202.49042415618896 | 34.0290789604187 | 339.50628662109375 | [0.06692675 0.10990013 0.14421661] | [0.05500979 0.07121425 0.0832353 ] | [0.03038556 0.02516184 0.02215696] | [0.40397246 0.54802956 0.63196286] |
+-------+--------------------+------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 22 s: 0 batch_loss 0.561720609664917 BPR_loss 0.4100968539714813 reg_loss 0.15162375569343567
epoch: 22 s: 256000 batch_loss 0.5556881427764893 BPR_loss 0.4012577533721924 reg_loss 0.15443041920661926
epoch: 22 s: 512000 batch_loss 0.557689905166626 BPR_loss 0.40388914942741394 reg_loss 0.15380072593688965
epoch: 22 s: 768000 batch_loss 0.5679658651351929 BPR_loss 0.4120938777923584 reg_loss 0.15587201714515686
epoch: 22 s: 1024000 batch_loss 0.5676546692848206 BPR_loss 0.4180312156677246 reg_loss 0.14962343871593475
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |       Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   22  | 202.94604992866516 | 34.51907515525818 | 338.328369140625 | [0.0667452  0.11005903 0.14425195] | [0.05496032 0.07128127 0.08324651] | [0.0303382  0.02521789 0.0221617 ] | [0.40431982 0.5491032  0.63328912] |
+-------+--------------------+-------------------+------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 23 s: 0 batch_loss 0.5531030297279358 BPR_loss 0.400033563375473 reg_loss 0.15306946635246277
epoch: 23 s: 256000 batch_loss 0.5614550113677979 BPR_loss 0.40949705243110657 reg_loss 0.15195795893669128
epoch: 23 s: 512000 batch_loss 0.5575488209724426 BPR_loss 0.4020513892173767 reg_loss 0.15549743175506592
epoch: 23 s: 768000 batch_loss 0.5602466464042664 BPR_loss 0.4086511731147766 reg_loss 0.15159547328948975
epoch: 23 s: 1024000 batch_loss 0.5506407618522644 BPR_loss 0.39275065064430237 reg_loss 0.15789011120796204
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   23  | 202.01617121696472 | 34.77262020111084 | 337.30487060546875 | [0.06638029 0.10945556 0.14399101] | [0.05444044 0.07070741 0.08278349] | [0.03016926 0.02509552 0.02210854] | [0.40169888 0.54771378 0.63227864] |
+-------+--------------------+-------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 24 s: 0 batch_loss 0.5522174835205078 BPR_loss 0.39857977628707886 reg_loss 0.15363773703575134
epoch: 24 s: 256000 batch_loss 0.5595340728759766 BPR_loss 0.40565115213394165 reg_loss 0.1538829356431961
epoch: 24 s: 512000 batch_loss 0.5506856441497803 BPR_loss 0.39503324031829834 reg_loss 0.15565238893032074
epoch: 24 s: 768000 batch_loss 0.5595595240592957 BPR_loss 0.4061356782913208 reg_loss 0.15342386066913605
epoch: 24 s: 1024000 batch_loss 0.5559111833572388 BPR_loss 0.3999773859977722 reg_loss 0.15593381226062775
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss        |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   24  | 201.09672951698303 | 35.833505630493164 | 336.44366455078125 | [0.06630287 0.10944246 0.1437077 ] | [0.05446823 0.07072029 0.08271799] | [0.03017557 0.02504895 0.0220517 ] | [0.40255147 0.54780851 0.63098396] |
+-------+--------------------+--------------------+--------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 25 s: 0 batch_loss 0.5539557337760925 BPR_loss 0.3941207528114319 reg_loss 0.15983499586582184
epoch: 25 s: 256000 batch_loss 0.5583485960960388 BPR_loss 0.40017008781433105 reg_loss 0.15817850828170776
epoch: 25 s: 512000 batch_loss 0.5566914081573486 BPR_loss 0.4001091718673706 reg_loss 0.15658225119113922
epoch: 25 s: 768000 batch_loss 0.5518683791160583 BPR_loss 0.3932637572288513 reg_loss 0.15860462188720703
epoch: 25 s: 1024000 batch_loss 0.5614883899688721 BPR_loss 0.4018572270870209 reg_loss 0.15963114798069
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)  |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   25  | 201.82677268981934 | 35.35864806175232 | 335.3038635253906 | [0.06672291 0.10960058 0.14401355] | [0.05486067 0.07098404 0.08303742] | [0.03037451 0.02511763 0.02214275] | [0.40431982 0.54837691 0.63221549] |
+-------+--------------------+-------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
epoch: 26 s: 0 batch_loss 0.5590129494667053 BPR_loss 0.40141913294792175 reg_loss 0.15759381651878357
epoch: 26 s: 256000 batch_loss 0.5550073981285095 BPR_loss 0.3957618176937103 reg_loss 0.1592455804347992
epoch: 26 s: 512000 batch_loss 0.5497688055038452 BPR_loss 0.3889393210411072 reg_loss 0.16082945466041565
epoch: 26 s: 768000 batch_loss 0.5616258382797241 BPR_loss 0.4051956534385681 reg_loss 0.15643015503883362
epoch: 26 s: 1024000 batch_loss 0.5545401573181152 BPR_loss 0.39610689878463745 reg_loss 0.1584332287311554
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Epoch |  training time(s)  |   tesing time(s)   |        Loss       |               recall               |                ndcg                |             precision              |             hit_ratio              |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|   26  | 201.32678651809692 | 34.460692405700684 | 334.3720397949219 | [0.06610618 0.10893018 0.14331256] | [0.05435271 0.07046743 0.08251033] | [0.0301061  0.02495974 0.0220296 ] | [0.40157257 0.54591386 0.63104711] |
+-------+--------------------+--------------------+-------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 10 log:0.06610618152682127
early stopping at 26, recall@20:0.0675
